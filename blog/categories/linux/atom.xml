<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: linux | Core dump overflow]]></title>
  <link href="http://chousensha.github.io/blog/categories/linux/atom.xml" rel="self"/>
  <link href="http://chousensha.github.io/"/>
  <updated>2018-02-28T13:43:02-05:00</updated>
  <id>http://chousensha.github.io/</id>
  <author>
    <name><![CDATA[chousensha]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[LFCS prep - User and group management]]></title>
    <link href="http://chousensha.github.io/blog/2018/02/28/lfcs-prep-user-and-group-management/"/>
    <updated>2018-02-28T13:26:56-05:00</updated>
    <id>http://chousensha.github.io/blog/2018/02/28/lfcs-prep-user-and-group-management</id>
    <content type="html"><![CDATA[<p>Various commands for the LFCS User and Group Management domain, which at the time of this post can be found at <a href="https://training.linuxfoundation.org/images/pdfs/LFCS_Domains_Competencies_V2.16.pdf">https://training.linuxfoundation.org/images/pdfs/LFCS_Domains_Competencies_V2.16.pdf</a></p>

<!-- more -->


<p><img class="center" src="/images/sysadmin/users.png" title="&lsquo;user cmds&rsquo; &lsquo;user and group cmds&rsquo;" ></p>

<h4>ulimit</h4>

<blockquote><p>Provides control over the resources available  to the shell and to processes started by it, on systems that allow such control</p></blockquote>

<p>```
help ulimit
ulimit: ulimit [-SHacdefilmnpqrstuvx] [limit]</p>

<pre><code>Modify shell resource limits.

Provides control over the resources available to the shell and processes
it creates, on systems that allow such control.

Options:
  -S    use the `soft' resource limit
  -H    use the `hard' resource limit
  -a    all current limits are reported
  -b    the socket buffer size
  -c    the maximum size of core files created
  -d    the maximum size of a process's data segment
  -e    the maximum scheduling priority (`nice')
  -f    the maximum size of files written by the shell and its children
  -i    the maximum number of pending signals
  -l    the maximum size a process may lock into memory
  -m    the maximum resident set size
  -n    the maximum number of open file descriptors
  -p    the pipe buffer size
  -q    the maximum number of bytes in POSIX message queues
  -r    the maximum real-time scheduling priority
  -s    the maximum stack size
  -t    the maximum amount of cpu time in seconds
  -u    the maximum number of user processes
  -v    the size of virtual memory
  -x    the maximum number of file locks

If LIMIT is given, it is the new value of the specified resource; the
special LIMIT values `soft', `hard', and `unlimited' stand for the
current soft limit, the current hard limit, and no limit, respectively.
Otherwise, the current value of the specified resource is printed.  If
no option is given, then -f is assumed.

Values are in 1024-byte increments, except for -t, which is in seconds,
-p, which is in increments of 512 bytes, and -u, which is an unscaled
number of processes.

Exit Status:
Returns success unless an invalid option is supplied or an error occurs.
</code></pre>

<p>```</p>

<p>Config file in <strong>/etc/security/limits.conf</strong></p>

<ul>
<li>list current limits</li>
</ul>


<p><code>
ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 7238
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 7238
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
</code></p>

<h4>quotacheck</h4>

<blockquote><p>scan a filesystem for disk usage, create, check and repair quota files</p></blockquote>

<h4>quotaon, quotaoff</h4>

<blockquote><p>turn filesystem quotas on and off</p></blockquote>

<h4>repquota</h4>

<blockquote><p>summarize quotas for a filesystem</p></blockquote>

<h4>setquota</h4>

<blockquote><p>set disk quotas</p></blockquote>

<h4>edquota</h4>

<blockquote><p>edit user quotas</p></blockquote>

<h4>pwscore</h4>

<blockquote><p>simple configurable tool for checking quality of a password</p>

<p>password is read from stdin</p>

<p>It either reports an error if the password fails any of the checks,  or it  prints out the password quality score as an integer value between 0 and 100.</p></blockquote>

<h4>getent</h4>

<blockquote><p>get entries from Name Service Switch libraries</p></blockquote>

<ul>
<li>enumerate networks</li>
</ul>


<p><code>
getent networks
default               0.0.0.0
loopback              127.0.0.0
link-local            169.254.0.0
</code></p>

<h4>set</h4>

<blockquote><p>list shell attributes</p></blockquote>

<p><code>
set -o
allexport       off
braceexpand     on
emacs           on
errexit         off
errtrace        off
functrace       off
hashall         on
histexpand      on
history         on
ignoreeof       off
interactive-comments    on
keyword         off
monitor         on
noclobber       off
noexec          off
noglob          off
nolog           off
notify          off
nounset         off
onecmd          off
physical        off
pipefail        off
posix           off
privileged      off
verbose         off
vi              off
xtrace          off
</code></p>

<ul>
<li><p>-o <option name> set option to on</p></li>
<li><p>+o <option name> set option to off</p></li>
</ul>


<p>Example: noclobber protects files from being accidentally overwritten with >. To set it at login, add it in .bashrc. You can still overwrite with: <strong>>|</strong></p>

<h4>who</h4>

<blockquote><p>show who is logged on</p></blockquote>

<p><code>
who
root     :0           2017-09-19 12:38 (:0)
root     pts/0        2017-09-19 12:38 (:0)
root     pts/1        2017-09-19 12:40 (:0)
</code></p>

<ul>
<li>b # time of last system boot</li>
</ul>


<p>```
who -b</p>

<pre><code>     system boot  2017-09-19 12:36
</code></pre>

<p>```</p>

<ul>
<li>q # all login names and number of users logged on</li>
</ul>


<p>```
who -q
root root root</p>

<h1>users=3</h1>

<p>```</p>

<ul>
<li>r # print current runlevel</li>
</ul>


<p>```
who -r</p>

<pre><code>     run-level 5  2017-09-20 13:15
</code></pre>

<p>```</p>

<h4>id</h4>

<blockquote><p>print real and effective user and group IDs</p></blockquote>

<ul>
<li>print all group IDs</li>
</ul>


<p><code>
id -G madhat
1000 10
</code></p>

<ul>
<li>print group names</li>
</ul>


<p><code>
id -Gn madhat
madhat wheel
</code></p>

<h4>useradd</h4>

<blockquote><p>create a new user or update default new user information</p></blockquote>

<ul>
<li>-c # Any text string. It is generally a short description of the login, and is currently used as the field for the user&rsquo;s full name.</li>
<li>-e # expire date. The date on which the user account will be disabled. The date is specified in the format YYYY-MM-DD.</li>
</ul>


<p>If not specified, useradd will use the default expiry date specified by the EXPIRE variable in /etc/default/useradd, or an empty string (no expiry) by default.</p>

<ul>
<li>-g # The group name or number of the user&rsquo;s initial login group. The group name must exist. A group number must refer to an already existing group.</li>
<li>-G # A list of supplementary groups which the user is also a member of. Each group is separated from the next by a comma, with no intervening whitespace</li>
<li>-m # Create the user&rsquo;s home directory if it does not exist</li>
<li><p>-s # The name of the user&rsquo;s login shell</p></li>
<li><p>create user, specify primary and supplementary groups, create home directory, specify login shell</p></li>
</ul>


<p><code>
useradd -c 'sample user' -g samplegroup -G users -m -s /bin/sh nixer
grep nixer /etc/passwd
nixer:x:1001:1025:sample user:/home/nixer:/bin/sh
</code></p>

<ul>
<li>list defaults</li>
</ul>


<p><code>
useradd -D
GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/bash
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes
</code></p>

<h4>adduser</h4>

<ul>
<li>symlink to useradd on CentOS, Perl script on Debian / Ubuntu</li>
</ul>


<h4>usermod</h4>

<blockquote><p>modify a user account</p></blockquote>

<ul>
<li>-c # new comment</li>
<li>-d # new home directory</li>
<li>-l # new login name</li>
<li>-s # new shell</li>
</ul>


<h4>chsh</h4>

<blockquote><p>change your login shell</p></blockquote>

<ul>
<li><p>-s # new shell</p></li>
<li><p>list shells</p></li>
</ul>


<p><code>
chsh -l
/bin/sh
/bin/bash
/sbin/nologin
/usr/bin/sh
/usr/bin/bash
/usr/sbin/nologin
/bin/tcsh
/bin/csh
</code></p>

<h4>userdel</h4>

<blockquote><p>delete a user account and related files</p></blockquote>

<h4>chpasswd</h4>

<blockquote><p>update passwords in batch mode</p>

<p>The chpasswd command reads a list of user name and password pairs from
standard input and uses this information to update a group of existing
users. Each line is of the format:</p>

<p>user_name:password</p>

<p>This command is intended to be used in a large system environment where
many accounts are created at a single time.</p></blockquote>

<h4>chage</h4>

<blockquote><p>change user password expiry information</p></blockquote>

<ul>
<li>set password expiration date and list account aging information</li>
</ul>


<p><code>
chage -E 2017-11-20 madhat
[root@tron ~]# chage -l madhat
Last password change                    : never
Password expires                    : never
Password inactive                   : never
Account expires                     : Nov 20, 2017
Minimum number of days between password change      : 0
Maximum number of days between password change      : 99999
Number of days of warning before password expires   : 7
</code></p>

<h4>pwconv</h4>

<blockquote><p>creates shadow from passwd and an optionally existing shadow.</p></blockquote>

<h4>pwunconv</h4>

<blockquote><p>creates passwd from passwd and shadow and then removes shadow.</p></blockquote>

<h4>grpconv</h4>

<blockquote><p>creates gshadow from group and an optionally existing gshadow.</p></blockquote>

<h4>grpunconv</h4>

<blockquote><p>creates group from group and gshadow and then removes gshadow.</p></blockquote>

<h4>newgrp</h4>

<blockquote><p>log in to a new group &ndash; change the current group ID during a login session</p></blockquote>

<h4>groupadd</h4>

<blockquote><p>create a new group</p></blockquote>

<ul>
<li>-g # GID value</li>
</ul>


<h4>gpasswd</h4>

<blockquote><p>administer /etc/group and /etc/gshadow</p></blockquote>

<ul>
<li>-a # add user to group</li>
<li>-d # delete user from group</li>
<li>-M # set list of group members</li>
</ul>


<h4>chgrp</h4>

<blockquote><p>change group ownership</p>

<p>chgrp [OPTION]&hellip; GROUP FILE</p></blockquote>

<ul>
<li>-R # operate on files and directories recursively</li>
</ul>


<p>```</p>

<hr />

<p>/ You get along very well with everyone \
\ except animals and people.            /</p>

<hr />

<pre><code>    \   ^__^
     \  (oo)\_______
        (__)\       )\/\
            ||----w |
            ||     ||
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LFCS prep - Operation of running systems]]></title>
    <link href="http://chousensha.github.io/blog/2018/02/27/lfcs-prep-operation-of-running-systems/"/>
    <updated>2018-02-27T12:54:56-05:00</updated>
    <id>http://chousensha.github.io/blog/2018/02/27/lfcs-prep-operation-of-running-systems</id>
    <content type="html"><![CDATA[<p>Various commands for the LFCS Operation of Running Systems domain, which at the time of this post can be found at <a href="https://training.linuxfoundation.org/images/pdfs/LFCS_Domains_Competencies_V2.16.pdf">https://training.linuxfoundation.org/images/pdfs/LFCS_Domains_Competencies_V2.16.pdf</a></p>

<!-- more -->


<p><img class="center" src="/images/sysadmin/os1.png" title="&lsquo;linux cmds&rsquo; &lsquo;linux operation&rsquo;" ></p>

<p><img class="center" src="/images/sysadmin/os2.png" title="&lsquo;linux cmds&rsquo; &lsquo;linux operation&rsquo;" ></p>

<ul>
<li>systemd-analyze</li>
</ul>


<blockquote><p>Analyze system boot-up performance</p></blockquote>

<p><code>
systemd-analyze
Startup finished in 403ms (kernel) + 1.517s (initrd) + 37.584s (userspace) = 39.505s
</code></p>

<h4>crontab</h4>

<blockquote><p> maintains crontab files for individual users</p>

<p>Crontab  is the program used to install, remove or list the tables used to serve the
cron(8) daemon.  Each user can have their own crontab, and though  these  are  files
in  /var/spool/, they are not intended to be edited directly</p></blockquote>

<ul>
<li>format of crontab entry</li>
</ul>


<p>```
cat /etc/crontab
SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root</p>

<h1>For details see man 4 crontabs</h1>

<h1>Example of job definition:</h1>

<h1>.&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash; minute (0 &ndash; 59)</h1>

<h1>|  .&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash; hour (0 &ndash; 23)</h1>

<h1>|  |  .&mdash;&mdash;&mdash;&mdash;&mdash; day of month (1 &ndash; 31)</h1>

<h1>|  |  |  .&mdash;&mdash;&mdash;&ndash; month (1 &ndash; 12) OR jan,feb,mar,apr &hellip;</h1>

<h1>|  |  |  |  .&mdash;&mdash; day of week (0 &ndash; 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</h1>

<h1>|  |  |  |  |</h1>

<h1>*  *  *  *  * user-name  command to be executed</h1>

<p>```</p>

<ul>
<li>run uptime as root every minute, hour, day of month, month, on weekdays</li>
</ul>


<p><code>
crontab -e
* * * * 1-5 uptime &gt;&gt; /root/log.txt
</code></p>

<p>```
You have new mail in /var/spool/mail/root
[root@tron ~]# mail
Heirloom Mail version 12.5 7/5/10.  Type ? for help.
&ldquo;/var/spool/mail/root&rdquo;: 4 messages 4 new</p>

<blockquote><p>N  1 (Cron Daemon)         Mon Oct  9 14:10  25/850   &ldquo;Cron &lt;root@tron> root&rdquo;
 N  2 (Cron Daemon)         Mon Oct  9 14:11  25/850   &ldquo;Cron &lt;root@tron> root&rdquo;
 N  3 (Cron Daemon)         Mon Oct  9 14:12  25/850   &ldquo;Cron &lt;root@tron> root&rdquo;
 N  4 (Cron Daemon)         Mon Oct  9 14:13  25/850   &ldquo;Cron &lt;root@tron> root&rdquo;
```</p></blockquote>

<p><code>
 cat log.txt
 14:29:02 up  1:03,  3 users,  load average: 0.01, 0.09, 0.12
 14:30:01 up  1:04,  3 users,  load average: 0.39, 0.24, 0.18
</code></p>

<h4>anacron</h4>

<blockquote><p>runs commands periodically</p>

<p>Unlike cron(8), it does not assume that the machine is  running  continuously. <br/>
Hence, it can be used on machines that are not running 24 hours a day to control
regular jobs  as  daily,  weekly, and monthly jobs</p></blockquote>

<p>```
 cat /etc/anacrontab
 # /etc/anacrontab: configuration file for anacron</p>

<p> # See anacron(8) and anacrontab(5) for details.</p>

<p> SHELL=/bin/sh
 PATH=/sbin:/bin:/usr/sbin:/usr/bin
 MAILTO=root
 # the maximal random delay added to the base delay of the jobs
 RANDOM_DELAY=45
 # the jobs will be started during the following hours only
 START_HOURS_RANGE=3-22</p>

<p> #period in days   delay in minutes   job-identifier   command
 1  5   cron.daily      nice run-parts /etc/cron.daily
 7  25  cron.weekly     nice run-parts /etc/cron.weekly
 @monthly 45    cron.monthly        nice run-parts /etc/cron.monthly
```</p>

<ul>
<li>anacron job</li>
</ul>


<p><code>
1 1 demo netstat -lnt &gt; /root/conn.txt
</code></p>

<p>Check validity of job file with <code>anacron -T</code></p>

<h4>at</h4>

<blockquote><p>executes commands at a specified time</p></blockquote>

<ul>
<li>schedule job and use Ctrl-D at the prompt when you&rsquo;re done</li>
</ul>


<p><code>
 at 19:08 oct 09
 at&gt; netstat -lnt &gt; /root/ports.txt
 at&gt; &lt;EOT&gt;
 job 3 at Mon Oct  9 19:08:00 2017
</code></p>

<h4>atq</h4>

<blockquote><p>lists  the  user&rsquo;s  pending  jobs, unless the user is the superuser; in that case,
everybody&rsquo;s jobs are listed.</p></blockquote>

<p><code>
 [root@tron ~]# atq
 3  Mon Oct  9 19:08:00 2017 a root
</code></p>

<h4>ldd</h4>

<blockquote><p>print shared library dependencies</p>

<p>In the usual  case,  ldd  invokes  the  standard  dynamic  linker  (see ld.so(8))<br/>
with the LD_TRACE_LOADED_OBJECTS environment variable set to 1, which causes the
linker to display  the  library  dependencies.   Be aware,  > however,  that  in some
circumstances, some versions of ldd may attempt to obtain the dependency information
by directly executing  the program.  Thus, you should never employ ldd on an untrusted
executable, since this may result in the execution  of  arbitrary  code.   A  safer
alternative when dealing with untrusted executables is:</p>

<p>$ objdump -p /path/to/program | grep NEEDED</p></blockquote>

<p>```
 ldd /usr/bin/bash</p>

<pre><code>linux-vdso.so.1 =&gt;  (0x00007fff62b20000)
libtinfo.so.5 =&gt; /lib64/libtinfo.so.5 (0x00007ff06afba000)
libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007ff06adb6000)
libc.so.6 =&gt; /lib64/libc.so.6 (0x00007ff06a9f4000)
/lib64/ld-linux-x86-64.so.2 (0x00007ff06b1f9000)
</code></pre>

<p>```</p>

<h4>sar</h4>

<blockquote><p>Collect, report, or save system activity information</p></blockquote>

<ul>
<li>CPU activity</li>
</ul>


<p>```
 sar
 Linux 3.10.0-514.26.2.el7.x86_64 (tron)    10/05/2017  <em>x86_64</em>    (1 CPU)</p>

<p> 03:57:29 PM       LINUX RESTART</p>

<p> 04:00:01 PM     CPU     %user     %nice   %system   %iowait    %steal     %idle
 04:10:01 PM     all      2.66      0.00      1.02      0.15      0.00     96.17
 04:20:01 PM     all      2.64      0.00      0.83      0.01      0.00     96.52
 04:30:01 PM     all      0.65      0.03      0.94      0.09      0.00     98.28
 04:40:01 PM     all      0.35      0.00      0.20      0.00      0.00     99.45
 04:50:01 PM     all      0.25      0.00      0.14      0.00      0.00     99.60
 05:00:01 PM     all      0.24      0.00      0.17      0.00      0.00     99.58
 05:10:01 PM     all      0.24      0.00      0.17      0.00      0.00     99.59
 05:20:01 PM     all      0.35      0.00      0.20      0.00      0.00     99.45
 05:30:01 PM     all      0.40      0.00      0.24      0.00      0.00     99.36
 05:40:01 PM     all      0.51      0.00      0.21      0.00      0.00     99.27
 05:50:01 PM     all      5.88      0.00      1.51      0.02      0.00     92.59
 06:00:02 PM     all      0.48      0.00      0.25      0.00      0.00     99.27
 06:10:01 PM     all      0.16      0.00      0.19      0.00      0.00     99.65
 06:20:01 PM     all      2.16      0.00      0.59      0.01      0.00     97.25
 06:30:01 PM     all      2.94      0.00      0.69      0.00      0.00     96.37
 06:40:01 PM     all      0.10      0.00      0.18      0.00      0.00     99.72
 06:50:01 PM     all      0.11      0.00      0.13      0.00      0.00     99.76
 07:00:02 PM     all      0.17      0.00      0.21      0.00      0.00     99.62
 07:10:01 PM     all      0.10      0.00      0.15      0.00      0.00     99.76
 07:20:01 PM     all      0.10      0.00      0.14      0.00      0.00     99.76
 07:30:01 PM     all      0.14      0.00      0.16      0.00      0.00     99.70
 07:40:02 PM     all      0.10      0.00      0.14      0.00      0.00     99.76</p>

<p> 07:40:02 PM     CPU     %user     %nice   %system   %iowait    %steal     %idle
 07:50:01 PM     all      0.09      0.00      0.15      0.00      0.00     99.75
 08:00:01 PM     all      0.19      0.00      0.26      0.00      0.00     99.55
 08:10:01 PM     all      0.44      0.00      0.22      0.00      0.00     99.34
 Average:        all      0.84      0.00      0.36      0.01      0.00     98.78
```</p>

<ul>
<li>memory statistics</li>
</ul>


<p>```
 sar -r
 Linux 3.10.0-514.26.2.el7.x86_64 (tron)    10/05/2017  <em>x86_64</em>    (1 CPU)</p>

<p> 03:57:29 PM       LINUX RESTART</p>

<p> 04:00:01 PM kbmemfree kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty
 04:10:01 PM    889804    994304     52.77      1004    382376   2556680     64.22    522128    294044        12
 04:20:01 PM    890844    993264     52.72      1004    382456   2556872     64.22    521256    294004         4
 04:30:01 PM    802736   1081372     57.39      1004    387280   2557724     64.24    524088    296556         0
 04:40:01 PM    802744   1081364     57.39      1004    387320   2557724     64.24    524120    296564        12
 04:50:01 PM    802712   1081396     57.40      1004    387296   2557724     64.24    524096    296556         0
 05:00:01 PM    802640   1081468     57.40      1004    387304   2582312     64.86    524252    296544         8
 05:10:01 PM    803032   1081076     57.38      1004    387288   2581776     64.85    524048    296516         0
 05:20:01 PM    798948   1085160     57.60      1004    387288   2581776     64.85    528108    296516         0
 05:30:01 PM    798808   1085300     57.60      1004    387312   2581776     64.85    528156    296524        20
 05:40:01 PM    798552   1085556     57.62      1004    387344   2581720     64.85    528424    296520         0
 05:50:01 PM    773308   1110800     58.96      1004    388048   2605656     65.45    553040    297056         0
 06:00:02 PM    773116   1110992     58.97      1004    388056   2605656     65.45    553196    297056         0
 06:10:01 PM    770812   1113296     59.09      1004    388564   2605664     65.45    554944    297556         0
 06:20:01 PM    733504   1150604     61.07      1004    388708   2642264     66.37    592036    297640         0
 06:30:01 PM    732720   1151388     61.11      1004    388852   2642544     66.37    592928    297552         0
 06:40:01 PM    732732   1151376     61.11      1004    388884   2642608     66.38    592956    297556         8
 06:50:01 PM    732640   1151468     61.11      1004    388864   2642608     66.38    592948    297556         0
 07:00:02 PM    732616   1151492     61.12      1004    388872   2642608     66.38    593060    297496         0
 07:10:01 PM    732512   1151596     61.12      1004    388880   2642608     66.38    593120    297496         0
 07:20:01 PM    732536   1151572     61.12      1004    388888   2642608     66.38    593324    297320         0
 07:30:01 PM    732452   1151656     61.12      1004    388896   2642608     66.38    593348    297320         0
 07:40:02 PM    732424   1151684     61.13      1004    388924   2642608     66.38    593364    297324         4</p>

<p> 07:40:02 PM kbmemfree kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty
 07:50:01 PM    732388   1151720     61.13      1004    388908   2642608     66.38    593376    297320         0
 08:00:01 PM    732444   1151664     61.13      1004    388956   2642608     66.38    594632    296136         8
 08:10:01 PM    752844   1131264     60.04      1004    388988   2621972     65.86    574028    296148         0
 Average:       772795   1111313     58.98      1004    387782   2608132     65.51    560359    296755         3
```</p>

<h4>iostat</h4>

<blockquote><p>report CPU statistics and input/output statistics for devices and partitions.</p></blockquote>

<p>```
 iostat
 Linux 3.10.0-514.26.2.el7.x86_64 (tron)    10/05/2017  <em>x86_64</em>    (1 CPU)</p>

<p> avg-cpu:  %user   %nice %system %iowait  %steal   %idle</p>

<pre><code>        1.41    0.01    0.76    0.20    0.00   97.61
</code></pre>

<p> Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn
 sda               2.09        54.42         6.10     452565      50723
 dm-0              1.85        50.73         5.85     421879      48655
 dm-1              0.02         0.13         0.00       1068          0
```</p>

<h4>pidstat</h4>

<blockquote><p>Report statistics for Linux tasks</p></blockquote>

<p>```
 pidstat -p 3381
 Linux 3.10.0-514.26.2.el7.x86_64 (tron)    10/05/2017  <em>x86_64</em>    (1 CPU)</p>

<p> 06:20:21 PM   UID       PID    %usr %system  %guest    %CPU   CPU  Command
```</p>

<h4>mpstat</h4>

<blockquote><p>Report processors related statistics</p></blockquote>

<p>```
 mpstat
 Linux 3.10.0-514.26.2.el7.x86_64 (tron)    10/05/2017  <em>x86_64</em>    (1 CPU)</p>

<p> 06:23:38 PM  CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest  %gnice   %idle
 06:23:38 PM  all    1.59    0.01    0.76    0.20    0.00    0.02    0.00    0.00    0.00   97.42
```</p>

<h4>vmstat</h4>

<blockquote><p>Report virtual memory statistics</p></blockquote>

<p><code>
 vmstat
 procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----
  r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st
  4  0      0 776148   1004 503192    0    0    70     8   79  169  2  1 97  0  0
</code></p>

<h4>tload</h4>

<blockquote><p>graphic representation of system load average</p></blockquote>

<p><code>
 0.01, 0.07, 0.17
</code></p>

<h4>watch</h4>

<blockquote><p>execute a program periodically, showing output fullscreen</p></blockquote>

<h4>lscpu</h4>

<blockquote><p>display information about the CPU architecture</p></blockquote>

<p><code>
 lscpu
 Architecture:          x86_64
 CPU op-mode(s):        32-bit, 64-bit
 Byte Order:            Little Endian
 CPU(s):                1
 On-line CPU(s) list:   0
 Thread(s) per core:    1
 Core(s) per socket:    1
 Socket(s):             1
 NUMA node(s):          1
 Vendor ID:             GenuineIntel
 CPU family:            6
 Model:                 69
 Model name:            Intel(R) Core(TM) i5-4300U CPU @ 1.90GHz
 Stepping:              1
 CPU MHz:               2493.585
 BogoMIPS:              4988.45
 Hypervisor vendor:     VMware
 Virtualization type:   full
 L1d cache:             32K
 L1i cache:             32K
 L2 cache:              256K
 L3 cache:              3072K
 NUMA node0 CPU(s):     0
</code></p>

<h4>uptime</h4>

<blockquote><p>Tell how long the system has been running</p></blockquote>

<p><code>
 uptime
  16:11:48 up 14 min,  3 users,  load average: 0.06, 0.20, 0.28
</code></p>

<ul>
<li>show since when is the system up</li>
</ul>


<p><code>
 uptime -s
 2017-10-05 15:57:10
</code></p>

<h4>pmap</h4>

<blockquote><p>report memory map of a process</p></blockquote>

<ul>
<li>-p # Show full path to files in the mapping column</li>
</ul>


<p><code>
 pmap -p $$
 3425:   bash
 0000000000400000    884K r-x-- /usr/bin/bash
 00000000006dc000      4K r---- /usr/bin/bash
 00000000006dd000     36K rw--- /usr/bin/bash
 00000000006e6000     24K rw---   [ anon ]
 0000000000cbc000   1572K rw---   [ anon ]
 00007f1b843d1000     48K r-x-- /usr/lib64/libnss_files-2.17.so
 00007f1b843dd000   2044K ----- /usr/lib64/libnss_files-2.17.so
 00007f1b845dc000      4K r---- /usr/lib64/libnss_files-2.17.so
 00007f1b845dd000      4K rw--- /usr/lib64/libnss_files-2.17.so
 00007f1b845de000     24K rw---   [ anon ]
 00007f1b845e4000 103588K r---- /usr/lib/locale/locale-archive
 00007f1b8ab0d000   1756K r-x-- /usr/lib64/libc-2.17.so
 00007f1b8acc4000   2044K ----- /usr/lib64/libc-2.17.so
 00007f1b8aec3000     16K r---- /usr/lib64/libc-2.17.so
 00007f1b8aec7000      8K rw--- /usr/lib64/libc-2.17.so
 00007f1b8aec9000     20K rw---   [ anon ]
 00007f1b8aece000      8K r-x-- /usr/lib64/libdl-2.17.so
 00007f1b8aed0000   2048K ----- /usr/lib64/libdl-2.17.so
 00007f1b8b0d0000      4K r---- /usr/lib64/libdl-2.17.so
 00007f1b8b0d1000      4K rw--- /usr/lib64/libdl-2.17.so
 00007f1b8b0d2000    148K r-x-- /usr/lib64/libtinfo.so.5.9
 00007f1b8b0f7000   2048K ----- /usr/lib64/libtinfo.so.5.9
 00007f1b8b2f7000     16K r---- /usr/lib64/libtinfo.so.5.9
 00007f1b8b2fb000      4K rw--- /usr/lib64/libtinfo.so.5.9
 00007f1b8b2fc000    128K r-x-- /usr/lib64/ld-2.17.so
 00007f1b8b504000     12K rw---   [ anon ]
 00007f1b8b512000      8K rw---   [ anon ]
 00007f1b8b514000     28K r--s- /usr/lib64/gconv/gconv-modules.cache
 00007f1b8b51b000      4K rw---   [ anon ]
 00007f1b8b51c000      4K r---- /usr/lib64/ld-2.17.so
 00007f1b8b51d000      4K rw--- /usr/lib64/ld-2.17.so
 00007f1b8b51e000      4K rw---   [ anon ]
 00007ffeb5ec8000    132K rw---   [ stack ]
 00007ffeb5efc000      8K r-x--   [ anon ]
 ffffffffff600000      4K r-x--   [ anon ]
  total           116692K
</code></p>

<h4>pwdx</h4>

<blockquote><p>report current working directory of a process</p></blockquote>

<p><code>
 pwdx $$
 3425: /root
</code></p>

<h4>free</h4>

<blockquote><p>Display amount of free and used memory in the system</p></blockquote>

<p>```
 free -h</p>

<pre><code>           total        used        free      shared  buff/cache   available
</code></pre>

<p> Mem:           1.8G        509M        883M         10M        446M        1.1G
 Swap:          2.0G          0B        2.0G
```</p>

<h4>nice</h4>

<blockquote><p>run a program with modified scheduling priority</p></blockquote>

<p> Niceness  values range  from  -20 (most favorable to the process) to 19 (least favorable to the process).</p>

<ul>
<li>-n # add integer N to the niceness (default 10)</li>
</ul>


<h4>renice</h4>

<blockquote><p> alter priority of running processes</p></blockquote>

<ul>
<li>-n # priority</li>
</ul>


<h4>sleep</h4>

<blockquote><p>delay for a specified amount of time</p></blockquote>

<h4>bg</h4>

<blockquote><p>Resume each suspended job jobspec  in  the  background,  as  if  it  had been started
with &amp;</p></blockquote>

<h4>fg</h4>

<blockquote><p>Resume jobspec in the foreground, and make it the current job</p></blockquote>

<h4>jobs</h4>

<blockquote><p>list active jobs</p></blockquote>

<p><code>
 sleep 15 &amp;
 [1] 9767
 [root@tron ~]# jobs
 [1]+  Running                 sleep 15 &amp;
</code></p>

<h4>kill</h4>

<blockquote><p>terminate a process</p>

<p>Default is the TERM signal, which is similar to asking nicely to terminate. The more
forcefull option is KILL(9)</p></blockquote>

<ul>
<li>list signals</li>
</ul>


<p><code>
 kill -l
  1) SIGHUP  2) SIGINT   3) SIGQUIT  4) SIGILL   5) SIGTRAP
  6) SIGABRT     7) SIGBUS   8) SIGFPE   9) SIGKILL 10) SIGUSR1
 11) SIGSEGV    12) SIGUSR2 13) SIGPIPE 14) SIGALRM 15) SIGTERM
 16) SIGSTKFLT  17) SIGCHLD 18) SIGCONT 19) SIGSTOP 20) SIGTSTP
 21) SIGTTIN    22) SIGTTOU 23) SIGURG  24) SIGXCPU 25) SIGXFSZ
 26) SIGVTALRM  27) SIGPROF 28) SIGWINCH    29) SIGIO   30) SIGPWR
 31) SIGSYS 34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3
 38) SIGRTMIN+4 39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8
 43) SIGRTMIN+9 44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13
 48) SIGRTMIN+14    49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12
 53) SIGRTMAX-11    54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7
 58) SIGRTMAX-6 59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2
 63) SIGRTMAX-1 64) SIGRTMAX
</code></p>

<h4>pgrep,  pkill</h4>

<blockquote><p>look  up  or signal processes based on name and other attributes</p></blockquote>

<h4>ps</h4>

<blockquote><p>report a snapshot of the current processes</p></blockquote>

<ul>
<li>-e # Select all processes.  Identical to -A</li>
</ul>


<p>```
 ps -e
   PID TTY          TIME CMD</p>

<pre><code> 1 ?        00:00:02 systemd
 2 ?        00:00:00 kthreadd
 3 ?        00:00:00 ksoftirqd/0
 5 ?        00:00:00 kworker/0:0H
 7 ?        00:00:00 migration/0
 8 ?        00:00:00 rcu_bh
 9 ?        00:00:00 rcu_sched
10 ?        00:00:00 watchdog/0
12 ?        00:00:00 kdevtmpfs
</code></pre>

<p>[&hellip;]
  3591 pts/0    00:00:00 man
  3598 pts/0    00:00:00 less
  3608 ?        00:00:00 sleep
  3614 pts/1    00:00:00 ps
```</p>

<ul>
<li>-r #  Restrict the selection to only running processes</li>
</ul>


<p><code>
 ps -r
   PID TTY      STAT   TIME COMMAND
  1354 tty1     Rs+    0:08 /usr/bin/Xorg :0 -background none -noreset -audit 4 -
  3805 pts/1    R+     0:00 ps -r
</code></p>

<ul>
<li><p>-u # Select by effective user ID (EUID) or name</p></li>
<li><p>process tree</p></li>
</ul>


<p><code>
 ps --forest
   PID TTY          TIME CMD
  3508 pts/1    00:00:00 bash
  3880 pts/1    00:00:00  \_ ps
</code></p>

<ul>
<li>all processes + EUID</li>
</ul>


<p><code>
 ps -aux
 USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
 root         1  0.1  0.3 128088  6756 ?        Ss   17:03   0:02 /usr/lib/system
 root         2  0.0  0.0      0     0 ?        S    17:03   0:00 [kthreadd]
 root         3  0.0  0.0      0     0 ?        S    17:03   0:00 [ksoftirqd/0]
 root         7  0.0  0.0      0     0 ?        S    17:03   0:00 [migration/0]
 root         8  0.0  0.0      0     0 ?        S    17:03   0:00 [rcu_bh]
 root         9  0.0  0.0      0     0 ?        R    17:03   0:00 [rcu_sched]
 root        10  0.0  0.0      0     0 ?        S    17:03   0:00 [watchdog/0]
 root        12  0.0  0.0      0     0 ?        S    17:03   0:00 [kdevtmpfs]
 root        13  0.0  0.0      0     0 ?        S&lt;   17:03   0:00 [netns]
 root        14  0.0  0.0      0     0 ?        S    17:03   0:00 [khungtaskd]
 root        15  0.0  0.0      0     0 ?        S&lt;   17:03   0:00 [writeback]
 root        16  0.0  0.0      0     0 ?        S&lt;   17:03   0:00 [kintegrityd]
 root        17  0.0  0.0      0     0 ?        S&lt;   17:03   0:00 [bioset]
 root        18  0.0  0.0      0     0 ?        S&lt;   17:03   0:00 [kblockd]
 root        19  0.0  0.0      0     0 ?        S&lt;   17:03   0:00 [md]
 root        25  0.0  0.0      0     0 ?        S    17:04   0:00 [kswapd0]
 root        26  0.0  0.0      0     0 ?        SN   17:04   0:00 [ksmd]
 root        27  0.0  0.0      0     0 ?        SN   17:04   0:00 [khugepaged]
 root        28  0.0  0.0      0     0 ?        S    17:04   0:00 [fsnotify_mark]
 root        29  0.0  0.0      0     0 ?        S&lt;   17:04   0:00 [crypto]
 [...]
 root       587  0.0  0.3  47700  5856 ?        Ss   17:04   0:00 /usr/lib/system
 root       625  0.0  0.0      0     0 ?        S&lt;   17:04   0:00 [nfit]
 root       666  0.0  0.0      0     0 ?        S&lt;   17:04   0:00 [xfs-buf/sda1]
 dbus       727  0.0  0.1  36328  3332 ?        Ssl  17:04   0:01 /bin/dbus-daemo
 root       734  0.0  0.0 201208  1208 ?        Ssl  17:04   0:00 /usr/sbin/gsspr
 root      2862  0.0  0.1 380356  3468 ?        Sl   17:06   0:00 /usr/libexec/gv
 root      3508  0.0  0.1 116688  3392 pts/1    Ss   17:07   0:00 bash
 root      3591  0.0  0.1 119548  2292 pts/0    S+   17:12   0:00 man ps
 root      3598  0.0  0.0 110248   960 pts/0    S+   17:12   0:00 less -s
 root      3718  0.0  0.0      0     0 ?        S&lt;   17:22   0:00 [kworker/0:2H]
 root      3743  0.0  0.0      0     0 ?        S    17:24   0:00 [kworker/0:0]
 root      3819  0.0  0.0      0     0 ?        S&lt;   17:27   0:00 [kworker/0:1H]
 root      3892  0.1  0.0      0     0 ?        S    17:29   0:00 [kworker/0:2]
 root      3955  0.0  0.0      0     0 ?        S&lt;   17:33   0:00 [kworker/0:0H]
 root      3967  0.0  0.0 107892   604 ?        S    17:34   0:00 sleep 60
 root      3968  0.1  0.0      0     0 ?        R    17:34   0:00 [kworker/0:1]
 root      3979  0.0  0.0 153136  1876 pts/1    R+   17:35   0:00 ps -aux
</code></p>

<ul>
<li>long format, don&rsquo;t show flags</li>
</ul>


<p><code>
 ps -ly
 S   UID   PID  PPID  C PRI  NI   RSS    SZ WCHAN  TTY          TIME CMD
 S     0  3508  3438  0  80   0  3392 29172 wait   pts/1    00:00:00 bash
 R     0  4002  3508  0  80   0  1452 37232 -      pts/1    00:00:00 ps
</code></p>

<ul>
<li>get running processes</li>
</ul>


<p><code>
 echo $$
 3744
 ps -p $$ -F
 UID        PID  PPID  C    SZ   RSS PSR STIME TTY          TIME CMD
 root      3697  3692  0 29172  3372   0 13:09 pts/0    00:00:00 bash
</code></p>

<h4>pstree</h4>

<blockquote><p>display a tree of processes</p></blockquote>

<ul>
<li>-a # Show  command  line arguments</li>
</ul>


<p><code>
 pstree -a
 systemd --switched-root --system --deserialize 21
   ├─ModemManager
   │   └─2*[{ModemManager}]
   ├─NetworkManager --no-daemon
   │   ├─dhclient -d -q -sf /usr/libexec/nm-dhcp-helper -pf /var/run/dhclient-enp0s3.pid -lf ...
   │   └─2*[{NetworkManager}]
   ├─abrt-watch-log -F BUG: WARNING: at WARNING: CPU: INFO: possible recursive locking detected ernel BUG at list_del corruption list_add corruptiondo_IRQ: stack overfl
   ├─abrt-watch-log -F Backtrace /var/log/Xorg.0.log -- /usr/bin/abrt-dump-xorg -xD
   ├─abrtd -d -s
   ├─accounts-daemon
   │   └─2*[{accounts-daemon}]
   ├─alsactl -s -n 19 -c -E ALSA_CONFIG_PATH=/etc/alsa/alsactl.conf --initfile=/lib/alsa/init/00main rdaemon
   ├─at-spi-bus-laun
   │   ├─dbus-daemon --config-file=/etc/at-spi2/accessibility.conf --nofork --print-address 3
   │   │   └─{dbus-daemon}
   │   └─3*[{at-spi-bus-laun}]
   ├─at-spi2-registr --use-gnome-session
   │   └─2*[{at-spi2-registr}]
   ├─atd -f
   ├─auditd -n
   │   ├─audispd
   │   │   ├─sedispatch
   │   │   └─{audispd}
   │   └─{auditd}
   ├─avahi-daemon
   │   └─avahi-daemon
   ├─caribou
   │   └─2*[{caribou}]
   ├─colord
   │   └─2*[{colord}]
   ├─crond -n
   ├─cupsd -f
   ├─dbus-daemon --fork --print-pid 4 --print-address 6 --session
   │   └─{dbus-daemon}
   ├─dbus-daemon --system --address=systemd: --nofork --nopidfile --systemd-activation
   │   └─{dbus-daemon}
   ├─dbus-launch --sh-syntax --exit-with-session
   ├─dconf-service
   │   └─2*[{dconf-service}]
   ├─dnsmasq --conf-file=/var/lib/libvirt/dnsmasq/default.conf --leasefile-ro --dhcp-script=/usr/libexec/libvirt_leaseshelper
   │   └─dnsmasq --conf-file=/var/lib/libvirt/dnsmasq/default.conf --leasefile-ro --dhcp-script=/usr/libexec/libvirt_leaseshelper
   ├─evolution-calen
   │   └─5*[{evolution-calen}]
   ├─evolution-sourc
   │   └─2*[{evolution-sourc}]
   ├─gconfd-2
   ├─gdm
   │   ├─Xorg :0 -background none -noreset -audit 4 -verbose -auth /run/gdm/auth-for-gdm-kJZtDT/database -seat seat0 -nolisten tcp vt1
   │   ├─gdm-session-wor
   │   │   ├─gnome-session --session gnome-classic
   │   │   │   ├─abrt-applet
   │   │   │   │   └─2*[{abrt-applet}]
   │   │   │   ├─gnome-settings-
   │   │   │   │   └─5*[{gnome-settings-}]
   │   │   │   ├─gnome-shell
   │   │   │   │   ├─ibus-daemon --xim --panel disable
   │   │   │   │   │   ├─ibus-dconf
   │   │   │   │   │   │   └─3*[{ibus-dconf}]
   │   │   │   │   │   ├─ibus-engine-sim
   │   │   │   │   │   │   └─2*[{ibus-engine-sim}]
   │   │   │   │   │   └─2*[{ibus-daemon}]
   │   │   │   │   └─6*[{gnome-shell}]
   │   │   │   ├─gnome-software --gapplication-service
   │   │   │   │   └─3*[{gnome-software}]
   │   │   │   ├─nautilus --no-default-window --force-desktop
   │   │   │   │   └─3*[{nautilus}]
   │   │   │   ├─rhsm-icon
   │   │   │   │   └─2*[{rhsm-icon}]
   │   │   │   ├─seapplet
   │   │   │   ├─ssh-agent /bin/sh -c exec -l /bin/bash -c "env GNOME_SHELL_SESSION_MODE=classic gnome-session --session gnome-classic"
   │   │   │   ├─tracker-extract
   │   │   │   │   └─13*[{tracker-extract}]
   │   │   │   ├─tracker-miner-a
   │   │   │   │   └─2*[{tracker-miner-a}]
   │   │   │   ├─tracker-miner-f
   │   │   │   │   └─3*[{tracker-miner-f}]
   │   │   │   ├─tracker-miner-u
   │   │   │   │   └─2*[{tracker-miner-u}]
   │   │   │   └─3*[{gnome-session}]
   │   │   └─2*[{gdm-session-wor}]
   │   └─3*[{gdm}]
   ├─gnome-keyring-d --daemonize --login
   │   └─4*[{gnome-keyring-d}]
   ├─gnome-shell-cal
   │   └─5*[{gnome-shell-cal}]
   ├─gnome-terminal-
   │   ├─bash
   │   │   └─man pstree
   │   │       └─less -s
   │   ├─bash
   │   │   └─pstree -a
   │   ├─gnome-pty-helpe
   │   └─3*[{gnome-terminal-}]
   ├─goa-daemon
   │   └─3*[{goa-daemon}]
   ├─goa-identity-se
   │   └─3*[{goa-identity-se}]
   ├─gsd-printer
   │   └─2*[{gsd-printer}]
   ├─gssproxy -D
   │   └─5*[{gssproxy}]
   ├─gvfs-afc-volume
   │   └─3*[{gvfs-afc-volume}]
   ├─gvfs-goa-volume
   │   └─2*[{gvfs-goa-volume}]
   ├─gvfs-gphoto2-vo
   │   └─2*[{gvfs-gphoto2-vo}]
   ├─gvfs-mtp-volume
   │   └─2*[{gvfs-mtp-volume}]
   ├─gvfs-udisks2-vo
   │   └─2*[{gvfs-udisks2-vo}]
   ├─gvfsd
   │   └─2*[{gvfsd}]
   ├─gvfsd-fuse /run/user/0/gvfs -f -o big_writes
   │   └─5*[{gvfsd-fuse}]
   ├─gvfsd-metadata
   │   └─2*[{gvfsd-metadata}]
   ├─gvfsd-trash --spawner :1.3 /org/gtk/gvfs/exec_spaw/0
   │   └─2*[{gvfsd-trash}]
   ├─ibus-x11 --kill-daemon
   │   └─2*[{ibus-x11}]
   ├─ksmtuned /usr/sbin/ksmtuned
   │   └─sleep 60
   ├─libvirtd
   │   └─15*[{libvirtd}]
   ├─lsmd -d
   ├─lvmetad -f
   ├─master -w
   │   ├─pickup -l -t unix -u
   │   └─qmgr -l -t unix -u
   ├─mcelog --ignorenodev --daemon --syslog
   ├─mission-control
   │   └─3*[{mission-control}]
   ├─packagekitd
   │   └─2*[{packagekitd}]
   ├─polkitd --no-debug
   │   └─5*[{polkitd}]
   ├─pulseaudio --start
   │   └─{pulseaudio}
   ├─rhnsd
   ├─rhsmcertd
   ├─rngd -f
   ├─rsyslogd -n
   │   └─2*[{rsyslogd}]
   ├─rtkit-daemon
   │   └─2*[{rtkit-daemon}]
   ├─smartd -n -q never
   ├─sshd -D
   ├─systemd-journal
   ├─systemd-logind
   ├─systemd-udevd
   ├─tracker-store
   │   └─7*[{tracker-store}]
   ├─tuned -Es /usr/sbin/tuned -l -P
   │   └─4*[{tuned}]
   ├─udisksd --no-debug
   │   └─4*[{udisksd}]
   ├─upowerd
   │   └─2*[{upowerd}]
   ├─vmtoolsd
   │   └─{vmtoolsd}
   ├─vmtoolsd -n vmusr
   └─wpa_supplicant -u -f /var/log/wpa_supplicant.log -c /etc/wpa_supplicant/wpa_supplicant.conf -P /var/run/wpa_supplicant.pid
</code></p>

<h4>runlevel</h4>

<blockquote><p>Print previous and current SysV runlevel</p>

<p>If a runlevel cannot be determined, N is printed instead</p></blockquote>

<p><code>
 runlevel
 N 5
</code></p>

<h4>init / telinit</h4>

<ul>
<li>legacy</li>
</ul>


<p>```
 init [OPTIONS&hellip;] {COMMAND}</p>

<p> Send control commands to the init daemon.</p>

<pre><code>  --help      Show this help
  --no-wall   Don't send wall message before halt/power-off/reboot
</code></pre>

<p> Commands:
   0              Power-off the machine
   6              Reboot the machine
   2, 3, 4, 5     Start runlevelX.target unit
   1, s, S        Enter rescue mode
   q, Q           Reload init daemon configuration
   u, U           Reexecute init daemon
```</p>

<h4>mkfifo</h4>

<blockquote><p>make FIFOs (named pipes)</p></blockquote>

<p><code>
 mkfifo /tmp/pipe
 [root@tron ~]# ls -l /tmp/pipe
 prw-r--r--. 1 root root 0 Sep 27 13:32 /tmp/pipe
</code></p>

<h4>script</h4>

<blockquote><p>make typescript of terminal session</p></blockquote>

<p>```
 script
 Script started, file is typescript
 [root@tron ~]# ls
 anaconda-ks.cfg  Downloads             Music          Templates
 Desktop          hashes.txt            openscap_data  test.txt
 dns.conf         initial-setup-ks.cfg  Pictures       typescript
 Documents        man.txt               Public         Videos
 [root@tron ~]# rm -f dns.conf hashes.txt
 [root@tron ~]# exit
 exit
 Script done, file is typescript
 [root@tron ~]# cat typescript
 Script started on Wed 27 Sep 2017 01:34:50 PM EEST
 [root@tron ~]# ls
 anaconda-ks.cfg  Downloads             Music          Templates
 Desktop          hashes.txt            openscap_data  test.txt
 dns.conf         initial-setup-ks.cfg  Pictures       typescript
 Documents        man.txt               Public         Videos
 [root@tron ~]# rm -f dns.conf hashes.txt
 [root@tron ~]# exit
 exit</p>

<p> Script done on Wed 27 Sep 2017 01:35:18 PM EEST
```</p>

<h4>stat</h4>

<blockquote><p>display file or file system status</p></blockquote>

<p><code>
 stat hashes.txt
   File: ‘hashes.txt’
   Size: 43         Blocks: 8          IO Block: 4096   regular file
 Device: fd00h/64768d   Inode: 33859054    Links: 1
 Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
 Context: unconfined_u:object_r:admin_home_t:s0
 Access: 2017-09-26 11:27:18.298105601 +0300
 Modify: 2017-09-22 14:14:29.035069557 +0300
 Change: 2017-09-22 14:14:29.035069557 +0300
  Birth: -
</code></p>

<h4>lastlog</h4>

<blockquote><p>reports the most recent login of all users or of a given user</p></blockquote>

<p><code>
 lastlog
 Username         Port     From             Latest
 root             :0                        Sat Oct  7 14:45:28 +0300 2017
 bin                                        **Never logged in**
 daemon                                     **Never logged in**
 adm                                        **Never logged in**
 lp                                         **Never logged in**
 sync                                       **Never logged in**
 shutdown                                   **Never logged in**
 halt                                       **Never logged in**
 mail                                       **Never logged in**
 operator                                   **Never logged in**
 games                                      **Never logged in**
 ftp                                        **Never logged in**
 nobody                                     **Never logged in**
 systemd-bus-proxy                           **Never logged in**
 systemd-network                            **Never logged in**
 dbus                                       **Never logged in**
 polkitd                                    **Never logged in**
 abrt                                       **Never logged in**
 unbound                                    **Never logged in**
 tss                                        **Never logged in**
 colord                                     **Never logged in**
 usbmuxd                                    **Never logged in**
 geoclue                                    **Never logged in**
 saslauth                                   **Never logged in**
 libstoragemgmt                             **Never logged in**
 rpc                                        **Never logged in**
 rtkit                                      **Never logged in**
 chrony                                     **Never logged in**
 radvd                                      **Never logged in**
 qemu                                       **Never logged in**
 ntp                                        **Never logged in**
 rpcuser                                    **Never logged in**
 nfsnobody                                  **Never logged in**
 avahi-autoipd                              **Never logged in**
 setroubleshoot                             **Never logged in**
 sssd                                       **Never logged in**
 pulse                                      **Never logged in**
 gdm              :0                        Sat Oct  7 14:42:55 +0300 2017
 gnome-initial-setup :0                        Tue Apr 26 15:36:08 +0300 2016
 sshd                                       **Never logged in**
 avahi                                      **Never logged in**
 postfix                                    **Never logged in**
 tcpdump                                    **Never logged in**
 nixhat           :0                        Sat Aug 19 20:00:48 +0300 2017
 apache                                     **Never logged in**
 smbuser                                    **Never logged in**
 squid                                      **Never logged in**
</code></p>

<ul>
<li>see last time a user logged in</li>
</ul>


<p><code>
 lastlog -u root
 Username         Port     From             Latest
 root             :0                        Sat Oct  7 14:45:28 +0300 2017
</code></p>

<h4>last</h4>

<blockquote><p>show listing of last logged in users</p>

<p>Last searches back through the file /var/log/wtmp (or the  file  designated  by  the
f flag) and displays a list of all users logged in (and out) since that file was
created.</p></blockquote>

<p>```
 last -n 10
 root     pts/1        :0               Sat Oct  7 14:53   still logged in <br/>
 root     pts/0        :0               Sat Oct  7 14:45   still logged in <br/>
 root     :0           :0               Sat Oct  7 14:45   still logged in <br/>
 (unknown :0           :0               Sat Oct  7 14:42 &ndash; 14:45  (00:02)  <br/>
 reboot   system boot  3.10.0-514.21.1. Sat Oct  7 14:41 &ndash; 14:54  (00:13)  <br/>
 root     pts/1        :0               Fri Oct  6 21:48 &ndash; 23:19  (01:30)  <br/>
 root     pts/0        :0               Fri Oct  6 21:47 &ndash; 23:19  (01:32)  <br/>
 root     :0           :0               Fri Oct  6 21:43 &ndash; 23:19  (01:36)  <br/>
 (unknown :0           :0               Fri Oct  6 21:37 &ndash; 21:43  (00:05)  <br/>
 reboot   system boot  3.10.0-514.21.1. Fri Oct  6 21:36 &ndash; 23:19  (01:43)</p>

<p> wtmp begins Tue Apr 26 15:32:43 2016
```</p>

<h4>lastb</h4>

<blockquote><p>shows a log of the file /var/log/btmp, which contains all the bad login attempts</p></blockquote>

<p>```
 lastb
 root     :0           :0               Sat Oct  7 14:57 &ndash; 14:57  (00:00)  <br/>
 root     :0           :0               Sat Oct  7 14:57 &ndash; 14:57  (00:00)  <br/>
 nixhat   :0           :0               Sat Oct  7 14:57 &ndash; 14:57  (00:00)</p>

<p> btmp begins Sat Oct  7 14:57:26 2017
```</p>

<h4>logrotate</h4>

<blockquote><p>rotates, compresses, and mails system logs</p></blockquote>

<p> Config file: <strong>/etc/logrotate.conf</strong></p>

<h4>journalctl</h4>

<blockquote><p>Query the systemd journal</p></blockquote>

<p><code>
 journalctl -u httpd.service
 -- Logs begin at Sat 2017-10-07 14:41:21 EEST, end at Sat 2017-10-07 15:34:36 EE
 Oct 07 14:42:14 localhost.localdomain systemd[1]: Starting The Apache HTTP Serve
 Oct 07 14:42:23 localhost.localdomain httpd[1099]: AH00558: httpd: Could not rel
 Oct 07 14:42:24 localhost.localdomain systemd[1]: Started The Apache HTTP Server
 Oct 07 15:11:02 localhost.localdomain httpd[6068]: AH00558: httpd: Could not rel
 Oct 07 15:11:02 localhost.localdomain systemd[1]: Reloaded The Apache HTTP Serve
</code></p>

<ul>
<li>show boot log</li>
</ul>


<p><code>
 journalctl -b | tail
 Jan 25 18:28:01 rhel7 systemd[1]: Created slice user-993.slice.
 Jan 25 18:28:01 rhel7 systemd[1]: Starting user-993.slice.
 Jan 25 18:28:01 rhel7 systemd[1]: Started Session 45 of user pcp.
 Jan 25 18:28:01 rhel7 systemd[1]: Starting Session 45 of user pcp.
 Jan 25 18:28:01 rhel7 CROND[6820]: (pcp) CMD ( /usr/libexec/pcp/bin/pmie_check -C)
 Jan 25 18:28:01 rhel7 systemd[1]: Removed slice user-993.slice.
 Jan 25 18:28:01 rhel7 systemd[1]: Stopping user-993.slice.
 Jan 25 18:30:01 rhel7 systemd[1]: Started Session 46 of user root.
 Jan 25 18:30:01 rhel7 systemd[1]: Starting Session 46 of user root.
 Jan 25 18:30:01 rhel7 CROND[6978]: (root) CMD (/usr/lib64/sa/sa1 1 1)
</code></p>

<ul>
<li>show error events</li>
</ul>


<p><code>
 journalctl -p err
 -- Logs begin at Thu 2018-01-25 14:28:07 EET, end at Thu 2018-01-25 18:30:01 EET. --
 Jan 25 14:28:10 rhel7 kernel: piix4_smbus 0000:00:07.3: Host SMBus controller not enabled!
 Jan 25 14:28:11 rhel7 kernel: intel_rapl: no valid rapl domains found in package 0
 Jan 25 14:28:35 rhel7 cntlm[1121]: Error creating a new PID file
 Jan 25 14:28:45 rhel7 spice-vdagent[2501]: Cannot access vdagent virtio channel /dev/virtio-ports/com.redhat.spice.0
 Jan 25 14:28:57 rhel7 udisksd[2652]: Error probing device: Error sending ATA command IDENTIFY PACKET DEVICE to /dev/sr0: ATA command failed: error=0x01 count=0x02 status=0x5
 Jan 25 14:47:48 rhel7 gdm-launch-environment][2380]: pam_systemd(gdm-launch-environment:session): Failed to release session: Interrupted system call
 Jan 25 14:47:50 rhel7 spice-vdagent[3306]: Cannot access vdagent virtio channel /dev/virtio-ports/com.redhat.spice.0
 Jan 25 14:48:15 rhel7 pulseaudio[3318]: GetManagedObjects() failed: org.freedesktop.DBus.Error.NoReply: Did not receive a reply. Possible causes include: the remote applicat
 Jan 25 14:53:38 rhel7 kernel: ata4: exception Emask 0x10 SAct 0x0 SErr 0x4010000 action 0xe frozen
 Jan 25 14:53:38 rhel7 kernel: ata4: irq_stat 0x00400040, connection status changed
 Jan 25 14:53:38 rhel7 kernel: ata4: SError: { PHYRdyChg DevExch }
</code></p>

<h4>rpm</h4>

<blockquote><p>RPM Package Manager</p></blockquote>

<ul>
<li>count all installed packages</li>
</ul>


<p><code>
rpqm -qa | wc -l
1366
</code></p>

<ul>
<li>get info about installed package</li>
</ul>


<p><code>
 rpm -qi samba
 Name        : samba
 Epoch       : 0
 Version     : 4.4.4
 Release     : 14.el7_3
 Architecture: x86_64
 Install Date: Thu 08 Jun 2017 10:55:00 AM EEST
 Group       : System Environment/Daemons
 Size        : 1869228
 License     : GPLv3+ and LGPLv3+
 Signature   : RSA/SHA256, Thu 25 May 2017 04:16:22 PM EEST, Key ID 24c6a8a7f4a80eb5
 Source RPM  : samba-4.4.4-14.el7_3.src.rpm
 Build Date  : Thu 25 May 2017 02:35:40 PM EEST
 Build Host  : c1bm.rdu2.centos.org
 Relocations : (not relocatable)
 Packager    : CentOS BuildSystem &lt;http://bugs.centos.org&gt;
 Vendor      : CentOS
 URL         : http://www.samba.org/
 Summary     : Server and Client software to interoperate with Windows machines
 Description :
 Samba is the standard Windows interoperability suite of programs for Linux and
 Unix.
</code></p>

<ul>
<li>list files in package</li>
</ul>


<p><code>
 rpm -ql lynx
 /etc/lynx-site.cfg
 /etc/lynx.cfg
 /etc/lynx.lss
 /usr/bin/lynx
 /usr/share/doc/lynx-2.8.8
 [...]
 /usr/share/locale/zh_TW/LC_MESSAGES/lynx.mo
 /usr/share/man/man1/lynx.1.gz
</code></p>

<ul>
<li>list config files</li>
</ul>


<p><code>
 rpm -qc name
</code></p>

<ul>
<li>install RPM package</li>
</ul>


<p><code>
 rpm -i pkgname
</code></p>

<ul>
<li>upgrade package</li>
</ul>


<p><code>
 rpm -U pkgname
</code></p>

<ul>
<li>remove package</li>
</ul>


<p><code>
 rpm -e pkgname
</code></p>

<ul>
<li>see where file comes from</li>
</ul>


<p><code>
 rpm -qf /etc/httpd/conf
 httpd-2.4.6-45.el7.centos.4.x86_64
</code></p>

<ul>
<li>verify package</li>
</ul>


<p><code>
rpm -V pgkname
</code></p>

<ul>
<li>list documentation files</li>
</ul>


<p><code>
rpm -qd cmdname
</code></p>

<h4>yum</h4>

<blockquote><p>Yellowdog Updater Modified</p></blockquote>

<ul>
<li>install automatically</li>
</ul>


<p><code>
 yum install -y pkgname
</code></p>

<ul>
<li>get info about package</li>
</ul>


<p>```
 yum info nmap
 [&hellip;]
 Available Packages
 Name        : nmap
 Arch        : x86_64
 Epoch       : 2
 Version     : 6.40
 Release     : 7.el7
 Size        : 4.0 M
 Repo        : base/7/x86_64
 Summary     : Network exploration tool and security scanner
 URL         : <a href="http://nmap.org/">http://nmap.org/</a>
 License     : GPLv2 and LGPLv2+ and GPLv2+ and BSD
 Description : Nmap is a utility for network exploration or security auditing.</p>

<pre><code>         : It supports ping scanning (determine which hosts are up), many
         : port scanning techniques (determine what services the hosts are
         : offering), and TCP/IP fingerprinting (remote host operating system
         : identification). Nmap also offers flexible target and port
         : specification, decoy scanning, determination of TCP sequence
         : predictability characteristics, reverse-identd scanning, and more.
         : In addition to the classic command-line nmap executable, the Nmap
         : suite includes a flexible data transfer, redirection, and
         : debugging tool (netcat utility ncat), a utility for comparing scan
         : results (ndiff), and a packet generation and response analysis
         : tool (nping).
</code></pre>

<p>```</p>

<ul>
<li>remove pkg</li>
</ul>


<p><code>
 yum remove pkgname
</code></p>

<ul>
<li>list dependencies</li>
</ul>


<p>```
 yum deplist cowsay
 [&hellip;]
 package: cowsay.noarch 3.04-4.el7
   dependency: /bin/sh</p>

<pre><code>provider: bash.x86_64 4.2.46-29.el7_4
</code></pre>

<p>   dependency: /usr/bin/perl</p>

<pre><code>provider: perl.x86_64 4:5.16.3-292.el7
</code></pre>

<p>   dependency: perl(Cwd)</p>

<pre><code>provider: perl-PathTools.x86_64 3.40-5.el7
</code></pre>

<p>   dependency: perl(File::Basename)</p>

<pre><code>provider: perl.x86_64 4:5.16.3-292.el7
</code></pre>

<p>   dependency: perl(Getopt::Std)</p>

<pre><code>provider: perl.x86_64 4:5.16.3-292.el7
</code></pre>

<p>   dependency: perl(Text::Tabs)</p>

<pre><code>provider: perl.x86_64 4:5.16.3-292.el7
</code></pre>

<p>   dependency: perl(Text::Wrap)</p>

<pre><code>provider: perl.x86_64 4:5.16.3-292.el7
</code></pre>

<p>   dependency: perl(strict)</p>

<pre><code>provider: perl.x86_64 4:5.16.3-292.el7
</code></pre>

<p>   dependency: perl-Encode</p>

<pre><code>provider: perl-Encode.x86_64 2.51-7.el7
</code></pre>

<p>```</p>

<ul>
<li>list installed packages</li>
</ul>


<p><code>
 yum list installed
 [...]
 yum.noarch                             3.4.3-150.el7.centos            @base    
 yum-langpacks.noarch                   0.4.2-7.el7                     @base    
 yum-metadata-parser.x86_64             1.1.4-10.el7                    @anaconda
 yum-plugin-fastestmirror.noarch        1.1.31-40.el7                   @base    
 yum-utils.noarch                       1.1.31-40.el7                   @base    
 zenity.x86_64                          3.8.0-5.el7                     @anaconda
 zip.x86_64                             3.0-11.el7                      @base    
 zlib.x86_64                            1.2.7-17.el7                    @base    
</code></p>

<ul>
<li>update all packages</li>
</ul>


<p><code>
 yum update
</code></p>

<ul>
<li>check if updates are available, without updating</li>
</ul>


<p><code>
 yum check-update
</code></p>

<ul>
<li>list info about available packages</li>
</ul>


<p><code>
 yum list python
 [...]
 Installed Packages
 python.x86_64                         2.7.5-48.el7                         @base
 Available Packages
 python.x86_64                         2.7.5-58.el7                         base
 [root@localhost ~]#
</code></p>

<ul>
<li>find out which package provides some feature or file</li>
</ul>


<p>```
 yum provides scapy
 scapy-2.3.3-1.el7.noarch : Interactive packet manipulation tool and network</p>

<pre><code>                      : scanner
</code></pre>

<p> Repo        : epel
```</p>

<ul>
<li>find packages when you know something about  the package but aren&rsquo;t sure of its name.</li>
</ul>


<p><code>
 yum search name
</code></p>

<ul>
<li>list package summary</li>
</ul>


<p>```
 yum info scapy
 Available Packages
 Name        : scapy
 Arch        : noarch
 Version     : 2.3.3
 Release     : 1.el7
 Size        : 983 k
 Repo        : epel/x86_64
 Summary     : Interactive packet manipulation tool and network scanner
 URL         : <a href="http://www.secdev.org/projects/scapy/">http://www.secdev.org/projects/scapy/</a>
 License     : GPLv2
 Description : Scapy is a powerful interactive packet manipulation program built</p>

<pre><code>         : on top of the Python interpreter. It can be used to forge or
         : decode packets of a wide number of protocols, send them over the
         : wire, capture them, match requests and replies, and much more.
</code></pre>

<p>```</p>

<ul>
<li>find which package provides an utility</li>
</ul>


<p><code>
 yum provides sealert
 Loaded plugins: langpacks, product-id, search-disabled-repos, subscription-manager
 setroubleshoot-server-3.2.27.2-3.el7.x86_64 : SELinux troubleshoot server
 Repo        : rhel7-local
 Matched from:
 Filename    : /usr/bin/sealert
</code></p>

<ul>
<li>perform cleaning operations</li>
</ul>


<p><code>
 yum clean
 all           dbcache       headers       packages      
 cache         expire-cache  metadata   
</code></p>

<ul>
<li>Produces a list of all dependencies and  what  packages  provide those  dependencies  for the given packages.</li>
</ul>


<p>```
yum deplist scapy
 package: scapy.noarch 2.3.3-1.el7
   dependency: /usr/bin/python</p>

<pre><code>provider: python.x86_64 2.7.5-58.el7
</code></pre>

<p>   dependency: python >= 2.5</p>

<pre><code>provider: python.x86_64 2.7.5-58.el7
</code></pre>

<p>   dependency: python(abi) = 2.7</p>

<pre><code>provider: python.x86_64 2.7.5-58.el7
</code></pre>

<p>```</p>

<ul>
<li>list configured repositories</li>
</ul>


<p><code>
 yum repolist
 repo id               repo name                                           status
 base/7/x86_64         CentOS-7 - Base                                      9,591
 *epel/x86_64          Extra Packages for Enterprise Linux 7 - x86_64      11,985
 extras/7/x86_64       CentOS-7 - Extras                                      227
 nux-dextop/x86_64     Nux.Ro RPMs for general desktop use                  1,599
 updates/7/x86_64      CentOS-7 - Updates                                     731
 repolist: 24,133
</code></p>

<ul>
<li>see past transactions</li>
</ul>


<p><code>
 yum history
</code></p>

<ul>
<li>list available kernels</li>
</ul>


<p>```
 yum list kernel
 Loaded plugins: langpacks, product-id, search-disabled-repos, subscription-</p>

<pre><code>           : manager
</code></pre>

<p> Repodata is over 2 weeks old. Install yum-cron? Or run: yum makecache fast
 Installed Packages
 kernel.x86_64              3.10.0-514.el7                    @anaconda/7.3    <br/>
 kernel.x86_64              3.10.0-514.26.2.el7               @rhel-7-server-rpms
 Available Packages
 kernel.x86_64              3.10.0-693.2.2.el7                rhel-7-server-rpms
```</p>

<ul>
<li>install new kernel and set it as default boot choice</li>
</ul>


<p><code>
yum --enablerepo=kernelrepo install kernelname
</code></p>

<p>Set <code>GRUB_DEFAULT=0</code> to make it default, 1 otherwise</p>

<p>```</p>

<hr />

<p>/ Fine day for friends. So-so day for \
\ you.                                /</p>

<hr />

<pre><code>    \   ^__^
     \  (oo)\_______
        (__)\       )\/\
            ||----w |
            ||     ||
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LFCS prep - Essential commands]]></title>
    <link href="http://chousensha.github.io/blog/2018/02/24/lfcs-prep-essential-commands/"/>
    <updated>2018-02-24T16:46:53-05:00</updated>
    <id>http://chousensha.github.io/blog/2018/02/24/lfcs-prep-essential-commands</id>
    <content type="html"><![CDATA[<p>Various commands for the LFCS Essential Commands domain, which at the time of this post can be found at <a href="https://training.linuxfoundation.org/images/pdfs/LFCS_Domains_Competencies_V2.16.pdf">https://training.linuxfoundation.org/images/pdfs/LFCS_Domains_Competencies_V2.16.pdf</a></p>

<!-- more-->


<p><img class="center" src="/images/sysadmin/cmds.png" title="&lsquo;linux cmds&rsquo; &lsquo;cmd essentials&rsquo;" ></p>

<h4>cut</h4>

<blockquote><p>remove sections from each line of files</p></blockquote>

<ul>
<li>select only relevant fields of output</li>
</ul>


<p>Here I&rsquo;m looking only at users and their home directories from /etc/passwd:</p>

<p><code>
cat /etc/passwd | cut -d: -f1,6 | tail -n 5
apache:/usr/share/httpd
nixer:/home/nixer
lfcs:/home/lfcs
squid:/var/spool/squid
tom:/home/tom
</code></p>

<h4>sed</h4>

<blockquote><p>stream editor for filtering and transforming text</p></blockquote>

<ul>
<li>substitute all occurrences in a file to something else: <code>sed &rsquo;s/original/replacement/flag' filename</code></li>
</ul>


<p><code>
cat text.txt
Peace is a lie, there is only passion.
Through passion, I gain strength.
Through strength, I gain power.
Through power, I gain victory.
Through victory, my chains are broken.
</code></p>

<p>Changed the I to a we and redirect to a new file:</p>

<p><code>
sed 's/I/we/g' text.txt &gt; altered.txt
cat altered.txt
Peace is a lie, there is only passion.
Through passion, we gain strength.
Through strength, we gain power.
Through power, we gain victory.
Through victory, my chains are broken.
The Force shall free me.
</code></p>

<h4>diff</h4>

<blockquote><p>compare files line by line</p></blockquote>

<ul>
<li>compare files side by side</li>
</ul>


<p><code>
diff -y text.txt altered.txt
Peace is a lie, there is only passion.              Peace is a lie, there is only passion.
Through passion, I gain strength.                 | Through passion, we gain strength.
Through strength, I gain power.                   | Through strength, we gain power.
Through power, I gain victory.                    | Through power, we gain victory.
Through victory, my chains are broken.              Through victory, my chains are broken.
The Force shall free me.                    The Force shall free me.
</code></p>

<h4>man</h4>

<blockquote><p>an interface to the on-line reference manuals</p></blockquote>

<ul>
<li>search manpages by keyword</li>
</ul>


<p><code>
man -k print | head -n 5
fmtmsg (3)           - print formatted error messages
isprint (3)          - character classification routines
iswprint (3)         - test for printing wide character
netstat (8)          - Print network connections, routing tables, interface statistics, masquerade connections, and multicast memberships
abrt-action-list-dsos (1) - Prints out DSO from mapped memory regions.
</code></p>

<h4>umask</h4>

<blockquote><p>display or set the file creation mask</p></blockquote>

<p>It can be used to remove, but not add permissions</p>

<p><code>
umask
0022
umask -S
u=rwx,g=rx,o=rx
</code></p>

<h4>info</h4>

<blockquote><p>read Info documents</p></blockquote>

<h4>touch</h4>

<blockquote><p>Update the access and modification times of each FILE to the current time</p></blockquote>

<ul>
<li>r FILE &ndash;>  use this file&rsquo;s times instead of current time</li>
</ul>


<h4>whatis</h4>

<blockquote><p>display manual page descriptions</p></blockquote>

<p><code>
whatis ip
ip (7)               - Linux IPv4 protocol implementation
ip (8)               - show / manipulate routing, devices, pol...
</code></p>

<h4>apropos</h4>

<blockquote><p>search the manual page names and descriptions</p></blockquote>

<p><code>
apropos network | tail
teamnl (8)           - team network device Netlink interface tool
tracepath (8)        - traces path to a network host discoveri...
tracepath6 (8)       - traces path to a network host discoveri...
traceroute (8)       - print the route packets trace to networ...
traceroute6 (8)      - print the route packets trace to networ...
tshark (1)           - Dump and analyze network traffic
umount.nfs (8)       - unmount a Network File System
usernetctl (8)       - allow a user to manipulate a network in...
wget (1)             - The non-interactive network downloader.
wireshark (1)        - Interactively dump and analyze network ...
</code></p>

<h4>uniq</h4>

<blockquote><p>report or omit repeated lines</p></blockquote>

<ul>
<li><p>D # print all duplicate lines</p></li>
<li><p>u # only print unique lines</p></li>
<li><p>it won&rsquo;t detect repeated lines unless they are adjacent. Sort first</p></li>
</ul>


<h4>sort</h4>

<blockquote><p>sort lines of text files</p></blockquote>

<h4>fmt</h4>

<blockquote><p>simple optimal text formatter</p></blockquote>

<ul>
<li>u # uniform spacing: one space between words, two after sentences</li>
</ul>


<p><code>
[root@tron ~]# cat test.txt
Test.     Next sentence.   This    doesn't   look       right
[root@tron ~]# fmt -u test.txt
Test.  Next sentence.  This doesn't look right
</code></p>

<h4>nl</h4>

<blockquote><p>number lines of files</p></blockquote>

<p>```
nl test.txt</p>

<pre><code> 1  First line

 2  Second line

 3  Third line
</code></pre>

<p>```</p>

<h4>updatedb</h4>

<blockquote><p>creates or updates a database used by locate(1). It&rsquo;s usually  run daily by cron(8) to update the default database.</p></blockquote>

<h4>tty</h4>

<blockquote><p>print the file name of the terminal connected to standard input</p></blockquote>

<p><code>
tty
/dev/pts/1
</code></p>

<h4>type</h4>

<blockquote><p>indicate how each name would be interpreted  if used as a command name</p></blockquote>

<p><code>
type ls
ls is aliased to `ls --color=auto'
</code></p>

<h4>tree</h4>

<blockquote><p>list contents of directories in a tree-like format</p></blockquote>

<p><code>
tree
.
├── anaconda-ks.cfg
├── Desktop
├── Documents
│   ├── archive_file
│   ├── arhive.tar.gz
│   ├── Documents
│   │   ├── archive_file
│   │   └── test.txt
│   └── test.txt
├── Downloads
├── initial-setup-ks.cfg
├── Music
├── openscap_data
│   └── eval_remediate_results.xml
├── Pictures
├── Public
├── Templates
├── test.txt
└── Videos
</code></p>

<h4>wc</h4>

<blockquote><p>print newline, word, and byte counts for each file</p></blockquote>

<ul>
<li>l # lines</li>
</ul>


<p><code>
wc -l /etc/hosts
2 /etc/hosts
</code></p>

<ul>
<li>w # words</li>
</ul>


<p><code>
wc -w test.txt
6 test.txt
</code></p>

<h4>grep</h4>

<blockquote><p>print lines matching a pattern</p></blockquote>

<ul>
<li><p>-E # Interpret PATTERN as an extended regular  expression</p></li>
<li><p>-i # ignore case</p></li>
<li><p>-n # prefix each line of output with its line number</p></li>
<li><p>list items that begin with certain PATTERN</p></li>
</ul>


<p><code>
yum list installed | grep ^kernel
kernel.x86_64                        3.10.0-514.el7          @anaconda/7.3      
kernel.x86_64                        3.10.0-514.26.2.el7     @rhel-7-server-rpms
kernel-devel.x86_64                  3.10.0-514.el7          @anaconda/7.3      
kernel-devel.x86_64                  3.10.0-514.26.2.el7     @rhel-7-server-rpms
kernel-headers.x86_64                3.10.0-514.26.2.el7     @rhel-7-server-rpms
kernel-tools.x86_64                  3.10.0-514.26.2.el7     @rhel-7-server-rpms
kernel-tools-libs.x86_64             3.10.0-514.26.2.el7     @rhel-7-server-rpms
</code></p>

<ul>
<li>list items that end with certain PATTERN</li>
</ul>


<p><code>
yum list installed | grep x86_64$
NetworkManager-libreswan-gnome.x86_64
iscsi-initiator-utils-iscsiuio.x86_64
libreport-plugin-reportuploader.x86_64
libreport-rhel-anaconda-bugzilla.x86_64
libvirt-daemon-driver-interface.x86_64
libvirt-daemon-driver-nwfilter.x86_64
openlmi-indicationmanager-libs.x86_64
sane-backends-drivers-scanners.x86_64
subscription-manager-initial-setup-addon.x86_64
</code></p>

<ul>
<li>grep something that begins and ends with a certain PATTERN, but with variable content in the middle</li>
</ul>


<p><code>
grep -E '^de......tion$' /usr/share/dict/words | head -n 5
deactivation
dealkylation
deallocation
deambulation
deammonation
</code></p>

<h4>find</h4>

<blockquote><p>search for files in a directory hierarchy</p></blockquote>

<ul>
<li><p>find / -perm -6000 # find SUID and SGID</p></li>
<li><p>find / -size 10M -type f # find files whose size is 10 megabytes</p></li>
<li><p>type d/c/l/f # directories/character devices/symlinks/files</p></li>
<li><p>user <username> # owned by username</p></li>
<li><p>exec <cmd> &lsquo;{}&rsquo; + # execute cmd on results of the find cmd</p></li>
<li><p>print # print full filename to stdout, followed by newline</p></li>
<li><p>name &ldquo;value&rdquo; # find values that start with the name</p></li>
<li><p>iname # ignore case</p></li>
<li><p>not -name # not <name></p></li>
<li><p>size +/&ndash; c/k/m/G # size in bytes; + =larger than, &ndash; = smaller than; c = bytes, k = kilobytes, m = megabytes, G = gigabytes</p></li>
<li><p>mtime # modification time</p></li>
<li><p>atime # access time</p></li>
</ul>


<h4>which</h4>

<blockquote><p>shows the full path of (shell) commands. It does this by searching for an executable or script in the directories listed in the environment variable PATH</p></blockquote>

<p><code>
which python
/usr/bin/python
</code></p>

<h4>locate</h4>

<blockquote><p>find files by name. Reads one or more databases prepared by updatedb(8) and writes file names matching at least one of the PATTERNs to  standard  output,  one  per line.</p></blockquote>

<p>It is much faster than find. On most systems, <em>locate</em> is a link to <em>slocate</em>, which includes security features that prevent users from seeing files in directories they shouldn&rsquo;t be able to access</p>

<p><code>
locate tcpdump
/usr/sbin/tcpdump
/usr/share/bash-completion/completions/tcpdump
/usr/share/doc/tcpdump-4.5.1
/usr/share/doc/systemtap-client-3.0/examples/network/tcpdumplike.meta
/usr/share/doc/systemtap-client-3.0/examples/network/tcpdumplike.stp
/usr/share/doc/tcpdump-4.5.1/CHANGES
/usr/share/doc/tcpdump-4.5.1/CREDITS
/usr/share/doc/tcpdump-4.5.1/LICENSE
/usr/share/doc/tcpdump-4.5.1/README.md
/usr/share/man/man8/tcpdump.8.gz
/usr/share/mime/application/vnd.tcpdump.pcap.xml
/var/cache/man/cat8/tcpdump.8.gz
</code></p>

<h4>tar</h4>

<blockquote><p>saves many files together into a single tape or disk archive, and can restore individual files from the archive</p></blockquote>

<ul>
<li><p>c # create archive</p></li>
<li><p>t # list the contents of an archive</p></li>
<li><p>x # extract files from archive</p></li>
<li><p>v # verbosely list files processed</p></li>
<li><p>z # gzip compression</p></li>
<li><p>j # bzip compression</p></li>
<li><p>A # append files to existing archive</p></li>
<li><p>file # archive file</p></li>
<li><p>p # preserve permissions</p></li>
<li><p>W # attempt to verify the archive after writing it</p></li>
<li><p>&mdash;exclude=PATTERN # exclude files</p></li>
<li><p>create archive</p></li>
</ul>


<p><code>
tar cvzf arhive.tar.gz Documents/
Documents/
Documents/test.txt
Documents/archive_file
[root@tron ~]# ls
</code></p>

<ul>
<li>list files in archive_file</li>
</ul>


<p><code>
tar tvf arhive.tar.gz
drwxr-xr-x root/root         0 2017-09-08 17:54 Documents/
-rw-r--r-- root/root        36 2017-09-08 17:53 Documents/test.txt
-rw-r--r-- root/root         0 2017-09-08 17:54 Documents/archive_file
</code></p>

<ul>
<li>decompress gzip archive: <code>tar xzvf arhive.tar.gz</code></li>
</ul>


<p>```</p>

<hr />

<p>/ Kindness is a language which the deaf \
| can hear and the blind can read.      |
|                                       |
\ &mdash; Mark Twain                         /</p>

<hr />

<pre><code>    \   ^__^
     \  (oo)\_______
        (__)\       )\/\
            ||----w |
            ||     ||
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LFCS prep - Managing SELinux]]></title>
    <link href="http://chousensha.github.io/blog/2018/02/23/lfcs-prep-managing-selinux/"/>
    <updated>2018-02-23T13:18:55-05:00</updated>
    <id>http://chousensha.github.io/blog/2018/02/23/lfcs-prep-managing-selinux</id>
    <content type="html"><![CDATA[<p>In this post we&rsquo;ll go over using SELinux to manage the security of a Linux system.</p>

<p>NSA Security-Enhanced Linux or SELinux is a mandatory access control architecture controlled through the <code>/etc/selinux/config</code> file.</p>

<!-- more -->


<p>Let&rsquo;s take a peek at the file on my box:</p>

<p>```
cat /etc/selinux/config</p>

<h1>This file controls the state of SELinux on the system.</h1>

<h1>SELINUX= can take one of these three values:</h1>

<h1>enforcing &ndash; SELinux security policy is enforced.</h1>

<h1>permissive &ndash; SELinux prints warnings instead of enforcing.</h1>

<h1>disabled &ndash; No SELinux policy is loaded.</h1>

<p>SELINUX=enforcing</p>

<h1>SELINUXTYPE= can take one of three two values:</h1>

<h1>targeted &ndash; Targeted processes are protected,</h1>

<h1>minimum &ndash; Modification of targeted policy. Only selected processes are protected.</h1>

<h1>mls &ndash; Multi Level Security protection.</h1>

<p>SELINUXTYPE=targeted
```</p>

<p>If SELinux is disabled and then enabled, all the files inside the filesystem will need to be re-labeled.</p>

<p>You can adjust SELinux with many commands and utilities:</p>

<h3>getenforce</h3>

<blockquote><p>get the current mode of SELinux</p></blockquote>

<p><code>
getenforce
Enforcing
</code></p>

<h3>sestatus</h3>

<blockquote><p>SELinux status tool</p></blockquote>

<p><code>
sestatus
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Max kernel policy version:      28
</code></p>

<h3>setenforce</h3>

<blockquote><p>modify the mode SELinux is running in</p>

<p>Use Enforcing or 1 to put SELinux in enforcing mode.
Use Permissive or 0 to put SELinux in permissive mode</p></blockquote>

<h3>SELinux log files:</h3>

<p><code>
tail /var/log/audit/audit.log | grep AVC
type=USER_AVC msg=audit(1518200447.761:276): pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:s0 msg='avc:  denied  { status } for auid=n/a uid=0 gid=0 path="/etc/fstab" cmdline="systemctl show --property=RequiredBy -- -.mount" scontext=system_u:system_r:initrc_t:s0 tcontext=unconfined_u:object_r:etc_t:s0 tclass=service  exe="/usr/lib/systemd/systemd" sauid=0 hostname=? addr=? terminal=?'
</code></p>

<h3>ausearch</h3>

<blockquote><p>a tool to query audit daemon logs</p></blockquote>

<p>```</p>

<h2>ausearch -m avc</h2>

<p>time->Wed Aug  3 15:23:45 2016
type=SYSCALL msg=audit(1470227025.724:584): arch=c000003e syscall=49 success=no exit=-13 a0=6 a1=7efd495a23a8 a2=1c a3=7fff168b531c items=0 ppid=1 pid=8541 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm=&ldquo;httpd&rdquo; exe=&ldquo;/usr/sbin/httpd&rdquo; subj=system_u:system_r:httpd_t:s0 key=(null)
type=AVC msg=audit(1470227025.724:584): avc:  denied  { name_bind } for  pid=8541 comm=&ldquo;httpd&rdquo; src=8888 scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:unreserved_port_t:s0 tclass=tcp_socket
```</p>

<h3>restorecon</h3>

<blockquote><p>restore file(s) default SELinux security contexts.</p></blockquote>

<h3>chcon</h3>

<blockquote><p>change file SELinux security context</p></blockquote>

<h3>semanage</h3>

<blockquote><p>SELinux Policy Management tool</p></blockquote>

<p><code>
semanage boolean -l | grep nfs
xen_use_nfs                    (off  ,  off)  Allow xen to use nfs
mpd_use_nfs                    (off  ,  off)  Allow mpd to use nfs
virt_use_nfs                   (off  ,  off)  Allow virt to use nfs
use_nfs_home_dirs              (off  ,  off)  Allow use to nfs home dirs
ksmtuned_use_nfs               (off  ,  off)  Allow ksmtuned to use nfs
nfsd_anon_write                (off  ,  off)  Allow nfsd to anon write
git_system_use_nfs             (off  ,  off)  Allow git to system use nfs
git_cgi_use_nfs                (off  ,  off)  Allow git to cgi use nfs
logrotate_use_nfs              (off  ,  off)  Allow logrotate to use nfs
cobbler_use_nfs                (off  ,  off)  Allow cobbler to use nfs
httpd_use_nfs                  (off  ,  off)  Allow httpd to use nfs
sge_use_nfs                    (off  ,  off)  Allow sge to use nfs
sanlock_use_nfs                (off  ,  off)  Allow sanlock to use nfs
samba_share_nfs                (off  ,  off)  Allow samba to share nfs
ftpd_use_nfs                   (off  ,  off)  Allow ftpd to use nfs
openshift_use_nfs              (off  ,  off)  Allow openshift to use nfs
polipo_use_nfs                 (off  ,  off)  Allow polipo to use nfs
tmpreaper_use_nfs              (off  ,  off)  Allow tmpreaper to use nfs
nfs_export_all_rw              (on   ,   on)  Allow nfs to export all rw
nfs_export_all_ro              (on   ,   on)  Allow nfs to export all ro
</code></p>

<ul>
<li>list ports</li>
</ul>


<p><code>
semanage port -l | grep ftp
ftp_data_port_t                tcp      20
ftp_port_t                     tcp      21, 989, 990
ftp_port_t                     udp      989, 990
tftp_port_t                    udp      69
</code></p>

<ul>
<li>change label</li>
</ul>


<p><code>
semanage fcontext --add -t &lt;type&gt; file
</code></p>

<p>You need to call restorecon after changing the context</p>

<h3>getsebool</h3>

<blockquote><p>get SELinux boolean value(s)</p></blockquote>

<p><code>
getsebool -a | grep ftp
ftpd_anon_write --&gt; off
ftpd_connect_all_unreserved --&gt; off
ftpd_connect_db --&gt; off
ftpd_full_access --&gt; off
ftpd_use_cifs --&gt; off
ftpd_use_fusefs --&gt; off
ftpd_use_nfs --&gt; off
ftpd_use_passive_mode --&gt; off
httpd_can_connect_ftp --&gt; off
httpd_enable_ftp_server --&gt; off
tftp_anon_write --&gt; off
tftp_home_dir --&gt; off
</code></p>

<h3>setsebool</h3>

<blockquote><p>set SELinux boolean value</p></blockquote>

<p><code>
setseebol &lt;boolean&gt; on/off
</code></p>

<ul>
<li>-P # make the change persistent to reboots</li>
</ul>


<h3>seinfo</h3>

<blockquote><p>SELinux policy query tool</p></blockquote>

<p>Install the <em>setools</em> package to get this utility</p>

<p>```
seinfo</p>

<p>Statistics for policy file: /sys/fs/selinux/policy
Policy Version &amp; Type: v.28 (binary, mls)</p>

<p>   Classes:            91    Permissions:       256
   Sensitivities:       1    Categories:       1024
   Types:            4729    Attributes:        251
   Users:               8    Roles:              14
   Booleans:          301    Cond. Expr.:       350
   Allow:          101266    Neverallow:          0
   Auditallow:        157    Dontaudit:        8030
   Type_trans:      17756    Type_change:        74
   Type_member:        35    Role allow:         39
   Role_trans:        416    Range_trans:      5697
   Constraints:       109    Validatetrans:       0
   Initial SIDs:       27    Fs_use:             28
   Genfscon:          105    Portcon:           597
   Netifcon:            0    Nodecon:             0
   Permissives:         6    Polcap:              2
```</p>

<h3>sealert</h3>

<blockquote><p>sealert is the user interface component (either GUI or command line) to
the  setroubleshoot  system. setroubleshoot is used to diagnose SELinux
denials and attempts  to  provide  user  friendly  explanations  for  a
SELinux  denial (e.g. AVC) and recommendations for how one might adjust
the system to prevent the denial in the future.</p></blockquote>

<ul>
<li><p>-l # Lookup alert by id, if id is wildcard * then return all alerts</p></li>
<li><p>-a # Scan a log file, analyze its AVC&rsquo;s</p></li>
</ul>


<p>```
sealert -a /var/log/audit/audit.log
100% done</p>

<h2>found 4 alerts in /var/log/audit/audit.log</h2>

<p>SELinux is preventing /usr/bin/pgrep from getattr access on the filesystem /sys.</p>

<p><strong><strong><em>  Plugin catchall (100. confidence) suggests   </em></strong></strong>*********************</p>

<p>If you believe that pgrep should be allowed getattr access on the sys filesystem by default.
Then you should report this as a bug.
You can generate a local policy module to allow this access.
Do
allow this access for now by executing:</p>

<h1>ausearch -c &lsquo;pgrep&rsquo; &mdash;raw | audit2allow -M my-pgrep</h1>

<h1>semodule -i my-pgrep.pp</h1>

<p>Additional Information:
Source Context                system_u:system_r:ksmtuned_t:s0
Target Context                system_u:object_r:sysfs_t:s0
Target Objects                /sys [ filesystem ]
Source                        pgrep
Source Path                   /usr/bin/pgrep
Port                          <Unknown>
Host                          <Unknown>
Source RPM Packages           procps-ng-3.3.10-10.el7.x86_64
Target RPM Packages           filesystem-3.2-21.el7.x86_64
Policy RPM                    selinux-policy-3.13.1-102.el7_3.16.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Enforcing
Host Name                     rhel7
Platform                      Linux rhel7 3.10.0-514.26.2.el7.x86_64 #1 SMP Fri</p>

<pre><code>                          Jun 30 05:26:04 UTC 2017 x86_64 x86_64
</code></pre>

<p>Alert Count                   9
First Seen                    2018-02-10 02:25:54 JST
Last Seen                     2018-02-10 03:19:45 JST
Local ID                      d5a68144-c84d-44c4-bde0-31380fd5bb60</p>

<p>Raw Audit Messages
type=AVC msg=audit(1518200385.729:205): avc:  denied  { getattr } for  pid=4616 comm=&ldquo;pgrep&rdquo; name=&ldquo;/&rdquo; dev=&ldquo;sysfs&rdquo; ino=1 scontext=system_u:system_r:ksmtuned_t:s0 tcontext=system_u:object_r:sysfs_t:s0 tclass=filesystem</p>

<p>type=SYSCALL msg=audit(1518200385.729:205): arch=x86_64 syscall=statfs success=no exit=EACCES a0=7f9407f4e013 a1=7fffcd705e80 a2=fffffffffff476d8 a3=7fffcd705b90 items=0 ppid=4615 pid=4616 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=(none) ses=4294967295 comm=pgrep exe=/usr/bin/pgrep subj=system_u:system_r:ksmtuned_t:s0 key=(null)</p>

<p>Hash: pgrep,ksmtuned_t,sysfs_t,filesystem,getattr
[&hellip;]
```</p>

<p>```</p>

<hr />

<p>/ Someone is speaking well of you. \
|                                  |
\ How unusual!                     /</p>

<hr />

<pre><code>    \   ^__^
     \  (oo)\_______
        (__)\       )\/\
            ||----w |
            ||     ||
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LFCS prep - Software RAID]]></title>
    <link href="http://chousensha.github.io/blog/2018/02/22/lfcs-prep-software-raid/"/>
    <updated>2018-02-22T13:37:45-05:00</updated>
    <id>http://chousensha.github.io/blog/2018/02/22/lfcs-prep-software-raid</id>
    <content type="html"><![CDATA[<p>Today we&rsquo;ll look at creating software RAID devices with <em>mdadm</em>. For the example I will use /dev/sdb1 and /dev/sdb2</p>

<!-- more -->


<p>To create an array:</p>

<p>```
mdadm &mdash;create &mdash;verbose /dev/md0 &mdash;level=mirror &mdash;raid-devices=2 /dev/sdb1 /dev/sdb2
mdadm: /dev/sdb1 appears to be part of a raid array:</p>

<pre><code>   level=raid0 devices=0 ctime=Thu Jan  1 09:00:00 1970
</code></pre>

<p>mdadm: partition table exists on /dev/sdb1 but will be lost or</p>

<pre><code>   meaningless after creating array
</code></pre>

<p>mdadm: Note: this array has metadata at the start and</p>

<pre><code>may not be suitable as a boot device.  If you plan to
store '/boot' on this device please ensure that
your boot-loader understands md/v1.x metadata, or use
--metadata=0.90
</code></pre>

<p>mdadm: size set to 102272K
Continue creating array? y
mdadm: Defaulting to version 1.2 metadata
mdadm: array /dev/md0 started.</p>

<p>```</p>

<p>To view more information about the array:</p>

<p>```
cat /proc/mdstat
Personalities : [raid1]
md0 : active raid1 sdb2[1] sdb1[0]</p>

<pre><code>  102272 blocks super 1.2 [2/2] [UU]
</code></pre>

<p>unused devices: <none>
```</p>

<p>For more detailed information:</p>

<p>```
mdadm &mdash;detail /dev/md0
/dev/md0:</p>

<pre><code>    Version : 1.2
</code></pre>

<p>  Creation Time : Tue Feb 20 00:17:49 2018</p>

<pre><code> Raid Level : raid1
 Array Size : 102272 (99.88 MiB 104.73 MB)
</code></pre>

<p>  Used Dev Size : 102272 (99.88 MiB 104.73 MB)
   Raid Devices : 2
  Total Devices : 2</p>

<pre><code>Persistence : Superblock is persistent

Update Time : Tue Feb 20 00:17:53 2018
      State : clean 
</code></pre>

<p> Active Devices : 2
Working Devices : 2
 Failed Devices : 0
  Spare Devices : 0</p>

<pre><code>       Name : rhel7:0  (local to host rhel7)
       UUID : a92e04f3:1652f291:8c68266d:6c760648
     Events : 17

Number   Major   Minor   RaidDevice State
   0       8       17        0      active sync   /dev/sdb1
   1       8       18        1      active sync   /dev/sdb2
</code></pre>

<p>```</p>

<p>Now format the RAID device:</p>

<p><code>
mkfs.ext4 /dev/md0
</code></p>

<p>You need to create the config file <code>/etc/mdadm.conf</code> and add to it the output of the below command:</p>

<p><code>
mdadm --detail --scan
ARRAY /dev/md0 metadata=1.2 name=rhel7:0 UUID=a92e04f3:1652f291:8c68266d:6c760648
</code></p>

<p>See more information about the array disks:</p>

<p>```
mdadm &mdash;examine /dev/sdb1
/dev/sdb1:</p>

<pre><code>      Magic : a92b4efc
    Version : 1.2
Feature Map : 0x0
 Array UUID : a92e04f3:1652f291:8c68266d:6c760648
       Name : rhel7:0  (local to host rhel7)
</code></pre>

<p>  Creation Time : Tue Feb 20 00:17:49 2018</p>

<pre><code> Raid Level : raid1
</code></pre>

<p>   Raid Devices : 2</p>

<p> Avail Dev Size : 204640 (99.92 MiB 104.78 MB)</p>

<pre><code> Array Size : 102272 (99.88 MiB 104.73 MB)
</code></pre>

<p>  Used Dev Size : 204544 (99.88 MiB 104.73 MB)</p>

<pre><code>Data Offset : 160 sectors
</code></pre>

<p>   Super Offset : 8 sectors
   Unused Space : before=72 sectors, after=96 sectors</p>

<pre><code>      State : clean
Device UUID : 109087ab:0f2121e6:b6e09819:ffba2648

Update Time : Tue Feb 20 00:22:17 2018
</code></pre>

<p>  Bad Block Log : 512 entries available at offset 72 sectors</p>

<pre><code>   Checksum : f832b421 - correct
     Events : 17
</code></pre>

<p>   Device Role : Active device 0
   Array State : AA (&lsquo;A&rsquo; == active, &lsquo;.&rsquo; == missing, &lsquo;R&rsquo; == replacing)
```</p>

<p>Mount the array and check it:</p>

<p><code>
df -h /dev/md0
Filesystem      Size  Used Avail Use% Mounted on
/dev/md0         93M  1.6M   85M   2% /mnt/raid
</code></p>

<p>Other useful commands:</p>

<ul>
<li>assemble array</li>
</ul>


<p><code>
mdadm --assemble /dev/md0
</code></p>

<ul>
<li>remove disk from array (you have to mark it as failing first)</li>
</ul>


<p><code>
mdadm --fail /dev/md0 /dev/sdb2
mdadm --remove /dev/md0 /dev/sdb2
</code></p>

<ul>
<li>add disk to array</li>
</ul>


<p><code>
mdadm --add /dev/md0 /dev/sdb2
</code></p>

<ul>
<li>remove array</li>
</ul>


<p><code>
mdadm --stop /dev/md0
mdadm --remove /dev/md0
</code></p>

<p>```</p>

<hr />

<p>/ Don&rsquo;t relax! It&rsquo;s only your tension \
\ that&rsquo;s holding you together.        /</p>

<hr />

<pre><code>    \   ^__^
     \  (oo)\_______
        (__)\       )\/\
            ||----w |
            ||     ||
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
</feed>
